<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Simple random sampling | Spatial sampling with R</title>
  <meta name="description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Simple random sampling | Spatial sampling with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.pdf" />
  <meta property="og:description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="github-repo" content="DickBrus/SpatialSamplingwithR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Simple random sampling | Spatial sampling with R" />
  
  <meta name="twitter:description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="twitter:image" content="/images/cover.pdf" />

<meta name="author" content="Dick J. Brus" />


<meta name="date" content="2023-02-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="IntroProbabilitySampling.html"/>
<link rel="next" href="STSI.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial sampling with R</a></li>

<li class="divider"></li>
<li><a href="index.html#preface" id="toc-preface">Preface</a>
<ul>
<li><a href="index.html#acknowledgments" id="toc-acknowledgments">Acknowledgments</a></li>
</ul></li>
<li><a href="GeneralIntro.html#GeneralIntro" id="toc-GeneralIntro"><span class="toc-section-number">1</span> Introduction</a>
<ul>
<li><a href="GeneralIntro.html#BasicConcepts" id="toc-BasicConcepts"><span class="toc-section-number">1.1</span> Basic sampling concepts</a>
<ul>
<li><a href="GeneralIntro.html#PopulationParameters" id="toc-PopulationParameters"><span class="toc-section-number">1.1.1</span> Population parameters</a></li>
<li><a href="GeneralIntro.html#descriptive-statistics-vs.-inference-about-a-population" id="toc-descriptive-statistics-vs.-inference-about-a-population"><span class="toc-section-number">1.1.2</span> Descriptive statistics vs. inference about a population</a></li>
<li><a href="GeneralIntro.html#random-sampling-vs.-probability-sampling" id="toc-random-sampling-vs.-probability-sampling"><span class="toc-section-number">1.1.3</span> Random sampling vs. probability sampling</a></li>
</ul></li>
<li><a href="GeneralIntro.html#DBvsMB" id="toc-DBvsMB"><span class="toc-section-number">1.2</span> Design-based vs. model-based approach</a></li>
<li><a href="GeneralIntro.html#Datasets" id="toc-Datasets"><span class="toc-section-number">1.3</span> Populations used in sampling experiments</a>
<ul>
<li><a href="GeneralIntro.html#Voorst" id="toc-Voorst"><span class="toc-section-number">1.3.1</span> Soil organic matter in Voorst, the Netherlands</a></li>
<li><a href="GeneralIntro.html#Poppy" id="toc-Poppy"><span class="toc-section-number">1.3.2</span> Poppy fields in Kandahar, Afghanistan</a></li>
<li><a href="GeneralIntro.html#Amazonia" id="toc-Amazonia"><span class="toc-section-number">1.3.3</span> Aboveground biomass in Eastern Amazonia, Brazil</a></li>
<li><a href="GeneralIntro.html#TASIberia" id="toc-TASIberia"><span class="toc-section-number">1.3.4</span> Annual mean air temperature in Iberia</a></li>
</ul></li>
</ul></li>
<li><a href="#part-probability-sampling-for-estimating-population-parameters" id="toc-part-probability-sampling-for-estimating-population-parameters">(PART) Probability sampling for estimating population parameters</a></li>
<li><a href="IntroProbabilitySampling.html#IntroProbabilitySampling" id="toc-IntroProbabilitySampling"><span class="toc-section-number">2</span> Introduction to probability sampling</a>
<ul>
<li><a href="IntroProbabilitySampling.html#arbitrary-haphazard-sampling-vs.-probability-sampling" id="toc-arbitrary-haphazard-sampling-vs.-probability-sampling">Arbitrary (haphazard) sampling vs. probability sampling</a></li>
<li><a href="IntroProbabilitySampling.html#HTestimator" id="toc-HTestimator"><span class="toc-section-number">2.1</span> Horvitz-Thompson estimator</a></li>
<li><a href="IntroProbabilitySampling.html#hansen-hurwitz-estimator" id="toc-hansen-hurwitz-estimator"><span class="toc-section-number">2.2</span> Hansen-Hurwitz estimator</a></li>
<li><a href="IntroProbabilitySampling.html#using-models-in-design-based-approach" id="toc-using-models-in-design-based-approach"><span class="toc-section-number">2.3</span> Using models in design-based approach</a></li>
</ul></li>
<li><a href="SI.html#SI" id="toc-SI"><span class="toc-section-number">3</span> Simple random sampling</a>
<ul>
<li><a href="SI.html#HTestimatorSI" id="toc-HTestimatorSI"><span class="toc-section-number">3.1</span> Estimation of population parameters</a>
<ul>
<li><a href="SI.html#PopProportion" id="toc-PopProportion"><span class="toc-section-number">3.1.1</span> Population proportion</a></li>
<li><a href="SI.html#CDF" id="toc-CDF"><span class="toc-section-number">3.1.2</span> Cumulative distribution function and quantiles</a></li>
</ul></li>
<li><a href="SI.html#VarMeanSI" id="toc-VarMeanSI"><span class="toc-section-number">3.2</span> Sampling variance of estimator of population parameters</a></li>
<li><a href="SI.html#ConfidenceInterval" id="toc-ConfidenceInterval"><span class="toc-section-number">3.3</span> Confidence interval estimate</a>
<ul>
<li><a href="SI.html#ConfidenceIntervalProportion" id="toc-ConfidenceIntervalProportion"><span class="toc-section-number">3.3.1</span> Confidence interval for a proportion</a></li>
</ul></li>
<li><a href="SI.html#SIcircularplots" id="toc-SIcircularplots"><span class="toc-section-number">3.4</span> Simple random sampling of circular plots</a>
<ul>
<li><a href="SI.html#sampling-from-a-finite-set-of-fixed-circles" id="toc-sampling-from-a-finite-set-of-fixed-circles"><span class="toc-section-number">3.4.1</span> Sampling from a finite set of fixed circles</a></li>
<li><a href="SI.html#sampling-from-an-infinite-set-of-floating-circles" id="toc-sampling-from-an-infinite-set-of-floating-circles"><span class="toc-section-number">3.4.2</span> Sampling from an infinite set of floating circles</a></li>
</ul></li>
</ul></li>
<li><a href="STSI.html#STSI" id="toc-STSI"><span class="toc-section-number">4</span> Stratified simple random sampling</a>
<ul>
<li><a href="STSI.html#EstimatorsSTSI" id="toc-EstimatorsSTSI"><span class="toc-section-number">4.1</span> Estimation of population parameters</a>
<ul>
<li><a href="STSI.html#population-proportion-cumulative-distribution-function-and-quantiles" id="toc-population-proportion-cumulative-distribution-function-and-quantiles"><span class="toc-section-number">4.1.1</span> Population proportion, cumulative distribution function, and quantiles</a></li>
<li><a href="STSI.html#WhyStratify" id="toc-WhyStratify"><span class="toc-section-number">4.1.2</span> Why should we stratify?</a></li>
</ul></li>
<li><a href="STSI.html#CISTSI" id="toc-CISTSI"><span class="toc-section-number">4.2</span> Confidence interval estimate</a></li>
<li><a href="STSI.html#STSIallocation" id="toc-STSIallocation"><span class="toc-section-number">4.3</span> Allocation of sample size to strata</a></li>
<li><a href="STSI.html#cumrootf" id="toc-cumrootf"><span class="toc-section-number">4.4</span> <em>Cum-root-f</em> stratification</a></li>
<li><a href="STSI.html#kmeansstratification" id="toc-kmeansstratification"><span class="toc-section-number">4.5</span> Stratification with multiple covariates</a></li>
<li><a href="STSI.html#geostrata" id="toc-geostrata"><span class="toc-section-number">4.6</span> Geographical stratification</a></li>
<li><a href="STSI.html#multiway-stratification" id="toc-multiway-stratification"><span class="toc-section-number">4.7</span> Multiway stratification</a></li>
<li><a href="STSI.html#MultivariateStratification" id="toc-MultivariateStratification"><span class="toc-section-number">4.8</span> Multivariate stratification</a></li>
</ul></li>
<li><a href="SY.html#SY" id="toc-SY"><span class="toc-section-number">5</span> Systematic random sampling</a>
<ul>
<li><a href="SY.html#EstVarSY" id="toc-EstVarSY"><span class="toc-section-number">5.1</span> Estimation of population parameters</a></li>
<li><a href="SY.html#approximating-the-sampling-variance-of-the-estimator-of-the-mean" id="toc-approximating-the-sampling-variance-of-the-estimator-of-the-mean"><span class="toc-section-number">5.2</span> Approximating the sampling variance of the estimator of the mean</a></li>
</ul></li>
<li><a href="Cl.html#Cl" id="toc-Cl"><span class="toc-section-number">6</span> Cluster random sampling</a>
<ul>
<li><a href="Cl.html#clustersamplingestimators" id="toc-clustersamplingestimators"><span class="toc-section-number">6.1</span> Estimation of population parameters</a></li>
<li><a href="Cl.html#clusters-selected-with-probabilities-proportional-to-size-without-replacement" id="toc-clusters-selected-with-probabilities-proportional-to-size-without-replacement"><span class="toc-section-number">6.2</span> Clusters selected with probabilities proportional to size, without replacement</a></li>
<li><a href="Cl.html#SIC" id="toc-SIC"><span class="toc-section-number">6.3</span> Simple random sampling of clusters</a></li>
<li><a href="Cl.html#StratifiedCl" id="toc-StratifiedCl"><span class="toc-section-number">6.4</span> Stratified cluster random sampling</a></li>
</ul></li>
<li><a href="Twostage.html#Twostage" id="toc-Twostage"><span class="toc-section-number">7</span> Two-stage cluster random sampling</a>
<ul>
<li><a href="Twostage.html#twostagesamplingestimators" id="toc-twostagesamplingestimators"><span class="toc-section-number">7.1</span> Estimation of population parameters</a></li>
<li><a href="Twostage.html#primary-sampling-units-selected-without-replacement" id="toc-primary-sampling-units-selected-without-replacement"><span class="toc-section-number">7.2</span> Primary sampling units selected without replacement</a></li>
<li><a href="Twostage.html#TwostageSISI" id="toc-TwostageSISI"><span class="toc-section-number">7.3</span> Simple random sampling of primary sampling units</a></li>
<li><a href="Twostage.html#StratifiedTwostage" id="toc-StratifiedTwostage"><span class="toc-section-number">7.4</span> Stratified two-stage cluster random sampling</a></li>
</ul></li>
<li><a href="pps.html#pps" id="toc-pps"><span class="toc-section-number">8</span> Sampling with probabilities proportional to size</a>
<ul>
<li><a href="pps.html#ppswr" id="toc-ppswr"><span class="toc-section-number">8.1</span> Probability-proportional-to-size sampling with replacement</a></li>
<li><a href="pps.html#ppswor" id="toc-ppswor"><span class="toc-section-number">8.2</span> Probability-proportional-to-size sampling without replacement</a>
<ul>
<li><a href="pps.html#Systematicpps" id="toc-Systematicpps"><span class="toc-section-number">8.2.1</span> Systematic pps sampling without replacement</a></li>
<li><a href="pps.html#pivotalmethod" id="toc-pivotalmethod"><span class="toc-section-number">8.2.2</span> The pivotal method</a></li>
</ul></li>
</ul></li>
<li><a href="BalancedSpreaded.html#BalancedSpreaded" id="toc-BalancedSpreaded"><span class="toc-section-number">9</span> Balanced and well-spread sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#Balanced" id="toc-Balanced"><span class="toc-section-number">9.1</span> Balanced sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#balanced-sample-vs.-balanced-sampling-design" id="toc-balanced-sample-vs.-balanced-sampling-design"><span class="toc-section-number">9.1.1</span> Balanced sample vs. balanced sampling design</a></li>
<li><a href="BalancedSpreaded.html#unequal-inclusion-probabilities" id="toc-unequal-inclusion-probabilities"><span class="toc-section-number">9.1.2</span> Unequal inclusion probabilities</a></li>
<li><a href="BalancedSpreaded.html#StratifiedsamplingasBalancedsampling" id="toc-StratifiedsamplingasBalancedsampling"><span class="toc-section-number">9.1.3</span> Stratified random sampling</a></li>
<li><a href="BalancedSpreaded.html#Multiwaystratification" id="toc-Multiwaystratification"><span class="toc-section-number">9.1.4</span> Multiway stratification</a></li>
</ul></li>
<li><a href="BalancedSpreaded.html#Spreaded" id="toc-Spreaded"><span class="toc-section-number">9.2</span> Well-spread sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#LPM" id="toc-LPM"><span class="toc-section-number">9.2.1</span> Local pivotal method</a></li>
<li><a href="BalancedSpreaded.html#GRTS" id="toc-GRTS"><span class="toc-section-number">9.2.2</span> Generalised random-tessellation stratified sampling</a></li>
</ul></li>
<li><a href="BalancedSpreaded.html#BalancedandSpreaded" id="toc-BalancedandSpreaded"><span class="toc-section-number">9.3</span> Balanced sampling with spreading</a></li>
</ul></li>
<li><a href="Modelassisted.html#Modelassisted" id="toc-Modelassisted"><span class="toc-section-number">10</span> Model-assisted estimation</a>
<ul>
<li><a href="Modelassisted.html#GREG" id="toc-GREG"><span class="toc-section-number">10.1</span> Generalised regression estimator</a>
<ul>
<li><a href="Modelassisted.html#RegressionEstimator" id="toc-RegressionEstimator"><span class="toc-section-number">10.1.1</span> Simple and multiple regression estimators</a></li>
<li><a href="Modelassisted.html#penalised-least-squares-estimation" id="toc-penalised-least-squares-estimation"><span class="toc-section-number">10.1.2</span> Penalised least squares estimation</a></li>
<li><a href="Modelassisted.html#RegressionEstimatorSTSI" id="toc-RegressionEstimatorSTSI"><span class="toc-section-number">10.1.3</span> Regression estimator with stratified simple random sampling</a></li>
</ul></li>
<li><a href="Modelassisted.html#RatioEstimator" id="toc-RatioEstimator"><span class="toc-section-number">10.2</span> Ratio estimator</a>
<ul>
<li><a href="Modelassisted.html#RatioEstimatorSTSI" id="toc-RatioEstimatorSTSI"><span class="toc-section-number">10.2.1</span> Ratio estimators with stratified simple random sampling</a></li>
</ul></li>
<li><a href="Modelassisted.html#PoststratifiedEstimator" id="toc-PoststratifiedEstimator"><span class="toc-section-number">10.3</span> Poststratified estimator</a></li>
<li><a href="Modelassisted.html#RandomForest" id="toc-RandomForest"><span class="toc-section-number">10.4</span> Model-assisted estimation using machine learning techniques</a>
<ul>
<li><a href="Modelassisted.html#predicting-with-a-regression-tree" id="toc-predicting-with-a-regression-tree"><span class="toc-section-number">10.4.1</span> Predicting with a regression tree</a></li>
<li><a href="Modelassisted.html#predicting-with-a-random-forest" id="toc-predicting-with-a-random-forest"><span class="toc-section-number">10.4.2</span> Predicting with a random forest</a></li>
</ul></li>
<li><a href="Modelassisted.html#big-data-and-volunteer-data" id="toc-big-data-and-volunteer-data"><span class="toc-section-number">10.5</span> Big data and volunteer data</a></li>
</ul></li>
<li><a href="Twophase.html#Twophase" id="toc-Twophase"><span class="toc-section-number">11</span> Two-phase random sampling</a>
<ul>
<li><a href="Twophase.html#TwophaseStratification" id="toc-TwophaseStratification"><span class="toc-section-number">11.1</span> Two-phase random sampling for stratification</a></li>
<li><a href="Twophase.html#TwophaseRegression" id="toc-TwophaseRegression"><span class="toc-section-number">11.2</span> Two-phase random sampling for regression</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#RequiredSampleSize" id="toc-RequiredSampleSize"><span class="toc-section-number">12</span> Computing the required sample size</a>
<ul>
<li><a href="RequiredSampleSize.html#standard-error" id="toc-standard-error"><span class="toc-section-number">12.1</span> Standard error</a></li>
<li><a href="RequiredSampleSize.html#ReqSampleSizeLengthCI" id="toc-ReqSampleSizeLengthCI"><span class="toc-section-number">12.2</span> Length of confidence interval</a>
<ul>
<li><a href="RequiredSampleSize.html#length-of-confidence-interval-for-a-proportion" id="toc-length-of-confidence-interval-for-a-proportion"><span class="toc-section-number">12.2.1</span> Length of confidence interval for a proportion</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#statistical-testing-of-hypothesis" id="toc-statistical-testing-of-hypothesis"><span class="toc-section-number">12.3</span> Statistical testing of hypothesis</a>
<ul>
<li><a href="RequiredSampleSize.html#sample-size-for-testing-a-proportion" id="toc-sample-size-for-testing-a-proportion"><span class="toc-section-number">12.3.1</span> Sample size for testing a proportion</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#DesignEffect" id="toc-DesignEffect"><span class="toc-section-number">12.4</span> Accounting for design effect</a></li>
<li><a href="RequiredSampleSize.html#BayesianSampleSize" id="toc-BayesianSampleSize"><span class="toc-section-number">12.5</span> Bayesian sample size determination</a>
<ul>
<li><a href="RequiredSampleSize.html#bayesian-criteria-for-sample-size-computation" id="toc-bayesian-criteria-for-sample-size-computation"><span class="toc-section-number">12.5.1</span> Bayesian criteria for sample size computation</a></li>
<li><a href="RequiredSampleSize.html#mixed-bayesian-likelihood-approach" id="toc-mixed-bayesian-likelihood-approach"><span class="toc-section-number">12.5.2</span> Mixed Bayesian-likelihood approach</a></li>
<li><a href="RequiredSampleSize.html#estimation-of-population-mean" id="toc-estimation-of-population-mean"><span class="toc-section-number">12.5.3</span> Estimation of population mean</a></li>
<li><a href="RequiredSampleSize.html#estimation-of-a-population-proportion" id="toc-estimation-of-a-population-proportion"><span class="toc-section-number">12.5.4</span> Estimation of a population proportion</a></li>
</ul></li>
</ul></li>
<li><a href="MBpredictionofDesignVariance.html#MBpredictionofDesignVariance" id="toc-MBpredictionofDesignVariance"><span class="toc-section-number">13</span> Model-based optimisation of probability sampling designs</a>
<ul>
<li><a href="MBpredictionofDesignVariance.html#model-based-optimisation-of-sampling-design-type-and-sample-size" id="toc-model-based-optimisation-of-sampling-design-type-and-sample-size"><span class="toc-section-number">13.1</span> Model-based optimisation of sampling design type and sample size</a>
<ul>
<li><a href="MBpredictionofDesignVariance.html#AnalyticalApproach" id="toc-AnalyticalApproach"><span class="toc-section-number">13.1.1</span> Analytical approach</a></li>
<li><a href="MBpredictionofDesignVariance.html#GeostatisticalSimulationApproach" id="toc-GeostatisticalSimulationApproach"><span class="toc-section-number">13.1.2</span> Geostatistical simulation approach</a></li>
<li><a href="MBpredictionofDesignVariance.html#MBpredSamplingVarBayes" id="toc-MBpredSamplingVarBayes"><span class="toc-section-number">13.1.3</span> Bayesian approach</a></li>
</ul></li>
<li><a href="MBpredictionofDesignVariance.html#Ospats" id="toc-Ospats"><span class="toc-section-number">13.2</span> Model-based optimisation of spatial strata</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#SmallAreaEstimation" id="toc-SmallAreaEstimation"><span class="toc-section-number">14</span> Sampling for estimating parameters of domains</a>
<ul>
<li><a href="SmallAreaEstimation.html#LargeDomainsDirectEstimator" id="toc-LargeDomainsDirectEstimator"><span class="toc-section-number">14.1</span> Direct estimator for large domains</a></li>
<li><a href="SmallAreaEstimation.html#SmallDomainsModelAssisted" id="toc-SmallDomainsModelAssisted"><span class="toc-section-number">14.2</span> Model-assisted estimators for small domains</a>
<ul>
<li><a href="SmallAreaEstimation.html#RegressionestimatorSmallDomain" id="toc-RegressionestimatorSmallDomain"><span class="toc-section-number">14.2.1</span> Regression estimator</a></li>
<li><a href="SmallAreaEstimation.html#SyntheticestimatorSmallDomain" id="toc-SyntheticestimatorSmallDomain"><span class="toc-section-number">14.2.2</span> Synthetic estimator</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#SmallAreaModelBased" id="toc-SmallAreaModelBased"><span class="toc-section-number">14.3</span> Model-based prediction</a>
<ul>
<li><a href="SmallAreaEstimation.html#random-intercept-model" id="toc-random-intercept-model"><span class="toc-section-number">14.3.1</span> Random intercept model</a></li>
<li><a href="SmallAreaEstimation.html#geostatistical-model" id="toc-geostatistical-model"><span class="toc-section-number">14.3.2</span> Geostatistical model</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#supplemental-probability-sampling-of-small-domains" id="toc-supplemental-probability-sampling-of-small-domains"><span class="toc-section-number">14.4</span> Supplemental probability sampling of small domains</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#RepeatedSurveys" id="toc-RepeatedSurveys"><span class="toc-section-number">15</span> Repeated sample surveys for monitoring population parameters</a>
<ul>
<li><a href="RepeatedSurveys.html#space-time-designs" id="toc-space-time-designs"><span class="toc-section-number">15.1</span> Space-time designs</a></li>
<li><a href="RepeatedSurveys.html#SpaceTimeparameters" id="toc-SpaceTimeparameters"><span class="toc-section-number">15.2</span> Space-time population parameters</a></li>
<li><a href="RepeatedSurveys.html#design-based-generalised-least-squares-estimation-of-spatial-means" id="toc-design-based-generalised-least-squares-estimation-of-spatial-means"><span class="toc-section-number">15.3</span> Design-based generalised least squares estimation of spatial means</a>
<ul>
<li><a href="RepeatedSurveys.html#current-mean" id="toc-current-mean"><span class="toc-section-number">15.3.1</span> Current mean</a></li>
<li><a href="RepeatedSurveys.html#change-of-the-spatial-mean" id="toc-change-of-the-spatial-mean"><span class="toc-section-number">15.3.2</span> Change of the spatial mean</a></li>
<li><a href="RepeatedSurveys.html#temporal-trend-of-the-spatial-mean" id="toc-temporal-trend-of-the-spatial-mean"><span class="toc-section-number">15.3.3</span> Temporal trend of the spatial mean</a></li>
<li><a href="RepeatedSurveys.html#space-time-mean" id="toc-space-time-mean"><span class="toc-section-number">15.3.4</span> Space-time mean</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#case-study-annual-mean-daily-temperature-in-iberia" id="toc-case-study-annual-mean-daily-temperature-in-iberia"><span class="toc-section-number">15.4</span> Case study: annual mean daily temperature in Iberia</a>
<ul>
<li><a href="RepeatedSurveys.html#static-synchronous-design" id="toc-static-synchronous-design"><span class="toc-section-number">15.4.1</span> Static-synchronous design</a></li>
<li><a href="RepeatedSurveys.html#independent-synchronous-design" id="toc-independent-synchronous-design"><span class="toc-section-number">15.4.2</span> Independent synchronous design</a></li>
<li><a href="RepeatedSurveys.html#serially-alternating-design" id="toc-serially-alternating-design"><span class="toc-section-number">15.4.3</span> Serially alternating design</a></li>
<li><a href="RepeatedSurveys.html#supplemented-panel-design" id="toc-supplemented-panel-design"><span class="toc-section-number">15.4.4</span> Supplemented panel design</a></li>
<li><a href="RepeatedSurveys.html#rotating-panel-design" id="toc-rotating-panel-design"><span class="toc-section-number">15.4.5</span> Rotating panel design</a></li>
<li><a href="RepeatedSurveys.html#sampling-experiment" id="toc-sampling-experiment"><span class="toc-section-number">15.4.6</span> Sampling experiment</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#space-time-sampling-with-stratified-random-sampling-in-space" id="toc-space-time-sampling-with-stratified-random-sampling-in-space"><span class="toc-section-number">15.5</span> Space-time sampling with stratified random sampling in space</a></li>
</ul></li>
<li><a href="#part-sampling-for-mapping" id="toc-part-sampling-for-mapping">(PART) Sampling for mapping</a></li>
<li><a href="IntroSamplingforMapping.html#IntroSamplingforMapping" id="toc-IntroSamplingforMapping"><span class="toc-section-number">16</span> Introduction to sampling for mapping</a>
<ul>
<li><a href="IntroSamplingforMapping.html#when-is-probability-sampling-not-required" id="toc-when-is-probability-sampling-not-required"><span class="toc-section-number">16.1</span> When is probability sampling not required?</a></li>
<li><a href="IntroSamplingforMapping.html#sampling-for-simultaneously-mapping-and-estimating-means" id="toc-sampling-for-simultaneously-mapping-and-estimating-means"><span class="toc-section-number">16.2</span> Sampling for simultaneously mapping and estimating means</a></li>
<li><a href="IntroSamplingforMapping.html#broad-overview-of-sampling-designs-for-mapping" id="toc-broad-overview-of-sampling-designs-for-mapping"><span class="toc-section-number">16.3</span> Broad overview of sampling designs for mapping</a></li>
</ul></li>
<li><a href="RegularGridSpatialCoverage.html#RegularGridSpatialCoverage" id="toc-RegularGridSpatialCoverage"><span class="toc-section-number">17</span> Regular grid and spatial coverage sampling</a>
<ul>
<li><a href="RegularGridSpatialCoverage.html#Regulargrid" id="toc-Regulargrid"><span class="toc-section-number">17.1</span> Regular grid sampling</a></li>
<li><a href="RegularGridSpatialCoverage.html#SpatialCoverage" id="toc-SpatialCoverage"><span class="toc-section-number">17.2</span> Spatial coverage sampling</a></li>
<li><a href="RegularGridSpatialCoverage.html#SpatialInfill" id="toc-SpatialInfill"><span class="toc-section-number">17.3</span> Spatial infill sampling</a></li>
</ul></li>
<li><a href="kmeans.html#kmeans" id="toc-kmeans"><span class="toc-section-number">18</span> Covariate space coverage sampling</a>
<ul>
<li><a href="kmeans.html#covariate-space-infill-sampling" id="toc-covariate-space-infill-sampling"><span class="toc-section-number">18.1</span> Covariate space infill sampling</a></li>
<li><a href="kmeans.html#PerformanceCSC" id="toc-PerformanceCSC"><span class="toc-section-number">18.2</span> Performance of covariate space coverage sampling in random forest prediction</a></li>
</ul></li>
<li><a href="cLHS.html#cLHS" id="toc-cLHS"><span class="toc-section-number">19</span> Conditioned Latin hypercube sampling</a>
<ul>
<li><a href="cLHS.html#cLHIS" id="toc-cLHIS"><span class="toc-section-number">19.1</span> Conditioned Latin hypercube infill sampling</a></li>
<li><a href="cLHS.html#performance-of-conditioned-latin-hypercube-sampling-in-random-forest-prediction" id="toc-performance-of-conditioned-latin-hypercube-sampling-in-random-forest-prediction"><span class="toc-section-number">19.2</span> Performance of conditioned Latin hypercube sampling in random forest prediction</a></li>
</ul></li>
<li><a href="SpatialResponseSurface.html#SpatialResponseSurface" id="toc-SpatialResponseSurface"><span class="toc-section-number">20</span> Spatial response surface sampling</a>
<ul>
<li><a href="SpatialResponseSurface.html#IncreaseSampleSize" id="toc-IncreaseSampleSize"><span class="toc-section-number">20.1</span> Increasing the sample size</a></li>
<li><a href="SpatialResponseSurface.html#stratified-spatial-response-surface-sampling" id="toc-stratified-spatial-response-surface-sampling"><span class="toc-section-number">20.2</span> Stratified spatial response surface sampling</a></li>
<li><a href="SpatialResponseSurface.html#mapping" id="toc-mapping"><span class="toc-section-number">20.3</span> Mapping</a></li>
</ul></li>
<li><a href="Introkriging.html#Introkriging" id="toc-Introkriging"><span class="toc-section-number">21</span> Introduction to kriging</a>
<ul>
<li><a href="Introkriging.html#OrdinaryKriging" id="toc-OrdinaryKriging"><span class="toc-section-number">21.1</span> Ordinary kriging</a></li>
<li><a href="Introkriging.html#BlockKriging" id="toc-BlockKriging"><span class="toc-section-number">21.2</span> Block-kriging</a></li>
<li><a href="Introkriging.html#IntroKED" id="toc-IntroKED"><span class="toc-section-number">21.3</span> Kriging with an external drift</a></li>
<li><a href="Introkriging.html#VariogramEstimation" id="toc-VariogramEstimation"><span class="toc-section-number">21.4</span> Estimating the semivariogram</a>
<ul>
<li><a href="Introkriging.html#MoM" id="toc-MoM"><span class="toc-section-number">21.4.1</span> Method-of-moments</a></li>
<li><a href="Introkriging.html#MLestimationVariogram" id="toc-MLestimationVariogram"><span class="toc-section-number">21.4.2</span> Maximum likelihood</a></li>
</ul></li>
<li><a href="Introkriging.html#ResidualVariogram" id="toc-ResidualVariogram"><span class="toc-section-number">21.5</span> Estimating the residual semivariogram</a>
<ul>
<li><a href="Introkriging.html#IterativeMoM" id="toc-IterativeMoM"><span class="toc-section-number">21.5.1</span> Iterative method-of-moments</a></li>
<li><a href="Introkriging.html#REML" id="toc-REML"><span class="toc-section-number">21.5.2</span> Restricted maximum likelihood</a></li>
</ul></li>
</ul></li>
<li><a href="MBgridspacing.html#MBgridspacing" id="toc-MBgridspacing"><span class="toc-section-number">22</span> Model-based optimisation of the grid spacing</a>
<ul>
<li><a href="MBgridspacing.html#GridspacingOK" id="toc-GridspacingOK"><span class="toc-section-number">22.1</span> Optimal grid spacing for ordinary kriging</a></li>
<li><a href="MBgridspacing.html#controlling-the-mean-or-a-quantile-of-the-ordinary-kriging-variance" id="toc-controlling-the-mean-or-a-quantile-of-the-ordinary-kriging-variance"><span class="toc-section-number">22.2</span> Controlling the mean or a quantile of the ordinary kriging variance</a></li>
<li><a href="MBgridspacing.html#optimal-grid-spacing-for-block-kriging" id="toc-optimal-grid-spacing-for-block-kriging"><span class="toc-section-number">22.3</span> Optimal grid spacing for block-kriging</a></li>
<li><a href="MBgridspacing.html#MBgridspacingKED" id="toc-MBgridspacingKED"><span class="toc-section-number">22.4</span> Optimal grid spacing for kriging with an external drift</a></li>
<li><a href="MBgridspacing.html#BayesianGridSpacing" id="toc-BayesianGridSpacing"><span class="toc-section-number">22.5</span> Bayesian approach</a></li>
</ul></li>
<li><a href="MBSamplePattern.html#MBSamplePattern" id="toc-MBSamplePattern"><span class="toc-section-number">23</span> Model-based optimisation of the sampling pattern</a>
<ul>
<li><a href="MBSamplePattern.html#SSA" id="toc-SSA"><span class="toc-section-number">23.1</span> Spatial simulated annealing</a></li>
<li><a href="MBSamplePattern.html#SamplePatternOK" id="toc-SamplePatternOK"><span class="toc-section-number">23.2</span> Optimising the sampling pattern for ordinary kriging</a></li>
<li><a href="MBSamplePattern.html#SamplePatternKED" id="toc-SamplePatternKED"><span class="toc-section-number">23.3</span> Optimising the sampling pattern for kriging with an external drift</a></li>
<li><a href="MBSamplePattern.html#model-based-infill-sampling-for-ordinary-kriging" id="toc-model-based-infill-sampling-for-ordinary-kriging"><span class="toc-section-number">23.4</span> Model-based infill sampling for ordinary kriging</a></li>
<li><a href="MBSamplePattern.html#model-based-infill-sampling-for-kriging-with-an-external-drift" id="toc-model-based-infill-sampling-for-kriging-with-an-external-drift"><span class="toc-section-number">23.5</span> Model-based infill sampling for kriging with an external drift</a></li>
</ul></li>
<li><a href="SamplingVariogram.html#SamplingVariogram" id="toc-SamplingVariogram"><span class="toc-section-number">24</span> Sampling for estimating the semivariogram</a>
<ul>
<li><a href="SamplingVariogram.html#NestedSampling" id="toc-NestedSampling"><span class="toc-section-number">24.1</span> Nested sampling</a></li>
<li><a href="SamplingVariogram.html#IndependentSamplingPairs" id="toc-IndependentSamplingPairs"><span class="toc-section-number">24.2</span> Independent sampling of pairs of points</a></li>
<li><a href="SamplingVariogram.html#samplingforvariogram" id="toc-samplingforvariogram"><span class="toc-section-number">24.3</span> Optimisation of sampling pattern for semivariogram estimation</a>
<ul>
<li><a href="SamplingVariogram.html#UncertainSemivariogramParameters" id="toc-UncertainSemivariogramParameters"><span class="toc-section-number">24.3.1</span> Uncertainty about semivariogram parameters</a></li>
<li><a href="SamplingVariogram.html#UncertainKrigingVariance" id="toc-UncertainKrigingVariance"><span class="toc-section-number">24.3.2</span> Uncertainty about the kriging variance</a></li>
</ul></li>
<li><a href="SamplingVariogram.html#SamplingEstimationandPrediction" id="toc-SamplingEstimationandPrediction"><span class="toc-section-number">24.4</span> Optimisation of sampling pattern for semivariogram estimation and mapping</a></li>
<li><a href="SamplingVariogram.html#a-practical-solution" id="toc-a-practical-solution"><span class="toc-section-number">24.5</span> A practical solution</a></li>
</ul></li>
<li><a href="Validation.html#Validation" id="toc-Validation"><span class="toc-section-number">25</span> Sampling for validation of maps</a>
<ul>
<li><a href="Validation.html#map-quality-indices" id="toc-map-quality-indices"><span class="toc-section-number">25.1</span> Map quality indices</a>
<ul>
<li><a href="Validation.html#estimation-of-map-quality-indices" id="toc-estimation-of-map-quality-indices"><span class="toc-section-number">25.1.1</span> Estimation of map quality indices</a></li>
</ul></li>
<li><a href="Validation.html#real-world-case-study" id="toc-real-world-case-study"><span class="toc-section-number">25.2</span> Real-world case study</a>
<ul>
<li><a href="Validation.html#estimation-of-the-population-mean-error-and-mean-squared-error" id="toc-estimation-of-the-population-mean-error-and-mean-squared-error"><span class="toc-section-number">25.2.1</span> Estimation of the population mean error and mean squared error</a></li>
<li><a href="Validation.html#estimation-of-the-standard-error-of-the-estimator-of-the-population-mean-error-and-mean-squared-error" id="toc-estimation-of-the-standard-error-of-the-estimator-of-the-population-mean-error-and-mean-squared-error"><span class="toc-section-number">25.2.2</span> Estimation of the standard error of the estimator of the population mean error and mean squared error</a></li>
<li><a href="Validation.html#estimation-of-model-efficiency-coefficient" id="toc-estimation-of-model-efficiency-coefficient"><span class="toc-section-number">25.2.3</span> Estimation of model efficiency coefficient</a></li>
<li><a href="Validation.html#statistical-testing-of-hypothesis-about-population-me-and-mse" id="toc-statistical-testing-of-hypothesis-about-population-me-and-mse"><span class="toc-section-number">25.2.4</span> Statistical testing of hypothesis about population ME and MSE</a></li>
</ul></li>
</ul></li>
<li><a href="Approaches.html#Approaches" id="toc-Approaches"><span class="toc-section-number">26</span> Design-based, model-based, and model-assisted approach for sampling and inference</a>
<ul>
<li><a href="Approaches.html#two-sources-of-randomness" id="toc-two-sources-of-randomness"><span class="toc-section-number">26.1</span> Two sources of randomness</a></li>
<li><a href="Approaches.html#iid" id="toc-iid"><span class="toc-section-number">26.2</span> Identically and independently distributed</a></li>
<li><a href="Approaches.html#BiasandVariance" id="toc-BiasandVariance"><span class="toc-section-number">26.3</span> Bias and variance</a></li>
<li><a href="Approaches.html#effectivesamplesize" id="toc-effectivesamplesize"><span class="toc-section-number">26.4</span> Effective sample size</a></li>
<li><a href="Approaches.html#ExploitSpatialStructure" id="toc-ExploitSpatialStructure"><span class="toc-section-number">26.5</span> Exploiting spatial structure in design-based approach</a></li>
<li><a href="Approaches.html#ModelassistedvsModeldependent" id="toc-ModelassistedvsModeldependent"><span class="toc-section-number">26.6</span> Model-assisted vs. model-dependent</a></li>
</ul></li>
<li><a href="#appendix-appendices" id="toc-appendix-appendices">(APPENDIX) Appendices</a></li>
<li><a href="Answers.html#Answers" id="toc-Answers"><span class="toc-section-number">27</span> Answers to exercises</a>
<ul>
<li><a href="Answers.html#introduction-to-probability-sampling" id="toc-introduction-to-probability-sampling">Introduction to probability sampling</a></li>
<li><a href="Answers.html#simple-random-sampling-1" id="toc-simple-random-sampling-1">Simple random sampling</a></li>
<li><a href="Answers.html#stratified-simple-random-sampling-1" id="toc-stratified-simple-random-sampling-1">Stratified simple random sampling</a></li>
<li><a href="Answers.html#systematic-random-sampling-2" id="toc-systematic-random-sampling-2">Systematic random sampling</a></li>
<li><a href="Answers.html#cluster-random-sampling" id="toc-cluster-random-sampling">Cluster random sampling</a></li>
<li><a href="Answers.html#two-stage-cluster-random-sampling-1" id="toc-two-stage-cluster-random-sampling-1">Two-stage cluster random sampling</a></li>
<li><a href="Answers.html#sampling-with-probabilities-proportional-to-size" id="toc-sampling-with-probabilities-proportional-to-size">Sampling with probabilities proportional to size</a></li>
<li><a href="Answers.html#balanced-and-well-spread-sampling" id="toc-balanced-and-well-spread-sampling">Balanced and well-spread sampling</a></li>
<li><a href="Answers.html#model-assisted-estimation" id="toc-model-assisted-estimation">Model-assisted estimation</a></li>
<li><a href="Answers.html#two-phase-random-sampling" id="toc-two-phase-random-sampling">Two-phase random sampling</a></li>
<li><a href="Answers.html#computing-the-required-sample-size" id="toc-computing-the-required-sample-size">Computing the required sample size</a></li>
<li><a href="Answers.html#model-based-optimisation-of-probability-sampling-designs" id="toc-model-based-optimisation-of-probability-sampling-designs">Model-based optimisation of probability sampling designs</a></li>
<li><a href="Answers.html#repeated-sample-surveys-for-monitoring-population-parameters" id="toc-repeated-sample-surveys-for-monitoring-population-parameters">Repeated sample surveys for monitoring population parameters</a></li>
<li><a href="Answers.html#regular-grid-and-spatial-coverage-sampling" id="toc-regular-grid-and-spatial-coverage-sampling">Regular grid and spatial coverage sampling</a></li>
<li><a href="Answers.html#covariate-space-coverage-sampling" id="toc-covariate-space-coverage-sampling">Covariate space coverage sampling</a></li>
<li><a href="Answers.html#conditioned-latin-hypercube-sampling" id="toc-conditioned-latin-hypercube-sampling">Conditioned Latin hypercube sampling</a></li>
<li><a href="Answers.html#model-based-optimisation-of-the-grid-spacing" id="toc-model-based-optimisation-of-the-grid-spacing">Model-based optimisation of the grid spacing</a></li>
<li><a href="Answers.html#model-based-optimisation-of-the-sampling-pattern" id="toc-model-based-optimisation-of-the-sampling-pattern">Model-based optimisation of the sampling pattern</a></li>
<li><a href="Answers.html#sampling-for-estimating-the-semivariogram" id="toc-sampling-for-estimating-the-semivariogram">Sampling for estimating the semivariogram</a></li>
<li><a href="Answers.html#sampling-for-validation-of-maps" id="toc-sampling-for-validation-of-maps">Sampling for validation of maps</a></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/DickBrus/">Dick Brus</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial sampling with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="SI" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Simple random sampling<a href="SI.html#SI" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Simple random sampling is the most basic form of probability sampling. There are two subtypes:</p>
<ol style="list-style-type: decimal">
<li>simple random sampling with replacement; and</li>
<li>simple random sampling without replacement.</li>
</ol>
<p>This distinction is irrelevant for infinite populations. In sampling with replacement a population unit may be selected more than once.</p>
<p>In <strong>R</strong> a simple random sample can be selected with or without replacement by function <code>sample</code> from the <strong>base</strong> package. For instance, a simple random sample without replacement of 10 units from a population of 100 units labelled as <span class="math inline">\(1,2, \dots ,100\)</span>, can be selected by</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="SI.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">100</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code> [1]  21   7   5  16  58  76  44 100  71  84</code></pre>
<p>The number of units in the sample is referred to as the sample size (<span class="math inline">\(n = 10\)</span> in the code chunk above). Use argument <code>replace = TRUE</code> to select a simple random sample with replacement.</p>
<p>When the spatial population is continuous and infinite, as in sampling points from an area, the infinite population is discretised by a very fine grid. Discretisation is not strictly needed (we could also select points directly), but it is used in this book for reasons explained in Chapter <a href="GeneralIntro.html#GeneralIntro">1</a>. The centres of the grid cells are then listed in a data frame, which serves as the sampling frame (Chapter <a href="GeneralIntro.html#GeneralIntro">1</a>). In the next code chunk, a simple random sample without replacement of size 40 is selected from Voorst. The infinite population is represented by the centres of square grid cells with a side length of 25 m. These centres are listed in tibble<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> <code>grdVoorst</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="SI.html#cb6-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb6-2"><a href="SI.html#cb6-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(grdVoorst)</span>
<span id="cb6-3"><a href="SI.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb6-4"><a href="SI.html#cb6-4" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">sample</span>(N, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-5"><a href="SI.html#cb6-5" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> grdVoorst[units, ]</span>
<span id="cb6-6"><a href="SI.html#cb6-6" aria-hidden="true" tabindex="-1"></a>mysample</span></code></pre></div>
<pre><code># A tibble: 40 x 4
       s1      s2     z stratum
    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  
 1 206992 464506.  23.5 EA     
 2 202567 464606. 321.  XF     
 3 205092 464530. 124.  XF     
 4 203367 464556.  53.6 EA     
 5 205592 465180.  38.4 PA     
 6 201842 464956. 159.  XF     
 7 201667 464930. 139.  XF     
 8 204317 465306.  59.4 PA     
 9 203042 464406.  90.5 BA     
10 204567 464530.  48.1 PA     
# ... with 30 more rows</code></pre>
<p>The result of function <code>sample</code> is a vector with the centres of the selected cells of the discretisation grid, referred to as discretisation points. The order of the elements of the vector is the order in which these are selected. Restricting the sampling points to the discretisation points can be avoided as follows. A simple random sample of points is selected in two stages. First, <em>n</em> times a grid cell is selected by simple random sampling <em>with replacement</em>. Second, every time a grid cell is selected, one point is selected fully randomly from that grid cell. This selection procedure accounts for the infinite number of points in the population. In the code chunk below, the second step of this selection procedure is implemented with function <code>jitter</code>. It adds random noise to the spatial coordinates of the centres of the selected grid cells, by drawing from a continuous uniform distribution <span class="math inline">\(\text{unif}(-c,c)\)</span>, with <span class="math inline">\(c\)</span> half the side length of the square grid cells. With this selection procedure we respect that the population actually is infinite.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="SI.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb8-2"><a href="SI.html#cb8-2" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">sample</span>(N, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-3"><a href="SI.html#cb8-3" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> grdVoorst[units, ]</span>
<span id="cb8-4"><a href="SI.html#cb8-4" aria-hidden="true" tabindex="-1"></a>cellsize <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb8-5"><a href="SI.html#cb8-5" aria-hidden="true" tabindex="-1"></a>mysample<span class="sc">$</span>s1 <span class="ot">&lt;-</span> <span class="fu">jitter</span>(mysample<span class="sc">$</span>s1, <span class="at">amount =</span> cellsize <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb8-6"><a href="SI.html#cb8-6" aria-hidden="true" tabindex="-1"></a>mysample<span class="sc">$</span>s2 <span class="ot">&lt;-</span> <span class="fu">jitter</span>(mysample<span class="sc">$</span>s2, <span class="at">amount =</span> cellsize <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb8-7"><a href="SI.html#cb8-7" aria-hidden="true" tabindex="-1"></a>mysample</span></code></pre></div>
<pre><code># A tibble: 40 x 4
        s1      s2     z stratum
     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  
 1 206986. 464493.  23.5 EA     
 2 202574. 464609. 321.  XF     
 3 205095. 464527. 124.  XF     
 4 203369. 464556.  53.6 EA     
 5 205598. 465181.  38.4 PA     
 6 201836. 464965. 159.  XF     
 7 201665. 464941. 139.  XF     
 8 204319. 465310.  59.4 PA     
 9 203052. 464402.  90.5 BA     
10 204564. 464529.  48.1 PA     
# ... with 30 more rows</code></pre>
<p>Variable <code>stratum</code> is not used in this chapter but in the next chapter. The selected sample is shown in Figure <a href="SI.html#fig:SampleSI">3.1</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:SampleSI"></span>
<img src="SpatialSampling_files/figure-html/SampleSI-1.png" alt="Simple random sample of size 40 from Voorst." width="100%" />
<p class="caption">
Figure 3.1: Simple random sample of size 40 from Voorst.
</p>
</div>
<div id="dropouts" class="section level4 unnumbered hasAnchor">
<h4>Dropouts<a href="SI.html#dropouts" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In practice, it may happen that inspection in the field shows that a selected sampling unit does not belong to the target population or cannot be observed for whatever reason (e.g., no permission). For instance, in a soil survey the sampling unit may happen to fall on a road or in a built-up area. What to do with these dropouts? Shifting this unit to a nearby unit may lead to a biased estimator of the population mean, i.e., a systematic error in the estimated population mean. Besides, knowledge of the inclusion probabilities is lost. This can be avoided by discarding these units and replacing them by sampling units from a back-up list, selected in the same way, i.e., by the same type of sampling design. The order of sampling units in this list must be the order in which they are selected. In summary, do not replace a deleted sampling unit by the nearest sampling unit from the back-up list, but by the first unit, not yet selected, from the back-up list.</p>
</div>
<div id="HTestimatorSI" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Estimation of population parameters<a href="SI.html#HTestimatorSI" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In simple random sampling without replacement of a finite population, every possible sample of <span class="math inline">\(n\)</span> units has an equal probability of being selected. There are <span class="math inline">\(\binom{N}{n}\)</span> samples of size <span class="math inline">\(n\)</span> and <span class="math inline">\(\binom{N-1}{n-1}\)</span> samples that contain unit <span class="math inline">\(k\)</span>. From this it follows that the probability that unit <span class="math inline">\(k\)</span> is included in the sample is <span class="math inline">\(\binom{N-1}{n-1}/\binom{N}{n}=\frac{n}{N}\)</span> <span class="citation">(<a href="#ref-loh99" role="doc-biblioref">Lohr 1999</a>)</span>. Substituting this in the general <span class="math inline">\(\pi\)</span> estimator for the total (Equation <a href="IntroProbabilitySampling.html#eq:HTTotal">(2.2)</a>) gives for simple random sampling without replacement (from finite populations)</p>
<p><span class="math display" id="eq:HTTotalSI">\[\begin{equation}
\hat{t}(z)=\frac{N}{n}\sum_{k \in \mathcal{S}} z_k = N \bar{z}_{\mathcal{S}} \;,
\tag{3.1}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(\bar{z}_{\mathcal{S}}\)</span> the unweighted <em>sample mean</em>. So, for simple random sampling without replacement the <span class="math inline">\(\pi\)</span> estimator of the population mean is the <em>unweighted</em> sample mean:</p>
<p><span class="math display" id="eq:HTMeanSI">\[\begin{equation}
\hat{\bar{z}} = \bar{z}_{\mathcal{S}} = \frac{1}{n}\sum_{k \in \mathcal{S}} z_k \;.
\tag{3.2}
\end{equation}\]</span></p>
<p>In simple random sampling with replacement of finite populations, a unit may occur multiple times in the sample <span class="math inline">\(\mathcal{S}\)</span>. In this case, the population total can be estimated by the pwr estimator <span class="citation">(<a href="#ref-sar92" role="doc-biblioref">Särndal, Swensson, and Wretman 1992</a>)</span></p>
<p><span class="math display" id="eq:HHTotal">\[\begin{equation}
\hat{t}(z)= \frac{1}{n} \sum_{k \in \mathcal{S}} \frac{z_{k}}{p_{k}} \;,
\tag{3.3}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the number of draws (sample size) and <span class="math inline">\(p_{k}\)</span> is the draw-by-draw selection probability of unit <span class="math inline">\(k\)</span>. With simple random sampling <span class="math inline">\(p_{k}=1/N, k=1, \dots , N\)</span>. Inserting this in the pwr estimator yields</p>
<p><span class="math display" id="eq:HHTotalSIR">\[\begin{equation}
\hat{t}(z)= \frac{N}{n} \sum_{k \in \mathcal{S}} z_{k} \;,
\tag{3.4}
\end{equation}\]</span></p>
<p>which is equal to the <span class="math inline">\(\pi\)</span> estimator of the population total for simple random sampling <em>without replacement</em>.</p>
<p>Alternatively, the population total can be estimated by the <span class="math inline">\(\pi\)</span> estimator. With simple random sampling with replacement the inclusion probability of each unit <span class="math inline">\(k\)</span> equals <span class="math inline">\(1-\left(1-\frac{1}{N}\right)^n\)</span>, which is smaller than the inclusion probability with simple random sampling without replacement of size <span class="math inline">\(n\)</span> <span class="citation">(<a href="#ref-sar92" role="doc-biblioref">Särndal, Swensson, and Wretman 1992</a>)</span>. Inserting these inclusion probabilities in the general <span class="math inline">\(\pi\)</span> estimator of the population total (Equation <a href="IntroProbabilitySampling.html#eq:HTTotal">(2.2)</a>), where the sample <span class="math inline">\(\mathcal{S}\)</span> is reduced to the unique units in the sample, yields the <span class="math inline">\(\pi\)</span> estimator of the total for simple random sampling with replacement.</p>
<p>With simple random sampling of <em>infinite</em> populations, the <span class="math inline">\(\pi\)</span> estimator of the population mean equals the sample mean. Multiplying this estimator with the area of the region of interest <span class="math inline">\(A\)</span> yields the <span class="math inline">\(\pi\)</span> estimator of the population total:</p>
<p><span class="math display" id="eq:HTTotalSIInfinite">\[\begin{equation}
\hat{t}(z)= \frac{A}{n}\sum_{k \in \mathcal{S}}z_{k} \;.
\tag{3.5}
\end{equation}\]</span></p>
<p>As explained above, selected sampling units that do not belong to the target population must be replaced by a unit from a back-up list if we want to observe the intended number of units. The question then is how to estimate the population total and mean. We cannot use the <span class="math inline">\(\pi\)</span> estimator of Equation <a href="SI.html#eq:HTTotalSI">(3.1)</a> to estimate the population total, because we do not know the population size <span class="math inline">\(N\)</span>. The population size can be estimated by</p>
<p><span class="math display">\[\begin{equation}
\widehat{N} = \frac{n-d}{n}N^*\;,
\end{equation}\]</span></p>
<p>with <span class="math inline">\(d\)</span> the number of dropouts and <span class="math inline">\(N^*\)</span> the supposed population size, i.e., the number of units in the sampling frame used to select the sample. This yields the inclusion probability</p>
<p><span class="math display">\[\begin{equation}
\pi_k = \frac{n}{\widehat{N}}=\frac{n^2}{(n-d)N^*}\;.
\end{equation}\]</span></p>
<p>Inserting this in the <span class="math inline">\(\pi\)</span> estimator of the population total yields</p>
<p><span class="math display">\[\begin{equation}
\hat{t}(z) = \frac{(n-d)N^*}{n^2}\sum_{k \in \mathcal{S}} z_{k} = \frac{(n-d)N^*}{n} \bar{z}_{\mathcal{S}}=\widehat{N}\bar{z}_{\mathcal{S}}\;.
\end{equation}\]</span></p>
<p>A natural estimator of the population mean is</p>
<p><span class="math display">\[\begin{equation}
\hat{\bar{z}} = \frac{\hat{t}(z)}{\widehat{N}}=\bar{z}_{\mathcal{S}}\;.
\end{equation}\]</span></p>
<p>This estimator is a so-called ratio estimator: both the numerator and denominator are estimators of totals. See Section <a href="Modelassisted.html#RatioEstimator">10.2</a> for more information about this estimator.</p>
<p>The simple random sample of size 40 selected above is used to estimate the total mass of soil organic matter (SOM) in the population. First, the population mean is estimated.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="SI.html#cb10-1" aria-hidden="true" tabindex="-1"></a>mz <span class="ot">&lt;-</span> <span class="fu">mean</span>(mysample<span class="sc">$</span>z)</span></code></pre></div>
<p>The estimated mean SOM concentration is 93.3 g kg<sup>-1</sup>. Simply multiplying the estimated mean by the area <span class="math inline">\(A\)</span> to obtain an estimate of the population total is not very useful, as the dimension of the total then is in g kg<sup>-1</sup> m<sup>2</sup>. To estimate the total mass of SOM in the soil layer <span class="math inline">\(0-30\)</span> cm, first the soil volume in m<sup>3</sup> is computed by the total number of grid cells, <span class="math inline">\(N\)</span>, multiplied by the size of the grid cells and by the thickness of the soil layer. The total is then estimated by the product of this volume, the bulk density of soil (1,500 kg m<sup>-3</sup>), and the estimated population mean (g kg<sup>-1</sup>). This is multiplied by 10<sup>-6</sup> to obtain the total mass of SOM in Mg (1 Mg is 1,000 kg).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="SI.html#cb11-1" aria-hidden="true" tabindex="-1"></a>vol_soil <span class="ot">&lt;-</span> N <span class="sc">*</span> <span class="dv">25</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fl">0.3</span></span>
<span id="cb11-2"><a href="SI.html#cb11-2" aria-hidden="true" tabindex="-1"></a>bd <span class="ot">&lt;-</span> <span class="dv">1500</span></span>
<span id="cb11-3"><a href="SI.html#cb11-3" aria-hidden="true" tabindex="-1"></a>tz <span class="ot">&lt;-</span> vol_soil <span class="sc">*</span> bd <span class="sc">*</span> mz <span class="sc">*</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">6</span></span></code></pre></div>
<p>The estimated total is 197,545 Mg (420 Mg ha<sup>-1</sup>).</p>

<div class="rmdnote">
Note that a constant bulk density is used. Ideally, this bulk density is also measured at the sampling points, by collecting soil aliquots of a constant volume. The measured SOM concentration and bulk density can then be used to compute the volumetric SOM concentration in kg m<sup>-3</sup> at the sampling points. The estimated population mean of this volumetric SOM concentration can then be multiplied by the total volume of soil in the study area, to get an estimate of the total mass of SOM in the study area.
</div>
<p>The simulated population is now sampled 10,000 times to see how sampling affects the estimates. For each sample, the population mean is estimated by the sample mean. Figure <a href="SI.html#fig:SamplingDistributionSI">3.2</a> shows the approximated sampling distribution of the <span class="math inline">\(\pi\)</span> estimator of the mean SOM concentration. Note that the sampling distribution is nearly symmetric, whereas the frequency distribution of the SOM concentrations in the population is far from symmetric, see Figure <a href="GeneralIntro.html#fig:histogramVoorst">1.4</a>. The increased symmetry is due to the averaging of 40 numbers.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:SamplingDistributionSI"></span>
<img src="SpatialSampling_files/figure-html/SamplingDistributionSI-1.png" alt="Approximated sampling distribution of the \(\pi\) estimator of the mean SOM concentration (g kg-1) in Voorst for simple random sampling of size 40." width="80%" />
<p class="caption">
Figure 3.2: Approximated sampling distribution of the <span class="math inline">\(\pi\)</span> estimator of the mean SOM concentration (g kg<sup>-1</sup>) in Voorst for simple random sampling of size 40.
</p>
</div>
<p>If we would repeat the sampling an infinite number of times and make the width of the bins in the histogram infinitely small, then we obtain, after scaling so that the sum of the area under the curve equals 1, the <em>sampling distribution</em> of the estimator of the population mean. Important summary statistics of this sampling distribution are the expectation (mean) and the variance.</p>
<p>When the expectation equals the population mean, there is no systematic error. The estimator is then said to be <em>design-unbiased</em>. In Chapter <a href="Introkriging.html#Introkriging">21</a> another type of unbiasedness is introduced, model-unbiasedness. The difference between design-unbiasedness and model-unbiasedness is explained in Chapter <a href="Approaches.html#Approaches">26</a>. In following chapters of Part I unbiased means design-unbiased. Actually, it is not the estimator which is unbiased, but the combination of a sampling design and an estimator. For instance, with an equal probability sampling design, the sample mean is an unbiased estimator of the population mean, whereas it is a biased estimator in combination with an unequal probability sampling design.</p>
<p>The variance, referred to as the sampling variance, is a measure of the random error. Ideally, this variance is as small as possible, so that there is a large probability that for an individual estimate the estimation error is small. The variance is a measure of the <em>precision</em> of an estimator. An estimator with a small variance but a strong bias is not a good estimator. To assess the quality of an estimator, we should look at both. The variance and the bias are often combined in the <em>mean squared error</em> (MSE), which is the sum of the variance and the <em>squared</em> bias. An estimator with a small MSE is an <em>accurate</em> estimator. So, contrary to precision, accuracy also accounts for the bias.</p>
<p>Do not confuse the <em>population</em> variance and the <em>sampling</em> variance. The population variance, or spatial variance, is a <em>population characteristic</em>, whereas the sampling variance is a <em>characteristic of a sampling strategy</em>, i.e., a combination of a sampling design and an estimator. The sampling variance quantifies our <em>uncertainty</em> about the population mean. The sampling variance can be manipulated by changing the sample size <span class="math inline">\(n\)</span>, the type of sampling design, and the estimator. This has no effect on the population variance. The average of the 10,000 estimated population means equals 81.1 g kg<sup>-1</sup>, so the difference with the true population mean equals -0.03 g kg<sup>-1</sup>. The variance of the 10,000 estimated population means equals 55.8 (g kg<sup>-1</sup>)<sup>2</sup>. The square root of this variance, referred to as the <em>standard error</em>, equals 7.47 g kg<sup>-1</sup>. Note that the standard error has the same units as the study variable, g kg<sup>-1</sup>, whereas the units of the variance are the squared units of the study variable.</p>
<div id="PopProportion" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Population proportion<a href="SI.html#PopProportion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In some cases one is interested in the proportion of the population (study area) satisfying a given condition. Think, for instance, of the proportion of trees in a forest infected by some disease, the proportion of an area or areal fraction, in which a soil pollutant exceeds some critical threshold, or the proportion of an area where habitat conditions are suitable for some endangered species. Recall that a population proportion is defined as the population mean of an 0/1 indicator <span class="math inline">\(y\)</span> with value 1 if the condition is satisfied, and 0 otherwise (Subsection <a href="GeneralIntro.html#PopulationParameters">1.1.1</a>). For simple random sampling, this population proportion can be estimated by the same formula as for the mean (Equation <a href="SI.html#eq:HTMeanSI">(3.2)</a>):</p>
<p><span class="math display" id="eq:HTProportionSI">\[\begin{equation}
\hat{p} =  \frac{1}{n}\sum_{k \in \mathcal{S}} y_k \;.
\tag{3.6}
\end{equation}\]</span></p>
</div>
<div id="CDF" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Cumulative distribution function and quantiles<a href="SI.html#CDF" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The population cumulative distribution function (CDF) is defined in Equation <a href="GeneralIntro.html#eq:CDF">(1.4)</a>. A population CDF can be estimated by repeated application of the indicator technique described in the previous subsection on estimating a population proportion. A series of threshold values is chosen. Each threshold results in <span class="math inline">\(n\)</span> indicator values having value 1 if the observed study variable <span class="math inline">\(z\)</span> of unit <span class="math inline">\(k\)</span> is smaller than or equal to the threshold, and 0 otherwise. These indicator values are then used to estimate the proportion of the population with a <span class="math inline">\(z\)</span>-value smaller than or equal to that threshold. For simple random sampling, these proportions can be estimated with Equation <a href="SI.html#eq:HTProportionSI">(3.6)</a>. Commonly, the unique <span class="math inline">\(z\)</span>-values in the sample are used as threshold values, leading to as many estimated population proportions as there are unique values in the sample.</p>
<p>Figure <a href="SI.html#fig:CDFSIVoorst">3.3</a> shows the estimated CDF, estimated from the simple random sample of 40 units from Voorst. The steps are at the unique values of SOM in the sample.</p>

<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="SI.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mysample, <span class="at">mapping =</span> <span class="fu">aes</span>(z)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="SI.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">&quot;step&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-3"><a href="SI.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;SOM&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="SI.html#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">&quot;F&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CDFSIVoorst"></span>
<img src="SpatialSampling_files/figure-html/CDFSIVoorst-1.png" alt="Cumulative distribution function of the SOM concentration (g kg-1) in Voorst, estimated from the simple random sample of 40 units." width="80%" />
<p class="caption">
Figure 3.3: Cumulative distribution function of the SOM concentration (g kg<sup>-1</sup>) in Voorst, estimated from the simple random sample of 40 units.
</p>
</div>
<p>The estimated population proportions can be used to estimate a population quantile for any population proportion (cumulative frequency, probability), for instance the median, first quartile, and third quartile, corresponding to a population proportion of 0.5, 0.25, and 0.75, respectively. A simple estimator is the smallest <span class="math inline">\(k\)</span>th order statistic with an estimated proportion larger than or equal to the desired cumulative frequency <span class="citation">(<a href="#ref-Hyndman1996" role="doc-biblioref">Hyndman and Fan 1996</a>)</span>.</p>
<p>The estimated CDF shows jumps of size <span class="math inline">\(1/n\)</span>, so that the estimated population proportion can be larger than the desired proportion. The estimated population proportions therefore are often interpolated, for instance linearly. Function <code>quantile</code> of the <strong>stats</strong> package can be used to estimate a quantile. With argument <code>type = 4</code> linear interpolation is used to estimate the quantiles.</p>

<div class="rmdnote">
Function <code>quantile</code> actually computes sample quantiles, i.e., it assumes that the population units are selected with equal inclusion probabilities (as in simple random sampling), so that the estimators of the population proportions obtained with Equation <a href="SI.html#eq:HTProportionSI">(3.6)</a> are unbiased. With unequal inclusion probabilities these probabilities must be accounted for in estimating the population proportions, see following chapters.
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="SI.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(mysample<span class="sc">$</span>z, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">type =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="SI.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>  25%   50%   75% 
 50.4  65.6 138.7 </code></pre>
<p>Note the pipe operator <code>%&gt;%</code> of package <strong>magrittr</strong> <span class="citation">(<a href="#ref-magrittr" role="doc-biblioref">Bache and Wickham 2020</a>)</span> forwarding the result of function <code>quantile</code> to function <code>round</code>.</p>
<p>Package <strong>QuantileNPCI</strong> <span class="citation">(<a href="#ref-QuantileNPCI" role="doc-biblioref">N. Hutson, Hutson, and Yan 2019</a>)</span> can be used to compute a non-parametric confidence interval estimate of a quantile, using fractional order statistics <span class="citation">(<a href="#ref-Hutson1999" role="doc-biblioref">A. D. Hutson 1999</a>)</span>. Parameter <code>q</code> specifies the proportion.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="SI.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(QuantileNPCI)</span>
<span id="cb15-2"><a href="SI.html#cb15-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">quantCI</span>(mysample<span class="sc">$</span>z, <span class="at">q =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">method =</span> <span class="st">&quot;exact&quot;</span>)</span></code></pre></div>
<p>The estimated median equals 66.2 g kg<sup>-1</sup>, the lower bound of the 95% confidence interval equals 54.0 g kg<sup>-1</sup>, and the upper bound equals 98.1 g kg<sup>-1</sup>.</p>
<div id="exercises-2" class="section level4 unnumbered hasAnchor">
<h4>Exercises<a href="SI.html#exercises-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>Compare the approximated sampling distribution of the <span class="math inline">\(\pi\)</span> estimator of the mean SOM concentration of Voorst (Figure <a href="SI.html#fig:SamplingDistributionSI">3.2</a>) with the histogram of the 7,528 simulated SOM values (Figure <a href="GeneralIntro.html#fig:histogramVoorst">1.4</a>). Explain the differences.<br />
</li>
<li>What happens with the spread in the approximated sampling distribution (variance of estimated population means) when the sample size <span class="math inline">\(n\)</span> is increased?<br />
</li>
<li>Suppose we would repeat the sampling <span class="math inline">\(10^{12}\)</span> number of times, what would happen with the difference between the average of the estimated population means and the true population mean?</li>
</ol>
</div>
</div>
</div>
<div id="VarMeanSI" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Sampling variance of estimator of population parameters<a href="SI.html#VarMeanSI" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For simple random sampling of an infinite population and simple random sampling with replacement of a finite population, the sampling variance of the estimator of the population mean equals</p>
<p><span class="math display" id="eq:VarMean">\[\begin{equation}
V\!\left(\hat{\bar{z}}\right)=\frac{S^{2}(z)}{n} \;,
\tag{3.7}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(S^{2}(z)\)</span> the <em>population</em> variance, also referred to as the spatial variance. For finite populations, this population variance is defined as <span class="citation">(<a href="#ref-loh99" role="doc-biblioref">Lohr 1999</a>)</span></p>
<p><span class="math display" id="eq:PopulationVariance">\[\begin{equation}
S^{2}(z)=\frac{1}{N-1}\sum\limits_{k=1}^N\left(z_{k}-\bar{z}\right)^{2} \;,
\tag{3.8}
\end{equation}\]</span></p>
<p>and for infinite populations as</p>
<p><span class="math display" id="eq:PopulationVarianceInfinite">\[\begin{equation}
S^{2}(z) = \frac{1}{A} \int \limits_{\mathbf{s} \in \mathcal{A}} \left(z(\mathbf{s})-\bar{z}\right)^2\text{d}\mathbf{s} \;,
\tag{3.9}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(z(\mathbf{s})\)</span> the value of the study variable <span class="math inline">\(z\)</span> at a point with two-dimensional coordinates <span class="math inline">\(\mathbf{s}=(s_1,s_2)\)</span>, <span class="math inline">\(A\)</span> the area of the study area, and <span class="math inline">\(\mathcal{A}\)</span> the study area. In practice, we select only one sample, i.e., we do not repeat the sampling many times. Still it is possible to <em>estimate</em> the variance of the estimator of the population mean if we would repeat the sampling. In other words, we can estimate the sampling variance of the estimator of the population mean from a single sample. We do so by estimating the population variance from the sample, and this estimate can then be used to estimate the <em>sampling</em> variance of the estimator of the population mean. For simple random sampling <em>with replacement</em> from finite populations, the sampling variance of the estimator of the population mean can be estimated by</p>
<p><span class="math display" id="eq:EstVarMeanSIR">\[\begin{equation}
\widehat{V}\!\left(\hat{\bar{z}}\right)=\frac{\widehat{S^2}(z)}{n}= \frac{1}{n\,(n-1)}\sum\limits_{k \in \mathcal{S}}\left(z_{k}-\bar{z}_{\mathcal{S}}\right)^{2} \;,
\tag{3.10}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(\widehat{S^2}(z)\)</span> the <em>estimated</em> population variance. With simple random sampling, the <em>sample</em> variance, i.e., the variance of the sample data, is an unbiased estimator of the population variance. The variance estimator of Equation <a href="SI.html#eq:EstVarMeanSIR">(3.10)</a> can also be used for <em>infinite</em> populations. For simple random sampling <em>without replacement</em> from finite populations, the sampling variance of the estimator of the population mean can be estimated by</p>
<p><span class="math display" id="eq:EstVarMeanSI">\[\begin{equation}
\widehat{V}\!\left(\hat{\bar{z}}\right)=\left(1-\frac{n}{N}\right)\frac{\widehat{S^2}(z)}{n} \;.
\tag{3.11}
\end{equation}\]</span></p>
<p>The term <span class="math inline">\(1-\frac{n}{N}\)</span> is referred to as the finite population correction (fpc).</p>
<p>In the sampling experiment described above, the average of the 10,000 <em>estimated</em> sampling variances equals 55.7 (g kg<sup>-1</sup>)<sup>2</sup>. The true sampling variance equals 55.4 (g kg<sup>-1</sup>)<sup>2</sup>. So, the difference is very small, indicating that the estimator of the sampling variance, Equation <a href="SI.html#eq:EstVarMeanSI">(3.11)</a>, is design-unbiased.</p>
<p>The sampling variance of the estimator of the total of a finite population can be estimated by multiplying the estimated variance of the estimator of the population mean by <span class="math inline">\(N^2\)</span>. For simple random sampling without replacement this estimator thus equals</p>
<p><span class="math display" id="eq:EstVarTotalSI">\[\begin{equation}
\widehat{V}\!\left(\hat{t}(z)\right)=N^2 \left(1-\frac{n}{N}\right)\frac{\widehat{S^{2}}(z)}{n} \;.
\tag{3.12}
\end{equation}\]</span></p>
<p>For simple random sampling of infinite populations, the sampling variance of the estimator of the total can be estimated by</p>
<p><span class="math display" id="eq:EstVarTotalSIR">\[\begin{equation}
\widehat{V}\!\left(\hat{t}(z)\right)=A^2\frac{\widehat{S^{2}}(z)}{n} \;.
\tag{3.13}
\end{equation}\]</span></p>
<p>The sampling variance of the estimator of a proportion <span class="math inline">\(\hat{p}\)</span> for simple random sampling without replacement of a finite population can be estimated by</p>
<p><span class="math display" id="eq:EstVarProportionSI">\[\begin{equation}
\widehat{V}\!\left(\hat{p}\right)=\left( 1-\frac{n}{N}\right) \frac{\hat{p}(1-\hat{p})}{n-1} \;.
\tag{3.14}
\end{equation}\]</span></p>
<p>The numerator in this estimator is an estimate of the population variance of the indicator. Note that this estimated population variance is divided by <span class="math inline">\(n-1\)</span>, and not by <span class="math inline">\(n\)</span> as in the estimator of the population mean <span class="citation">(<a href="#ref-loh99" role="doc-biblioref">Lohr 1999</a>)</span>.</p>
<p>Estimation of the standard error of the estimated population mean in <strong>R</strong> is very straightforward. To estimate the standard error of the estimated total in Mg, the standard error of the estimated population mean must be multiplied by a constant equal to the product of the soil volume, the bulk density, and <span class="math inline">\(10^{-6}\)</span>; see second code chunk in Section <a href="SI.html#HTestimatorSI">3.1</a>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="SI.html#cb16-1" aria-hidden="true" tabindex="-1"></a>se_mz <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(mysample<span class="sc">$</span>z) <span class="sc">/</span> n)</span>
<span id="cb16-2"><a href="SI.html#cb16-2" aria-hidden="true" tabindex="-1"></a>se_tz <span class="ot">&lt;-</span> se_mz <span class="sc">*</span> vol_soil <span class="sc">*</span> bd <span class="sc">*</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">6</span></span></code></pre></div>
<p>The estimated standard error of the estimated total equals 20,334 Mg. This standard error does not account for spatial variation of bulk density.</p>
<p>Although there is no advantage in using package <strong>survey</strong> <span class="citation">(<a href="#ref-Lumley2020" role="doc-biblioref">Lumley 2021</a>)</span> to compute the <span class="math inline">\(\pi\)</span> estimator and its standard error for this simple sampling design, I illustrate how this works. For more complex designs and alternative estimators, estimation of the population mean and its standard error with functions defined in this package is very convenient, as will be shown in the following chapters.</p>
<p>First, the sampling design that is used to select the sampling units is specified with function <code>svydesign</code>. The first argument specifies the sampling units. In this case, the centres of the discretisation grid cells are used as sampling units, which is indicated by the formula <code>id = ~ 1</code>. In Chapter <a href="Cl.html#Cl">6</a> clusters of population units are used as sampling units, and in Chapter <a href="Twostage.html#Twostage">7</a> both clusters and individual units are used as sampling units. Argument <code>probs</code> specifies the inclusion probabilities of the sampling units. Alternatively, we may specify the weights with argument <code>weights</code>, which are in this case equal to the inverse of the inclusion probabilities. Variable <code>pi</code> is a column in tibble <code>mysample</code>, which is indicated with the tilde in <code>probs = ~ pi</code>.</p>
<p>The population mean is then estimated with function <code>svymean</code>. The first argument is a formula specifying the study variable. Argument <code>design</code> specifies the sampling design.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="SI.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb17-2"><a href="SI.html#cb17-2" aria-hidden="true" tabindex="-1"></a>mysample<span class="sc">$</span>pi <span class="ot">&lt;-</span> n <span class="sc">/</span> N</span>
<span id="cb17-3"><a href="SI.html#cb17-3" aria-hidden="true" tabindex="-1"></a>design_si <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">id =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="at">probs =</span> <span class="sc">~</span> pi, <span class="at">data =</span> mysample)</span>
<span id="cb17-4"><a href="SI.html#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">svymean</span>(<span class="sc">~</span> z, <span class="at">design =</span> design_si)</span></code></pre></div>
<pre><code>    mean     SE
z 93.303 9.6041</code></pre>
<p>For simple random sampling of finite populations without replacement, argument <code>fpc</code> is used to correct the standard error.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="SI.html#cb19-1" aria-hidden="true" tabindex="-1"></a>mysample<span class="sc">$</span>N <span class="ot">&lt;-</span> N</span>
<span id="cb19-2"><a href="SI.html#cb19-2" aria-hidden="true" tabindex="-1"></a>design_si <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">id =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="at">probs =</span> <span class="sc">~</span> pi, <span class="at">fpc =</span> <span class="sc">~</span> N, <span class="at">data =</span> mysample)</span>
<span id="cb19-3"><a href="SI.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">svymean</span>(<span class="sc">~</span> z, design_si)</span></code></pre></div>
<pre><code>    mean     SE
z 93.303 9.5786</code></pre>
<p>The estimated standard error is smaller now due to the finite population correction, see Equation <a href="SI.html#eq:EstVarMeanSI">(3.11)</a>.</p>
<p>Population totals can be estimated with function <code>svytotal</code>, quantiles with function <code>svyquantile</code>, and ratios of population totals with <code>svyratio</code>, to mention a few functions that will be used in following chapters.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="SI.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">svyquantile</span>(<span class="sc">~</span> z, design_si, <span class="at">quantile =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.9</span>))</span></code></pre></div>
<pre><code>$z
     quantile    ci.2.5   ci.97.5       se
0.5  65.56675  53.67764  99.93484 11.43457
0.9 164.36975 153.86258 320.74887 41.25353

attr(,&quot;hasci&quot;)
[1] TRUE
attr(,&quot;class&quot;)
[1] &quot;newsvyquantile&quot;</code></pre>
<div id="exercises-3" class="section level4 unnumbered hasAnchor">
<h4>Exercises<a href="SI.html#exercises-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol start="4" style="list-style-type: decimal">
<li>Is the sampling variance for simple random sampling without replacement larger or smaller than for simple random sampling with replacement, given the sample size <span class="math inline">\(n\)</span>? Explain your answer.<br />
</li>
<li>What is the effect of the population size <span class="math inline">\(N\)</span> on this difference?<br />
</li>
<li>In Section <a href="SI.html#VarMeanSI">3.2</a> the true sampling variance is reported, i.e., the variance of the estimator of the population mean if we would repeat the sampling an infinite number of times. How can this true sampling variance be computed?<br />
</li>
<li>In reality, we cannot compute the true sampling variance. Why not?</li>
</ol>
</div>
</div>
<div id="ConfidenceInterval" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Confidence interval estimate<a href="SI.html#ConfidenceInterval" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A second way of expressing our uncertainty about the estimated total, mean, or proportion is to present not merely a single number, but an interval. The wider the interval, the more uncertain we are about the estimate, and vice versa, the narrower the interval, the more confident we are. To learn how to compute a confidence interval, I return to the sampling distribution of the estimator of the mean SOM concentration. Suppose we would like to compute the bounds of an interval <span class="math inline">\([a,b]\)</span> such that 5% of the estimated population means is smaller than <span class="math inline">\(a\)</span>, and 5% is larger than <span class="math inline">\(b\)</span>. To compute the lower bound <span class="math inline">\(a\)</span> and the upper bound <span class="math inline">\(b\)</span> of this 90% interval, we must specify the distribution function. When the distribution of the study variable <span class="math inline">\(z\)</span> is normal and we know the variance of <span class="math inline">\(z\)</span> in the population, then the sampling distribution of the estimator of the population mean is also normal, regardless of the sample size. The larger the sample size, the smaller the effect of the distribution of <span class="math inline">\(z\)</span> on the sampling distribution of the estimator of the population mean. For instance, even when the distribution of <span class="math inline">\(z\)</span> is far from symmetric, then still the sampling distribution of the estimator of the population mean is approximately normal if the sample size is large, say <span class="math inline">\(n &gt; 100\)</span>. This is the essence of the central limit theorem. Above, we already noticed that the sampling distribution is much less asymmetric than the frequency distribution of the simulated values, and looks much more like a normal distribution. Assuming a normal distribution, the bounds of the 90% interval are given by</p>
<p><span class="math display" id="eq:CIBounds">\[\begin{equation}
\hat{\bar{z}} \pm u_{(0.10/2)}\cdot \sqrt{V\!\left(\hat{\bar{z}}\right)} \;,
\tag{3.15}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(u_{(0.10/2)}\)</span> is the <span class="math inline">\(0.95\)</span> quantile of the standard normal distribution, i.e., the value of <span class="math inline">\(u\)</span> having a tail area of 0.05 to its right. Note that in this equation the sampling variance of the estimator of the population mean <span class="math inline">\(V\!\left(\hat{\bar{z}}\right)\)</span> is used. In practice, this variance is unknown, because the population variance is unknown, and must be estimated from the sample (Equations <a href="SI.html#eq:EstVarMeanSIR">(3.10)</a> and <a href="SI.html#eq:EstVarMeanSI">(3.11)</a>). To account for the unknown sampling variance, the standard normal distribution is replaced by Student’s <em>t</em> distribution (hereafter shortly referred to as the <em>t</em> distribution), which has thicker tails than the standard normal distribution. This leads to the following bounds of the <span class="math inline">\(100(1-\alpha)\%\)</span> confidence interval estimate of the mean:</p>
<p><span class="math display" id="eq:CIBoundsStudent">\[\begin{equation}
\hat{\bar{z}} \pm t^{(n-1)}_{\alpha /2}\cdot
\sqrt{\widehat{V}\!\left(\hat{\bar{z}}\right)} \;,
\tag{3.16}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(t^{(n-1)}_{\alpha /2}\)</span> is the <span class="math inline">\((1-\alpha /2)\)</span> quantile of the <em>t</em> distribution with <span class="math inline">\((n-1)\)</span> degrees of freedom. The quantity <span class="math inline">\((1-\alpha)\)</span> is referred to as the confidence level. The larger the number of degrees of freedom <span class="math inline">\((n-1)\)</span>, the closer the <em>t</em> distribution is to the standard normal distribution. The quantity <span class="math inline">\(t^{(n-1)}_{1-\alpha /2}\cdot \sqrt{\widehat{V}\!\left(\hat{\bar{z}}\right)}\)</span> is referred to as the margin of error.</p>
<p>Function <code>qt</code> computes a quantile of a <em>t</em> distribution, given the degrees of freedom and the cumulative probability. The bounds of the confidence interval can then be computed as follows.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="SI.html#cb23-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb23-2"><a href="SI.html#cb23-2" aria-hidden="true" tabindex="-1"></a>margin <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>, n <span class="sc">-</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> se_mz</span>
<span id="cb23-3"><a href="SI.html#cb23-3" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> mz <span class="sc">-</span> margin</span>
<span id="cb23-4"><a href="SI.html#cb23-4" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> mz <span class="sc">+</span> margin</span></code></pre></div>
<p>More easily, we can use method <code>confint</code> of package <strong>survey</strong> to compute the confidence interval.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="SI.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(<span class="fu">svymean</span>(<span class="sc">~</span> z, design_si), <span class="at">df =</span> <span class="fu">degf</span>(design_si), <span class="at">level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>     2.5 %   97.5 %
z 73.92817 112.6771</code></pre>

<div class="rmdnote">
The interpretation of a confidence interval is not straightforward. A common misinterpretation is that if the 0.90 confidence interval estimate of the population mean equals <span class="math inline">\([a,b]\)</span>, then the probability that the population mean is in this interval equals 0.90. In classical sampling theory, this cannot be a correct interpretation, because the population mean is not a random variable, and consequently the probability that the population mean is in an interval does not exist. However, the estimated bounds of the confidence interval are random variables, because the estimated population mean and also the estimated sampling variance vary among samples drawn with a probability sampling design. Therefore, it does make sense to attach a probability to this interval.
</div>
<p>Figure <a href="SI.html#fig:coverageconfinterval">3.4</a> shows the 90% confidence interval estimates of the mean SOM concentration for the first 100 simple random samples drawn above. Note that both the location and the length of the intervals differ between samples. For each sample, I determined whether this interval covers the population mean.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:coverageconfinterval"></span>
<img src="SpatialSampling_files/figure-html/coverageconfinterval-1.png" alt="Estimated confidence intervals of the mean SOM concentration (g kg-1) in Voorst, estimated from 100 simple random samples of size 40. The vertical red line is at the true population mean (81.1 g kg-1)." width="80%" />
<p class="caption">
Figure 3.4: Estimated confidence intervals of the mean SOM concentration (g kg<sup>-1</sup>) in Voorst, estimated from 100 simple random samples of size 40. The vertical red line is at the true population mean (81.1 g kg<sup>-1</sup>).
</p>
</div>
<p>Out of the 10,000 samples, 1,132 samples do not cover the population mean, i.e., close to the specified 10%. So, a 90% confidence interval is a random interval that contains in the long run the population mean 90% of the time.</p>
<div id="ConfidenceIntervalProportion" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Confidence interval for a proportion<a href="SI.html#ConfidenceIntervalProportion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ideally, a confidence interval for a population proportion is based on the binomial distribution of the number of sampling units satisfying a condition (the number of successes). The binomial distribution is a discrete distribution. There are various methods for computing coverage probabilities of confidence intervals for a binomial proportion, see <span class="citation">Brown, Cai, and DasGupta (<a href="#ref-Brown2001" role="doc-biblioref">2001</a>)</span> for a discussion. A common method for computing the confidence interval of a proportion is the Clopper-Pearson method. Function <code>BinomCI</code> of package <strong>DescTools</strong> can be used to compute confidence intervals for proportions <span class="citation">(<a href="#ref-DescTools" role="doc-biblioref">Signorell 2021</a>)</span>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="SI.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb26-2"><a href="SI.html#cb26-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb26-3"><a href="SI.html#cb26-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb26-4"><a href="SI.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p.est <span class="ot">&lt;-</span> <span class="fu">BinomCI</span>(k, n, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="st">&quot;clopper-pearson&quot;</span>))</span></code></pre></div>
<pre><code>     est     lwr.ci    upr.ci
[1,] 0.1 0.03327509 0.2181354</code></pre>
<p>The confidence interval is not symmetric around the estimated proportion of 0.1. As can be seen below, the upper bound is the proportion at which the probability of 5 or fewer successes is 0.025,</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="SI.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> k, <span class="at">size =</span> n, <span class="at">prob =</span> p.est[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>[1] 0.025</code></pre>
<p>and the lower bound of the confidence interval is the proportion at which the probability of 5 or more successes is also equal to 0.025. Note that to compute the upper tail probability, we must assign <span class="math inline">\(k-1 = 4\)</span> to argument <code>q</code>, because with argument <code>lower.tail = FALSE</code> function <code>pbinom</code> computes the probability of <span class="math inline">\(X&gt;x\)</span>, not of <span class="math inline">\(X \geq x\)</span>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="SI.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> k <span class="sc">-</span> <span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob =</span> p.est[<span class="dv">2</span>], <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>[1] 0.025</code></pre>
<p>For large sample sizes and for proportions close to 0.5, the confidence interval can be computed with a normal distribution as an approximation to the binomial distribution, using Equation <a href="SI.html#eq:EstVarProportionSI">(3.14)</a> for the variance estimator of the estimator of a proportion:</p>
<p><span class="math display" id="eq:Waldinterval">\[\begin{equation}
\hat{p} \pm u_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n-1}} \;.
\tag{3.17}
\end{equation}\]</span></p>
<p>This interval is referred to as the Wald interval. It is a fact that unless <span class="math inline">\(n\)</span> is very large, the actual coverage probability of the Wald interval is poor for <span class="math inline">\(p\)</span> near 0 or 1. A rule of thumb is that the Wald interval should be used only when <span class="math inline">\(n \cdot min\{p,(1−p)\}\)</span> is at least 5 or 10. For small <span class="math inline">\(n\)</span>, <span class="citation">Brown, Cai, and DasGupta (<a href="#ref-Brown2001" role="doc-biblioref">2001</a>)</span> recommend the Wilson interval and for larger <span class="math inline">\(n\)</span> the Agresti-Coull interval. These intervals can be computed with function <code>BinomCI</code> of package <strong>DescTools</strong>.</p>
</div>
</div>
<div id="SIcircularplots" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Simple random sampling of circular plots<a href="SI.html#SIcircularplots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In forest inventory, vegetation surveys, and agricultural surveys, circular sampling plots are quite common. Using circular plots as sampling units is not entirely straightforward, because the study area cannot be partitioned into a finite number of circles that fully cover the study area. The use of circular plots as sampling units can be implemented in two ways <span class="citation">(<a href="#ref-DeVries1986" role="doc-biblioref">De Vries 1986</a>)</span>:</p>
<ol style="list-style-type: decimal">
<li>sampling from a finite set of fixed circles; and</li>
<li>sampling from an infinite set of floating circles.</li>
</ol>
<div id="sampling-from-a-finite-set-of-fixed-circles" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Sampling from a finite set of fixed circles<a href="SI.html#sampling-from-a-finite-set-of-fixed-circles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sampling from a finite set of fixed circles is simple, but as we will see this requires an assumption about the distribution of the study variable in the population. In this implementation, the sampling units consist of a finite set of slightly overlapping or non-overlapping fixed circular plots (Figure <a href="SI.html#fig:circularplotswithinsquares">3.5</a>). The circles can be constructed as follows. A grid with squares is superimposed on the study area, so that it fully covers the study area. These squares are then substituted by circles with an area equal to the area of the squares, or by non-overlapping tangent circles inscribed in the squares. The radius of the partly overlapping circles equals <span class="math inline">\(\sqrt{a/\pi}\)</span>, with <span class="math inline">\(a\)</span> the area of the squares, the radius of the non-overlapping circles equals <span class="math inline">\(\sqrt{a}/2\)</span>. In both implementations, the infinite population is replaced by a finite population of circles that does not fully tessellate the study area. When using the partly overlapping circles as sampling units we may avoid overlap by selecting a systematic sample (Chapter <a href="SY.html#SY">5</a>) of circular plots. The population total can then be estimated by Equation <a href="SI.html#eq:HTTotalSI">(3.1)</a>, substituting <span class="math inline">\(A/a\)</span> for <span class="math inline">\(N\)</span>, and where <span class="math inline">\(z_k\)</span> is the total of the <span class="math inline">\(k\)</span>th circle (sum of observations of all population units in <span class="math inline">\(k\)</span>th circle). However, no unbiased estimator of the sampling variance of the estimator of the population total or mean is available for this sampling design, see Chapter <a href="SY.html#SY">5</a>.</p>
<p>With simple random sampling without replacement of non-overlapping circular plots, the finite population total can be estimated by Equation <a href="SI.html#eq:HTTotalSI">(3.1)</a> and its sampling variance by Equation <a href="SI.html#eq:EstVarTotalSI">(3.12)</a>. However, the circular plots do not cover the full study area, and as a consequence the total of the infinite population is underestimated. A corrected estimate can be obtained by estimating the mean of the finite population and multiplying this estimated population mean by <span class="math inline">\(A/a\)</span> <span class="citation">(<a href="#ref-DeVries1986" role="doc-biblioref">De Vries 1986</a>)</span>:</p>
<p><span class="math display" id="eq:correctedestimate">\[\begin{equation}
\hat{t}(z)= \frac{A}{a} \hat{\bar{z}}\;,
\tag{3.18}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(\hat{\bar{z}}\)</span> the estimated mean of the finite population. The variance can be estimated by the variance of the estimator of the mean of the finite population, multiplied by the square of <span class="math inline">\(A/a\)</span>. However, we still need to assume that the mean of the finite population is equal to the mean of the infinite population. This assumption can be avoided by sampling from an infinite set of floating circles.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:circularplotswithinsquares"></span>
<img src="SpatialSampling_files/figure-html/circularplotswithinsquares-1.png" alt="Simple random sample of ten circular plots from a square discretised by a finite set of partly overlapping or non-overlapping circular plots." width="100%" />
<p class="caption">
Figure 3.5: Simple random sample of ten circular plots from a square discretised by a finite set of partly overlapping or non-overlapping circular plots.
</p>
</div>
</div>
<div id="sampling-from-an-infinite-set-of-floating-circles" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Sampling from an infinite set of floating circles<a href="SI.html#sampling-from-an-infinite-set-of-floating-circles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A simple random sample of floating circular plots can be selected by simple random sampling of the centres of the plots. The circular plots overlap if two selected points are separated by a distance smaller than the diameter of the circular plots. Besides, when a plot is selected near the border of the study area, a part of the plot is outside the study area. This part is ignored in estimating the population mean or total. To select the centres, the study area must be extended by a zone with a width equal to the radius of the circular plots. This is illustrated in Figure <a href="SI.html#fig:circularplots">3.6</a>, showing a square study area of 100 m <span class="math inline">\(\times\)</span> 100 m. To select ten circular plots with a radius of 5 m from this square, ten points are selected by simple random sampling, using function <code>runif</code>, with -5 as lower limit and 105 as upper limit of the uniform distribution.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="SI.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">129</span>)</span>
<span id="cb32-2"><a href="SI.html#cb32-2" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">10</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">max =</span> <span class="dv">105</span>)</span>
<span id="cb32-3"><a href="SI.html#cb32-3" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">10</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">max =</span> <span class="dv">105</span>)</span></code></pre></div>
<p>Two points are selected outside the study area, in the extended zone. For both points, a small part of the circular plot is inside the square. To determine the study variable for these two sampling units, only the part of the plot inside the square is observed. In other words, these two observations have a smaller support than the observations of the other eight plots, see Chapter <a href="GeneralIntro.html#GeneralIntro">1</a>.</p>
<p>In the upper left corner, two sampling units are selected that largely overlap. The intersection of the two circular plots is used twice, to determine the study variable of both sampling units.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:circularplots"></span>
<img src="SpatialSampling_files/figure-html/circularplots-1.png" alt="Simple random sample of ten floating circular plots from a square." width="80%" />
<p class="caption">
Figure 3.6: Simple random sample of ten floating circular plots from a square.
</p>
</div>
<p>Given the observations of the selected circular plots, the population total can be estimated by <span class="citation">(<a href="#ref-DeVries1986" role="doc-biblioref">De Vries 1986</a>)</span></p>
<p><span class="math display" id="eq:EstimatorPopulationTotalCircles">\[\begin{equation}
\hat{t}(z)= \frac{A}{a}\frac{1}{n}\sum_{k \in \mathcal{S}} z_k\;,
\tag{3.19}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(a\)</span> the area of the circle and <span class="math inline">\(z_k\)</span> the observed total of sampling unit <span class="math inline">\(k\)</span> (circle). The same estimate of the total is obtained if we divide the observations by <span class="math inline">\(a\)</span> to obtain a mean per sampling unit:</p>
<p><span class="math display" id="eq:EstimatorPopulationTotalCircles2">\[\begin{equation}
\hat{t}(z)= A\frac{1}{n}\sum_{k \in \mathcal{S}}\frac{z_k}{a}\;.
\tag{3.20}
\end{equation}\]</span></p>
<p>The sampling variance of the estimator of the total can be estimated by</p>
<p><span class="math display" id="eq:VarEstimatorPopulationTotalCircles">\[\begin{equation}
\widehat{V}(\hat{t}(z)) = \left(\frac{A}{a}\right)^2 \frac{\widehat{S^2}(z)}{n}\;,
\tag{3.21}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(\widehat{S^2}(z)\)</span> the estimated population variance of the totals per population unit (circle).</p>
<div id="exercises-4" class="section level4 unnumbered hasAnchor">
<h4>Exercises<a href="SI.html#exercises-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol start="8" style="list-style-type: decimal">
<li>Write an <strong>R</strong> script to select a simple random sample of size 40 from Voorst.
<ul>
<li>Use the selected sample to estimate the population mean of the SOM concentration (<span class="math inline">\(z\)</span> in the data frame) and its standard error.</li>
<li>Compute the lower and the upper bound of the 90% confidence interval using the <em>t</em> distribution, and check whether the population mean is covered by the interval.</li>
<li>Compare the length of the 90% confidence interval with the length of the 95% interval. Explain the difference in width.</li>
<li>Use the selected sample to estimate the total mass of SOM in Mg in the topsoil (<span class="math inline">\(0-30\)</span> cm) of Voorst. Use as a bulk density 1,500 kg m<sup>-3</sup>. The size of the grid cells is 25 m <span class="math inline">\(\times\)</span> 25 m.</li>
<li>Estimate the standard error of the estimated total.</li>
<li>Do you think this standard error is a realistic estimate of the uncertainty about the estimated total?</li>
</ul></li>
</ol>

</div>
</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-magrittr" class="csl-entry">
Bache, Stefan Milton, and Hadley Wickham. 2020. <em><span class="nocase">magrittr: A Forward-Pipe Operator for R</span></em>. <a href="https://CRAN.R-project.org/package=magrittr">https://CRAN.R-project.org/package=magrittr</a>.
</div>
<div id="ref-Brown2001" class="csl-entry">
Brown, L. D., T. T. Cai, and A. DasGupta. 2001. <span>“<span class="nocase">Interval estimation for a binomial proportion - Comment - Rejoinder</span>.”</span> <em>Statistical Science</em> 16 (2): 101–33.
</div>
<div id="ref-DeVries1986" class="csl-entry">
De Vries, P. G. 1986. <em>Sampling Theory for Forest Inventory: A Teach-Yourself Course</em>. New York: Springer-Verlag.
</div>
<div id="ref-Hutson1999" class="csl-entry">
Hutson, Alan D. 1999. <span>“Calculating Nonparametric Confidence Intervals for Quantiles Using Fractional Order Statistics.”</span> <em>Journal of Applied Statistics</em> 26 (3): 343–53. <a href="https://doi.org/10.1080/02664769922458">https://doi.org/10.1080/02664769922458</a>.
</div>
<div id="ref-QuantileNPCI" class="csl-entry">
Hutson, Nicholas, Alan Hutson, and Li Yan. 2019. <em>QuantileNPCI: Nonparametric Confidence Intervals for Quantiles</em>. <a href="https://CRAN.R-project.org/package=QuantileNPCI">https://CRAN.R-project.org/package=QuantileNPCI</a>.
</div>
<div id="ref-Hyndman1996" class="csl-entry">
Hyndman, R. J., and Y. Fan. 1996. <span>“Sample Quantiles in Statistical Packages.”</span> <em>American Statistician</em> 50 (4): 361–65. <a href="https://doi.org/10.2307/2684934">https://doi.org/10.2307/2684934</a>.
</div>
<div id="ref-loh99" class="csl-entry">
Lohr, S. L. 1999. <em>Sampling: Design and Analysis</em>. Pacific Grove: Duxbury Press.
</div>
<div id="ref-Lumley2020" class="csl-entry">
———. 2021. <em><span class="nocase">survey: Analysis of Complex Survey Samples</span></em>.
</div>
<div id="ref-tibble" class="csl-entry">
Müller, Kirill, and Hadley Wickham. 2021. <em>Tibble: Simple Data Frames</em>. <a href="https://CRAN.R-project.org/package=tibble">https://CRAN.R-project.org/package=tibble</a>.
</div>
<div id="ref-sar92" class="csl-entry">
Särndal, C. E., B. Swensson, and J. Wretman. 1992. <em>Model Assisted Survey Sampling</em>. New York: Springer.
</div>
<div id="ref-DescTools" class="csl-entry">
Signorell, Andri. 2021. <em>DescTools: Tools for Descriptive Statistics</em>. <a href="https://cran.r-project.org/package=DescTools">https://cran.r-project.org/package=DescTools</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>A tibble is a data frame of class <code>tbl_df</code> of package <strong>tibble</strong> <span class="citation">(<a href="#ref-tibble" role="doc-biblioref">K. Müller and Wickham 2021</a>)</span>. Hereafter, I will use the terms tibble and data frame interchangeably. A traditional data frame is referred to as a <code>data.frame</code>.<a href="SI.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="IntroProbabilitySampling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="STSI.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/DickBrus/SpatialSamplingwithR/edit/master/03-SI.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SpatialSampling.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
