<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 18 Covariate space coverage sampling | Spatial sampling with R</title>
  <meta name="description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 18 Covariate space coverage sampling | Spatial sampling with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.pdf" />
  <meta property="og:description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="github-repo" content="DickBrus/SpatialSamplingwithR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 18 Covariate space coverage sampling | Spatial sampling with R" />
  
  <meta name="twitter:description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="twitter:image" content="/images/cover.pdf" />

<meta name="author" content="Dick J. Brus" />


<meta name="date" content="2023-06-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="RegularGridSpatialCoverage.html"/>
<link rel="next" href="cLHS.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial sampling with R</a></li>

<li class="divider"></li>
<li><a href="index.html#preface" id="toc-preface">Preface</a>
<ul>
<li><a href="index.html#acknowledgments" id="toc-acknowledgments">Acknowledgments</a></li>
</ul></li>
<li><a href="GeneralIntro.html#GeneralIntro" id="toc-GeneralIntro"><span class="toc-section-number">1</span> Introduction</a>
<ul>
<li><a href="GeneralIntro.html#BasicConcepts" id="toc-BasicConcepts"><span class="toc-section-number">1.1</span> Basic sampling concepts</a>
<ul>
<li><a href="GeneralIntro.html#PopulationParameters" id="toc-PopulationParameters"><span class="toc-section-number">1.1.1</span> Population parameters</a></li>
<li><a href="GeneralIntro.html#descriptive-statistics-vs.-inference-about-a-population" id="toc-descriptive-statistics-vs.-inference-about-a-population"><span class="toc-section-number">1.1.2</span> Descriptive statistics vs. inference about a population</a></li>
<li><a href="GeneralIntro.html#random-sampling-vs.-probability-sampling" id="toc-random-sampling-vs.-probability-sampling"><span class="toc-section-number">1.1.3</span> Random sampling vs. probability sampling</a></li>
</ul></li>
<li><a href="GeneralIntro.html#DBvsMB" id="toc-DBvsMB"><span class="toc-section-number">1.2</span> Design-based vs. model-based approach</a></li>
<li><a href="GeneralIntro.html#Datasets" id="toc-Datasets"><span class="toc-section-number">1.3</span> Populations used in sampling experiments</a>
<ul>
<li><a href="GeneralIntro.html#Voorst" id="toc-Voorst"><span class="toc-section-number">1.3.1</span> Soil organic matter in Voorst, the Netherlands</a></li>
<li><a href="GeneralIntro.html#Poppy" id="toc-Poppy"><span class="toc-section-number">1.3.2</span> Poppy fields in Kandahar, Afghanistan</a></li>
<li><a href="GeneralIntro.html#Amazonia" id="toc-Amazonia"><span class="toc-section-number">1.3.3</span> Aboveground biomass in Eastern Amazonia, Brazil</a></li>
<li><a href="GeneralIntro.html#TASIberia" id="toc-TASIberia"><span class="toc-section-number">1.3.4</span> Annual mean air temperature in Iberia</a></li>
</ul></li>
</ul></li>
<li><a href="#part-probability-sampling-for-estimating-population-parameters" id="toc-part-probability-sampling-for-estimating-population-parameters">(PART) Probability sampling for estimating population parameters</a></li>
<li><a href="IntroProbabilitySampling.html#IntroProbabilitySampling" id="toc-IntroProbabilitySampling"><span class="toc-section-number">2</span> Introduction to probability sampling</a>
<ul>
<li><a href="IntroProbabilitySampling.html#arbitrary-haphazard-sampling-vs.-probability-sampling" id="toc-arbitrary-haphazard-sampling-vs.-probability-sampling">Arbitrary (haphazard) sampling vs. probability sampling</a></li>
<li><a href="IntroProbabilitySampling.html#HTestimator" id="toc-HTestimator"><span class="toc-section-number">2.1</span> Horvitz-Thompson estimator</a></li>
<li><a href="IntroProbabilitySampling.html#hansen-hurwitz-estimator" id="toc-hansen-hurwitz-estimator"><span class="toc-section-number">2.2</span> Hansen-Hurwitz estimator</a></li>
<li><a href="IntroProbabilitySampling.html#using-models-in-design-based-approach" id="toc-using-models-in-design-based-approach"><span class="toc-section-number">2.3</span> Using models in design-based approach</a></li>
</ul></li>
<li><a href="SI.html#SI" id="toc-SI"><span class="toc-section-number">3</span> Simple random sampling</a>
<ul>
<li><a href="SI.html#HTestimatorSI" id="toc-HTestimatorSI"><span class="toc-section-number">3.1</span> Estimation of population parameters</a>
<ul>
<li><a href="SI.html#PopProportion" id="toc-PopProportion"><span class="toc-section-number">3.1.1</span> Population proportion</a></li>
<li><a href="SI.html#CDF" id="toc-CDF"><span class="toc-section-number">3.1.2</span> Cumulative distribution function and quantiles</a></li>
</ul></li>
<li><a href="SI.html#VarMeanSI" id="toc-VarMeanSI"><span class="toc-section-number">3.2</span> Sampling variance of estimator of population parameters</a></li>
<li><a href="SI.html#ConfidenceInterval" id="toc-ConfidenceInterval"><span class="toc-section-number">3.3</span> Confidence interval estimate</a>
<ul>
<li><a href="SI.html#ConfidenceIntervalProportion" id="toc-ConfidenceIntervalProportion"><span class="toc-section-number">3.3.1</span> Confidence interval for a proportion</a></li>
</ul></li>
<li><a href="SI.html#SIcircularplots" id="toc-SIcircularplots"><span class="toc-section-number">3.4</span> Simple random sampling of circular plots</a>
<ul>
<li><a href="SI.html#sampling-from-a-finite-set-of-fixed-circles" id="toc-sampling-from-a-finite-set-of-fixed-circles"><span class="toc-section-number">3.4.1</span> Sampling from a finite set of fixed circles</a></li>
<li><a href="SI.html#sampling-from-an-infinite-set-of-floating-circles" id="toc-sampling-from-an-infinite-set-of-floating-circles"><span class="toc-section-number">3.4.2</span> Sampling from an infinite set of floating circles</a></li>
</ul></li>
</ul></li>
<li><a href="STSI.html#STSI" id="toc-STSI"><span class="toc-section-number">4</span> Stratified simple random sampling</a>
<ul>
<li><a href="STSI.html#EstimatorsSTSI" id="toc-EstimatorsSTSI"><span class="toc-section-number">4.1</span> Estimation of population parameters</a>
<ul>
<li><a href="STSI.html#population-proportion-cumulative-distribution-function-and-quantiles" id="toc-population-proportion-cumulative-distribution-function-and-quantiles"><span class="toc-section-number">4.1.1</span> Population proportion, cumulative distribution function, and quantiles</a></li>
<li><a href="STSI.html#WhyStratify" id="toc-WhyStratify"><span class="toc-section-number">4.1.2</span> Why should we stratify?</a></li>
</ul></li>
<li><a href="STSI.html#CISTSI" id="toc-CISTSI"><span class="toc-section-number">4.2</span> Confidence interval estimate</a></li>
<li><a href="STSI.html#STSIallocation" id="toc-STSIallocation"><span class="toc-section-number">4.3</span> Allocation of sample size to strata</a></li>
<li><a href="STSI.html#cumrootf" id="toc-cumrootf"><span class="toc-section-number">4.4</span> <em>Cum-root-f</em> stratification</a></li>
<li><a href="STSI.html#kmeansstratification" id="toc-kmeansstratification"><span class="toc-section-number">4.5</span> Stratification with multiple covariates</a></li>
<li><a href="STSI.html#geostrata" id="toc-geostrata"><span class="toc-section-number">4.6</span> Geographical stratification</a></li>
<li><a href="STSI.html#multiway-stratification" id="toc-multiway-stratification"><span class="toc-section-number">4.7</span> Multiway stratification</a></li>
<li><a href="STSI.html#MultivariateStratification" id="toc-MultivariateStratification"><span class="toc-section-number">4.8</span> Multivariate stratification</a></li>
</ul></li>
<li><a href="SY.html#SY" id="toc-SY"><span class="toc-section-number">5</span> Systematic random sampling</a>
<ul>
<li><a href="SY.html#EstVarSY" id="toc-EstVarSY"><span class="toc-section-number">5.1</span> Estimation of population parameters</a></li>
<li><a href="SY.html#approximating-the-sampling-variance-of-the-estimator-of-the-mean" id="toc-approximating-the-sampling-variance-of-the-estimator-of-the-mean"><span class="toc-section-number">5.2</span> Approximating the sampling variance of the estimator of the mean</a></li>
</ul></li>
<li><a href="Cl.html#Cl" id="toc-Cl"><span class="toc-section-number">6</span> Cluster random sampling</a>
<ul>
<li><a href="Cl.html#clustersamplingestimators" id="toc-clustersamplingestimators"><span class="toc-section-number">6.1</span> Estimation of population parameters</a></li>
<li><a href="Cl.html#clusters-selected-with-probabilities-proportional-to-size-without-replacement" id="toc-clusters-selected-with-probabilities-proportional-to-size-without-replacement"><span class="toc-section-number">6.2</span> Clusters selected with probabilities proportional to size, without replacement</a></li>
<li><a href="Cl.html#SIC" id="toc-SIC"><span class="toc-section-number">6.3</span> Simple random sampling of clusters</a></li>
<li><a href="Cl.html#StratifiedCl" id="toc-StratifiedCl"><span class="toc-section-number">6.4</span> Stratified cluster random sampling</a></li>
</ul></li>
<li><a href="Twostage.html#Twostage" id="toc-Twostage"><span class="toc-section-number">7</span> Two-stage cluster random sampling</a>
<ul>
<li><a href="Twostage.html#twostagesamplingestimators" id="toc-twostagesamplingestimators"><span class="toc-section-number">7.1</span> Estimation of population parameters</a></li>
<li><a href="Twostage.html#primary-sampling-units-selected-without-replacement" id="toc-primary-sampling-units-selected-without-replacement"><span class="toc-section-number">7.2</span> Primary sampling units selected without replacement</a></li>
<li><a href="Twostage.html#TwostageSISI" id="toc-TwostageSISI"><span class="toc-section-number">7.3</span> Simple random sampling of primary sampling units</a></li>
<li><a href="Twostage.html#StratifiedTwostage" id="toc-StratifiedTwostage"><span class="toc-section-number">7.4</span> Stratified two-stage cluster random sampling</a></li>
</ul></li>
<li><a href="pps.html#pps" id="toc-pps"><span class="toc-section-number">8</span> Sampling with probabilities proportional to size</a>
<ul>
<li><a href="pps.html#ppswr" id="toc-ppswr"><span class="toc-section-number">8.1</span> Probability-proportional-to-size sampling with replacement</a></li>
<li><a href="pps.html#ppswor" id="toc-ppswor"><span class="toc-section-number">8.2</span> Probability-proportional-to-size sampling without replacement</a>
<ul>
<li><a href="pps.html#Systematicpps" id="toc-Systematicpps"><span class="toc-section-number">8.2.1</span> Systematic pps sampling without replacement</a></li>
<li><a href="pps.html#pivotalmethod" id="toc-pivotalmethod"><span class="toc-section-number">8.2.2</span> The pivotal method</a></li>
</ul></li>
</ul></li>
<li><a href="BalancedSpreaded.html#BalancedSpreaded" id="toc-BalancedSpreaded"><span class="toc-section-number">9</span> Balanced and well-spread sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#Balanced" id="toc-Balanced"><span class="toc-section-number">9.1</span> Balanced sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#balanced-sample-vs.-balanced-sampling-design" id="toc-balanced-sample-vs.-balanced-sampling-design"><span class="toc-section-number">9.1.1</span> Balanced sample vs. balanced sampling design</a></li>
<li><a href="BalancedSpreaded.html#unequal-inclusion-probabilities" id="toc-unequal-inclusion-probabilities"><span class="toc-section-number">9.1.2</span> Unequal inclusion probabilities</a></li>
<li><a href="BalancedSpreaded.html#StratifiedsamplingasBalancedsampling" id="toc-StratifiedsamplingasBalancedsampling"><span class="toc-section-number">9.1.3</span> Stratified random sampling</a></li>
<li><a href="BalancedSpreaded.html#Multiwaystratification" id="toc-Multiwaystratification"><span class="toc-section-number">9.1.4</span> Multiway stratification</a></li>
</ul></li>
<li><a href="BalancedSpreaded.html#Spreaded" id="toc-Spreaded"><span class="toc-section-number">9.2</span> Well-spread sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#LPM" id="toc-LPM"><span class="toc-section-number">9.2.1</span> Local pivotal method</a></li>
<li><a href="BalancedSpreaded.html#GRTS" id="toc-GRTS"><span class="toc-section-number">9.2.2</span> Generalised random-tessellation stratified sampling</a></li>
</ul></li>
<li><a href="BalancedSpreaded.html#BalancedandSpreaded" id="toc-BalancedandSpreaded"><span class="toc-section-number">9.3</span> Balanced sampling with spreading</a></li>
</ul></li>
<li><a href="Modelassisted.html#Modelassisted" id="toc-Modelassisted"><span class="toc-section-number">10</span> Model-assisted estimation</a>
<ul>
<li><a href="Modelassisted.html#GREG" id="toc-GREG"><span class="toc-section-number">10.1</span> Generalised regression estimator</a>
<ul>
<li><a href="Modelassisted.html#RegressionEstimator" id="toc-RegressionEstimator"><span class="toc-section-number">10.1.1</span> Simple and multiple regression estimators</a></li>
<li><a href="Modelassisted.html#penalised-least-squares-estimation" id="toc-penalised-least-squares-estimation"><span class="toc-section-number">10.1.2</span> Penalised least squares estimation</a></li>
<li><a href="Modelassisted.html#RegressionEstimatorSTSI" id="toc-RegressionEstimatorSTSI"><span class="toc-section-number">10.1.3</span> Regression estimator with stratified simple random sampling</a></li>
</ul></li>
<li><a href="Modelassisted.html#RatioEstimator" id="toc-RatioEstimator"><span class="toc-section-number">10.2</span> Ratio estimator</a>
<ul>
<li><a href="Modelassisted.html#RatioEstimatorSTSI" id="toc-RatioEstimatorSTSI"><span class="toc-section-number">10.2.1</span> Ratio estimators with stratified simple random sampling</a></li>
</ul></li>
<li><a href="Modelassisted.html#PoststratifiedEstimator" id="toc-PoststratifiedEstimator"><span class="toc-section-number">10.3</span> Poststratified estimator</a></li>
<li><a href="Modelassisted.html#RandomForest" id="toc-RandomForest"><span class="toc-section-number">10.4</span> Model-assisted estimation using machine learning techniques</a>
<ul>
<li><a href="Modelassisted.html#predicting-with-a-regression-tree" id="toc-predicting-with-a-regression-tree"><span class="toc-section-number">10.4.1</span> Predicting with a regression tree</a></li>
<li><a href="Modelassisted.html#predicting-with-a-random-forest" id="toc-predicting-with-a-random-forest"><span class="toc-section-number">10.4.2</span> Predicting with a random forest</a></li>
</ul></li>
<li><a href="Modelassisted.html#big-data-and-volunteer-data" id="toc-big-data-and-volunteer-data"><span class="toc-section-number">10.5</span> Big data and volunteer data</a></li>
</ul></li>
<li><a href="Twophase.html#Twophase" id="toc-Twophase"><span class="toc-section-number">11</span> Two-phase random sampling</a>
<ul>
<li><a href="Twophase.html#TwophaseStratification" id="toc-TwophaseStratification"><span class="toc-section-number">11.1</span> Two-phase random sampling for stratification</a></li>
<li><a href="Twophase.html#TwophaseRegression" id="toc-TwophaseRegression"><span class="toc-section-number">11.2</span> Two-phase random sampling for regression</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#RequiredSampleSize" id="toc-RequiredSampleSize"><span class="toc-section-number">12</span> Computing the required sample size</a>
<ul>
<li><a href="RequiredSampleSize.html#standard-error" id="toc-standard-error"><span class="toc-section-number">12.1</span> Standard error</a></li>
<li><a href="RequiredSampleSize.html#ReqSampleSizeLengthCI" id="toc-ReqSampleSizeLengthCI"><span class="toc-section-number">12.2</span> Length of confidence interval</a>
<ul>
<li><a href="RequiredSampleSize.html#length-of-confidence-interval-for-a-proportion" id="toc-length-of-confidence-interval-for-a-proportion"><span class="toc-section-number">12.2.1</span> Length of confidence interval for a proportion</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#statistical-testing-of-hypothesis" id="toc-statistical-testing-of-hypothesis"><span class="toc-section-number">12.3</span> Statistical testing of hypothesis</a>
<ul>
<li><a href="RequiredSampleSize.html#sample-size-for-testing-a-proportion" id="toc-sample-size-for-testing-a-proportion"><span class="toc-section-number">12.3.1</span> Sample size for testing a proportion</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#DesignEffect" id="toc-DesignEffect"><span class="toc-section-number">12.4</span> Accounting for design effect</a></li>
<li><a href="RequiredSampleSize.html#BayesianSampleSize" id="toc-BayesianSampleSize"><span class="toc-section-number">12.5</span> Bayesian sample size determination</a>
<ul>
<li><a href="RequiredSampleSize.html#bayesian-criteria-for-sample-size-computation" id="toc-bayesian-criteria-for-sample-size-computation"><span class="toc-section-number">12.5.1</span> Bayesian criteria for sample size computation</a></li>
<li><a href="RequiredSampleSize.html#mixed-bayesian-likelihood-approach" id="toc-mixed-bayesian-likelihood-approach"><span class="toc-section-number">12.5.2</span> Mixed Bayesian-likelihood approach</a></li>
<li><a href="RequiredSampleSize.html#estimation-of-population-mean" id="toc-estimation-of-population-mean"><span class="toc-section-number">12.5.3</span> Estimation of population mean</a></li>
<li><a href="RequiredSampleSize.html#estimation-of-a-population-proportion" id="toc-estimation-of-a-population-proportion"><span class="toc-section-number">12.5.4</span> Estimation of a population proportion</a></li>
</ul></li>
</ul></li>
<li><a href="MBpredictionofDesignVariance.html#MBpredictionofDesignVariance" id="toc-MBpredictionofDesignVariance"><span class="toc-section-number">13</span> Model-based optimisation of probability sampling designs</a>
<ul>
<li><a href="MBpredictionofDesignVariance.html#model-based-optimisation-of-sampling-design-type-and-sample-size" id="toc-model-based-optimisation-of-sampling-design-type-and-sample-size"><span class="toc-section-number">13.1</span> Model-based optimisation of sampling design type and sample size</a>
<ul>
<li><a href="MBpredictionofDesignVariance.html#AnalyticalApproach" id="toc-AnalyticalApproach"><span class="toc-section-number">13.1.1</span> Analytical approach</a></li>
<li><a href="MBpredictionofDesignVariance.html#GeostatisticalSimulationApproach" id="toc-GeostatisticalSimulationApproach"><span class="toc-section-number">13.1.2</span> Geostatistical simulation approach</a></li>
<li><a href="MBpredictionofDesignVariance.html#MBpredSamplingVarBayes" id="toc-MBpredSamplingVarBayes"><span class="toc-section-number">13.1.3</span> Bayesian approach</a></li>
</ul></li>
<li><a href="MBpredictionofDesignVariance.html#Ospats" id="toc-Ospats"><span class="toc-section-number">13.2</span> Model-based optimisation of spatial strata</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#SmallAreaEstimation" id="toc-SmallAreaEstimation"><span class="toc-section-number">14</span> Sampling for estimating parameters of domains</a>
<ul>
<li><a href="SmallAreaEstimation.html#LargeDomainsDirectEstimator" id="toc-LargeDomainsDirectEstimator"><span class="toc-section-number">14.1</span> Direct estimator for large domains</a></li>
<li><a href="SmallAreaEstimation.html#SmallDomainsModelAssisted" id="toc-SmallDomainsModelAssisted"><span class="toc-section-number">14.2</span> Model-assisted estimators for small domains</a>
<ul>
<li><a href="SmallAreaEstimation.html#RegressionestimatorSmallDomain" id="toc-RegressionestimatorSmallDomain"><span class="toc-section-number">14.2.1</span> Regression estimator</a></li>
<li><a href="SmallAreaEstimation.html#SyntheticestimatorSmallDomain" id="toc-SyntheticestimatorSmallDomain"><span class="toc-section-number">14.2.2</span> Synthetic estimator</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#SmallAreaModelBased" id="toc-SmallAreaModelBased"><span class="toc-section-number">14.3</span> Model-based prediction</a>
<ul>
<li><a href="SmallAreaEstimation.html#random-intercept-model" id="toc-random-intercept-model"><span class="toc-section-number">14.3.1</span> Random intercept model</a></li>
<li><a href="SmallAreaEstimation.html#geostatistical-model" id="toc-geostatistical-model"><span class="toc-section-number">14.3.2</span> Geostatistical model</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#supplemental-probability-sampling-of-small-domains" id="toc-supplemental-probability-sampling-of-small-domains"><span class="toc-section-number">14.4</span> Supplemental probability sampling of small domains</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#RepeatedSurveys" id="toc-RepeatedSurveys"><span class="toc-section-number">15</span> Repeated sample surveys for monitoring population parameters</a>
<ul>
<li><a href="RepeatedSurveys.html#space-time-designs" id="toc-space-time-designs"><span class="toc-section-number">15.1</span> Space-time designs</a></li>
<li><a href="RepeatedSurveys.html#SpaceTimeparameters" id="toc-SpaceTimeparameters"><span class="toc-section-number">15.2</span> Space-time population parameters</a></li>
<li><a href="RepeatedSurveys.html#design-based-generalised-least-squares-estimation-of-spatial-means" id="toc-design-based-generalised-least-squares-estimation-of-spatial-means"><span class="toc-section-number">15.3</span> Design-based generalised least squares estimation of spatial means</a>
<ul>
<li><a href="RepeatedSurveys.html#current-mean" id="toc-current-mean"><span class="toc-section-number">15.3.1</span> Current mean</a></li>
<li><a href="RepeatedSurveys.html#change-of-the-spatial-mean" id="toc-change-of-the-spatial-mean"><span class="toc-section-number">15.3.2</span> Change of the spatial mean</a></li>
<li><a href="RepeatedSurveys.html#temporal-trend-of-the-spatial-mean" id="toc-temporal-trend-of-the-spatial-mean"><span class="toc-section-number">15.3.3</span> Temporal trend of the spatial mean</a></li>
<li><a href="RepeatedSurveys.html#space-time-mean" id="toc-space-time-mean"><span class="toc-section-number">15.3.4</span> Space-time mean</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#case-study-annual-mean-daily-temperature-in-iberia" id="toc-case-study-annual-mean-daily-temperature-in-iberia"><span class="toc-section-number">15.4</span> Case study: annual mean daily temperature in Iberia</a>
<ul>
<li><a href="RepeatedSurveys.html#static-synchronous-design" id="toc-static-synchronous-design"><span class="toc-section-number">15.4.1</span> Static-synchronous design</a></li>
<li><a href="RepeatedSurveys.html#independent-synchronous-design" id="toc-independent-synchronous-design"><span class="toc-section-number">15.4.2</span> Independent synchronous design</a></li>
<li><a href="RepeatedSurveys.html#serially-alternating-design" id="toc-serially-alternating-design"><span class="toc-section-number">15.4.3</span> Serially alternating design</a></li>
<li><a href="RepeatedSurveys.html#supplemented-panel-design" id="toc-supplemented-panel-design"><span class="toc-section-number">15.4.4</span> Supplemented panel design</a></li>
<li><a href="RepeatedSurveys.html#rotating-panel-design" id="toc-rotating-panel-design"><span class="toc-section-number">15.4.5</span> Rotating panel design</a></li>
<li><a href="RepeatedSurveys.html#sampling-experiment" id="toc-sampling-experiment"><span class="toc-section-number">15.4.6</span> Sampling experiment</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#space-time-sampling-with-stratified-random-sampling-in-space" id="toc-space-time-sampling-with-stratified-random-sampling-in-space"><span class="toc-section-number">15.5</span> Space-time sampling with stratified random sampling in space</a></li>
</ul></li>
<li><a href="#part-sampling-for-mapping" id="toc-part-sampling-for-mapping">(PART) Sampling for mapping</a></li>
<li><a href="IntroSamplingforMapping.html#IntroSamplingforMapping" id="toc-IntroSamplingforMapping"><span class="toc-section-number">16</span> Introduction to sampling for mapping</a>
<ul>
<li><a href="IntroSamplingforMapping.html#when-is-probability-sampling-not-required" id="toc-when-is-probability-sampling-not-required"><span class="toc-section-number">16.1</span> When is probability sampling not required?</a></li>
<li><a href="IntroSamplingforMapping.html#sampling-for-simultaneously-mapping-and-estimating-means" id="toc-sampling-for-simultaneously-mapping-and-estimating-means"><span class="toc-section-number">16.2</span> Sampling for simultaneously mapping and estimating means</a></li>
<li><a href="IntroSamplingforMapping.html#broad-overview-of-sampling-designs-for-mapping" id="toc-broad-overview-of-sampling-designs-for-mapping"><span class="toc-section-number">16.3</span> Broad overview of sampling designs for mapping</a></li>
</ul></li>
<li><a href="RegularGridSpatialCoverage.html#RegularGridSpatialCoverage" id="toc-RegularGridSpatialCoverage"><span class="toc-section-number">17</span> Regular grid and spatial coverage sampling</a>
<ul>
<li><a href="RegularGridSpatialCoverage.html#Regulargrid" id="toc-Regulargrid"><span class="toc-section-number">17.1</span> Regular grid sampling</a></li>
<li><a href="RegularGridSpatialCoverage.html#SpatialCoverage" id="toc-SpatialCoverage"><span class="toc-section-number">17.2</span> Spatial coverage sampling</a></li>
<li><a href="RegularGridSpatialCoverage.html#SpatialInfill" id="toc-SpatialInfill"><span class="toc-section-number">17.3</span> Spatial infill sampling</a></li>
</ul></li>
<li><a href="kmeans.html#kmeans" id="toc-kmeans"><span class="toc-section-number">18</span> Covariate space coverage sampling</a>
<ul>
<li><a href="kmeans.html#covariate-space-infill-sampling" id="toc-covariate-space-infill-sampling"><span class="toc-section-number">18.1</span> Covariate space infill sampling</a></li>
<li><a href="kmeans.html#PerformanceCSC" id="toc-PerformanceCSC"><span class="toc-section-number">18.2</span> Performance of covariate space coverage sampling in random forest prediction</a></li>
</ul></li>
<li><a href="cLHS.html#cLHS" id="toc-cLHS"><span class="toc-section-number">19</span> Conditioned Latin hypercube sampling</a>
<ul>
<li><a href="cLHS.html#cLHIS" id="toc-cLHIS"><span class="toc-section-number">19.1</span> Conditioned Latin hypercube infill sampling</a></li>
<li><a href="cLHS.html#performance-of-conditioned-latin-hypercube-sampling-in-random-forest-prediction" id="toc-performance-of-conditioned-latin-hypercube-sampling-in-random-forest-prediction"><span class="toc-section-number">19.2</span> Performance of conditioned Latin hypercube sampling in random forest prediction</a></li>
</ul></li>
<li><a href="SpatialResponseSurface.html#SpatialResponseSurface" id="toc-SpatialResponseSurface"><span class="toc-section-number">20</span> Spatial response surface sampling</a>
<ul>
<li><a href="SpatialResponseSurface.html#IncreaseSampleSize" id="toc-IncreaseSampleSize"><span class="toc-section-number">20.1</span> Increasing the sample size</a></li>
<li><a href="SpatialResponseSurface.html#stratified-spatial-response-surface-sampling" id="toc-stratified-spatial-response-surface-sampling"><span class="toc-section-number">20.2</span> Stratified spatial response surface sampling</a></li>
<li><a href="SpatialResponseSurface.html#mapping" id="toc-mapping"><span class="toc-section-number">20.3</span> Mapping</a></li>
</ul></li>
<li><a href="Introkriging.html#Introkriging" id="toc-Introkriging"><span class="toc-section-number">21</span> Introduction to kriging</a>
<ul>
<li><a href="Introkriging.html#OrdinaryKriging" id="toc-OrdinaryKriging"><span class="toc-section-number">21.1</span> Ordinary kriging</a></li>
<li><a href="Introkriging.html#BlockKriging" id="toc-BlockKriging"><span class="toc-section-number">21.2</span> Block-kriging</a></li>
<li><a href="Introkriging.html#IntroKED" id="toc-IntroKED"><span class="toc-section-number">21.3</span> Kriging with an external drift</a></li>
<li><a href="Introkriging.html#VariogramEstimation" id="toc-VariogramEstimation"><span class="toc-section-number">21.4</span> Estimating the semivariogram</a>
<ul>
<li><a href="Introkriging.html#MoM" id="toc-MoM"><span class="toc-section-number">21.4.1</span> Method-of-moments</a></li>
<li><a href="Introkriging.html#MLestimationVariogram" id="toc-MLestimationVariogram"><span class="toc-section-number">21.4.2</span> Maximum likelihood</a></li>
</ul></li>
<li><a href="Introkriging.html#ResidualVariogram" id="toc-ResidualVariogram"><span class="toc-section-number">21.5</span> Estimating the residual semivariogram</a>
<ul>
<li><a href="Introkriging.html#IterativeMoM" id="toc-IterativeMoM"><span class="toc-section-number">21.5.1</span> Iterative method-of-moments</a></li>
<li><a href="Introkriging.html#REML" id="toc-REML"><span class="toc-section-number">21.5.2</span> Restricted maximum likelihood</a></li>
</ul></li>
</ul></li>
<li><a href="MBgridspacing.html#MBgridspacing" id="toc-MBgridspacing"><span class="toc-section-number">22</span> Model-based optimisation of the grid spacing</a>
<ul>
<li><a href="MBgridspacing.html#GridspacingOK" id="toc-GridspacingOK"><span class="toc-section-number">22.1</span> Optimal grid spacing for ordinary kriging</a></li>
<li><a href="MBgridspacing.html#controlling-the-mean-or-a-quantile-of-the-ordinary-kriging-variance" id="toc-controlling-the-mean-or-a-quantile-of-the-ordinary-kriging-variance"><span class="toc-section-number">22.2</span> Controlling the mean or a quantile of the ordinary kriging variance</a></li>
<li><a href="MBgridspacing.html#optimal-grid-spacing-for-block-kriging" id="toc-optimal-grid-spacing-for-block-kriging"><span class="toc-section-number">22.3</span> Optimal grid spacing for block-kriging</a></li>
<li><a href="MBgridspacing.html#MBgridspacingKED" id="toc-MBgridspacingKED"><span class="toc-section-number">22.4</span> Optimal grid spacing for kriging with an external drift</a></li>
<li><a href="MBgridspacing.html#BayesianGridSpacing" id="toc-BayesianGridSpacing"><span class="toc-section-number">22.5</span> Bayesian approach</a></li>
</ul></li>
<li><a href="MBSamplePattern.html#MBSamplePattern" id="toc-MBSamplePattern"><span class="toc-section-number">23</span> Model-based optimisation of the sampling pattern</a>
<ul>
<li><a href="MBSamplePattern.html#SSA" id="toc-SSA"><span class="toc-section-number">23.1</span> Spatial simulated annealing</a></li>
<li><a href="MBSamplePattern.html#SamplePatternOK" id="toc-SamplePatternOK"><span class="toc-section-number">23.2</span> Optimising the sampling pattern for ordinary kriging</a></li>
<li><a href="MBSamplePattern.html#SamplePatternKED" id="toc-SamplePatternKED"><span class="toc-section-number">23.3</span> Optimising the sampling pattern for kriging with an external drift</a></li>
<li><a href="MBSamplePattern.html#model-based-infill-sampling-for-ordinary-kriging" id="toc-model-based-infill-sampling-for-ordinary-kriging"><span class="toc-section-number">23.4</span> Model-based infill sampling for ordinary kriging</a></li>
<li><a href="MBSamplePattern.html#model-based-infill-sampling-for-kriging-with-an-external-drift" id="toc-model-based-infill-sampling-for-kriging-with-an-external-drift"><span class="toc-section-number">23.5</span> Model-based infill sampling for kriging with an external drift</a></li>
</ul></li>
<li><a href="SamplingVariogram.html#SamplingVariogram" id="toc-SamplingVariogram"><span class="toc-section-number">24</span> Sampling for estimating the semivariogram</a>
<ul>
<li><a href="SamplingVariogram.html#NestedSampling" id="toc-NestedSampling"><span class="toc-section-number">24.1</span> Nested sampling</a></li>
<li><a href="SamplingVariogram.html#IndependentSamplingPairs" id="toc-IndependentSamplingPairs"><span class="toc-section-number">24.2</span> Independent sampling of pairs of points</a></li>
<li><a href="SamplingVariogram.html#samplingforvariogram" id="toc-samplingforvariogram"><span class="toc-section-number">24.3</span> Optimisation of sampling pattern for semivariogram estimation</a>
<ul>
<li><a href="SamplingVariogram.html#UncertainSemivariogramParameters" id="toc-UncertainSemivariogramParameters"><span class="toc-section-number">24.3.1</span> Uncertainty about semivariogram parameters</a></li>
<li><a href="SamplingVariogram.html#UncertainKrigingVariance" id="toc-UncertainKrigingVariance"><span class="toc-section-number">24.3.2</span> Uncertainty about the kriging variance</a></li>
</ul></li>
<li><a href="SamplingVariogram.html#SamplingEstimationandPrediction" id="toc-SamplingEstimationandPrediction"><span class="toc-section-number">24.4</span> Optimisation of sampling pattern for semivariogram estimation and mapping</a></li>
<li><a href="SamplingVariogram.html#a-practical-solution" id="toc-a-practical-solution"><span class="toc-section-number">24.5</span> A practical solution</a></li>
</ul></li>
<li><a href="Validation.html#Validation" id="toc-Validation"><span class="toc-section-number">25</span> Sampling for validation of maps</a>
<ul>
<li><a href="Validation.html#map-quality-indices" id="toc-map-quality-indices"><span class="toc-section-number">25.1</span> Map quality indices</a>
<ul>
<li><a href="Validation.html#estimation-of-map-quality-indices" id="toc-estimation-of-map-quality-indices"><span class="toc-section-number">25.1.1</span> Estimation of map quality indices</a></li>
</ul></li>
<li><a href="Validation.html#real-world-case-study" id="toc-real-world-case-study"><span class="toc-section-number">25.2</span> Real-world case study</a>
<ul>
<li><a href="Validation.html#estimation-of-the-population-mean-error-and-mean-squared-error" id="toc-estimation-of-the-population-mean-error-and-mean-squared-error"><span class="toc-section-number">25.2.1</span> Estimation of the population mean error and mean squared error</a></li>
<li><a href="Validation.html#estimation-of-the-standard-error-of-the-estimator-of-the-population-mean-error-and-mean-squared-error" id="toc-estimation-of-the-standard-error-of-the-estimator-of-the-population-mean-error-and-mean-squared-error"><span class="toc-section-number">25.2.2</span> Estimation of the standard error of the estimator of the population mean error and mean squared error</a></li>
<li><a href="Validation.html#estimation-of-model-efficiency-coefficient" id="toc-estimation-of-model-efficiency-coefficient"><span class="toc-section-number">25.2.3</span> Estimation of model efficiency coefficient</a></li>
<li><a href="Validation.html#statistical-testing-of-hypothesis-about-population-me-and-mse" id="toc-statistical-testing-of-hypothesis-about-population-me-and-mse"><span class="toc-section-number">25.2.4</span> Statistical testing of hypothesis about population ME and MSE</a></li>
</ul></li>
</ul></li>
<li><a href="Approaches.html#Approaches" id="toc-Approaches"><span class="toc-section-number">26</span> Design-based, model-based, and model-assisted approach for sampling and inference</a>
<ul>
<li><a href="Approaches.html#two-sources-of-randomness" id="toc-two-sources-of-randomness"><span class="toc-section-number">26.1</span> Two sources of randomness</a></li>
<li><a href="Approaches.html#iid" id="toc-iid"><span class="toc-section-number">26.2</span> Identically and independently distributed</a></li>
<li><a href="Approaches.html#BiasandVariance" id="toc-BiasandVariance"><span class="toc-section-number">26.3</span> Bias and variance</a></li>
<li><a href="Approaches.html#effectivesamplesize" id="toc-effectivesamplesize"><span class="toc-section-number">26.4</span> Effective sample size</a></li>
<li><a href="Approaches.html#ExploitSpatialStructure" id="toc-ExploitSpatialStructure"><span class="toc-section-number">26.5</span> Exploiting spatial structure in design-based approach</a></li>
<li><a href="Approaches.html#ModelassistedvsModeldependent" id="toc-ModelassistedvsModeldependent"><span class="toc-section-number">26.6</span> Model-assisted vs. model-dependent</a></li>
</ul></li>
<li><a href="#appendix-appendices" id="toc-appendix-appendices">(APPENDIX) Appendices</a></li>
<li><a href="Answers.html#Answers" id="toc-Answers"><span class="toc-section-number">27</span> Answers to exercises</a>
<ul>
<li><a href="Answers.html#introduction-to-probability-sampling" id="toc-introduction-to-probability-sampling">Introduction to probability sampling</a></li>
<li><a href="Answers.html#simple-random-sampling-1" id="toc-simple-random-sampling-1">Simple random sampling</a></li>
<li><a href="Answers.html#stratified-simple-random-sampling-1" id="toc-stratified-simple-random-sampling-1">Stratified simple random sampling</a></li>
<li><a href="Answers.html#systematic-random-sampling-2" id="toc-systematic-random-sampling-2">Systematic random sampling</a></li>
<li><a href="Answers.html#cluster-random-sampling" id="toc-cluster-random-sampling">Cluster random sampling</a></li>
<li><a href="Answers.html#two-stage-cluster-random-sampling-1" id="toc-two-stage-cluster-random-sampling-1">Two-stage cluster random sampling</a></li>
<li><a href="Answers.html#sampling-with-probabilities-proportional-to-size" id="toc-sampling-with-probabilities-proportional-to-size">Sampling with probabilities proportional to size</a></li>
<li><a href="Answers.html#balanced-and-well-spread-sampling" id="toc-balanced-and-well-spread-sampling">Balanced and well-spread sampling</a></li>
<li><a href="Answers.html#model-assisted-estimation" id="toc-model-assisted-estimation">Model-assisted estimation</a></li>
<li><a href="Answers.html#two-phase-random-sampling" id="toc-two-phase-random-sampling">Two-phase random sampling</a></li>
<li><a href="Answers.html#computing-the-required-sample-size" id="toc-computing-the-required-sample-size">Computing the required sample size</a></li>
<li><a href="Answers.html#model-based-optimisation-of-probability-sampling-designs" id="toc-model-based-optimisation-of-probability-sampling-designs">Model-based optimisation of probability sampling designs</a></li>
<li><a href="Answers.html#repeated-sample-surveys-for-monitoring-population-parameters" id="toc-repeated-sample-surveys-for-monitoring-population-parameters">Repeated sample surveys for monitoring population parameters</a></li>
<li><a href="Answers.html#regular-grid-and-spatial-coverage-sampling" id="toc-regular-grid-and-spatial-coverage-sampling">Regular grid and spatial coverage sampling</a></li>
<li><a href="Answers.html#covariate-space-coverage-sampling" id="toc-covariate-space-coverage-sampling">Covariate space coverage sampling</a></li>
<li><a href="Answers.html#conditioned-latin-hypercube-sampling" id="toc-conditioned-latin-hypercube-sampling">Conditioned Latin hypercube sampling</a></li>
<li><a href="Answers.html#model-based-optimisation-of-the-grid-spacing" id="toc-model-based-optimisation-of-the-grid-spacing">Model-based optimisation of the grid spacing</a></li>
<li><a href="Answers.html#model-based-optimisation-of-the-sampling-pattern" id="toc-model-based-optimisation-of-the-sampling-pattern">Model-based optimisation of the sampling pattern</a></li>
<li><a href="Answers.html#sampling-for-estimating-the-semivariogram" id="toc-sampling-for-estimating-the-semivariogram">Sampling for estimating the semivariogram</a></li>
<li><a href="Answers.html#sampling-for-validation-of-maps" id="toc-sampling-for-validation-of-maps">Sampling for validation of maps</a></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/DickBrus/">Dick Brus</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial sampling with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="kmeans" class="section level1 hasAnchor" number="18">
<h1><span class="header-section-number">Chapter 18</span> Covariate space coverage sampling<a href="kmeans.html#kmeans" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Regular grid sampling and spatial coverage sampling are pure spatial sampling designs. Covariates possibly related to the study variable are not accounted for in selecting sampling units. This can be suboptimal when the study variable is related to covariates of which maps are available, think for instance of remote sensing imagery or digital elevation models related to soil properties. Maps of these covariates can be used in mapping the study variable by, for instance, a multiple linear regression model or a random forest. This chapter describes a simple, straightforward method for selecting sampling units on the basis of the covariate values of the raster cells.</p>
<p>The simplest option for covariate space coverage (CSC) sampling is to cluster the raster cells by the k-means clustering algorithm in covariate space. Similar to spatial coverage sampling (Section <a href="RegularGridSpatialCoverage.html#SpatialCoverage">17.2</a>) the mean squared shortest distance (MSSD) is minimised, but now the distance is not measured in geographical space but in a <span class="math inline">\(p\)</span>-dimensional space spanned by the <span class="math inline">\(p\)</span> covariates. Think of this space as a multidimensional scatter plot with the covariates along the axes. The covariates are centred and scaled so that their means become zero and standard deviations become one. This is needed because, contrary to the spatial coordinates used as clustering variables in spatial coverage sampling, the ranges of the covariates in the population can differ greatly. In the clustering of the raster cells, the mean squared shortest <em>scaled</em> distance (MSSSD) is minimised. The name ‘scaled distance’ can be confusing. The distances are not scaled, but rather they are computed in a space spanned by the scaled covariates.</p>
<p>In the next code chunk, a CSC sample of 20 units is selected from Eastern Amazonia. All five quantitative covariates, SWIR2, Terra_PP, Prec_dm, Elevation, and Clay, are used as covariates. To select 20 units, 20 clusters are constructed using function <code>kmeans</code> of the <strong>stats</strong> package <span class="citation">(<a href="#ref-R2020" role="doc-biblioref">R Core Team 2021</a>)</span>. The number of clusters is passed to function <code>kmeans</code> with argument <code>centers</code>. Note that the number of clusters is not based, as would be usual in cluster analysis, on the assumed number of subregions with a high density of units in the multivariate distribution, but rather on the number of sampling units. The k-means clustering algorithm is a deterministic algorithm, i.e., the final optimised clustering is fully determined by the initial clustering. This final clustering can be suboptimal, i.e., the minimised MSSSD value is somewhat larger than the global minimum. Therefore, the clustering should be repeated many times, every time starting with a different random initial clustering. The number of repeats is specified with argument <code>nstart</code>. The best solution is automatically kept. To speed up the computations, a 5 km <span class="math inline">\(\times\)</span> 5 km subgrid of <code>grdAmazonia</code> is used.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="kmeans.html#cb430-1" aria-hidden="true" tabindex="-1"></a>covs <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">&quot;SWIR2&quot;</span>, <span class="st">&quot;Terra_PP&quot;</span>, <span class="st">&quot;Prec_dm&quot;</span>, <span class="st">&quot;Elevation&quot;</span>, <span class="st">&quot;Clay&quot;</span>)</span>
<span id="cb430-2"><a href="kmeans.html#cb430-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb430-3"><a href="kmeans.html#cb430-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb430-4"><a href="kmeans.html#cb430-4" aria-hidden="true" tabindex="-1"></a>myclusters <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(</span>
<span id="cb430-5"><a href="kmeans.html#cb430-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>(grdAmazonia[, covs]), <span class="at">centers =</span> n, <span class="at">iter.max =</span> <span class="dv">10000</span>, <span class="at">nstart =</span> <span class="dv">100</span>)</span>
<span id="cb430-6"><a href="kmeans.html#cb430-6" aria-hidden="true" tabindex="-1"></a>grdAmazonia<span class="sc">$</span>cluster <span class="ot">&lt;-</span> myclusters<span class="sc">$</span>cluster</span></code></pre></div>
<p>Raster cells with the shortest scaled Euclidean distance in covariate space to the centres of the clusters are selected as the sampling units. To this end, first a matrix with the distances of all the raster cells to the cluster centres is computed with function <code>rdist</code> of package <strong>fields</strong> <span class="citation">(<a href="#ref-fields" role="doc-biblioref">Nychka et al. 2021</a>)</span>. The raster cells closest to the centres are computed with function <code>apply</code>, using argument <code>FUN = which.min</code>.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="kmeans.html#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fields)</span>
<span id="cb431-2"><a href="kmeans.html#cb431-2" aria-hidden="true" tabindex="-1"></a>covs_s <span class="ot">&lt;-</span> <span class="fu">scale</span>(grdAmazonia[, covs])</span>
<span id="cb431-3"><a href="kmeans.html#cb431-3" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">rdist</span>(<span class="at">x1 =</span> myclusters<span class="sc">$</span>centers, <span class="at">x2 =</span> covs_s)</span>
<span id="cb431-4"><a href="kmeans.html#cb431-4" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">apply</span>(D, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> which.min)</span>
<span id="cb431-5"><a href="kmeans.html#cb431-5" aria-hidden="true" tabindex="-1"></a>myCSCsample <span class="ot">&lt;-</span> grdAmazonia[units, ]</span></code></pre></div>
<p>Figure <a href="kmeans.html#fig:CSCsample">18.1</a> shows the clustering of the raster cells and the raster cells closest in covariate space to the centres that are used as the selected sample. In Figure <a href="kmeans.html#fig:CSCsampleinscatter">18.2</a> the selected sample is plotted in biplots of some pairs of covariates. In the biplots, some sampling units are clearly clustered. However, this is misleading, as actually we must look in five-dimensional space to see whether the units are clustered. Two units with a large separation distance in a five-dimensional space can look quite close when projected on a two-dimensional plane.</p>
<p>The next code chunk shows how the MSSSD of the selected sample can be computed.</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="kmeans.html#cb432-1" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">rdist</span>(<span class="at">x1 =</span> <span class="fu">scale</span>(</span>
<span id="cb432-2"><a href="kmeans.html#cb432-2" aria-hidden="true" tabindex="-1"></a>  myCSCsample[, covs], <span class="at">center =</span> <span class="fu">attr</span>(covs_s, <span class="st">&quot;scaled:center&quot;</span>),</span>
<span id="cb432-3"><a href="kmeans.html#cb432-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale =</span> <span class="fu">attr</span>(covs_s, <span class="st">&quot;scaled:scale&quot;</span>)), <span class="at">x2 =</span> covs_s)</span>
<span id="cb432-4"><a href="kmeans.html#cb432-4" aria-hidden="true" tabindex="-1"></a>dmin <span class="ot">&lt;-</span> <span class="fu">apply</span>(D, <span class="at">MARGIN =</span> <span class="dv">2</span>, min)</span>
<span id="cb432-5"><a href="kmeans.html#cb432-5" aria-hidden="true" tabindex="-1"></a>MSSSD <span class="ot">&lt;-</span> <span class="fu">mean</span>(dmin<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<p>Note that to centre and scale the covariate values in the CSC sample, the population means and the population standard deviations are used, as passed to function <code>scale</code> with arguments <code>center</code> and <code>scale</code>. If these means and standard deviations are unspecified, the <em>sample</em> means and the <em>sample</em> standard deviations are used, resulting in an incorrect value of the minimised MSSSD value. The MSSSD of the selected sample equals 1.004.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CSCsample"></span>
<img src="SpatialSampling_files/figure-html/CSCsample-1.png" alt="Covariate space coverage sample of 20 units from Eastern Amazonia, obtained with k-means clustering using five covariates, plotted on a map of the clusters." width="100%" />
<p class="caption">
Figure 18.1: Covariate space coverage sample of 20 units from Eastern Amazonia, obtained with k-means clustering using five covariates, plotted on a map of the clusters.
</p>
</div>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CSCsampleinscatter"></span>
<img src="SpatialSampling_files/figure-html/CSCsampleinscatter-1.png" alt="Covariate space coverage sample of Figure 18.1 plotted in biplots of covariates, coloured by cluster." width="100%" />
<p class="caption">
Figure 18.2: Covariate space coverage sample of Figure <a href="kmeans.html#fig:CSCsample">18.1</a> plotted in biplots of covariates, coloured by cluster.
</p>
</div>
<p>Instead of function <code>kmeans</code> we may use function <code>kmeanspp</code> of package <strong>LICORS</strong> <span class="citation">(<a href="#ref-Goerg2013" role="doc-biblioref">Goerg 2013</a>)</span>. This function is an implementation of the k-means++ algorithm <span class="citation">(<a href="#ref-Arthur2007" role="doc-biblioref">Arthur and Vassilvitskii 2007</a>)</span>. This algorithm consists of two parts, namely the selection of an optimised initial sample, followed by the standard k-means. The algorithm is as follows:</p>
<ol style="list-style-type: decimal">
<li>Select one unit (raster cell) at random.<br />
</li>
<li>For each unsampled unit <span class="math inline">\(j\)</span>, compute <span class="math inline">\(d_{kj}\)</span>, i.e., the distance in standardised covariate space between <span class="math inline">\(j\)</span> and the nearest unit <span class="math inline">\(k\)</span> that has already been selected.<br />
</li>
<li>Choose one new raster cell at random as a new sampling unit with probabilities proportional to <span class="math inline">\(d^2_{kj}\)</span> and add the selected raster cell to the set of selected cells.<br />
</li>
<li>Repeat steps 2 and 3 until <span class="math inline">\(n\)</span> centres have been selected.<br />
</li>
<li>Now that the initial centres have been selected, proceed using standard k-means.</li>
</ol>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="kmeans.html#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(LICORS)</span>
<span id="cb433-2"><a href="kmeans.html#cb433-2" aria-hidden="true" tabindex="-1"></a>myclusters <span class="ot">&lt;-</span> <span class="fu">kmeanspp</span>(</span>
<span id="cb433-3"><a href="kmeans.html#cb433-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>(grdAmazonia[, covs]), <span class="at">k =</span> n, <span class="at">iter.max =</span> <span class="dv">10000</span>, <span class="at">nstart =</span> <span class="dv">30</span>)</span></code></pre></div>
<p>Due to the improved initial centres, the risk of ending in a local minimum is reduced. The k-means++ algorithm is of interest for small sample sizes. For large sample sizes, the extra time needed for computing the initial centres can become substantial and may not outweigh the larger number of starts that can be afforded with the usual k-means algorithm for the same computing time.</p>
<div id="covariate-space-infill-sampling" class="section level2 hasAnchor" number="18.1">
<h2><span class="header-section-number">18.1</span> Covariate space infill sampling<a href="kmeans.html#covariate-space-infill-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If we have legacy data that can be used to fit a model for mapping, it is more efficient to select an infill sample, similar to spatial infill sampling explained in Section <a href="RegularGridSpatialCoverage.html#SpatialInfill">17.3</a>. The only difference with spatial infill sampling is that the legacy data are now plotted in the space spanned by the covariates. The empty regions we would like to fill in are now the undersampled regions in this covariate space. The legacy sample units serve as fixed cluster centres; they cannot move through the covariate space during the optimisation of the infill sample. In the next code chunk, a function is defined for covariate space infill sampling.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="kmeans.html#cb434-1" aria-hidden="true" tabindex="-1"></a>CSIS <span class="ot">&lt;-</span> <span class="cf">function</span>(fixed, nsup, nstarts, mygrd) {</span>
<span id="cb434-2"><a href="kmeans.html#cb434-2" aria-hidden="true" tabindex="-1"></a>  n_fix <span class="ot">&lt;-</span> <span class="fu">nrow</span>(fixed)</span>
<span id="cb434-3"><a href="kmeans.html#cb434-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(mygrd)</span>
<span id="cb434-4"><a href="kmeans.html#cb434-4" aria-hidden="true" tabindex="-1"></a>  units <span class="ot">&lt;-</span> fixed<span class="sc">$</span>units</span>
<span id="cb434-5"><a href="kmeans.html#cb434-5" aria-hidden="true" tabindex="-1"></a>  mygrd_minfx <span class="ot">&lt;-</span> mygrd[<span class="sc">-</span>units, ]</span>
<span id="cb434-6"><a href="kmeans.html#cb434-6" aria-hidden="true" tabindex="-1"></a>  MSSSD_cur <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb434-7"><a href="kmeans.html#cb434-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nstarts) {</span>
<span id="cb434-8"><a href="kmeans.html#cb434-8" aria-hidden="true" tabindex="-1"></a>    units <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(mygrd_minfx), nsup)</span>
<span id="cb434-9"><a href="kmeans.html#cb434-9" aria-hidden="true" tabindex="-1"></a>    centers_sup <span class="ot">&lt;-</span> mygrd_minfx[units, ]</span>
<span id="cb434-10"><a href="kmeans.html#cb434-10" aria-hidden="true" tabindex="-1"></a>    centers <span class="ot">&lt;-</span> <span class="fu">rbind</span>(fixed[, <span class="fu">names</span>(mygrd)], centers_sup)</span>
<span id="cb434-11"><a href="kmeans.html#cb434-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">repeat</span> {</span>
<span id="cb434-12"><a href="kmeans.html#cb434-12" aria-hidden="true" tabindex="-1"></a>      D <span class="ot">&lt;-</span> <span class="fu">rdist</span>(<span class="at">x1 =</span> centers, <span class="at">x2 =</span> mygrd)</span>
<span id="cb434-13"><a href="kmeans.html#cb434-13" aria-hidden="true" tabindex="-1"></a>      clusters <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="at">X =</span> D, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> which.min) <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>(.)</span>
<span id="cb434-14"><a href="kmeans.html#cb434-14" aria-hidden="true" tabindex="-1"></a>      centers_cur <span class="ot">&lt;-</span> centers</span>
<span id="cb434-15"><a href="kmeans.html#cb434-15" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p) {</span>
<span id="cb434-16"><a href="kmeans.html#cb434-16" aria-hidden="true" tabindex="-1"></a>        centers[, i] <span class="ot">&lt;-</span> <span class="fu">tapply</span>(mygrd[, i], <span class="at">INDEX =</span> clusters, <span class="at">FUN =</span> mean)</span>
<span id="cb434-17"><a href="kmeans.html#cb434-17" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb434-18"><a href="kmeans.html#cb434-18" aria-hidden="true" tabindex="-1"></a>      <span class="co">#restore fixed centers</span></span>
<span id="cb434-19"><a href="kmeans.html#cb434-19" aria-hidden="true" tabindex="-1"></a>      centers[<span class="dv">1</span><span class="sc">:</span>n_fix, ] <span class="ot">&lt;-</span> centers_cur[<span class="dv">1</span><span class="sc">:</span>n_fix, ]</span>
<span id="cb434-20"><a href="kmeans.html#cb434-20" aria-hidden="true" tabindex="-1"></a>      <span class="co">#check convergence</span></span>
<span id="cb434-21"><a href="kmeans.html#cb434-21" aria-hidden="true" tabindex="-1"></a>      sumd <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">rdist</span>(<span class="at">x1 =</span> centers, <span class="at">x2 =</span> centers_cur)) <span class="sc">%&gt;%</span> <span class="fu">sum</span>(.)</span>
<span id="cb434-22"><a href="kmeans.html#cb434-22" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (sumd <span class="sc">&lt;</span> <span class="fl">1E-12</span>) {</span>
<span id="cb434-23"><a href="kmeans.html#cb434-23" aria-hidden="true" tabindex="-1"></a>        D <span class="ot">&lt;-</span> <span class="fu">rdist</span>(<span class="at">x1 =</span> centers, <span class="at">x2 =</span> mygrd)</span>
<span id="cb434-24"><a href="kmeans.html#cb434-24" aria-hidden="true" tabindex="-1"></a>        Dmin <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="at">X =</span> D, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> min)</span>
<span id="cb434-25"><a href="kmeans.html#cb434-25" aria-hidden="true" tabindex="-1"></a>        MSSSD <span class="ot">&lt;-</span> <span class="fu">mean</span>(Dmin<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb434-26"><a href="kmeans.html#cb434-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (s <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> MSSSD <span class="sc">&lt;</span> MSSSD_cur) {</span>
<span id="cb434-27"><a href="kmeans.html#cb434-27" aria-hidden="true" tabindex="-1"></a>          centers_best <span class="ot">&lt;-</span> centers</span>
<span id="cb434-28"><a href="kmeans.html#cb434-28" aria-hidden="true" tabindex="-1"></a>          clusters_best <span class="ot">&lt;-</span> clusters</span>
<span id="cb434-29"><a href="kmeans.html#cb434-29" aria-hidden="true" tabindex="-1"></a>          MSSSD_cur <span class="ot">&lt;-</span> MSSSD</span>
<span id="cb434-30"><a href="kmeans.html#cb434-30" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb434-31"><a href="kmeans.html#cb434-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb434-32"><a href="kmeans.html#cb434-32" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb434-33"><a href="kmeans.html#cb434-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb434-34"><a href="kmeans.html#cb434-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb434-35"><a href="kmeans.html#cb434-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">centers =</span> centers_best, <span class="at">clusters =</span> clusters_best)</span>
<span id="cb434-36"><a href="kmeans.html#cb434-36" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The function is used to select an infill sample of 15 units from Eastern Amazonia. A legacy sample of five units is randomly selected.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="kmeans.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb435-2"><a href="kmeans.html#cb435-2" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(grdAmazonia), <span class="dv">5</span>)</span>
<span id="cb435-3"><a href="kmeans.html#cb435-3" aria-hidden="true" tabindex="-1"></a>fixed <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(units, <span class="fu">scale</span>(grdAmazonia[, covs])[units, ])</span>
<span id="cb435-4"><a href="kmeans.html#cb435-4" aria-hidden="true" tabindex="-1"></a>mygrd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">scale</span>(grdAmazonia[, covs]))</span>
<span id="cb435-5"><a href="kmeans.html#cb435-5" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">CSIS</span>(<span class="at">fixed =</span> fixed, <span class="at">nsup =</span> <span class="dv">15</span>, <span class="at">nstarts =</span> <span class="dv">10</span>, <span class="at">mygrd =</span> mygrd)</span></code></pre></div>
<p>Figures <a href="kmeans.html#fig:CSCIS">18.3</a> and <a href="kmeans.html#fig:CSInfillsampleinscatter">18.4</a> show the selected sample plotted on a map of the clusters and in biplots of covariates, respectively.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CSCIS"></span>
<img src="SpatialSampling_files/figure-html/CSCIS-1.png" alt="Covariate space infill sample of 15 units from Eastern Amazonia, obtained with k-means clustering and five fixed cluster centres, plotted on a map of the clusters. The dots represent the fixed centres (legacy sample), the triangles the infill sample." width="100%" />
<p class="caption">
Figure 18.3: Covariate space infill sample of 15 units from Eastern Amazonia, obtained with k-means clustering and five fixed cluster centres, plotted on a map of the clusters. The dots represent the fixed centres (legacy sample), the triangles the infill sample.
</p>
</div>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CSInfillsampleinscatter"></span>
<img src="SpatialSampling_files/figure-html/CSInfillsampleinscatter-1.png" alt="Covariate space infill sample of Figure 18.3 plotted in biplots of covariates, coloured by cluster. The dots represent the fixed centres (legacy sample), the triangles the infill sample." width="100%" />
<p class="caption">
Figure 18.4: Covariate space infill sample of Figure <a href="kmeans.html#fig:CSCIS">18.3</a> plotted in biplots of covariates, coloured by cluster. The dots represent the fixed centres (legacy sample), the triangles the infill sample.
</p>
</div>
</div>
<div id="PerformanceCSC" class="section level2 hasAnchor" number="18.2">
<h2><span class="header-section-number">18.2</span> Performance of covariate space coverage sampling in random forest prediction<a href="kmeans.html#PerformanceCSC" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>CSC sampling can be a good candidate for a sampling design if we have multiple maps of covariates, and in addition if we do not want to rely on a linear relation between the study variable and the covariates. In this situation, we may consider mapping with machine learning algorithms such as neural networks and random forests (RF).</p>
<p>I used the Eastern Amazonia data set to evaluate CSC sampling for mapping the aboveground biomass (AGB). The five covariates are used as predictors in RF modelling. The calibrated models are used to predict AGB at the units of a validation sample of size 25,000 selected by simple random sampling without replacement from the 1 km <span class="math inline">\(\times\)</span> 1 km grid, excluding the cells of the 10 km <span class="math inline">\(\times\)</span> 10 km grid from which the calibration samples are selected. The predicted AGB values at the validation units are compared with the true AGB values, and the prediction errors are computed. The sample mean of the squared prediction error is a design-unbiased estimator of the population mean squared error, i.e., the mean of the squared errors at all population units (excluding the units of the 10 km <span class="math inline">\(\times\)</span> 10 km grid), see Chapter <a href="Validation.html#Validation">25</a>.</p>
<p>Three sample sizes are used, <span class="math inline">\(n=\)</span> 25, 50, 100. Of each sample size, 500 CSC samples are selected using the k-means algorithm, leading to 1,500 CSC samples in total. The numbers of starts are 500, 350, and 200 for <span class="math inline">\(n=\)</span> 25, 50, and 100, respectively. With these numbers of starts, the computing time was about equal to conditioned Latin hypercube sampling, see next chapter. Each sample is used to calibrate a RF model. Simple random sampling (SI) is used as a reference sampling design that ignores the covariates.</p>
<p>In Figure <a href="kmeans.html#fig:RelationMSSSDRMSE">18.5</a> the root mean squared error (RMSE) of the RF predictions of AGB is plotted against the minimised MSSSD, both for the <span class="math inline">\(3 \times 500\)</span> CSC samples and for the 3 <span class="math inline">\(\times\)</span> 500 simple random samples. It is no surprise that for all three sample sizes the minimised MSSSD values of the CSC samples are substantially smaller than those of the SI samples. However, despite the substantial smaller MSSSD values, the RMSE values for the CSC samples are only a bit smaller than those of the SI samples. Only for <span class="math inline">\(n=50\)</span> a moderately strong positive correlation can be seen: <span class="math inline">\(r=0.513\)</span>. For <span class="math inline">\(n=25\)</span> the correlation is 0.264 only, and for <span class="math inline">\(n=100\)</span> it is even negative: <span class="math inline">\(r=-0.183\)</span>. On average in this case study, CSC and SI perform about equally (Table <a href="kmeans.html#tab:TableRMSE4CSCandSI">18.1</a>). However, especially with <span class="math inline">\(n=25\)</span> and 50 the sampling distribution of RMSE with SI has a long right tail. This implies that with SI there is a serious risk that a sample will be selected resulting in poor RF predictions of AGB. In Chapter <a href="cLHS.html#cLHS">19</a> CSC sampling is compared with conditioned Latin hypercube sampling.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:RelationMSSSDRMSE"></span>
<img src="SpatialSampling_files/figure-html/RelationMSSSDRMSE-1.png" alt="Scatter plot of the minimisation criterion MSSSD and the root mean squared error (RMSE) of RF predictions of AGB in Eastern Amazonia for covariate space coverage (CSC) sampling and simple random (SI) sampling, and three sample sizes." width="100%" />
<p class="caption">
Figure 18.5: Scatter plot of the minimisation criterion MSSSD and the root mean squared error (RMSE) of RF predictions of AGB in Eastern Amazonia for covariate space coverage (CSC) sampling and simple random (SI) sampling, and three sample sizes.
</p>
</div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:TableRMSE4CSCandSI">Table 18.1: </span>Mean RMSE of RF predictions of AGB in Eastern Amazonia of 500 covariate space coverage (CSC) samples and 500 simple random (SI) samples, for three sample sizes.
</caption>
<thead>
<tr>
<th style="text-align:right;">
Sample size
</th>
<th style="text-align:right;">
CSC
</th>
<th style="text-align:right;">
SI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
49.30
</td>
<td style="text-align:right;">
50.58
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
40.85
</td>
<td style="text-align:right;">
43.16
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
39.33
</td>
<td style="text-align:right;">
38.83
</td>
</tr>
</tbody>
</table>
<div id="exercises-25" class="section level4 unnumbered hasAnchor">
<h4>Exercises<a href="kmeans.html#exercises-25" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>Write an <strong>R</strong> script to select a covariate space coverage sample of size 20 from Hunter Valley (<code>grdHunterValley</code> of package <strong>sswr</strong>). Use the covariates cti (compound topographic index, which is the same as topographic wetness index), ndvi (normalised difference vegetation index), and elevation_m in k-means clustering of the raster cells. Plot the clusters and the sample on a map of cti and in a biplot of cti against ndvi.</li>
</ol>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Arthur2007" class="csl-entry">
Arthur, D., and S. Vassilvitskii. 2007. <span>“<span class="nocase">k-means++: The advantages of careful seeding</span>.”</span> <em>Proceedings of the Annual ACM-SIAM Symposium on Discrete Algorithms</em> 07-09-January-2007: 1027–35.
</div>
<div id="ref-Goerg2013" class="csl-entry">
Goerg, G. M. 2013. <em><span class="nocase">LICORS: Light Cone Reconstruction of States - Predictive State Estimation From Spatio-Temporal Data</span></em>. <a href="https://CRAN.R-project.org/package=LICORS">https://CRAN.R-project.org/package=LICORS</a>.
</div>
<div id="ref-fields" class="csl-entry">
Nychka, D., R. Furrer, J. Paige, S. Sain, F. Gerber, and M. Iverson. 2021. <em>Fields: Tools for Spatial Data</em>. Boulder, CO, USA: University Corporation for Atmospheric Research. <a href="https://github.com/dnychka/fieldsRPackage">https://github.com/dnychka/fieldsRPackage</a>.
</div>
<div id="ref-R2020" class="csl-entry">
R Core Team. 2021. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="RegularGridSpatialCoverage.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cLHS.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/DickBrus/SpatialSamplingwithR/edit/master/24-CovariateSpaceCoverage.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SpatialSampling.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
