<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Computing the required sample size | Spatial sampling with R</title>
  <meta name="description" content="This book is for students, scientists, researchers and consultants who want to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Computing the required sample size | Spatial sampling with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/images/cover.pdf" />
  <meta property="og:description" content="This book is for students, scientists, researchers and consultants who want to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="github-repo" content="DickBrus/SpatialSamplingwithR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Computing the required sample size | Spatial sampling with R" />
  
  <meta name="twitter:description" content="This book is for students, scientists, researchers and consultants who want to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="twitter:image" content="/images/cover.pdf" />

<meta name="author" content="Dick J. Brus" />


<meta name="date" content="2021-11-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Twophase.html"/>
<link rel="next" href="MBpredictionofDesignVariance.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial sampling with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="GeneralIntro.html"><a href="GeneralIntro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="GeneralIntro.html"><a href="GeneralIntro.html#BasicConcepts"><i class="fa fa-check"></i><b>1.1</b> Basic sampling concepts</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="GeneralIntro.html"><a href="GeneralIntro.html#PopulationParameters"><i class="fa fa-check"></i><b>1.1.1</b> Population parameters</a></li>
<li class="chapter" data-level="1.1.2" data-path="GeneralIntro.html"><a href="GeneralIntro.html#descriptive-statistics-versus-inference-about-a-population"><i class="fa fa-check"></i><b>1.1.2</b> Descriptive statistics versus inference about a population</a></li>
<li class="chapter" data-level="1.1.3" data-path="GeneralIntro.html"><a href="GeneralIntro.html#random-sampling-versus-probability-sampling"><i class="fa fa-check"></i><b>1.1.3</b> Random sampling versus probability sampling</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="GeneralIntro.html"><a href="GeneralIntro.html#DBvsMB"><i class="fa fa-check"></i><b>1.2</b> Design-based versus model-based approach</a></li>
<li class="chapter" data-level="1.3" data-path="GeneralIntro.html"><a href="GeneralIntro.html#Datasets"><i class="fa fa-check"></i><b>1.3</b> Populations used in sampling experiments</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="GeneralIntro.html"><a href="GeneralIntro.html#Voorst"><i class="fa fa-check"></i><b>1.3.1</b> Soil organic matter in Voorst (Netherlands)</a></li>
<li class="chapter" data-level="1.3.2" data-path="GeneralIntro.html"><a href="GeneralIntro.html#Poppy"><i class="fa fa-check"></i><b>1.3.2</b> Poppy fields in Kandahar (Afghanistan)</a></li>
<li class="chapter" data-level="1.3.3" data-path="GeneralIntro.html"><a href="GeneralIntro.html#Amazonia"><i class="fa fa-check"></i><b>1.3.3</b> Aboveground biomass in Eastern Amazonia (Brazil)</a></li>
<li class="chapter" data-level="1.3.4" data-path="GeneralIntro.html"><a href="GeneralIntro.html#TASSpainPortugal"><i class="fa fa-check"></i><b>1.3.4</b> Annual mean air temperature in Spain and Portugal</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Probability sampling for estimating (sub)population parameters</b></span></li>
<li class="chapter" data-level="2" data-path="IntroProbabilitySampling.html"><a href="IntroProbabilitySampling.html"><i class="fa fa-check"></i><b>2</b> Introduction to probability sampling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="IntroProbabilitySampling.html"><a href="IntroProbabilitySampling.html#HTestimator"><i class="fa fa-check"></i><b>2.1</b> Horvitz-Thompson estimator</a></li>
<li class="chapter" data-level="2.2" data-path="IntroProbabilitySampling.html"><a href="IntroProbabilitySampling.html#hansen-hurwitz-estimator"><i class="fa fa-check"></i><b>2.2</b> Hansen-Hurwitz estimator</a></li>
<li class="chapter" data-level="2.3" data-path="IntroProbabilitySampling.html"><a href="IntroProbabilitySampling.html#using-models-in-design-based-approach"><i class="fa fa-check"></i><b>2.3</b> Using models in design-based approach</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="SI.html"><a href="SI.html"><i class="fa fa-check"></i><b>3</b> Simple random sampling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="SI.html"><a href="SI.html#HTestimatorSI"><i class="fa fa-check"></i><b>3.1</b> Estimation of population parameters</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="SI.html"><a href="SI.html#PopProportion"><i class="fa fa-check"></i><b>3.1.1</b> Population proportion</a></li>
<li class="chapter" data-level="3.1.2" data-path="SI.html"><a href="SI.html#CDF"><i class="fa fa-check"></i><b>3.1.2</b> Cumulative distribution function and quantiles</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="SI.html"><a href="SI.html#VarMeanSI"><i class="fa fa-check"></i><b>3.2</b> Sampling variance of estimator of population parameters</a></li>
<li class="chapter" data-level="3.3" data-path="SI.html"><a href="SI.html#ConfidenceInterval"><i class="fa fa-check"></i><b>3.3</b> Confidence interval estimate</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="SI.html"><a href="SI.html#ConfidenceIntervalProportion"><i class="fa fa-check"></i><b>3.3.1</b> Confidence interval for proportion</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="SI.html"><a href="SI.html#SIcircularplots"><i class="fa fa-check"></i><b>3.4</b> Simple random sampling of circular plots</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="SI.html"><a href="SI.html#sampling-from-a-finite-set-of-fixed-circles"><i class="fa fa-check"></i><b>3.4.1</b> Sampling from a finite set of fixed circles</a></li>
<li class="chapter" data-level="3.4.2" data-path="SI.html"><a href="SI.html#sampling-from-an-infinite-set-of-floating-circles"><i class="fa fa-check"></i><b>3.4.2</b> Sampling from an infinite set of floating circles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="STSI.html"><a href="STSI.html"><i class="fa fa-check"></i><b>4</b> Stratified simple random sampling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="STSI.html"><a href="STSI.html#EstimatorsSTSI"><i class="fa fa-check"></i><b>4.1</b> Estimation of population parameters</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="STSI.html"><a href="STSI.html#population-proportion-cumulative-distribution-function-and-quantiles"><i class="fa fa-check"></i><b>4.1.1</b> Population proportion, cumulative distribution function, and quantiles</a></li>
<li class="chapter" data-level="4.1.2" data-path="STSI.html"><a href="STSI.html#WhyStratify"><i class="fa fa-check"></i><b>4.1.2</b> When should we stratify?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="STSI.html"><a href="STSI.html#CISTSI"><i class="fa fa-check"></i><b>4.2</b> Confidence interval estimate</a></li>
<li class="chapter" data-level="4.3" data-path="STSI.html"><a href="STSI.html#STSIallocation"><i class="fa fa-check"></i><b>4.3</b> Allocation of sample size to strata</a></li>
<li class="chapter" data-level="4.4" data-path="STSI.html"><a href="STSI.html#cumrootf"><i class="fa fa-check"></i><b>4.4</b> <em>Cum-root-f</em> stratification</a></li>
<li class="chapter" data-level="4.5" data-path="STSI.html"><a href="STSI.html#kmeansstratification"><i class="fa fa-check"></i><b>4.5</b> Stratification with multiple covariates</a></li>
<li class="chapter" data-level="4.6" data-path="STSI.html"><a href="STSI.html#geostrata"><i class="fa fa-check"></i><b>4.6</b> Geographical stratification</a></li>
<li class="chapter" data-level="4.7" data-path="STSI.html"><a href="STSI.html#multi-way-stratification"><i class="fa fa-check"></i><b>4.7</b> Multi-way stratification</a></li>
<li class="chapter" data-level="4.8" data-path="STSI.html"><a href="STSI.html#MultivariateStratification"><i class="fa fa-check"></i><b>4.8</b> Multivariate stratification</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="SY.html"><a href="SY.html"><i class="fa fa-check"></i><b>5</b> Systematic random sampling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="SY.html"><a href="SY.html#EstVarSY"><i class="fa fa-check"></i><b>5.1</b> Estimation of population parameters</a></li>
<li class="chapter" data-level="5.2" data-path="SY.html"><a href="SY.html#approximating-the-sampling-variance-of-the-estimator-of-the-mean"><i class="fa fa-check"></i><b>5.2</b> Approximating the sampling variance of the estimator of the mean</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Cl.html"><a href="Cl.html"><i class="fa fa-check"></i><b>6</b> Cluster random sampling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="Cl.html"><a href="Cl.html#clustersamplingestimators"><i class="fa fa-check"></i><b>6.1</b> Estimation of population parameters</a></li>
<li class="chapter" data-level="6.2" data-path="Cl.html"><a href="Cl.html#clusters-selected-with-probabilities-proportional-to-size-without-replacement"><i class="fa fa-check"></i><b>6.2</b> Clusters selected with probabilities proportional to size, without replacement</a></li>
<li class="chapter" data-level="6.3" data-path="Cl.html"><a href="Cl.html#SIC"><i class="fa fa-check"></i><b>6.3</b> Simple random sampling of clusters</a></li>
<li class="chapter" data-level="6.4" data-path="Cl.html"><a href="Cl.html#StratifiedCl"><i class="fa fa-check"></i><b>6.4</b> Stratified cluster random sampling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Twostage.html"><a href="Twostage.html"><i class="fa fa-check"></i><b>7</b> Two-stage cluster random sampling</a>
<ul>
<li class="chapter" data-level="7.1" data-path="Twostage.html"><a href="Twostage.html#twostagesamplingestimators"><i class="fa fa-check"></i><b>7.1</b> Estimation of population parameters</a></li>
<li class="chapter" data-level="7.2" data-path="Twostage.html"><a href="Twostage.html#primary-sampling-units-selected-without-replacement"><i class="fa fa-check"></i><b>7.2</b> Primary sampling units selected without replacement</a></li>
<li class="chapter" data-level="7.3" data-path="Twostage.html"><a href="Twostage.html#TwostageSISI"><i class="fa fa-check"></i><b>7.3</b> Simple random sampling of primary sampling units</a></li>
<li class="chapter" data-level="7.4" data-path="Twostage.html"><a href="Twostage.html#StratifiedTwostage"><i class="fa fa-check"></i><b>7.4</b> Stratified two-stage cluster random sampling</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="pps.html"><a href="pps.html"><i class="fa fa-check"></i><b>8</b> Sampling with probabilities proportional to size</a>
<ul>
<li class="chapter" data-level="8.1" data-path="pps.html"><a href="pps.html#ppswr"><i class="fa fa-check"></i><b>8.1</b> Probability-proportional-to-size sampling with replacement</a></li>
<li class="chapter" data-level="8.2" data-path="pps.html"><a href="pps.html#ppswor"><i class="fa fa-check"></i><b>8.2</b> Probability-proportional-to-size sampling without replacement</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="pps.html"><a href="pps.html#Systematicpps"><i class="fa fa-check"></i><b>8.2.1</b> Systematic pps sampling without replacement</a></li>
<li class="chapter" data-level="8.2.2" data-path="pps.html"><a href="pps.html#pivotalmethod"><i class="fa fa-check"></i><b>8.2.2</b> The pivotal method</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html"><i class="fa fa-check"></i><b>9</b> Balanced and well-spread sampling</a>
<ul>
<li class="chapter" data-level="9.1" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#Balanced"><i class="fa fa-check"></i><b>9.1</b> Balanced sampling</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#balanced-sample-versus-balanced-sampling-design"><i class="fa fa-check"></i><b>9.1.1</b> Balanced sample versus balanced sampling design</a></li>
<li class="chapter" data-level="9.1.2" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#unequal-inclusion-probabilities"><i class="fa fa-check"></i><b>9.1.2</b> Unequal inclusion probabilities</a></li>
<li class="chapter" data-level="9.1.3" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#StratifiedsamplingasBalancedsampling"><i class="fa fa-check"></i><b>9.1.3</b> Stratified random sampling</a></li>
<li class="chapter" data-level="9.1.4" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#Multiwaystratification"><i class="fa fa-check"></i><b>9.1.4</b> Multi-way stratification</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#Spreaded"><i class="fa fa-check"></i><b>9.2</b> Well-spread sampling</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#LPM"><i class="fa fa-check"></i><b>9.2.1</b> Local pivotal method</a></li>
<li class="chapter" data-level="9.2.2" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#GRTS"><i class="fa fa-check"></i><b>9.2.2</b> Generalised random-tessellation stratified sampling</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#BalancedandSpreaded"><i class="fa fa-check"></i><b>9.3</b> Balanced sampling with spreading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Modelassisted.html"><a href="Modelassisted.html"><i class="fa fa-check"></i><b>10</b> Model-assisted estimation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="Modelassisted.html"><a href="Modelassisted.html#GREG"><i class="fa fa-check"></i><b>10.1</b> Generalised regression estimator</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="Modelassisted.html"><a href="Modelassisted.html#RegressionEstimator"><i class="fa fa-check"></i><b>10.1.1</b> Simple and multiple regression estimators</a></li>
<li class="chapter" data-level="10.1.2" data-path="Modelassisted.html"><a href="Modelassisted.html#penalised-least-squares-estimation"><i class="fa fa-check"></i><b>10.1.2</b> Penalised least squares estimation</a></li>
<li class="chapter" data-level="10.1.3" data-path="Modelassisted.html"><a href="Modelassisted.html#RegressionEstimatorSTSI"><i class="fa fa-check"></i><b>10.1.3</b> Regression estimator with stratified simple random sampling</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="Modelassisted.html"><a href="Modelassisted.html#RatioEstimator"><i class="fa fa-check"></i><b>10.2</b> Ratio estimator</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="Modelassisted.html"><a href="Modelassisted.html#RatioEstimatorSTSI"><i class="fa fa-check"></i><b>10.2.1</b> Ratio estimators with stratified simple random sampling</a></li>
<li class="chapter" data-level="10.2.2" data-path="Modelassisted.html"><a href="Modelassisted.html#PoststratifiedEstimator"><i class="fa fa-check"></i><b>10.2.2</b> Poststratified estimator</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="Modelassisted.html"><a href="Modelassisted.html#RandomForest"><i class="fa fa-check"></i><b>10.3</b> Model-assisted estimation using machine learning techniques</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="Modelassisted.html"><a href="Modelassisted.html#predicting-with-a-regression-tree"><i class="fa fa-check"></i><b>10.3.1</b> Predicting with a regression tree</a></li>
<li class="chapter" data-level="10.3.2" data-path="Modelassisted.html"><a href="Modelassisted.html#predicting-with-a-random-forest"><i class="fa fa-check"></i><b>10.3.2</b> Predicting with a random forest</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="Modelassisted.html"><a href="Modelassisted.html#big-data-and-volunteer-data"><i class="fa fa-check"></i><b>10.4</b> Big data and volunteer data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Twophase.html"><a href="Twophase.html"><i class="fa fa-check"></i><b>11</b> Two-phase random sampling</a>
<ul>
<li class="chapter" data-level="11.1" data-path="Twophase.html"><a href="Twophase.html#TwophaseStratification"><i class="fa fa-check"></i><b>11.1</b> Two-phase random sampling for stratification</a></li>
<li class="chapter" data-level="11.2" data-path="Twophase.html"><a href="Twophase.html#TwophaseRegression"><i class="fa fa-check"></i><b>11.2</b> Two-phase random sampling for regression</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html"><i class="fa fa-check"></i><b>12</b> Computing the required sample size</a>
<ul>
<li class="chapter" data-level="12.1" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#standard-error-of-estimator"><i class="fa fa-check"></i><b>12.1</b> Standard error of estimator</a></li>
<li class="chapter" data-level="12.2" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#ReqSampleSizeLengthCI"><i class="fa fa-check"></i><b>12.2</b> Length of confidence interval</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#length-of-confidence-interval-for-a-proportion"><i class="fa fa-check"></i><b>12.2.1</b> Length of confidence interval for a proportion</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#statistical-testing-of-hypothesis"><i class="fa fa-check"></i><b>12.3</b> Statistical testing of hypothesis</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#sample-size-for-testing-a-proportion"><i class="fa fa-check"></i><b>12.3.1</b> Sample size for testing a proportion</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#DesignEffect"><i class="fa fa-check"></i><b>12.4</b> Accounting for design effect</a></li>
<li class="chapter" data-level="12.5" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#BayesianSampleSize"><i class="fa fa-check"></i><b>12.5</b> Bayesian sample size determination</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#bayesian-criteria-for-sample-size-computation"><i class="fa fa-check"></i><b>12.5.1</b> Bayesian criteria for sample size computation</a></li>
<li class="chapter" data-level="12.5.2" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#mixed-bayesian-likelihood-approach"><i class="fa fa-check"></i><b>12.5.2</b> Mixed Bayesian-likelihood approach</a></li>
<li class="chapter" data-level="12.5.3" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#estimation-of-population-mean"><i class="fa fa-check"></i><b>12.5.3</b> Estimation of population mean</a></li>
<li class="chapter" data-level="12.5.4" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#estimation-of-a-population-proportion"><i class="fa fa-check"></i><b>12.5.4</b> Estimation of a population proportion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html"><i class="fa fa-check"></i><b>13</b> Model-based optimisation of probability sampling designs</a>
<ul>
<li class="chapter" data-level="13.1" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#model-based-optimisation-of-sampling-design-type-and-sample-size"><i class="fa fa-check"></i><b>13.1</b> Model-based optimisation of sampling design type and sample size</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#AnalyticalApproach"><i class="fa fa-check"></i><b>13.1.1</b> Analytical approach</a></li>
<li class="chapter" data-level="13.1.2" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#GeostatisticalSimulationApproach"><i class="fa fa-check"></i><b>13.1.2</b> Geostatistical simulation approach</a></li>
<li class="chapter" data-level="13.1.3" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#MBpredSamplingVarBayes"><i class="fa fa-check"></i><b>13.1.3</b> Bayesian approach</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#Ospats"><i class="fa fa-check"></i><b>13.2</b> Model-based optimisation of spatial strata</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html"><i class="fa fa-check"></i><b>14</b> Sampling for estimating parameters of (small) domains</a>
<ul>
<li class="chapter" data-level="14.1" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#LargeDomainsDirectEstimator"><i class="fa fa-check"></i><b>14.1</b> Direct estimator for large domains</a></li>
<li class="chapter" data-level="14.2" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#SmallDomainsModelAssisted"><i class="fa fa-check"></i><b>14.2</b> Model-assisted estimators for small domains</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#RegressionestimatorSmallDomain"><i class="fa fa-check"></i><b>14.2.1</b> Regression estimator</a></li>
<li class="chapter" data-level="14.2.2" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#SyntheticestimatorSmallDomain"><i class="fa fa-check"></i><b>14.2.2</b> Synthetic estimator</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#SmallAreaModelBased"><i class="fa fa-check"></i><b>14.3</b> Model-based prediction</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#random-intercept-model"><i class="fa fa-check"></i><b>14.3.1</b> Random intercept model</a></li>
<li class="chapter" data-level="14.3.2" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#geostatistical-model"><i class="fa fa-check"></i><b>14.3.2</b> Geostatistical model</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#supplemental-probability-sampling-of-small-domains"><i class="fa fa-check"></i><b>14.4</b> Supplemental probability sampling of small domains</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html"><i class="fa fa-check"></i><b>15</b> Repeated sample surveys for monitoring population parameters</a>
<ul>
<li class="chapter" data-level="15.1" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#space-time-designs"><i class="fa fa-check"></i><b>15.1</b> Space-time designs</a></li>
<li class="chapter" data-level="15.2" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#SpaceTimeparameters"><i class="fa fa-check"></i><b>15.2</b> Space-time population parameters</a></li>
<li class="chapter" data-level="15.3" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#design-based-generalised-least-squares-estimation-of-spatial-means"><i class="fa fa-check"></i><b>15.3</b> Design-based generalised least squares estimation of spatial means</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#current-mean"><i class="fa fa-check"></i><b>15.3.1</b> Current mean</a></li>
<li class="chapter" data-level="15.3.2" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#change-of-the-spatial-mean"><i class="fa fa-check"></i><b>15.3.2</b> Change of the spatial mean</a></li>
<li class="chapter" data-level="15.3.3" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#temporal-trend-of-the-spatial-mean"><i class="fa fa-check"></i><b>15.3.3</b> Temporal trend of the spatial mean</a></li>
<li class="chapter" data-level="15.3.4" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#space-time-mean"><i class="fa fa-check"></i><b>15.3.4</b> Space-time mean</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#case-study-annual-mean-daily-temperature-in-spain"><i class="fa fa-check"></i><b>15.4</b> Case study: annual mean daily temperature in Spain</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#static-synchronous-design"><i class="fa fa-check"></i><b>15.4.1</b> Static-synchronous design</a></li>
<li class="chapter" data-level="15.4.2" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#independent-synchronous-design"><i class="fa fa-check"></i><b>15.4.2</b> Independent synchronous design</a></li>
<li class="chapter" data-level="15.4.3" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#serially-alternating-design"><i class="fa fa-check"></i><b>15.4.3</b> Serially alternating design</a></li>
<li class="chapter" data-level="15.4.4" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#supplemented-panel-design"><i class="fa fa-check"></i><b>15.4.4</b> Supplemented panel design</a></li>
<li class="chapter" data-level="15.4.5" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#rotating-panel-design"><i class="fa fa-check"></i><b>15.4.5</b> Rotating panel design</a></li>
<li class="chapter" data-level="15.4.6" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#sampling-experiment"><i class="fa fa-check"></i><b>15.4.6</b> Sampling experiment</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#space-time-sampling-with-stratified-random-sampling-in-space"><i class="fa fa-check"></i><b>15.5</b> Space-time sampling with stratified random sampling in space</a></li>
</ul></li>
<li class="part"><span><b>II Sampling for mapping</b></span></li>
<li class="chapter" data-level="16" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html"><i class="fa fa-check"></i><b>16</b> Introduction to sampling for mapping</a>
<ul>
<li class="chapter" data-level="16.1" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html#when-is-probability-sampling-not-required"><i class="fa fa-check"></i><b>16.1</b> When is probability sampling not required?</a></li>
<li class="chapter" data-level="16.2" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html#sampling-for-simultaneously-mapping-and-estimating-means"><i class="fa fa-check"></i><b>16.2</b> Sampling for simultaneously mapping and estimating means</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html#balanced-stratified-random-sampling"><i class="fa fa-check"></i><b>16.2.1</b> Balanced stratified random sampling</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html#broad-overview-of-sampling-designs-for-mapping"><i class="fa fa-check"></i><b>16.3</b> Broad overview of sampling designs for mapping</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="RegularGridSpatialCoverage.html"><a href="RegularGridSpatialCoverage.html"><i class="fa fa-check"></i><b>17</b> Regular grid and spatial coverage sampling</a>
<ul>
<li class="chapter" data-level="17.1" data-path="RegularGridSpatialCoverage.html"><a href="RegularGridSpatialCoverage.html#Regulargrid"><i class="fa fa-check"></i><b>17.1</b> Regular grid sampling</a></li>
<li class="chapter" data-level="17.2" data-path="RegularGridSpatialCoverage.html"><a href="RegularGridSpatialCoverage.html#SpatialCoverage"><i class="fa fa-check"></i><b>17.2</b> Spatial coverage sampling</a></li>
<li class="chapter" data-level="17.3" data-path="RegularGridSpatialCoverage.html"><a href="RegularGridSpatialCoverage.html#SpatialInfill"><i class="fa fa-check"></i><b>17.3</b> Spatial infill sampling</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="kmeans.html"><a href="kmeans.html"><i class="fa fa-check"></i><b>18</b> Covariate space coverage sampling</a>
<ul>
<li class="chapter" data-level="18.1" data-path="kmeans.html"><a href="kmeans.html#covariate-space-infill-sampling"><i class="fa fa-check"></i><b>18.1</b> Covariate space infill sampling</a></li>
<li class="chapter" data-level="18.2" data-path="kmeans.html"><a href="kmeans.html#PerformanceCSC"><i class="fa fa-check"></i><b>18.2</b> Performance of covariate space coverage sampling in random forest prediction</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="cLHS.html"><a href="cLHS.html"><i class="fa fa-check"></i><b>19</b> Conditioned Latin hypercube sampling</a>
<ul>
<li class="chapter" data-level="19.1" data-path="cLHS.html"><a href="cLHS.html#cLHIS"><i class="fa fa-check"></i><b>19.1</b> Conditioned Latin hypercube infill sampling</a></li>
<li class="chapter" data-level="19.2" data-path="cLHS.html"><a href="cLHS.html#performance-of-conditioned-latin-hypercube-sampling-in-random-forest-prediction"><i class="fa fa-check"></i><b>19.2</b> Performance of conditioned Latin hypercube sampling in random forest prediction</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="SpatialResponseSurface.html"><a href="SpatialResponseSurface.html"><i class="fa fa-check"></i><b>20</b> Spatial response surface sampling</a>
<ul>
<li class="chapter" data-level="20.1" data-path="SpatialResponseSurface.html"><a href="SpatialResponseSurface.html#IncreaseSampleSize"><i class="fa fa-check"></i><b>20.1</b> Increasing the sample size</a></li>
<li class="chapter" data-level="20.2" data-path="SpatialResponseSurface.html"><a href="SpatialResponseSurface.html#stratified-spatial-response-surface-sampling"><i class="fa fa-check"></i><b>20.2</b> Stratified spatial response surface sampling</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="Introkriging.html"><a href="Introkriging.html"><i class="fa fa-check"></i><b>21</b> Introduction to kriging</a>
<ul>
<li class="chapter" data-level="21.1" data-path="Introkriging.html"><a href="Introkriging.html#ordinary-kriging"><i class="fa fa-check"></i><b>21.1</b> Ordinary kriging</a></li>
<li class="chapter" data-level="21.2" data-path="Introkriging.html"><a href="Introkriging.html#BlockKriging"><i class="fa fa-check"></i><b>21.2</b> Block-kriging</a></li>
<li class="chapter" data-level="21.3" data-path="Introkriging.html"><a href="Introkriging.html#IntroKED"><i class="fa fa-check"></i><b>21.3</b> Kriging with an external drift</a></li>
<li class="chapter" data-level="21.4" data-path="Introkriging.html"><a href="Introkriging.html#VariogramEstimation"><i class="fa fa-check"></i><b>21.4</b> Estimating the semivariogram</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="Introkriging.html"><a href="Introkriging.html#MoM"><i class="fa fa-check"></i><b>21.4.1</b> Method-of-moments</a></li>
<li class="chapter" data-level="21.4.2" data-path="Introkriging.html"><a href="Introkriging.html#MLestimationVariogram"><i class="fa fa-check"></i><b>21.4.2</b> Maximum likelihood</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="Introkriging.html"><a href="Introkriging.html#ResidualVariogram"><i class="fa fa-check"></i><b>21.5</b> Estimating the residual semivariogram</a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="Introkriging.html"><a href="Introkriging.html#IterativeMoM"><i class="fa fa-check"></i><b>21.5.1</b> Iterative method-of-moments</a></li>
<li class="chapter" data-level="21.5.2" data-path="Introkriging.html"><a href="Introkriging.html#REML"><i class="fa fa-check"></i><b>21.5.2</b> Restricted maximum likelihood</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="MBgridspacing.html"><a href="MBgridspacing.html"><i class="fa fa-check"></i><b>22</b> Model-based optimisation of the grid spacing</a>
<ul>
<li class="chapter" data-level="22.1" data-path="MBgridspacing.html"><a href="MBgridspacing.html#GridspacingOK"><i class="fa fa-check"></i><b>22.1</b> Optimal grid spacing for ordinary kriging</a></li>
<li class="chapter" data-level="22.2" data-path="MBgridspacing.html"><a href="MBgridspacing.html#controlling-the-mean-or-a-quantile-of-the-ordinary-kriging-variance"><i class="fa fa-check"></i><b>22.2</b> Controlling the mean or a quantile of the ordinary kriging variance</a></li>
<li class="chapter" data-level="22.3" data-path="MBgridspacing.html"><a href="MBgridspacing.html#optimal-grid-spacing-for-block-kriging"><i class="fa fa-check"></i><b>22.3</b> Optimal grid spacing for block-kriging</a></li>
<li class="chapter" data-level="22.4" data-path="MBgridspacing.html"><a href="MBgridspacing.html#MBgridspacingKED"><i class="fa fa-check"></i><b>22.4</b> Optimal grid spacing for kriging with an external drift</a></li>
<li class="chapter" data-level="22.5" data-path="MBgridspacing.html"><a href="MBgridspacing.html#BayesianGridSpacing"><i class="fa fa-check"></i><b>22.5</b> Bayesian approach</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html"><i class="fa fa-check"></i><b>23</b> Model-based optimisation of the sampling pattern</a>
<ul>
<li class="chapter" data-level="23.1" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#SSA"><i class="fa fa-check"></i><b>23.1</b> Spatial simulated annealing</a></li>
<li class="chapter" data-level="23.2" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#SamplePatternOK"><i class="fa fa-check"></i><b>23.2</b> Optimising the sampling pattern for ordinary kriging</a></li>
<li class="chapter" data-level="23.3" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#SamplePatternKED"><i class="fa fa-check"></i><b>23.3</b> Optimising the sampling pattern for kriging with an external drift</a></li>
<li class="chapter" data-level="23.4" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#model-based-infill-sampling-for-ordinary-kriging"><i class="fa fa-check"></i><b>23.4</b> Model-based infill sampling for ordinary kriging</a></li>
<li class="chapter" data-level="23.5" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#model-based-infill-sampling-for-kriging-with-an-external-drift"><i class="fa fa-check"></i><b>23.5</b> Model-based infill sampling for kriging with an external drift</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html"><i class="fa fa-check"></i><b>24</b> Sampling for estimating the semivariogram</a>
<ul>
<li class="chapter" data-level="24.1" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#nested-sampling"><i class="fa fa-check"></i><b>24.1</b> Nested sampling</a></li>
<li class="chapter" data-level="24.2" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#independent-sampling-of-pairs-of-points"><i class="fa fa-check"></i><b>24.2</b> Independent sampling of pairs of points</a></li>
<li class="chapter" data-level="24.3" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#samplingforvariogram"><i class="fa fa-check"></i><b>24.3</b> Optimisation of sampling pattern for semivariogram estimation</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#UncertainSemivariogramParameters"><i class="fa fa-check"></i><b>24.3.1</b> Uncertainty about semivariogram parameters</a></li>
<li class="chapter" data-level="24.3.2" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#UncertainKrigingVariance"><i class="fa fa-check"></i><b>24.3.2</b> Uncertainty about the kriging variance</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#SamplingEstimationandPrediction"><i class="fa fa-check"></i><b>24.4</b> Optimisation of sampling pattern for semivariogram estimation and mapping</a></li>
<li class="chapter" data-level="24.5" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#a-practical-solution"><i class="fa fa-check"></i><b>24.5</b> A practical solution</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="Validation.html"><a href="Validation.html"><i class="fa fa-check"></i><b>25</b> Sampling for validation of maps</a>
<ul>
<li class="chapter" data-level="25.1" data-path="Validation.html"><a href="Validation.html#map-quality-indices"><i class="fa fa-check"></i><b>25.1</b> Map quality indices</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="Validation.html"><a href="Validation.html#estimation-of-map-quality-indices"><i class="fa fa-check"></i><b>25.1.1</b> Estimation of map quality indices</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="Validation.html"><a href="Validation.html#real-world-case-study"><i class="fa fa-check"></i><b>25.2</b> Real-world case study</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="Validation.html"><a href="Validation.html#estimation-of-the-population-mean-error-and-mean-squared-error"><i class="fa fa-check"></i><b>25.2.1</b> Estimation of the population Mean Error and Mean Squared Error</a></li>
<li class="chapter" data-level="25.2.2" data-path="Validation.html"><a href="Validation.html#estimation-of-the-standard-error-of-the-estimated-population-me-and-mse"><i class="fa fa-check"></i><b>25.2.2</b> Estimation of the standard error of the estimated population ME and MSE</a></li>
<li class="chapter" data-level="25.2.3" data-path="Validation.html"><a href="Validation.html#estimation-of-mec"><i class="fa fa-check"></i><b>25.2.3</b> Estimation of MEC</a></li>
<li class="chapter" data-level="25.2.4" data-path="Validation.html"><a href="Validation.html#statistical-testing-of-hypothesis-about-population-me-and-mse"><i class="fa fa-check"></i><b>25.2.4</b> Statistical testing of hypothesis about population ME and MSE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="Approaches.html"><a href="Approaches.html"><i class="fa fa-check"></i><b>26</b> Design-based, model-based, and model-assisted approach for sampling and inference</a>
<ul>
<li class="chapter" data-level="26.1" data-path="Approaches.html"><a href="Approaches.html#two-sources-of-randomness"><i class="fa fa-check"></i><b>26.1</b> Two sources of randomness</a></li>
<li class="chapter" data-level="26.2" data-path="Approaches.html"><a href="Approaches.html#iid"><i class="fa fa-check"></i><b>26.2</b> “Identically and independently distributed” (i.i.d.)</a></li>
<li class="chapter" data-level="26.3" data-path="Approaches.html"><a href="Approaches.html#BiasandVariance"><i class="fa fa-check"></i><b>26.3</b> Bias and variance</a></li>
<li class="chapter" data-level="26.4" data-path="Approaches.html"><a href="Approaches.html#effectivesamplesize"><i class="fa fa-check"></i><b>26.4</b> Effective sample size</a></li>
<li class="chapter" data-level="26.5" data-path="Approaches.html"><a href="Approaches.html#ExploitSpatialStructure"><i class="fa fa-check"></i><b>26.5</b> Exploiting spatial structure in design-based approach</a></li>
<li class="chapter" data-level="26.6" data-path="Approaches.html"><a href="Approaches.html#ModelassistedvsModeldependent"><i class="fa fa-check"></i><b>26.6</b> Model-assisted versus model-dependent</a></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="Answers.html"><a href="Answers.html"><i class="fa fa-check"></i><b>A</b> Answers to exercises</a>
<ul>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#introduction-to-probability-sampling"><i class="fa fa-check"></i>Introduction to probability sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#simple-random-sampling-1"><i class="fa fa-check"></i>Simple random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#stratified-random-sampling"><i class="fa fa-check"></i>Stratified random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#systematic-random-sampling-2"><i class="fa fa-check"></i>Systematic random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#cluster-random-sampling"><i class="fa fa-check"></i>Cluster random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#two-stage-random-sampling"><i class="fa fa-check"></i>Two-stage random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#sampling-with-probabilities-proportional-to-size"><i class="fa fa-check"></i>Sampling with probabilities proportional to size</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#balanced-and-well-spread-sampling"><i class="fa fa-check"></i>Balanced and well-spread sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#model-assisted-estimation"><i class="fa fa-check"></i>Model-assisted estimation</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#two-phase-random-sampling"><i class="fa fa-check"></i>Two-phase random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#computing-the-required-sample-size"><i class="fa fa-check"></i>Computing the required sample size</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#model-based-optimisation-of-probability-sampling-designs"><i class="fa fa-check"></i>Model-based optimisation of probability sampling designs</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#repeated-sample-surveys-for-monitoring-population-parameters"><i class="fa fa-check"></i>Repeated sample surveys for monitoring population parameters</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#regular-grid-and-spatial-coverage-sampling"><i class="fa fa-check"></i>Regular grid and spatial coverage sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#covariate-space-coverage-sampling"><i class="fa fa-check"></i>Covariate space coverage sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#conditioned-latin-hypercube-sampling"><i class="fa fa-check"></i>Conditioned Latin hypercube sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#model-based-optimisation-of-the-grid-spacing"><i class="fa fa-check"></i>Model-based optimisation of the grid spacing</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#model-based-optimisation-of-the-sampling-pattern"><i class="fa fa-check"></i>Model-based optimisation of the sampling pattern</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#sampling-for-estimating-the-semivariogram"><i class="fa fa-check"></i>Sampling for estimating the semivariogram</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#sampling-for-validation-of-maps"><i class="fa fa-check"></i>Sampling for validation of maps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/DickBrus/">Dick Brus</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial sampling with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="RequiredSampleSize" class="section level1" number="12">
<h1><span class="header-section-number">Chapter 12</span> Computing the required sample size</h1>
<p>An important decision in designing sampling schemes is the number of units to select. In other words, what should the sample size be? If a certain budget is available for sampling, we can determine the affordable sample size from this budget. A costs model is then needed.</p>
<p>The alternative to deriving the affordable sample size from the budget is to start from a requirement on the quality of the survey result obtained by statistical inference. Two types of inference are distinguished, estimation and testing. The required sample size depends on the type of sampling design. With stratified random sampling we expect that we need fewer sampling units compared to simple random sampling to estimate the population mean with the same precision, whereas with cluster random sampling and two-stage cluster random sampling in general we need more sampling units. To compute the sample size given some quality requirement, we may start with computing the required sample size for simple random sampling and then correct this sample size to account for the design effect. Therefore I start with presenting formulas for computing the required sample size for simple random sampling. Section <a href="RequiredSampleSize.html#DesignEffect">12.4</a> describes how the required sample sizes for other types of sampling design can be derived.</p>
<p>Hereafter formulas for computing the required sample size are presented for simple random sampling <em>with replacement</em> (SIR) of finite populations and simple random sampling of infinite populations. For simple random sampling <em>without replacement</em> (SI) of finite populations these sample sizes can be corrected by <span class="citation">(<a href="#ref-loh99" role="doc-biblioref">Lohr 1999</a>)</span></p>
<p><span class="math display" id="eq:nreqSIR">\[\begin{equation}
n_{\mathrm{SI}} = \frac{n}{1+\frac{n_{\mathrm{SIR}}}{N}} \;,
\tag{12.1}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(n\)</span> the required sample size for simple random sampling with replacement.</p>
<div id="standard-error-of-estimator" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> Standard error of estimator</h2>
<p>A first option is to set a limit on the variance of the <span class="math inline">\(\pi\)</span> estimator of the population mean, see Equation <a href="SI.html#eq:VarMean">(3.7)</a>, or on the square root of this variance, the standard error of the estimator. Given a chosen limit for the standard error <span class="math inline">\(se_{\mathrm{max}}\)</span>, the required sample size for simple random sampling with replacement can be computed by</p>
<p><span class="math display" id="eq:nreqse">\[\begin{equation}
n = \left(\frac{S^*(z)}{se_{\mathrm{max}}}\right)^2 \;,
\tag{12.2}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(S^*(z)\)</span> a prior estimate of the population standard deviation. The required sample size <span class="math inline">\(n\)</span> should be rounded to the nearest integer greater than the right-hand side of Equation <a href="RequiredSampleSize.html#eq:nreqse">(12.2)</a>. This also applies to the following equations.</p>
<p>For the population proportion (areal fraction) as the parameter of interest, the required sample size can be computed by (see Equation <a href="SI.html#eq:EstVarProportionSI">(3.14)</a>)</p>
<p><span class="math display" id="eq:nreqseproportion">\[\begin{equation}
n = \left(\frac{\sqrt{p^*(1-p^*)}}{se_{\mathrm{max}}}\right)^2+1 \;,
\tag{12.3}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(p^*\)</span> a prior estimate of the population proportion.</p>

<div class="rmdnote">
To determine the required sample size for estimating the population proportion we need a prior estimate of the population parameter of interest itself, whereas for the population mean a prior estimate is needed of the population standard deviation. The parameter of which a prior estimate is needed for sample size determination is referred to as the design parameter.
</div>
<p>Alternatively, we may require that the <em>relative</em> standard error, i.e. the standard error of the estimator divided by the population mean, may not exceed a given limit <span class="math inline">\(rse_{\mathrm{max}}\)</span>. In this case the required sample size can be computed by</p>
<p><span class="math display" id="eq:nreqrse">\[\begin{equation}
n = \left(\frac{cv^*}{rse_{\mathrm{max}}}\right)^2 \;,
\tag{12.4}
\end{equation}\]</span></p>
<p>with<span class="math inline">\(cv^*\)</span> a prior estimate of the population coefficient of variation <span class="math inline">\(S(z)/\bar{z}\)</span>. For a constraint on the relative standard error of the population proportion estimator we obtain</p>
<p><span class="math display" id="eq:nreqrse2">\[\begin{equation}
n = \left(\frac{p^*(1-p^*)}{rse_{\mathrm{max}}\;p^*}\right)^2+1=\left(\frac{1-p^*}{rse_{\mathrm{max}}}\right)^2+1 \;.
\tag{12.5}
\end{equation}\]</span></p>
</div>
<div id="ReqSampleSizeLengthCI" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> Length of confidence interval</h2>
<p>Another option is to require that the length of the confidence interval of the population mean may not exceed a given limit <span class="math inline">\(l_{\mathrm{max}}\)</span>:</p>
<p><span class="math display" id="eq:widthCI">\[\begin{equation}
2 \; t_{\alpha/2,n-1}\frac{S(z)}{\sqrt{n}} \leq l_{\mathrm{max}} \;,
\tag{12.6}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(t_{\alpha/2,n-1}\)</span> the <span class="math inline">\((1-\alpha/2)\)</span> quantile of the <em>t</em> distribution with <span class="math inline">\(n-1\)</span> degrees of freedom, <span class="math inline">\(S(z)\)</span> the population standard deviation of the study variable, and <span class="math inline">\(n\)</span> the sample size. The problem is that we do not know the degrees of freedom (we want to determine the sample size <span class="math inline">\(n\)</span>). Therefore <span class="math inline">\(t_{\alpha/2,n-1}\)</span> is replaced by <span class="math inline">\(u_{\alpha/2}\)</span>, the <span class="math inline">\((1-\alpha/2)\)</span> quantile of the standard normal distribution. Rearranging yields</p>
<p><span class="math display" id="eq:nreqwidthCI">\[\begin{equation}
n = \left(u_{\alpha/2}\frac{S^*(z)}{l_{\mathrm{max}}/2}\right)^2 \;.
\tag{12.7}
\end{equation}\]</span></p>
<p>The requirement can also be formulated as</p>
<p><span class="math display" id="eq:nreqwidthCIalt">\[\begin{equation}
P(|\hat{\bar{z}}-\bar{z}| \leq d_{\mathrm{max}}) \leq 1-\alpha \;,
\tag{12.8}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(d_{\mathrm{max}}\)</span> the margin of error: <span class="math inline">\(d_{\mathrm{max}}=l_{\mathrm{max}}/2\)</span>.</p>
<p>An alternative is to require that with a large probability <span class="math inline">\(1-\alpha\)</span> the absolute value of the <em>relative</em> error of the estimated mean may not exceed a given limit <span class="math inline">\(r_{\mathrm{max}}\)</span>. In formula:</p>
<p><span class="math display" id="eq:nreqPrRelError">\[\begin{equation}
P\left(\frac{\lvert\hat{\bar{z}}-\bar{z}\rvert}{\bar{z}} \leq r_{\mathrm{max}}\right) \leq 1-\alpha \;.
\tag{12.9}
\end{equation}\]</span></p>
<p>Noting that the absolute error equals <span class="math inline">\(r_{\mathrm{max}} \cdot \bar{z}\)</span> and inserting this in Equation <a href="RequiredSampleSize.html#eq:nreqwidthCI">(12.7)</a> gives</p>
<p><span class="math display" id="eq:nreqPrRelError2">\[\begin{equation}
n = \left(u_{\alpha/2}\frac{cv^*}{r_{\mathrm{max}}}\right)^2 \;.
\tag{12.10}
\end{equation}\]</span></p>
<p>As an example the required sample size is computed for estimating the population mean of the soil organic matter concentration in Voorst. The requirement is that with a probability of 95% the absolute value of the <em>relative</em> error does not exceed 10%. A prior estimate of 0.5 for the population coefficient of variation is used.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="RequiredSampleSize.html#cb327-1" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb327-2"><a href="RequiredSampleSize.html#cb327-2" aria-hidden="true" tabindex="-1"></a>rmax <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb327-3"><a href="RequiredSampleSize.html#cb327-3" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="at">p=</span><span class="dv">1</span><span class="fl">-0.05</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb327-4"><a href="RequiredSampleSize.html#cb327-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>((u<span class="sc">*</span>cv<span class="sc">/</span>rmax)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<p>The required sample size is 97. The same result is obtained with function <code>nContMoe</code> of package <strong>PracTools</strong> (<span class="citation"><a href="#ref-PracTools" role="doc-biblioref">Valliant, Dever, and Kreuter</a> (<a href="#ref-PracTools" role="doc-biblioref">2021</a>)</span>, <span class="citation"><a href="#ref-Vaillant2018" role="doc-biblioref">Valliant, Dever, and Kreuter</a> (<a href="#ref-Vaillant2018" role="doc-biblioref">2018</a>)</span>).</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="RequiredSampleSize.html#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PracTools)</span>
<span id="cb328-2"><a href="RequiredSampleSize.html#cb328-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">ceiling</span>(<span class="fu">nContMoe</span>(<span class="at">moe.sw=</span><span class="dv">2</span>, <span class="at">e=</span>rmax, <span class="at">alpha=</span><span class="fl">0.05</span>, <span class="at">CVpop=</span>cv)))</span></code></pre></div>
<pre><code>[1] 97</code></pre>
<div id="length-of-confidence-interval-for-a-proportion" class="section level3" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> Length of confidence interval for a proportion</h3>
<p>Each of the methods for computing a confidence interval of a proportion described in Subsection <a href="SI.html#ConfidenceIntervalProportion">3.3.1</a> can be used to compute the required sample size given a limit for the length of the confidence interval of a proportion. The most simple option is to base the required sample size on the Wald interval (Equation <a href="SI.html#eq:Waldinterval">(3.17)</a>), so that the required sample size can be computed by</p>
<p><span class="math display" id="eq:nreqwidthCIprop">\[\begin{equation}
n = \left(u_{\alpha/2}\frac{\sqrt{p^*(1-p^*)}}{l_{\mathrm{max}}/2}\right)^2 +1\;.
\tag{12.11}
\end{equation}\]</span></p>
<p>The Wald interval approximates the discrete binomial distribution by a normal distribution. See the rule of thumb in Subsection <a href="SI.html#ConfidenceIntervalProportion">3.3.1</a> for when this approximation is reasonable.</p>
<p>Package <strong>binomSamSize</strong> <span class="citation">(<a href="#ref-Hohle2017" role="doc-biblioref">Höhle 2017</a>)</span> has quite a few functions for computing the required sample size. Function <code>ciss.wald</code> uses the normal approximation. In the next code chunk the required sample sizes are computed for a prior estimate of the population proportion <span class="math inline">\(p^*\)</span> of 0.2.</p>

<div class="rmdcaution">
Argument <code>d</code> in the functions below is <em>half</em> the length of the confidence interval.
</div>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="RequiredSampleSize.html#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(binomSamSize)</span>
<span id="cb330-2"><a href="RequiredSampleSize.html#cb330-2" aria-hidden="true" tabindex="-1"></a>p_prior <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb330-3"><a href="RequiredSampleSize.html#cb330-3" aria-hidden="true" tabindex="-1"></a>n_prop_wald <span class="ot">&lt;-</span> <span class="fu">ciss.wald</span>(<span class="at">p0=</span>p_prior, <span class="at">d=</span><span class="fl">0.1</span>, <span class="at">alpha=</span><span class="fl">0.05</span>)</span>
<span id="cb330-4"><a href="RequiredSampleSize.html#cb330-4" aria-hidden="true" tabindex="-1"></a>n_prop_agrcll <span class="ot">&lt;-</span> <span class="fu">ciss.agresticoull</span>(<span class="at">p0=</span>p_prior, <span class="at">d=</span><span class="fl">0.1</span>, <span class="at">alpha=</span><span class="fl">0.05</span>)</span>
<span id="cb330-5"><a href="RequiredSampleSize.html#cb330-5" aria-hidden="true" tabindex="-1"></a>n_prop_wilson <span class="ot">&lt;-</span> <span class="fu">ciss.wilson</span>(<span class="at">p0=</span>p_prior, <span class="at">d=</span><span class="fl">0.1</span>, <span class="at">alpha=</span><span class="fl">0.05</span>)</span></code></pre></div>
<p>The required sample sizes are 62, 58, and 60, for the Wald, Agresti-Coull, and Wilson approximation of the binomial proportion confidence interval, respectively. The required sample size with function <code>ciss.wald</code> is one unit smaller than as computed with Equation <a href="RequiredSampleSize.html#eq:nreqwidthCIprop">(12.11)</a>, as shown in the code chunk below.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="RequiredSampleSize.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>((<span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span><span class="fu">sqrt</span>(p_prior<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p_prior))<span class="sc">/</span><span class="fl">0.1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] 63</code></pre>
</div>
</div>
<div id="statistical-testing-of-hypothesis" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> Statistical testing of hypothesis</h2>
<p>The required sample size for testing a population mean with a two-sided alternative hypothesis can be computed by <span class="citation">(<a href="#ref-Ott2015" role="doc-biblioref">Ott and Longnecker 2015</a>)</span></p>
<p><span class="math display" id="eq:reqsamplesizetestingmean">\[\begin{equation}
n = \frac{S^2(z)}{\Delta^2}\;(u_{\alpha/2}+u_{\beta})^2 \;,
\tag{12.12}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(\Delta\)</span> the smallest relevant difference of the population mean from the test value, <span class="math inline">\(\alpha\)</span> the tolerable probability of a type I error, i.e. the probability of rejecting the null hypothesis when the population mean is equal to the test value, <span class="math inline">\(\beta\)</span> the tolerable probability of a type II error, i.e. the probability of not rejecting the null hypothesis when the population mean is not equal to the test value, <span class="math inline">\(u_{\alpha/2}\)</span> as before, and <span class="math inline">\(u_{\beta}\)</span> the <span class="math inline">\((1-\beta)\)</span> quantile of the standard normal distribution. The quantity <span class="math inline">\(1-\beta\)</span> is the power of a test: the probability of correctly rejecting the null hypothesis. For a one-sided test, <span class="math inline">\(u_{\alpha/2}\)</span> must be replaced by <span class="math inline">\(u_{\alpha}\)</span>.</p>
<p>In the next code chunk the sample size required for a given target power is computed with the standard normal distribution (Equation <a href="RequiredSampleSize.html#eq:reqsamplesizetestingmean">(12.12)</a>), as well as with the <em>t</em> distribution using function <code>pwr.t.test</code> of package <strong>pwr</strong> <span class="citation">(<a href="#ref-pwr" role="doc-biblioref">Champely 2020</a>)</span><a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>. This requires some iterative algorithm, as the degrees of freedom of the <em>t</em> distribution are a function of the sample size(s). The required sample size is computed for a one-sample test and a one-sided alternative hypothesis.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="RequiredSampleSize.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb333-2"><a href="RequiredSampleSize.html#cb333-2" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">4</span>; delta <span class="ot">&lt;-</span> <span class="dv">1</span>; alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>; beta <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb333-3"><a href="RequiredSampleSize.html#cb333-3" aria-hidden="true" tabindex="-1"></a>n_norm <span class="ot">&lt;-</span> (sd<span class="sc">/</span>delta)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb333-4"><a href="RequiredSampleSize.html#cb333-4" aria-hidden="true" tabindex="-1"></a>n_t <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(</span>
<span id="cb333-5"><a href="RequiredSampleSize.html#cb333-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">d=</span>delta<span class="sc">/</span>sd, <span class="at">sig.level=</span>alpha, <span class="at">power=</span>(<span class="dv">1</span><span class="sc">-</span>beta),</span>
<span id="cb333-6"><a href="RequiredSampleSize.html#cb333-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type=</span><span class="st">&quot;one.sample&quot;</span>, <span class="at">alternative=</span><span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<p>In this example the required sample size computed with the <em>t</em> distribution is two units larger than that obtained with the standard normal distribution: 101 versus 99. Package <strong>pwr</strong> has various functions for computing the power of a test given the sample size, or reversely, the sample size for a given power, such as for the two independent samples <em>t</em> test, binomial test (for one proportion), test for two proportions, etc.</p>
<div id="sample-size-for-testing-a-proportion" class="section level3" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> Sample size for testing a proportion</h3>
<p>For testing a proportion a graph is computed with the power of a binomial test against the sample size. This is illustrated with a one-sided alternative <span class="math inline">\(H_a: p &gt; 0.20\)</span> and a smallest relevant difference of 0.10.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="RequiredSampleSize.html#cb334-1" aria-hidden="true" tabindex="-1"></a>p_test <span class="ot">&lt;-</span> <span class="fl">0.20</span>; alpha <span class="ot">&lt;-</span> <span class="fl">0.10</span>; delta <span class="ot">&lt;-</span> <span class="fl">0.10</span></span>
<span id="cb334-2"><a href="RequiredSampleSize.html#cb334-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">150</span></span>
<span id="cb334-3"><a href="RequiredSampleSize.html#cb334-3" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> k_min <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="at">length=</span><span class="fu">length</span>(n))</span>
<span id="cb334-4"><a href="RequiredSampleSize.html#cb334-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb334-5"><a href="RequiredSampleSize.html#cb334-5" aria-hidden="true" tabindex="-1"></a>  k_min[i] <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(<span class="at">p=</span><span class="dv">1</span><span class="sc">-</span>alpha, <span class="at">size=</span>n[i], <span class="at">prob=</span>p_test)</span>
<span id="cb334-6"><a href="RequiredSampleSize.html#cb334-6" aria-hidden="true" tabindex="-1"></a>  power[i] <span class="ot">&lt;-</span> <span class="fu">pbinom</span>(<span class="at">q=</span>k_min[i], <span class="at">size=</span>n[i], <span class="at">prob=</span>p_test<span class="sc">+</span>delta, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span>
<span id="cb334-7"><a href="RequiredSampleSize.html#cb334-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>As can be seen in the <strong>R</strong> code, as a first step for each total sample size the smallest number of successes <span class="math inline">\(k_{\mathrm{min}}\)</span> is computed at which the null hypothesis is rejected. Then the binomial probability is computed of <span class="math inline">\(k_{\mathrm{min}}+1\)</span> or more successes for a probability of success equal to <span class="math inline">\(p_{\mathrm{test}}+\Delta\)</span>. Note that there is no need to add 1 to <code>k_min</code> as with argument <code>lower.tail=FALSE</code> the value specified with argument <code>q</code> is not included.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:powerbinomialtest"></span>
<img src="SpatialSampling_files/figure-html/powerbinomialtest-1.png" alt="Power of right-tail binomial test (test proportion: 0.2; significance level: 0.10)." width="80%" />
<p class="caption">
Figure 12.1: Power of right-tail binomial test (test proportion: 0.2; significance level: 0.10).
</p>
</div>
<p>Figure <a href="RequiredSampleSize.html#fig:powerbinomialtest">12.1</a> shows that the power does not increase monotonically with the sample size. The graph shows a saw-toothed behaviour. This is caused by the step-wise increase of the critical number of successes (<code>k_min</code>) with the total sample size.</p>
<p>The required sample size can be computed in two ways. The first option is to compute the smallest sample size for which the power is larger than or equal to the required power <span class="math inline">\(1-\beta\)</span>. The alternative is to compute the smallest sample size for which the power is larger than or equal to <span class="math inline">\(1-\beta\)</span> <em>for all sample sizes larger than this</em>.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="RequiredSampleSize.html#cb335-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">min</span>(n[<span class="fu">which</span>(power <span class="sc">&gt;</span> <span class="dv">1</span><span class="sc">-</span>beta)])</span>
<span id="cb335-2"><a href="RequiredSampleSize.html#cb335-2" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> (power <span class="sc">&gt;</span> <span class="dv">1</span><span class="sc">-</span>beta)</span>
<span id="cb335-3"><a href="RequiredSampleSize.html#cb335-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb335-4"><a href="RequiredSampleSize.html#cb335-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(ind[<span class="fu">length</span>(n)<span class="sc">-</span>i]<span class="sc">==</span><span class="cn">FALSE</span>)</span>
<span id="cb335-5"><a href="RequiredSampleSize.html#cb335-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb335-6"><a href="RequiredSampleSize.html#cb335-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb335-7"><a href="RequiredSampleSize.html#cb335-7" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> n[<span class="fu">length</span>(n)<span class="sc">-</span>i<span class="sc">+</span><span class="dv">1</span>]</span></code></pre></div>
<p>The smallest sample size at which the desired level of 0.8 is reached is 88. However, as can be seen in Figure <a href="RequiredSampleSize.html#fig:powerbinomialtest">12.1</a> for sample sizes 89, 90, 93, 94, and 97, the power drops below the desired level of 0.80. The smallest sample size at which the power stays above the level of 0.8 is 98.</p>
<p>Alternatively, we may use function <code>pwr.p.test</code> of package <strong>pwr</strong>. This is an approximation, using an arcsine transformation of proportions. The first step is to compute Cohen’s <span class="math inline">\(h\)</span>, which is a measure of the distance between two proportions: <span class="math inline">\(h = 2\;arcsin(\sqrt{p_1})-2\;arcsin(\sqrt{p_2})\)</span>. This can be done with function <code>ES.h</code>. The value of <span class="math inline">\(h\)</span> must be positive, which is achieved when the proportion assigned to argument <code>p1</code> is larger than the proportion assigned to argument <code>p2</code>.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="RequiredSampleSize.html#cb336-1" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">ES.h</span>(<span class="at">p1=</span><span class="fl">0.30</span>,<span class="at">p2=</span><span class="fl">0.20</span>)</span>
<span id="cb336-2"><a href="RequiredSampleSize.html#cb336-2" aria-hidden="true" tabindex="-1"></a>n_approx <span class="ot">&lt;-</span> <span class="fu">pwr.p.test</span>(</span>
<span id="cb336-3"><a href="RequiredSampleSize.html#cb336-3" aria-hidden="true" tabindex="-1"></a>  h, <span class="at">power=</span>(<span class="dv">1</span><span class="sc">-</span>beta), <span class="at">sig.level=</span>alpha, <span class="at">alternative=</span><span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<p>The approximated sample size equals 84, which is somewhat smaller than the required sample sizes computed above.</p>
<div id="exercises-18" class="section level4 unnumbered">
<h4>Exercises</h4>
<ol style="list-style-type: decimal">
<li>Write an <strong>R</strong> script to compute the required sample size, given a requirement in terms of half the length of the confidence interval of a proportion. Use a normal approximation for computing the confidence interval. Use a range of values for half the length of the interval: <span class="math inline">\(d = (0.05, 0.10, \cdots , 0.45)\)</span>. Use a prior (anticipated) proportion of 0.2 and a significance level of 0.95. Plot the required sample size against <span class="math inline">\(d\)</span>. Explain what you see. Why is it needed to provide a value for the prior proportion?<br />
</li>
<li>Do the same for a single value for half the width of the interval of 0.2 and a range of values for the prior proportion <span class="math inline">\(p^* = (0.05,0.10, \cdots ,0.50)\)</span>. Explain what you see. Why is it not needed to compute the required sample size for prior proportions <span class="math inline">\(&gt; 0.5\)</span>?</li>
</ol>
</div>
</div>
</div>
<div id="DesignEffect" class="section level2" number="12.4">
<h2><span class="header-section-number">12.4</span> Accounting for design effect</h2>
<p>The required sample sizes computed in the previous sections are all for simple random sampling in combination with the <span class="math inline">\(\pi\)</span> estimator of the population mean. But what is the required sample size for other types of sampling design, such as stratified (simple) random sampling, systematic random sampling, two-stage cluster random sampling, and cluster random sampling? Broadly speaking we expect that with stratified random sampling and systematic random sampling the sampling variance of the estimator of the mean will be smaller than with simple random sampling of the same number of units, whereas with two-stage cluster random sampling and cluster random sampling we expect larger sampling variances. Therefore, reversely, for the first two types of sampling design we expect that the sample size required to achieve the same level of accuracy or confidence will be smaller than with simple random sampling, and for the latter two design types this sample size will be larger. The design effect is commonly quantified by the ratio of two sampling variances of the population mean estimator <span class="citation">(<a href="#ref-loh99" role="doc-biblioref">Lohr 1999</a>)</span>:</p>
<p><span class="math display" id="eq:designeffect">\[\begin{equation}
de(p,\hat{\bar{z}}) = \frac{V_p(\hat{\bar{z}})}{V_{\mathrm{SI}}(\hat{\bar{z}}_{\pi})}= \frac{V_p(\hat{\bar{z}})}{S^2(z)/n}\;,
\tag{12.13}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(V_p(\hat{\bar{z}})\)</span> the sampling variance of an estimator (<span class="math inline">\(\pi\)</span> estimator, regression estimator) of the population mean with sampling design <span class="math inline">\(p\)</span> and <span class="math inline">\(V_{\mathrm{SI}}(\hat{\bar{z}}_{\pi})\)</span> the sampling variance of the <span class="math inline">\(\pi\)</span> estimator of the population mean with simple random sampling. Given an estimate of this design effect, the required sample size for a more complex sampling strategy (combination of sampling design and estimator), given a constraint on the standard error or the half-length of a confidence interval, can be computed by</p>
<p><span class="math display" id="eq:nreqdesigneffect">\[\begin{equation}
n(p,\hat{\bar{z}}) = \sqrt{de(p,\hat{\bar{z}})} \; n(\mathrm{SI},\pi) \;.
\tag{12.14}
\end{equation}\]</span></p>

<div class="rmdnote">
The design effect can also be quantified by the ratio of two standard errors. Then there is no need to take the square root of the design effect, as done in Equation <a href="RequiredSampleSize.html#eq:nreqdesigneffect">(12.14)</a>, to compute the required sample size for a more complex design, given a constraint on the standard error or the half-length of a confidence interval.
</div>
</div>
<div id="BayesianSampleSize" class="section level2" number="12.5">
<h2><span class="header-section-number">12.5</span> Bayesian sample size determination</h2>
<p>A serious drawback of the classical frequentist approach of computing the required sample size explained in the previous sections is that the required sample sizes are sensitive to the design parameters <span class="math inline">\(S^*\)</span>, <span class="math inline">\(p^*\)</span>, and <span class="math inline">\(cv^*\)</span>. We are rather uncertain about these parameters, and therefore it is attractive to replace a single value for these parameters by a probability distribution. This leads to a different statistical approach of computing the required sample size, the Bayesian approach. This Bayesian approach also offers the possibility of accommodating existing information about the population mean or proportion. In this section I show how this approach can be used to compute the required sample size for estimating a population mean or proportion.</p>
<p>But before going into details, let me explain the basics of the Bayesian approach of statistical inference. In the previous sections the statistical inference was from the frequentist perspective. How does the frequency distribution of the estimator of the population mean look like if we repeat the selection of a sample with a given sampling design over and over? Is the mean of this frequency distribution, referred to as the sampling distribution, equal to the population mean, and what is the variance of this sampling distribution?</p>
<p>The Bayesian approach is fundamentally different. The frequency distribution of the frequentist approach is replaced by a probability distribution of the population mean reflecting our <em>belief</em> about the population mean. Note that expressing our belief in terms of a probability distribution implies that in the Bayesian approach, contrary to the frequentist approach, the population mean is a random variable. Whereas in the frequentist approach it is incorrect to say that the probability that the population mean is inside the 95% confidence interval equals 95% (see Section <a href="SI.html#ConfidenceInterval">3.3</a>), this is perfectly fine in the Bayesian approach. The term confidence interval is replaced by the term <em>credible interval</em> to underline the fundamental different meaning of the interval.</p>
<p>The first step in the Bayesian approach of statistical inference is to postulate a <em>prior distribution</em> for the population parameter of interest. This prior distribution expresses our belief and uncertainty about the parameter before the sample data are taken into account.</p>
<p>The next step is to formalise a theory about the data. This boils down to making an assumption about the type of distribution function of the data. Can we safely assume that the data follow a normal or a binomial distribution? Once the type of distribution has been specified, we can write an equation for the probability of the data <em>as a function of the parameter</em>. This function is referred to as the <em>likelihood function</em>.</p>
<p>The final step is to revise our prior belief about the population parameter of interest, using the data and our theory about the data as expressed in the likelihood function. This results in the <em>posterior distribution</em> of the parameter. Our revised or updated belief is computed with Bayes’ rule:</p>
<p><span class="math display" id="eq:BayesTheorem">\[\begin{equation}
f(\theta|\mathbf{z}) = \frac{f(\theta) f(\mathbf{z}|\theta)} {f(\mathbf{z})}\;,
\tag{12.15}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(f(\theta|\mathbf{z})\)</span> the posterior distribution, i.e. the probability density<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> of the parameter given the sample data, <span class="math inline">\(f(\theta)\)</span> our prior belief in the parameters specified by a probability distribution (prior distribution), <span class="math inline">\(f(\mathbf{z}|\theta)\)</span> the likelihood of the data, and <span class="math inline">\(f(\mathbf{z})\)</span> the probability distribution of the data.</p>
<div id="bayesian-criteria-for-sample-size-computation" class="section level3" number="12.5.1">
<h3><span class="header-section-number">12.5.1</span> Bayesian criteria for sample size computation</h3>
<p>Equation <a href="RequiredSampleSize.html#eq:BayesTheorem">(12.15)</a> shows that the posterior distribution of the population parameter of interest depends on the probability distribution of the new data <span class="math inline">\(f(\mathbf{z})\)</span>. The problem is that these new data are not yet known. We are designing a sample, and the data yet are to be collected, so at first glance this might seem an unsolvable problem. However, what we could do is to simulate with the prior probability density function a large number of values of the population parameter(s), and with each parameter a large number of possible vectors with <span class="math inline">\(n\)</span> data. Each data vector is then used to update the prior to the posterior, using Bayes’ rule (Equation <a href="RequiredSampleSize.html#eq:BayesTheorem">(12.15)</a>). For each posterior either the length of the highest posterior density (HPD) interval  with a coverage probability of <span class="math inline">\(1-\alpha\)</span> is computed, or reversely, the coverage probability of the HPD interval of length <span class="math inline">\(l_{\mathrm{max}}\)</span>. Finally, the average of the lengths of the HPD intervals or the average of the coverage probabilities is computed, and these averages are compared with our precision requirement. If the average length is larger than <span class="math inline">\(l_{\mathrm{max}}\)</span>, or the coverage probability of intervals of length <span class="math inline">\(l_{\mathrm{max}}\)</span> is smaller than <span class="math inline">\(1-\alpha\)</span>, then we must increase <span class="math inline">\(n\)</span>; if the average length is smaller than <span class="math inline">\(l_{\mathrm{max}}\)</span>, or the coverage probability of intervals of length <span class="math inline">\(l_{\mathrm{max}}\)</span> is larger than <span class="math inline">\(1-\alpha\)</span>, then we must decrease <span class="math inline">\(n\)</span>. This whole procedure is repeated until our precision requirement is met. Simulation is one option to compute the sample size, (partly) analytical approaches are also available.</p>
<p>More formally, the procedure is as follows. The prior probability density function on the population parameter(s) <span class="math inline">\(\theta\)</span> is used to compute for a given sample size <span class="math inline">\(n\)</span> the <em>predictive</em> distribution of the data:</p>
<p><span class="math display" id="eq:predictivedistribution">\[\begin{equation}
f(\mathbf{z}|n) = \int_{\Theta} f(\mathbf{z}|\theta,n)f(\theta)\mathrm{d}\theta\;,
\tag{12.16}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(\Theta\)</span> the parameter space for <span class="math inline">\(\theta\)</span> containing all possible values of <span class="math inline">\(\theta\)</span>. This predictive distribution is also named the <em>preposterior</em> distribution, stressing that the data are not yet accounted for in the distribution.</p>
<p>Even if <span class="math inline">\(\theta\)</span> would be fixed, we do not have only one vector <span class="math inline">\(\mathbf{z}\)</span> with <span class="math inline">\(n\)</span> data values but a probability distribution, from which we can simulate possible data vectors, referred to as the data space <span class="math inline">\(\mathcal{Z}\)</span>. In case of a binomial probability and sample size <span class="math inline">\(n\)</span>, the data space <span class="math inline">\(\mathcal{Z}\)</span> (in the form of the number of observed successes given sample size <span class="math inline">\(n\)</span>) can be written as the set <span class="math inline">\(\{0,1,\cdots,n\}\)</span>, i.e. one vector of length <span class="math inline">\(n\)</span> with all “failures,” <span class="math inline">\(n\)</span> vectors of length <span class="math inline">\(n\)</span> with one success, <span class="math inline">\({n \choose 2}\)</span> vectors with two successes, etc. Each data vector is associated with a probability density (for continuous data) or probability mass (for discrete data). As a consequence, we do not have only one posterior distribution function <span class="math inline">\(f(\theta|\mathbf{z})\)</span>, but as many as we have data vectors in the data space. For each posterior distribution function the coverage of the HPD interval of a given length can be computed, or reversely, the length of the HPD interval for a given coverage. This leads to various criteria for computing the required sample size, among which are the average length criterion (ALC), the average coverage criterion (ACC), and the worst outcome criterion (WOC) (<span class="citation"><a href="#ref-Joseph1995" role="doc-biblioref">L. Joseph, Wolfson, and Du Berger</a> (<a href="#ref-Joseph1995" role="doc-biblioref">1995</a>)</span>, <span class="citation"><a href="#ref-Joseph1997" role="doc-biblioref">L. Joseph and Bélisle</a> (<a href="#ref-Joseph1997" role="doc-biblioref">1997</a>)</span>).</p>
<div id="average-length-criterion" class="section level4" number="12.5.1.1">
<h4><span class="header-section-number">12.5.1.1</span> Average length criterion</h4>
<p>For a fixed posterior HPD interval coverage of <span class="math inline">\(100(1-\alpha)\)</span>% the smallest sample size <span class="math inline">\(n\)</span> is determined such that</p>
<p><span class="math display" id="eq:ALC">\[\begin{equation}
\int_{\mathcal{Z}} l(\mathbf{z},n) f(\mathbf{z}|n)\mathrm{d}\mathbf{z} \leq l_{\mathrm{max}}\;,
\tag{12.17}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(f(\mathbf{z}|n)\)</span> is the predictive distribution of the data (Equation <a href="RequiredSampleSize.html#eq:predictivedistribution">(12.16)</a>) and <span class="math inline">\(l(\mathbf{z},n)\)</span> is the length of the <span class="math inline">\(100(1-\alpha)\)</span>% HPD interval for data <span class="math inline">\(\mathbf{z}\)</span> and sample size <span class="math inline">\(n\)</span>, obtained by solving</p>
<p><span class="math display" id="eq:solveALC">\[\begin{equation}
\int_v^{v+l(\mathbf{z},n)}f(\theta|\mathbf{z},n)\mathrm{d}\theta= 1-\alpha\;,
\tag{12.18}
\end{equation}\]</span></p>
<p>for <span class="math inline">\(l(\mathbf{z},n)\)</span>, for each possible data set <span class="math inline">\(\mathbf{z} \in \mathcal{Z}\)</span>. <span class="math inline">\(f(\theta|\mathbf{z},n)\)</span> is the posterior density of the population parameter of interest given the data <span class="math inline">\(\mathbf{z}\)</span> and sample size <span class="math inline">\(n\)</span>. ALC ensures that the average length of <span class="math inline">\(100(1-\alpha)\)</span>% posterior HPD intervals, weighted by <span class="math inline">\(f(\mathbf{z}|n)\)</span>, is at most <span class="math inline">\(l_{\mathrm{max}}\)</span>.</p>
</div>
<div id="average-coverage-criterion" class="section level4" number="12.5.1.2">
<h4><span class="header-section-number">12.5.1.2</span> Average coverage criterion</h4>
<p>For a fixed posterior HPD interval of length <span class="math inline">\(l_\mathrm{max}\)</span> the smallest sample size <span class="math inline">\(n\)</span> is determined such that</p>
<p><span class="math display" id="eq:ACC">\[\begin{equation}
\int_{\mathcal{Z}} \left\{ \int_v^{v+l_\mathrm{max}}f(\theta|\mathbf{z},n)\mathrm{d}\theta \right\} f(\mathbf{z}|n)\mathrm{d}\mathbf{z} \geq 1-\alpha \;.
\tag{12.19}
\end{equation}\]</span></p>
<p>ACC ensures that the average coverage of HPD intervals of length <span class="math inline">\(l_\mathrm{max}\)</span> is at least <span class="math inline">\(1-\alpha\)</span>. The integral inside the curly brackets is the integral of the posterior density of the population parameter of interest over the HPD interval <span class="math inline">\((v,v+l_\mathrm{max})\)</span>, given a data vector <span class="math inline">\(\mathbf{z}\)</span> of size <span class="math inline">\(n\)</span>. The mean of this integrated posterior density of the parameter of interest <span class="math inline">\(\theta\)</span> is obtained by multiplying the integrated density with the predictive probability of the data and integrating over all possible data sets in <span class="math inline">\(\mathcal{Z}\)</span>.</p>
</div>
<div id="worst-outcome-criterion" class="section level4" number="12.5.1.3">
<h4><span class="header-section-number">12.5.1.3</span> Worst outcome criterion</h4>
<p>Neither ALC nor ACC guarantee that for a particular data set <span class="math inline">\(\mathbf{z}\)</span> the criterion is met, as both are defined as averages over all possible data sets in <span class="math inline">\(\mathcal{Z}\)</span>. A more conservative sample size can be computed by requiring that for all data sets <span class="math inline">\(\mathcal{Z}\)</span> both criteria are met. <span class="citation"><a href="#ref-Joseph1997" role="doc-biblioref">L. Joseph and Bélisle</a> (<a href="#ref-Joseph1997" role="doc-biblioref">1997</a>)</span> modified this criterion by restricting the data sets to a subset <span class="math inline">\(\mathcal{W}\)</span> of most likely data sets. The criterion thus obtained is referred to as the modified worst outcome criterion, but I refer to it shortly as the worst outcome criterion (WOC). So, the criterion is</p>
<p><span class="math display" id="eq:worst">\[\begin{equation}
\mathrm{inf}_{\mathbf{z} \in \mathcal{W}} \left\{\int_v^{v+l(\mathbf{z},n)}f(\theta|\mathbf{z},n)\mathrm{d}\theta\right\} \geq 1- \alpha \;.
\tag{12.20}
\end{equation}\]</span></p>
<p>The smallest sample size satisfying this condition is used as the sample size. For instance, if the 95% most likely data sets are chosen as subspace <span class="math inline">\(\mathcal{W}\)</span>, WOC guarantees that there is 95% assurance that the length of the <span class="math inline">\(100(1-\alpha)\)</span>% posterior HPD intervals will be at most <span class="math inline">\(l_{\mathrm{max}}\)</span>. The fraction of most likely data sets in subspace <span class="math inline">\(\mathcal{W}\)</span> is referred to as the worst level.</p>
</div>
</div>
<div id="mixed-bayesian-likelihood-approach" class="section level3" number="12.5.2">
<h3><span class="header-section-number">12.5.2</span> Mixed Bayesian-likelihood approach</h3>
<p>Besides the fully Bayesian approach, <span class="citation"><a href="#ref-Joseph1997" role="doc-biblioref">L. Joseph and Bélisle</a> (<a href="#ref-Joseph1997" role="doc-biblioref">1997</a>)</span> describe a mixed Bayesian-likelihood approach for determining the sample size. In the mixed Bayesian-likelihood approach of sample size determination the prior distribution of the parameter(s) is only used to derive the predictive distribution of the data (Equation <a href="RequiredSampleSize.html#eq:predictivedistribution">(12.16)</a>), not for deriving the posterior distributions of the parameter of interest for each data vector. For analysis of the posterior distribution, an uninformative prior is therefore used. This mixed approach is of interest when, after the data have been collected, we prefer to estimate the population mean from these data only, using the frequentist approach described in previous sections.</p>
<p>An example of a situation where the mixed Bayesian-likelihood approach can be attractive is the following. Suppose some data of the study variable from the population of interest are already available, but we would like to collect more data so that we will be more confident about the (current) population mean once these new data are collected. The legacy data are used to construct a prior distribution. We have doubts about the quality of the legacy data because they were collected a long time ago and the study variable might have been changed in the meantime. In that case the mixed Bayesian-likelihood approach can be a good option – we are willing to use the legacy data to plan the sampling, but not to make statements about the current population.</p>
<p>No closed formula for computing the required sample size exists for this approach because the posterior density function <span class="math inline">\(f(\theta|z,n)\)</span> is not a well-defined distribution as before. However, the required sample size still can be approximated by simulation.</p>
</div>
<div id="estimation-of-population-mean" class="section level3" number="12.5.3">
<h3><span class="header-section-number">12.5.3</span> Estimation of population mean</h3>
<p>The three criteria (ALC, ACC, and WOC) described above are now used to compute the required sample size for estimating the population mean, assuming that the data come from a normal distribution. As we are uncertain about the population standard deviation <span class="math inline">\(\sigma\)</span> (<span class="math inline">\(S^*(z)\)</span> in Equation <a href="RequiredSampleSize.html#eq:nreqwidthCI">(12.7)</a> is only a prior point estimate of <span class="math inline">\(\sigma\)</span>), a prior distribution is assigned to this parameter. It is convenient to assign a gamma distribution as a prior distribution to the <em>reciprocal</em> of the population variance, referred to as the precision parameter <span class="math inline">\(\lambda = 1/\sigma^2\)</span>. More precisely, a prior <em>bivariate</em> normal-gamma distribution is assigned to the population mean and the precision parameter<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>. With this prior distribution, the <em>posterior</em> distribution of the population mean is fully defined, i.e. both the type of distribution and its parameters are known. The prior distribution is so-called <em>conjugate</em> with the normal distribution.</p>
<p>The gamma distribution has two parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. Figure <a href="RequiredSampleSize.html#fig:gammaprior">12.2</a> shows the gamma distribution for <span class="math inline">\(a=5\)</span> and <span class="math inline">\(b=100\)</span>.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="RequiredSampleSize.html#cb337-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">5</span>; b <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb337-2"><a href="RequiredSampleSize.html#cb337-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="fl">0.2</span>, <span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb337-3"><a href="RequiredSampleSize.html#cb337-3" aria-hidden="true" tabindex="-1"></a>dg <span class="ot">&lt;-</span> <span class="fu">dgamma</span>(<span class="at">x=</span>x, <span class="at">shape=</span>a, <span class="at">scale=</span><span class="dv">1</span><span class="sc">/</span>b)</span>
<span id="cb337-4"><a href="RequiredSampleSize.html#cb337-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>x, <span class="at">y=</span>dg, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Precision&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:gammaprior"></span>
<img src="SpatialSampling_files/figure-html/gammaprior-1.png" alt="Prior gamma distribution for the precision parameter for a shape parameter $a=5$ and a scale parameter $1/b=1/100$." width="80%" />
<p class="caption">
Figure 12.2: Prior gamma distribution for the precision parameter for a shape parameter <span class="math inline">\(a=5\)</span> and a scale parameter <span class="math inline">\(1/b=1/100\)</span>.
</p>
</div>
<p>The mean of the precision parameter <span class="math inline">\(\lambda\)</span> is given by <span class="math inline">\(a/b\)</span> and its standard deviation by <span class="math inline">\(\sqrt{a/b^2}\)</span>.</p>
<p>The normal-gamma prior is used to compute the predictive distribution for the data. For ACC the required sample size can then be computed with <span class="citation">(<a href="#ref-Adcock1988" role="doc-biblioref">Adcock 1988</a>)</span></p>
<p><span class="math display" id="eq:nreqACC">\[\begin{equation}
n = \frac{4b}{a\; l_{\mathrm{max}}^2}t^2_{2a;\alpha/2} - n_0 \;,
\tag{12.21}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(t^2_{2a;\alpha/2}\)</span> the squared <span class="math inline">\((1-\alpha/2)\)</span> quantile of the (usual, i.e. neither shifted nor scaled) <em>t</em> distribution with <span class="math inline">\(2a\)</span> degrees of freedom and <span class="math inline">\(n_0\)</span> the number of prior points. The prior sample size <span class="math inline">\(n_0\)</span> is only relevant if we have prior information about the population mean and an informative prior is used for this population mean. If we have no information about the population mean, a non-informative prior is used and <span class="math inline">\(n_0\)</span> equals 0. Note that as <span class="math inline">\(a/b\)</span> is the prior mean of the inverse of the population variance, Equation <a href="RequiredSampleSize.html#eq:nreqACC">(12.21)</a> is similar to Equation <a href="RequiredSampleSize.html#eq:nreqwidthCI">(12.7)</a>. The only difference is that a quantile from the standard normal distribution is replaced by a quantile from a <em>t</em> distribution with <span class="math inline">\(2a\)</span> degrees of freedom.</p>
<p>No closed-form formula exists for computing the smallest <span class="math inline">\(n\)</span> satisfying ALC, but the solution can be found by a bisectional search algorithm <span class="citation">(<a href="#ref-Joseph1997" role="doc-biblioref">L. Joseph and Bélisle 1997</a>)</span>.</p>
<p>Package <strong>SampleSizeMeans</strong> <span class="citation">(<a href="#ref-Joseph2012" role="doc-biblioref">L. Joseph and Bélisle 2012</a>)</span> is used to compute Bayesian required sample sizes, using both criteria (ACC and ALC), for the fully Bayesian and the mixed Bayesian-likelihood approach. The gamma distribution plotted in Figure <a href="RequiredSampleSize.html#fig:gammaprior">12.2</a> is used as a prior distribution for the precision parameter <span class="math inline">\(\lambda\)</span>. As a reference, also the frequentist required sample size is computed.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="RequiredSampleSize.html#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SampleSizeMeans)</span>
<span id="cb338-2"><a href="RequiredSampleSize.html#cb338-2" aria-hidden="true" tabindex="-1"></a>lmax <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb338-3"><a href="RequiredSampleSize.html#cb338-3" aria-hidden="true" tabindex="-1"></a>n_freq <span class="ot">&lt;-</span> <span class="fu">mu.freq</span>(<span class="at">len=</span>lmax, <span class="at">lambda=</span>a<span class="sc">/</span>b, <span class="at">level=</span><span class="fl">0.95</span>)</span>
<span id="cb338-4"><a href="RequiredSampleSize.html#cb338-4" aria-hidden="true" tabindex="-1"></a>n_alc <span class="ot">&lt;-</span> <span class="fu">mu.alc</span>(<span class="at">len=</span>lmax, <span class="at">alpha=</span>a, <span class="at">beta=</span>b, <span class="at">n0=</span><span class="dv">0</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span>
<span id="cb338-5"><a href="RequiredSampleSize.html#cb338-5" aria-hidden="true" tabindex="-1"></a>n_alcmbl <span class="ot">&lt;-</span> <span class="fu">mu.mblalc</span>(<span class="at">len=</span>lmax, <span class="at">alpha=</span>a, <span class="at">beta=</span>b, <span class="at">level=</span><span class="fl">0.95</span>)</span>
<span id="cb338-6"><a href="RequiredSampleSize.html#cb338-6" aria-hidden="true" tabindex="-1"></a>n_acc <span class="ot">&lt;-</span> <span class="fu">mu.acc</span>(<span class="at">len=</span>lmax, <span class="at">alpha=</span>a, <span class="at">beta=</span>b, <span class="at">n0=</span><span class="dv">0</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span>
<span id="cb338-7"><a href="RequiredSampleSize.html#cb338-7" aria-hidden="true" tabindex="-1"></a>n_accmbl <span class="ot">&lt;-</span> <span class="fu">mu.mblacc</span>(<span class="at">len=</span>lmax, <span class="at">alpha=</span>a, <span class="at">beta=</span>b, <span class="at">level=</span><span class="fl">0.95</span>)</span>
<span id="cb338-8"><a href="RequiredSampleSize.html#cb338-8" aria-hidden="true" tabindex="-1"></a>n_woc <span class="ot">&lt;-</span> <span class="fu">mu.modwoc</span>(</span>
<span id="cb338-9"><a href="RequiredSampleSize.html#cb338-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">len=</span>lmax, <span class="at">alpha=</span>a, <span class="at">beta=</span>b, <span class="at">n0=</span><span class="dv">0</span>, <span class="at">level=</span><span class="fl">0.95</span>, <span class="at">worst.level=</span><span class="fl">0.95</span>)</span>
<span id="cb338-10"><a href="RequiredSampleSize.html#cb338-10" aria-hidden="true" tabindex="-1"></a>n_wocmbl <span class="ot">&lt;-</span> <span class="fu">mu.mblmodwoc</span>(</span>
<span id="cb338-11"><a href="RequiredSampleSize.html#cb338-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">len=</span>lmax, <span class="at">alpha=</span>a, <span class="at">beta=</span>b, <span class="at">level=</span><span class="fl">0.95</span>, <span class="at">worst.level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:requiredsamplesizesnormalmean">Table 12.1: </span>Required sample sizes for estimating a normal mean, computed with three criteria for the fully Bayesian and the mixed Bayesian-likelihood (MBL) approach. Freq refers to the required sample size computed with the frequentist approach.
</caption>
<thead>
<tr>
<th style="text-align:right;">
Freq
</th>
<th style="text-align:right;">
ALC
</th>
<th style="text-align:right;">
ALC-MBL
</th>
<th style="text-align:right;">
ACC
</th>
<th style="text-align:right;">
ACC-MBL
</th>
<th style="text-align:right;">
WOC
</th>
<th style="text-align:right;">
WOC-MBL
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
77
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
93
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
102
</td>
<td style="text-align:right;">
194
</td>
<td style="text-align:right;">
201
</td>
</tr>
</tbody>
</table>
<p>Table <a href="RequiredSampleSize.html#tab:requiredsamplesizesnormalmean">12.1</a> shows that all six required sample sizes are larger than the frequentist required sample size. This makes sense as the frequentist approach does not account for uncertainty in the population variance parameter. The mixed approach leads to slightly larger required sample sizes than the fully Bayesian approach. This is because in the mixed approach the prior distribution of the precision parameter is not used. Apparently, we do not lose much information by ignoring this prior. With WOC the required sample sizes are about twice the sample sizes obtained with the other two criteria, but this depends of course on the size of the subspace <span class="math inline">\(\mathcal{W}\)</span>. If, for instance the 80% most likely data sets are chosen as subspace <span class="math inline">\(\mathcal{W}\)</span>, the required sample sizes are much smaller.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="RequiredSampleSize.html#cb339-1" aria-hidden="true" tabindex="-1"></a>n_woc80 <span class="ot">&lt;-</span> <span class="fu">mu.modwoc</span>(</span>
<span id="cb339-2"><a href="RequiredSampleSize.html#cb339-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">len=</span>lmax, <span class="at">alpha=</span>a, <span class="at">beta=</span>b, <span class="at">n0=</span><span class="dv">0</span>, <span class="at">level=</span><span class="fl">0.95</span>, <span class="at">worst.level=</span><span class="fl">0.80</span>)</span>
<span id="cb339-3"><a href="RequiredSampleSize.html#cb339-3" aria-hidden="true" tabindex="-1"></a>n_wocmbl80 <span class="ot">&lt;-</span> <span class="fu">mu.mblmodwoc</span>(</span>
<span id="cb339-4"><a href="RequiredSampleSize.html#cb339-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">len=</span>lmax, <span class="at">alpha=</span>a, <span class="at">beta=</span>b, <span class="at">level=</span><span class="fl">0.95</span>, <span class="at">worst.level=</span><span class="fl">0.80</span>)</span></code></pre></div>
<p>The required sample sizes with this criterion are 124 and 128 using the fully Bayesian and the mixed Bayesian-likelihood approach, respectively.</p>
</div>
<div id="estimation-of-a-population-proportion" class="section level3" number="12.5.4">
<h3><span class="header-section-number">12.5.4</span> Estimation of a population proportion</h3>
<p>The same criteria can be used to estimate the proportion of a population, or in case of an infinite population the areal fraction, satisfying some condition <span class="citation">(<a href="#ref-Joseph1995" role="doc-biblioref">L. Joseph, Wolfson, and Du Berger 1995</a>)</span>. With simple random sampling this boils down to estimating the probability-of-success parameter <span class="math inline">\(p\)</span> of a binomial distribution. In this case the space of possible outcomes <span class="math inline">\(\mathcal{Z}\)</span> is the number of successes, which is discrete: <span class="math inline">\(\mathcal{Z} = \{0,1,\cdots ,n\}\)</span> with <span class="math inline">\(n\)</span> the sample size.</p>
<p>The conjugate prior for the binomial likelihood is the beta distribution:</p>
<p><span class="math display" id="eq:priorBetadistribution">\[\begin{equation}
p \sim \frac{1}{B(c,d)} \pi^{c-1} (1-\pi)^{d-1} \;,
\tag{12.22}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(B(c,d)\)</span> is the beta function. The two parameters <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span> correspond to the number of ‘successes’ and ‘failures’ in the problem context. The larger these numbers, the more the prior information, and the more sharply defined the probability distribution. The plot below shows this distribution for <span class="math inline">\(c=0.6\)</span> and <span class="math inline">\(d=2.4\)</span>.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="RequiredSampleSize.html#cb340-1" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fl">0.6</span>; d <span class="ot">&lt;-</span> <span class="fl">2.4</span></span>
<span id="cb340-2"><a href="RequiredSampleSize.html#cb340-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb340-3"><a href="RequiredSampleSize.html#cb340-3" aria-hidden="true" tabindex="-1"></a>dbt <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(<span class="at">x=</span>x, <span class="at">shape1=</span>c, <span class="at">shape2=</span>d)</span>
<span id="cb340-4"><a href="RequiredSampleSize.html#cb340-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>x, <span class="at">y=</span>dbt, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Proportion&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:betaprior"></span>
<img src="SpatialSampling_files/figure-html/betaprior-1.png" alt="Prior beta distribution for the binomial proportion for a beta function $B(0.6,2.4)$." width="80%" />
<p class="caption">
Figure 12.3: Prior beta distribution for the binomial proportion for a beta function <span class="math inline">\(B(0.6,2.4)\)</span>.
</p>
</div>
<p>The mean of the binomial proportion equals <span class="math inline">\(c/(c+d)\)</span> and its standard deviation <span class="math inline">\(\sqrt{cd/\{(c+d+1)(c+d)^2\}}\)</span>.</p>
<p>The preposterior marginal distribution of the data is the beta-binomial distribution:</p>
<p><span class="math display" id="eq:preposteriorbinomialdata">\[\begin{equation}
f(z|n) = \binom{n}{z}\frac{B(z+c,n-z+d)}{B(c,d)}\;,
\tag{12.23}
\end{equation}\]</span></p>
<p>and for a given number of successes <span class="math inline">\(z\)</span> out of <span class="math inline">\(n\)</span> trials the posterior distribution of <span class="math inline">\(p\)</span> equals</p>
<p><span class="math display" id="eq:posteriorbinomialdata">\[\begin{equation}
f(p|z,n,c,d)=\frac{1}{B(z+c,n-z+d)} p^{z+c-1} (1-p)^{n-z+d-1} \;.  
\tag{12.24}
\end{equation}\]</span></p>
<p>For the binomial parameter, criterion ALC (Equation <a href="RequiredSampleSize.html#eq:ALC">(12.17)</a>) can be written as
<span class="math display" id="eq:ALCbinomial">\[\begin{equation}
\sum_{z=0}^n l(z,n)f(z,n) \leq l_{\mathrm{max}} \;.
\tag{12.25}
\end{equation}\]</span></p>
<p>To compute the smallest <span class="math inline">\(n\)</span> satisfying this condition, for each value of <span class="math inline">\(z\)</span> and each <span class="math inline">\(n\)</span>, <span class="math inline">\(l(z,n)\)</span> must be computed so that</p>
<p><span class="math display" id="eq:xxx">\[\begin{equation}
\int_v^{v+l(z,n)}f(p|z,n,c,d) \mathrm{d}p = 1-\alpha \;,
\tag{12.26}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(v\)</span> the lower bound of the HPD credible set given the sample size and the observed number of successes <span class="math inline">\(z\)</span>.</p>
<p>For the binomial parameter, criterion ACC (Equation <a href="RequiredSampleSize.html#eq:ACC">(12.19)</a>) can be written as</p>
<p><span class="math display" id="eq:ACCbinomial">\[\begin{equation}
\sum_{z=0}^n \mathrm{Pr}\{p \in (v,v+l_{\mathrm{max}})\}  f(z,n) \geq 1-\alpha \;,
\tag{12.27}
\end{equation}\]</span></p>
<p>with</p>
<p><span class="math display" id="eq:Binomialprob">\[\begin{equation}
\mathrm{Pr}\{p \in (v,v+l_{\mathrm{max}})\}  \propto \int_{v}^{v+l_{\mathrm{max}}}p^z(1-p)^{n-z} f(p) \mathrm{d}p\;,
\tag{12.28}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(f(p)\)</span> the prior density of the binomial parameter.</p>
<p>For more details about ACC and ALC, and about how the required sample size can be computed with WOC in case of the binomial parameter <span class="math inline">\(p\)</span>, I refer to <span class="citation"><a href="#ref-Joseph1995" role="doc-biblioref">L. Joseph, Wolfson, and Du Berger</a> (<a href="#ref-Joseph1995" role="doc-biblioref">1995</a>)</span>.</p>
<p>The required sample sizes for ALC, ACC, and WOC described in the previous subsection, using the fully Bayesian approach or the mixed Bayesian-likelihood approach, can be computed with package <a href="http://www.medicine.mcgill.ca/epidemiology/Joseph/software/Bayesian-Sample-Size.html"><strong>SampleSizeBinomial</strong></a><span class="citation">(<a href="#ref-SampleSizeBinomial" role="doc-biblioref">Lawrence Joseph et al. 2018</a>)</span>. This package is used to compute the required sample sizes using the beta distribution shown in Figure <a href="RequiredSampleSize.html#fig:betaprior">12.3</a> as a prior for the population proportion. Note that argument <code>len</code> of the various functions of package <strong>SampleSizeBinomial</strong> specifies the total length of the confidence interval, not <em>half</em> the length as specified by argument <code>d</code> of function <code>ciss.wald</code>.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="RequiredSampleSize.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SampleSizeBinomial)</span>
<span id="cb341-2"><a href="RequiredSampleSize.html#cb341-2" aria-hidden="true" tabindex="-1"></a>n_alc <span class="ot">&lt;-</span> <span class="fu">prop.alc</span>(<span class="at">len=</span><span class="fl">0.2</span>, <span class="at">alpha=</span>c, <span class="at">beta=</span>d, <span class="at">level=</span><span class="fl">0.95</span>, <span class="at">exact=</span><span class="cn">TRUE</span>)<span class="sc">$</span>n</span>
<span id="cb341-3"><a href="RequiredSampleSize.html#cb341-3" aria-hidden="true" tabindex="-1"></a>n_alcmbl <span class="ot">&lt;-</span> <span class="fu">prop.mblalc</span>(<span class="at">len=</span><span class="fl">0.2</span>, <span class="at">alpha=</span>c, <span class="at">beta=</span>d, <span class="at">level=</span><span class="fl">0.95</span>, <span class="at">exact=</span><span class="cn">TRUE</span>)<span class="sc">$</span>n</span>
<span id="cb341-4"><a href="RequiredSampleSize.html#cb341-4" aria-hidden="true" tabindex="-1"></a>n_acc <span class="ot">&lt;-</span> <span class="fu">prop.acc</span>(<span class="at">len=</span><span class="fl">0.2</span>, <span class="at">alpha=</span>c, <span class="at">beta=</span>d, <span class="at">level=</span><span class="fl">0.95</span>, <span class="at">exact=</span><span class="cn">TRUE</span>)<span class="sc">$</span>n</span>
<span id="cb341-5"><a href="RequiredSampleSize.html#cb341-5" aria-hidden="true" tabindex="-1"></a>n_accmbl <span class="ot">&lt;-</span> <span class="fu">prop.mblacc</span>(<span class="at">len=</span><span class="fl">0.2</span>, <span class="at">alpha=</span>c, <span class="at">beta=</span>d, <span class="at">level=</span><span class="fl">0.95</span>, <span class="at">exact=</span><span class="cn">TRUE</span>)<span class="sc">$</span>n</span>
<span id="cb341-6"><a href="RequiredSampleSize.html#cb341-6" aria-hidden="true" tabindex="-1"></a>n_woc <span class="ot">&lt;-</span> <span class="fu">prop.modwoc</span>(</span>
<span id="cb341-7"><a href="RequiredSampleSize.html#cb341-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">len=</span><span class="fl">0.2</span>, <span class="at">alpha=</span>c, <span class="at">beta=</span>d, <span class="at">level=</span><span class="fl">0.95</span>, <span class="at">exact=</span><span class="cn">TRUE</span>, <span class="at">worst.level=</span><span class="fl">0.80</span>)<span class="sc">$</span>n</span>
<span id="cb341-8"><a href="RequiredSampleSize.html#cb341-8" aria-hidden="true" tabindex="-1"></a>n_wocmbl <span class="ot">&lt;-</span> <span class="fu">prop.mblmodwoc</span>(</span>
<span id="cb341-9"><a href="RequiredSampleSize.html#cb341-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">len=</span><span class="fl">0.2</span>, <span class="at">alpha=</span>c, <span class="at">beta=</span>d, <span class="at">level=</span><span class="fl">0.95</span>, <span class="at">exact=</span><span class="cn">TRUE</span>, <span class="at">worst.level=</span><span class="fl">0.80</span>)<span class="sc">$</span>n</span>
<span id="cb341-10"><a href="RequiredSampleSize.html#cb341-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(binomSamSize)</span>
<span id="cb341-11"><a href="RequiredSampleSize.html#cb341-11" aria-hidden="true" tabindex="-1"></a>n_freq <span class="ot">&lt;-</span> <span class="fu">ciss.wald</span>(<span class="at">p0=</span>c<span class="sc">/</span>(c<span class="sc">+</span>d), <span class="at">d=</span><span class="fl">0.1</span>, <span class="at">alpha=</span><span class="fl">0.05</span>)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:requiredsamplesizesbinomialproportion">Table 12.2: </span>Required sample sizes for estimating a binomial proportion, computed with three criteria for the fully Bayesian and the mixed Bayesian-likelihood (MBL) approach. Freq refers to the required sample size computed with the frequentist approach.
</caption>
<thead>
<tr>
<th style="text-align:right;">
Freq
</th>
<th style="text-align:right;">
ALC
</th>
<th style="text-align:right;">
ALC-MBL
</th>
<th style="text-align:right;">
ACC
</th>
<th style="text-align:right;">
ACC-MBL
</th>
<th style="text-align:right;">
WOC
</th>
<th style="text-align:right;">
WOC-MBL
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
81
</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Adcock1988" class="csl-entry">
Adcock, C. J. 1988. <span>“<span class="nocase">A Bayesian approach to calculating sample sizes</span>.”</span> <em>Statistician</em> 37: 433–39.
</div>
<div id="ref-pwr" class="csl-entry">
Champely, Stephane. 2020. <em><span class="nocase">pwr: Basic Functions for Power Analysis</span></em>. <a href="https://CRAN.R-project.org/package=pwr">https://CRAN.R-project.org/package=pwr</a>.
</div>
<div id="ref-Hohle2017" class="csl-entry">
Höhle, M. 2017. <em><span class="nocase">binomSamSize: Confidence Intervals and Sample Size Determination for a Binomial Proportion under Simple Random Sampling and Pooled Sampling</span></em>. <a href="https://CRAN.R-project.org/package=binomSamSize">https://CRAN.R-project.org/package=binomSamSize</a>.
</div>
<div id="ref-Joseph1997" class="csl-entry">
Joseph, L., and P. Bélisle. 1997. <span>“Bayesian Sample Size Determination for Normal Means and Differences Between Normal Means.”</span> <em>Journal of the Royal Statistical Society. Series D (The Statistician)</em> 46 (2): 209–26. <a href="https://www.jstor.org/stable/2988525">https://www.jstor.org/stable/2988525</a>.
</div>
<div id="ref-Joseph2012" class="csl-entry">
———. 2012. <em><span class="nocase">SampleSizeMeans: Sample size calculations for normal means</span></em>. <a href="https://CRAN.R-project.org/package=SampleSizeMeans">https://CRAN.R-project.org/package=SampleSizeMeans</a>.
</div>
<div id="ref-Joseph1995" class="csl-entry">
Joseph, L., D. B. Wolfson, and R. Du Berger. 1995. <span>“Sample Size Calculations for Binomial Proportions via Highest Posterior Density Intervals.”</span> <em>Journal of the Royal Statistical Society. Series D (The Statistician)</em> 44 (2): 143–54. <a href="URL: http://www.jstor.org/stable/2348439">URL: http://www.jstor.org/stable/2348439</a>.
</div>
<div id="ref-SampleSizeBinomial" class="csl-entry">
Joseph, Lawrence, David B. Wolfson, Roxane du Berger, and Patrick Belisle. 2018. <em>SampleSizeBinomial: Bayesian Sample Size Determination for a Single Binomial Proportion</em>.
</div>
<div id="ref-loh99" class="csl-entry">
Lohr, S. L. 1999. <em>Sampling: Design and Analysis</em>. Pacific Grove: Duxbury Press.
</div>
<div id="ref-Ott2015" class="csl-entry">
Ott, R. L., and M. Longnecker. 2015. <em><span class="nocase">An Introduction to Statistical Methods and Data Analysis</span></em>. Seventh. Cengage Learning.
</div>
<div id="ref-Vaillant2018" class="csl-entry">
Valliant, Richard, Jill A. Dever, and Frauke Kreuter. 2018. <em>Practical Tools for Designing and Weighting Survey Samples</em>. Second. New York: Springer.
</div>
<div id="ref-PracTools" class="csl-entry">
———. 2021. <em>PracTools: Tools for Designing and Weighting Survey Samples</em>. <a href="https://CRAN.R-project.org/package=PracTools">https://CRAN.R-project.org/package=PracTools</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>The same result is obtained with function <code>power.t.test</code> of the <strong>stats</strong> package.<a href="RequiredSampleSize.html#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>I assume here that the parameter of interest <span class="math inline">\(\theta\)</span> is a continuous random variable.<a href="RequiredSampleSize.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>This is equal to a normal-inverse gamma distribution to the population mean and population variance.<a href="RequiredSampleSize.html#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Twophase.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="MBpredictionofDesignVariance.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/DickBrus/SpatialSamplingwithR/edit/master/12-RequiredSampleSize.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SpatialSampling.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
