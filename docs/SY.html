<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Systematic random sampling | Spatial sampling with R</title>
  <meta name="description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Systematic random sampling | Spatial sampling with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.pdf" />
  <meta property="og:description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="github-repo" content="DickBrus/SpatialSamplingwithR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Systematic random sampling | Spatial sampling with R" />
  
  <meta name="twitter:description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="twitter:image" content="/images/cover.pdf" />

<meta name="author" content="Dick J. Brus" />


<meta name="date" content="2023-01-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="STSI.html"/>
<link rel="next" href="Cl.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial sampling with R</a></li>

<li class="divider"></li>
<li><a href="index.html#preface" id="toc-preface">Preface</a>
<ul>
<li><a href="index.html#acknowledgments" id="toc-acknowledgments">Acknowledgments</a></li>
</ul></li>
<li><a href="GeneralIntro.html#GeneralIntro" id="toc-GeneralIntro"><span class="toc-section-number">1</span> Introduction</a>
<ul>
<li><a href="GeneralIntro.html#BasicConcepts" id="toc-BasicConcepts"><span class="toc-section-number">1.1</span> Basic sampling concepts</a>
<ul>
<li><a href="GeneralIntro.html#PopulationParameters" id="toc-PopulationParameters"><span class="toc-section-number">1.1.1</span> Population parameters</a></li>
<li><a href="GeneralIntro.html#descriptive-statistics-vs.-inference-about-a-population" id="toc-descriptive-statistics-vs.-inference-about-a-population"><span class="toc-section-number">1.1.2</span> Descriptive statistics vs. inference about a population</a></li>
<li><a href="GeneralIntro.html#random-sampling-vs.-probability-sampling" id="toc-random-sampling-vs.-probability-sampling"><span class="toc-section-number">1.1.3</span> Random sampling vs. probability sampling</a></li>
</ul></li>
<li><a href="GeneralIntro.html#DBvsMB" id="toc-DBvsMB"><span class="toc-section-number">1.2</span> Design-based vs. model-based approach</a></li>
<li><a href="GeneralIntro.html#Datasets" id="toc-Datasets"><span class="toc-section-number">1.3</span> Populations used in sampling experiments</a>
<ul>
<li><a href="GeneralIntro.html#Voorst" id="toc-Voorst"><span class="toc-section-number">1.3.1</span> Soil organic matter in Voorst, the Netherlands</a></li>
<li><a href="GeneralIntro.html#Poppy" id="toc-Poppy"><span class="toc-section-number">1.3.2</span> Poppy fields in Kandahar, Afghanistan</a></li>
<li><a href="GeneralIntro.html#Amazonia" id="toc-Amazonia"><span class="toc-section-number">1.3.3</span> Aboveground biomass in Eastern Amazonia, Brazil</a></li>
<li><a href="GeneralIntro.html#TASIberia" id="toc-TASIberia"><span class="toc-section-number">1.3.4</span> Annual mean air temperature in Iberia</a></li>
</ul></li>
</ul></li>
<li><a href="#part-probability-sampling-for-estimating-population-parameters" id="toc-part-probability-sampling-for-estimating-population-parameters">(PART) Probability sampling for estimating population parameters</a></li>
<li><a href="IntroProbabilitySampling.html#IntroProbabilitySampling" id="toc-IntroProbabilitySampling"><span class="toc-section-number">2</span> Introduction to probability sampling</a>
<ul>
<li><a href="IntroProbabilitySampling.html#arbitrary-haphazard-sampling-vs.-probability-sampling" id="toc-arbitrary-haphazard-sampling-vs.-probability-sampling">Arbitrary (haphazard) sampling vs. probability sampling</a></li>
<li><a href="IntroProbabilitySampling.html#HTestimator" id="toc-HTestimator"><span class="toc-section-number">2.1</span> Horvitz-Thompson estimator</a></li>
<li><a href="IntroProbabilitySampling.html#hansen-hurwitz-estimator" id="toc-hansen-hurwitz-estimator"><span class="toc-section-number">2.2</span> Hansen-Hurwitz estimator</a></li>
<li><a href="IntroProbabilitySampling.html#using-models-in-design-based-approach" id="toc-using-models-in-design-based-approach"><span class="toc-section-number">2.3</span> Using models in design-based approach</a></li>
</ul></li>
<li><a href="SI.html#SI" id="toc-SI"><span class="toc-section-number">3</span> Simple random sampling</a>
<ul>
<li><a href="SI.html#HTestimatorSI" id="toc-HTestimatorSI"><span class="toc-section-number">3.1</span> Estimation of population parameters</a>
<ul>
<li><a href="SI.html#PopProportion" id="toc-PopProportion"><span class="toc-section-number">3.1.1</span> Population proportion</a></li>
<li><a href="SI.html#CDF" id="toc-CDF"><span class="toc-section-number">3.1.2</span> Cumulative distribution function and quantiles</a></li>
</ul></li>
<li><a href="SI.html#VarMeanSI" id="toc-VarMeanSI"><span class="toc-section-number">3.2</span> Sampling variance of estimator of population parameters</a></li>
<li><a href="SI.html#ConfidenceInterval" id="toc-ConfidenceInterval"><span class="toc-section-number">3.3</span> Confidence interval estimate</a>
<ul>
<li><a href="SI.html#ConfidenceIntervalProportion" id="toc-ConfidenceIntervalProportion"><span class="toc-section-number">3.3.1</span> Confidence interval for a proportion</a></li>
</ul></li>
<li><a href="SI.html#SIcircularplots" id="toc-SIcircularplots"><span class="toc-section-number">3.4</span> Simple random sampling of circular plots</a>
<ul>
<li><a href="SI.html#sampling-from-a-finite-set-of-fixed-circles" id="toc-sampling-from-a-finite-set-of-fixed-circles"><span class="toc-section-number">3.4.1</span> Sampling from a finite set of fixed circles</a></li>
<li><a href="SI.html#sampling-from-an-infinite-set-of-floating-circles" id="toc-sampling-from-an-infinite-set-of-floating-circles"><span class="toc-section-number">3.4.2</span> Sampling from an infinite set of floating circles</a></li>
</ul></li>
</ul></li>
<li><a href="STSI.html#STSI" id="toc-STSI"><span class="toc-section-number">4</span> Stratified simple random sampling</a>
<ul>
<li><a href="STSI.html#EstimatorsSTSI" id="toc-EstimatorsSTSI"><span class="toc-section-number">4.1</span> Estimation of population parameters</a>
<ul>
<li><a href="STSI.html#population-proportion-cumulative-distribution-function-and-quantiles" id="toc-population-proportion-cumulative-distribution-function-and-quantiles"><span class="toc-section-number">4.1.1</span> Population proportion, cumulative distribution function, and quantiles</a></li>
<li><a href="STSI.html#WhyStratify" id="toc-WhyStratify"><span class="toc-section-number">4.1.2</span> Why should we stratify?</a></li>
</ul></li>
<li><a href="STSI.html#CISTSI" id="toc-CISTSI"><span class="toc-section-number">4.2</span> Confidence interval estimate</a></li>
<li><a href="STSI.html#STSIallocation" id="toc-STSIallocation"><span class="toc-section-number">4.3</span> Allocation of sample size to strata</a></li>
<li><a href="STSI.html#cumrootf" id="toc-cumrootf"><span class="toc-section-number">4.4</span> <em>Cum-root-f</em> stratification</a></li>
<li><a href="STSI.html#kmeansstratification" id="toc-kmeansstratification"><span class="toc-section-number">4.5</span> Stratification with multiple covariates</a></li>
<li><a href="STSI.html#geostrata" id="toc-geostrata"><span class="toc-section-number">4.6</span> Geographical stratification</a></li>
<li><a href="STSI.html#multiway-stratification" id="toc-multiway-stratification"><span class="toc-section-number">4.7</span> Multiway stratification</a></li>
<li><a href="STSI.html#MultivariateStratification" id="toc-MultivariateStratification"><span class="toc-section-number">4.8</span> Multivariate stratification</a></li>
</ul></li>
<li><a href="SY.html#SY" id="toc-SY"><span class="toc-section-number">5</span> Systematic random sampling</a>
<ul>
<li><a href="SY.html#EstVarSY" id="toc-EstVarSY"><span class="toc-section-number">5.1</span> Estimation of population parameters</a></li>
<li><a href="SY.html#approximating-the-sampling-variance-of-the-estimator-of-the-mean" id="toc-approximating-the-sampling-variance-of-the-estimator-of-the-mean"><span class="toc-section-number">5.2</span> Approximating the sampling variance of the estimator of the mean</a></li>
</ul></li>
<li><a href="Cl.html#Cl" id="toc-Cl"><span class="toc-section-number">6</span> Cluster random sampling</a>
<ul>
<li><a href="Cl.html#clustersamplingestimators" id="toc-clustersamplingestimators"><span class="toc-section-number">6.1</span> Estimation of population parameters</a></li>
<li><a href="Cl.html#clusters-selected-with-probabilities-proportional-to-size-without-replacement" id="toc-clusters-selected-with-probabilities-proportional-to-size-without-replacement"><span class="toc-section-number">6.2</span> Clusters selected with probabilities proportional to size, without replacement</a></li>
<li><a href="Cl.html#SIC" id="toc-SIC"><span class="toc-section-number">6.3</span> Simple random sampling of clusters</a></li>
<li><a href="Cl.html#StratifiedCl" id="toc-StratifiedCl"><span class="toc-section-number">6.4</span> Stratified cluster random sampling</a></li>
</ul></li>
<li><a href="Twostage.html#Twostage" id="toc-Twostage"><span class="toc-section-number">7</span> Two-stage cluster random sampling</a>
<ul>
<li><a href="Twostage.html#twostagesamplingestimators" id="toc-twostagesamplingestimators"><span class="toc-section-number">7.1</span> Estimation of population parameters</a></li>
<li><a href="Twostage.html#primary-sampling-units-selected-without-replacement" id="toc-primary-sampling-units-selected-without-replacement"><span class="toc-section-number">7.2</span> Primary sampling units selected without replacement</a></li>
<li><a href="Twostage.html#TwostageSISI" id="toc-TwostageSISI"><span class="toc-section-number">7.3</span> Simple random sampling of primary sampling units</a></li>
<li><a href="Twostage.html#StratifiedTwostage" id="toc-StratifiedTwostage"><span class="toc-section-number">7.4</span> Stratified two-stage cluster random sampling</a></li>
</ul></li>
<li><a href="pps.html#pps" id="toc-pps"><span class="toc-section-number">8</span> Sampling with probabilities proportional to size</a>
<ul>
<li><a href="pps.html#ppswr" id="toc-ppswr"><span class="toc-section-number">8.1</span> Probability-proportional-to-size sampling with replacement</a></li>
<li><a href="pps.html#ppswor" id="toc-ppswor"><span class="toc-section-number">8.2</span> Probability-proportional-to-size sampling without replacement</a>
<ul>
<li><a href="pps.html#Systematicpps" id="toc-Systematicpps"><span class="toc-section-number">8.2.1</span> Systematic pps sampling without replacement</a></li>
<li><a href="pps.html#pivotalmethod" id="toc-pivotalmethod"><span class="toc-section-number">8.2.2</span> The pivotal method</a></li>
</ul></li>
</ul></li>
<li><a href="BalancedSpreaded.html#BalancedSpreaded" id="toc-BalancedSpreaded"><span class="toc-section-number">9</span> Balanced and well-spread sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#Balanced" id="toc-Balanced"><span class="toc-section-number">9.1</span> Balanced sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#balanced-sample-vs.-balanced-sampling-design" id="toc-balanced-sample-vs.-balanced-sampling-design"><span class="toc-section-number">9.1.1</span> Balanced sample vs. balanced sampling design</a></li>
<li><a href="BalancedSpreaded.html#unequal-inclusion-probabilities" id="toc-unequal-inclusion-probabilities"><span class="toc-section-number">9.1.2</span> Unequal inclusion probabilities</a></li>
<li><a href="BalancedSpreaded.html#StratifiedsamplingasBalancedsampling" id="toc-StratifiedsamplingasBalancedsampling"><span class="toc-section-number">9.1.3</span> Stratified random sampling</a></li>
<li><a href="BalancedSpreaded.html#Multiwaystratification" id="toc-Multiwaystratification"><span class="toc-section-number">9.1.4</span> Multiway stratification</a></li>
</ul></li>
<li><a href="BalancedSpreaded.html#Spreaded" id="toc-Spreaded"><span class="toc-section-number">9.2</span> Well-spread sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#LPM" id="toc-LPM"><span class="toc-section-number">9.2.1</span> Local pivotal method</a></li>
<li><a href="BalancedSpreaded.html#GRTS" id="toc-GRTS"><span class="toc-section-number">9.2.2</span> Generalised random-tessellation stratified sampling</a></li>
</ul></li>
<li><a href="BalancedSpreaded.html#BalancedandSpreaded" id="toc-BalancedandSpreaded"><span class="toc-section-number">9.3</span> Balanced sampling with spreading</a></li>
</ul></li>
<li><a href="Modelassisted.html#Modelassisted" id="toc-Modelassisted"><span class="toc-section-number">10</span> Model-assisted estimation</a>
<ul>
<li><a href="Modelassisted.html#GREG" id="toc-GREG"><span class="toc-section-number">10.1</span> Generalised regression estimator</a>
<ul>
<li><a href="Modelassisted.html#RegressionEstimator" id="toc-RegressionEstimator"><span class="toc-section-number">10.1.1</span> Simple and multiple regression estimators</a></li>
<li><a href="Modelassisted.html#penalised-least-squares-estimation" id="toc-penalised-least-squares-estimation"><span class="toc-section-number">10.1.2</span> Penalised least squares estimation</a></li>
<li><a href="Modelassisted.html#RegressionEstimatorSTSI" id="toc-RegressionEstimatorSTSI"><span class="toc-section-number">10.1.3</span> Regression estimator with stratified simple random sampling</a></li>
</ul></li>
<li><a href="Modelassisted.html#RatioEstimator" id="toc-RatioEstimator"><span class="toc-section-number">10.2</span> Ratio estimator</a>
<ul>
<li><a href="Modelassisted.html#RatioEstimatorSTSI" id="toc-RatioEstimatorSTSI"><span class="toc-section-number">10.2.1</span> Ratio estimators with stratified simple random sampling</a></li>
</ul></li>
<li><a href="Modelassisted.html#PoststratifiedEstimator" id="toc-PoststratifiedEstimator"><span class="toc-section-number">10.3</span> Poststratified estimator</a></li>
<li><a href="Modelassisted.html#RandomForest" id="toc-RandomForest"><span class="toc-section-number">10.4</span> Model-assisted estimation using machine learning techniques</a>
<ul>
<li><a href="Modelassisted.html#predicting-with-a-regression-tree" id="toc-predicting-with-a-regression-tree"><span class="toc-section-number">10.4.1</span> Predicting with a regression tree</a></li>
<li><a href="Modelassisted.html#predicting-with-a-random-forest" id="toc-predicting-with-a-random-forest"><span class="toc-section-number">10.4.2</span> Predicting with a random forest</a></li>
</ul></li>
<li><a href="Modelassisted.html#big-data-and-volunteer-data" id="toc-big-data-and-volunteer-data"><span class="toc-section-number">10.5</span> Big data and volunteer data</a></li>
</ul></li>
<li><a href="Twophase.html#Twophase" id="toc-Twophase"><span class="toc-section-number">11</span> Two-phase random sampling</a>
<ul>
<li><a href="Twophase.html#TwophaseStratification" id="toc-TwophaseStratification"><span class="toc-section-number">11.1</span> Two-phase random sampling for stratification</a></li>
<li><a href="Twophase.html#TwophaseRegression" id="toc-TwophaseRegression"><span class="toc-section-number">11.2</span> Two-phase random sampling for regression</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#RequiredSampleSize" id="toc-RequiredSampleSize"><span class="toc-section-number">12</span> Computing the required sample size</a>
<ul>
<li><a href="RequiredSampleSize.html#standard-error" id="toc-standard-error"><span class="toc-section-number">12.1</span> Standard error</a></li>
<li><a href="RequiredSampleSize.html#ReqSampleSizeLengthCI" id="toc-ReqSampleSizeLengthCI"><span class="toc-section-number">12.2</span> Length of confidence interval</a>
<ul>
<li><a href="RequiredSampleSize.html#length-of-confidence-interval-for-a-proportion" id="toc-length-of-confidence-interval-for-a-proportion"><span class="toc-section-number">12.2.1</span> Length of confidence interval for a proportion</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#statistical-testing-of-hypothesis" id="toc-statistical-testing-of-hypothesis"><span class="toc-section-number">12.3</span> Statistical testing of hypothesis</a>
<ul>
<li><a href="RequiredSampleSize.html#sample-size-for-testing-a-proportion" id="toc-sample-size-for-testing-a-proportion"><span class="toc-section-number">12.3.1</span> Sample size for testing a proportion</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#DesignEffect" id="toc-DesignEffect"><span class="toc-section-number">12.4</span> Accounting for design effect</a></li>
<li><a href="RequiredSampleSize.html#BayesianSampleSize" id="toc-BayesianSampleSize"><span class="toc-section-number">12.5</span> Bayesian sample size determination</a>
<ul>
<li><a href="RequiredSampleSize.html#bayesian-criteria-for-sample-size-computation" id="toc-bayesian-criteria-for-sample-size-computation"><span class="toc-section-number">12.5.1</span> Bayesian criteria for sample size computation</a></li>
<li><a href="RequiredSampleSize.html#mixed-bayesian-likelihood-approach" id="toc-mixed-bayesian-likelihood-approach"><span class="toc-section-number">12.5.2</span> Mixed Bayesian-likelihood approach</a></li>
<li><a href="RequiredSampleSize.html#estimation-of-population-mean" id="toc-estimation-of-population-mean"><span class="toc-section-number">12.5.3</span> Estimation of population mean</a></li>
<li><a href="RequiredSampleSize.html#estimation-of-a-population-proportion" id="toc-estimation-of-a-population-proportion"><span class="toc-section-number">12.5.4</span> Estimation of a population proportion</a></li>
</ul></li>
</ul></li>
<li><a href="MBpredictionofDesignVariance.html#MBpredictionofDesignVariance" id="toc-MBpredictionofDesignVariance"><span class="toc-section-number">13</span> Model-based optimisation of probability sampling designs</a>
<ul>
<li><a href="MBpredictionofDesignVariance.html#model-based-optimisation-of-sampling-design-type-and-sample-size" id="toc-model-based-optimisation-of-sampling-design-type-and-sample-size"><span class="toc-section-number">13.1</span> Model-based optimisation of sampling design type and sample size</a>
<ul>
<li><a href="MBpredictionofDesignVariance.html#AnalyticalApproach" id="toc-AnalyticalApproach"><span class="toc-section-number">13.1.1</span> Analytical approach</a></li>
<li><a href="MBpredictionofDesignVariance.html#GeostatisticalSimulationApproach" id="toc-GeostatisticalSimulationApproach"><span class="toc-section-number">13.1.2</span> Geostatistical simulation approach</a></li>
<li><a href="MBpredictionofDesignVariance.html#MBpredSamplingVarBayes" id="toc-MBpredSamplingVarBayes"><span class="toc-section-number">13.1.3</span> Bayesian approach</a></li>
</ul></li>
<li><a href="MBpredictionofDesignVariance.html#Ospats" id="toc-Ospats"><span class="toc-section-number">13.2</span> Model-based optimisation of spatial strata</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#SmallAreaEstimation" id="toc-SmallAreaEstimation"><span class="toc-section-number">14</span> Sampling for estimating parameters of domains</a>
<ul>
<li><a href="SmallAreaEstimation.html#LargeDomainsDirectEstimator" id="toc-LargeDomainsDirectEstimator"><span class="toc-section-number">14.1</span> Direct estimator for large domains</a></li>
<li><a href="SmallAreaEstimation.html#SmallDomainsModelAssisted" id="toc-SmallDomainsModelAssisted"><span class="toc-section-number">14.2</span> Model-assisted estimators for small domains</a>
<ul>
<li><a href="SmallAreaEstimation.html#RegressionestimatorSmallDomain" id="toc-RegressionestimatorSmallDomain"><span class="toc-section-number">14.2.1</span> Regression estimator</a></li>
<li><a href="SmallAreaEstimation.html#SyntheticestimatorSmallDomain" id="toc-SyntheticestimatorSmallDomain"><span class="toc-section-number">14.2.2</span> Synthetic estimator</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#SmallAreaModelBased" id="toc-SmallAreaModelBased"><span class="toc-section-number">14.3</span> Model-based prediction</a>
<ul>
<li><a href="SmallAreaEstimation.html#random-intercept-model" id="toc-random-intercept-model"><span class="toc-section-number">14.3.1</span> Random intercept model</a></li>
<li><a href="SmallAreaEstimation.html#geostatistical-model" id="toc-geostatistical-model"><span class="toc-section-number">14.3.2</span> Geostatistical model</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#supplemental-probability-sampling-of-small-domains" id="toc-supplemental-probability-sampling-of-small-domains"><span class="toc-section-number">14.4</span> Supplemental probability sampling of small domains</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#RepeatedSurveys" id="toc-RepeatedSurveys"><span class="toc-section-number">15</span> Repeated sample surveys for monitoring population parameters</a>
<ul>
<li><a href="RepeatedSurveys.html#space-time-designs" id="toc-space-time-designs"><span class="toc-section-number">15.1</span> Space-time designs</a></li>
<li><a href="RepeatedSurveys.html#SpaceTimeparameters" id="toc-SpaceTimeparameters"><span class="toc-section-number">15.2</span> Space-time population parameters</a></li>
<li><a href="RepeatedSurveys.html#design-based-generalised-least-squares-estimation-of-spatial-means" id="toc-design-based-generalised-least-squares-estimation-of-spatial-means"><span class="toc-section-number">15.3</span> Design-based generalised least squares estimation of spatial means</a>
<ul>
<li><a href="RepeatedSurveys.html#current-mean" id="toc-current-mean"><span class="toc-section-number">15.3.1</span> Current mean</a></li>
<li><a href="RepeatedSurveys.html#change-of-the-spatial-mean" id="toc-change-of-the-spatial-mean"><span class="toc-section-number">15.3.2</span> Change of the spatial mean</a></li>
<li><a href="RepeatedSurveys.html#temporal-trend-of-the-spatial-mean" id="toc-temporal-trend-of-the-spatial-mean"><span class="toc-section-number">15.3.3</span> Temporal trend of the spatial mean</a></li>
<li><a href="RepeatedSurveys.html#space-time-mean" id="toc-space-time-mean"><span class="toc-section-number">15.3.4</span> Space-time mean</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#case-study-annual-mean-daily-temperature-in-iberia" id="toc-case-study-annual-mean-daily-temperature-in-iberia"><span class="toc-section-number">15.4</span> Case study: annual mean daily temperature in Iberia</a>
<ul>
<li><a href="RepeatedSurveys.html#static-synchronous-design" id="toc-static-synchronous-design"><span class="toc-section-number">15.4.1</span> Static-synchronous design</a></li>
<li><a href="RepeatedSurveys.html#independent-synchronous-design" id="toc-independent-synchronous-design"><span class="toc-section-number">15.4.2</span> Independent synchronous design</a></li>
<li><a href="RepeatedSurveys.html#serially-alternating-design" id="toc-serially-alternating-design"><span class="toc-section-number">15.4.3</span> Serially alternating design</a></li>
<li><a href="RepeatedSurveys.html#supplemented-panel-design" id="toc-supplemented-panel-design"><span class="toc-section-number">15.4.4</span> Supplemented panel design</a></li>
<li><a href="RepeatedSurveys.html#rotating-panel-design" id="toc-rotating-panel-design"><span class="toc-section-number">15.4.5</span> Rotating panel design</a></li>
<li><a href="RepeatedSurveys.html#sampling-experiment" id="toc-sampling-experiment"><span class="toc-section-number">15.4.6</span> Sampling experiment</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#space-time-sampling-with-stratified-random-sampling-in-space" id="toc-space-time-sampling-with-stratified-random-sampling-in-space"><span class="toc-section-number">15.5</span> Space-time sampling with stratified random sampling in space</a></li>
</ul></li>
<li><a href="#part-sampling-for-mapping" id="toc-part-sampling-for-mapping">(PART) Sampling for mapping</a></li>
<li><a href="IntroSamplingforMapping.html#IntroSamplingforMapping" id="toc-IntroSamplingforMapping"><span class="toc-section-number">16</span> Introduction to sampling for mapping</a>
<ul>
<li><a href="IntroSamplingforMapping.html#when-is-probability-sampling-not-required" id="toc-when-is-probability-sampling-not-required"><span class="toc-section-number">16.1</span> When is probability sampling not required?</a></li>
<li><a href="IntroSamplingforMapping.html#sampling-for-simultaneously-mapping-and-estimating-means" id="toc-sampling-for-simultaneously-mapping-and-estimating-means"><span class="toc-section-number">16.2</span> Sampling for simultaneously mapping and estimating means</a></li>
<li><a href="IntroSamplingforMapping.html#broad-overview-of-sampling-designs-for-mapping" id="toc-broad-overview-of-sampling-designs-for-mapping"><span class="toc-section-number">16.3</span> Broad overview of sampling designs for mapping</a></li>
</ul></li>
<li><a href="RegularGridSpatialCoverage.html#RegularGridSpatialCoverage" id="toc-RegularGridSpatialCoverage"><span class="toc-section-number">17</span> Regular grid and spatial coverage sampling</a>
<ul>
<li><a href="RegularGridSpatialCoverage.html#Regulargrid" id="toc-Regulargrid"><span class="toc-section-number">17.1</span> Regular grid sampling</a></li>
<li><a href="RegularGridSpatialCoverage.html#SpatialCoverage" id="toc-SpatialCoverage"><span class="toc-section-number">17.2</span> Spatial coverage sampling</a></li>
<li><a href="RegularGridSpatialCoverage.html#SpatialInfill" id="toc-SpatialInfill"><span class="toc-section-number">17.3</span> Spatial infill sampling</a></li>
</ul></li>
<li><a href="kmeans.html#kmeans" id="toc-kmeans"><span class="toc-section-number">18</span> Covariate space coverage sampling</a>
<ul>
<li><a href="kmeans.html#covariate-space-infill-sampling" id="toc-covariate-space-infill-sampling"><span class="toc-section-number">18.1</span> Covariate space infill sampling</a></li>
<li><a href="kmeans.html#PerformanceCSC" id="toc-PerformanceCSC"><span class="toc-section-number">18.2</span> Performance of covariate space coverage sampling in random forest prediction</a></li>
</ul></li>
<li><a href="cLHS.html#cLHS" id="toc-cLHS"><span class="toc-section-number">19</span> Conditioned Latin hypercube sampling</a>
<ul>
<li><a href="cLHS.html#cLHIS" id="toc-cLHIS"><span class="toc-section-number">19.1</span> Conditioned Latin hypercube infill sampling</a></li>
<li><a href="cLHS.html#performance-of-conditioned-latin-hypercube-sampling-in-random-forest-prediction" id="toc-performance-of-conditioned-latin-hypercube-sampling-in-random-forest-prediction"><span class="toc-section-number">19.2</span> Performance of conditioned Latin hypercube sampling in random forest prediction</a></li>
</ul></li>
<li><a href="SpatialResponseSurface.html#SpatialResponseSurface" id="toc-SpatialResponseSurface"><span class="toc-section-number">20</span> Spatial response surface sampling</a>
<ul>
<li><a href="SpatialResponseSurface.html#IncreaseSampleSize" id="toc-IncreaseSampleSize"><span class="toc-section-number">20.1</span> Increasing the sample size</a></li>
<li><a href="SpatialResponseSurface.html#stratified-spatial-response-surface-sampling" id="toc-stratified-spatial-response-surface-sampling"><span class="toc-section-number">20.2</span> Stratified spatial response surface sampling</a></li>
<li><a href="SpatialResponseSurface.html#mapping" id="toc-mapping"><span class="toc-section-number">20.3</span> Mapping</a></li>
</ul></li>
<li><a href="Introkriging.html#Introkriging" id="toc-Introkriging"><span class="toc-section-number">21</span> Introduction to kriging</a>
<ul>
<li><a href="Introkriging.html#OrdinaryKriging" id="toc-OrdinaryKriging"><span class="toc-section-number">21.1</span> Ordinary kriging</a></li>
<li><a href="Introkriging.html#BlockKriging" id="toc-BlockKriging"><span class="toc-section-number">21.2</span> Block-kriging</a></li>
<li><a href="Introkriging.html#IntroKED" id="toc-IntroKED"><span class="toc-section-number">21.3</span> Kriging with an external drift</a></li>
<li><a href="Introkriging.html#VariogramEstimation" id="toc-VariogramEstimation"><span class="toc-section-number">21.4</span> Estimating the semivariogram</a>
<ul>
<li><a href="Introkriging.html#MoM" id="toc-MoM"><span class="toc-section-number">21.4.1</span> Method-of-moments</a></li>
<li><a href="Introkriging.html#MLestimationVariogram" id="toc-MLestimationVariogram"><span class="toc-section-number">21.4.2</span> Maximum likelihood</a></li>
</ul></li>
<li><a href="Introkriging.html#ResidualVariogram" id="toc-ResidualVariogram"><span class="toc-section-number">21.5</span> Estimating the residual semivariogram</a>
<ul>
<li><a href="Introkriging.html#IterativeMoM" id="toc-IterativeMoM"><span class="toc-section-number">21.5.1</span> Iterative method-of-moments</a></li>
<li><a href="Introkriging.html#REML" id="toc-REML"><span class="toc-section-number">21.5.2</span> Restricted maximum likelihood</a></li>
</ul></li>
</ul></li>
<li><a href="MBgridspacing.html#MBgridspacing" id="toc-MBgridspacing"><span class="toc-section-number">22</span> Model-based optimisation of the grid spacing</a>
<ul>
<li><a href="MBgridspacing.html#GridspacingOK" id="toc-GridspacingOK"><span class="toc-section-number">22.1</span> Optimal grid spacing for ordinary kriging</a></li>
<li><a href="MBgridspacing.html#controlling-the-mean-or-a-quantile-of-the-ordinary-kriging-variance" id="toc-controlling-the-mean-or-a-quantile-of-the-ordinary-kriging-variance"><span class="toc-section-number">22.2</span> Controlling the mean or a quantile of the ordinary kriging variance</a></li>
<li><a href="MBgridspacing.html#optimal-grid-spacing-for-block-kriging" id="toc-optimal-grid-spacing-for-block-kriging"><span class="toc-section-number">22.3</span> Optimal grid spacing for block-kriging</a></li>
<li><a href="MBgridspacing.html#MBgridspacingKED" id="toc-MBgridspacingKED"><span class="toc-section-number">22.4</span> Optimal grid spacing for kriging with an external drift</a></li>
<li><a href="MBgridspacing.html#BayesianGridSpacing" id="toc-BayesianGridSpacing"><span class="toc-section-number">22.5</span> Bayesian approach</a></li>
</ul></li>
<li><a href="MBSamplePattern.html#MBSamplePattern" id="toc-MBSamplePattern"><span class="toc-section-number">23</span> Model-based optimisation of the sampling pattern</a>
<ul>
<li><a href="MBSamplePattern.html#SSA" id="toc-SSA"><span class="toc-section-number">23.1</span> Spatial simulated annealing</a></li>
<li><a href="MBSamplePattern.html#SamplePatternOK" id="toc-SamplePatternOK"><span class="toc-section-number">23.2</span> Optimising the sampling pattern for ordinary kriging</a></li>
<li><a href="MBSamplePattern.html#SamplePatternKED" id="toc-SamplePatternKED"><span class="toc-section-number">23.3</span> Optimising the sampling pattern for kriging with an external drift</a></li>
<li><a href="MBSamplePattern.html#model-based-infill-sampling-for-ordinary-kriging" id="toc-model-based-infill-sampling-for-ordinary-kriging"><span class="toc-section-number">23.4</span> Model-based infill sampling for ordinary kriging</a></li>
<li><a href="MBSamplePattern.html#model-based-infill-sampling-for-kriging-with-an-external-drift" id="toc-model-based-infill-sampling-for-kriging-with-an-external-drift"><span class="toc-section-number">23.5</span> Model-based infill sampling for kriging with an external drift</a></li>
</ul></li>
<li><a href="SamplingVariogram.html#SamplingVariogram" id="toc-SamplingVariogram"><span class="toc-section-number">24</span> Sampling for estimating the semivariogram</a>
<ul>
<li><a href="SamplingVariogram.html#NestedSampling" id="toc-NestedSampling"><span class="toc-section-number">24.1</span> Nested sampling</a></li>
<li><a href="SamplingVariogram.html#IndependentSamplingPairs" id="toc-IndependentSamplingPairs"><span class="toc-section-number">24.2</span> Independent sampling of pairs of points</a></li>
<li><a href="SamplingVariogram.html#samplingforvariogram" id="toc-samplingforvariogram"><span class="toc-section-number">24.3</span> Optimisation of sampling pattern for semivariogram estimation</a>
<ul>
<li><a href="SamplingVariogram.html#UncertainSemivariogramParameters" id="toc-UncertainSemivariogramParameters"><span class="toc-section-number">24.3.1</span> Uncertainty about semivariogram parameters</a></li>
<li><a href="SamplingVariogram.html#UncertainKrigingVariance" id="toc-UncertainKrigingVariance"><span class="toc-section-number">24.3.2</span> Uncertainty about the kriging variance</a></li>
</ul></li>
<li><a href="SamplingVariogram.html#SamplingEstimationandPrediction" id="toc-SamplingEstimationandPrediction"><span class="toc-section-number">24.4</span> Optimisation of sampling pattern for semivariogram estimation and mapping</a></li>
<li><a href="SamplingVariogram.html#a-practical-solution" id="toc-a-practical-solution"><span class="toc-section-number">24.5</span> A practical solution</a></li>
</ul></li>
<li><a href="Validation.html#Validation" id="toc-Validation"><span class="toc-section-number">25</span> Sampling for validation of maps</a>
<ul>
<li><a href="Validation.html#map-quality-indices" id="toc-map-quality-indices"><span class="toc-section-number">25.1</span> Map quality indices</a>
<ul>
<li><a href="Validation.html#estimation-of-map-quality-indices" id="toc-estimation-of-map-quality-indices"><span class="toc-section-number">25.1.1</span> Estimation of map quality indices</a></li>
</ul></li>
<li><a href="Validation.html#real-world-case-study" id="toc-real-world-case-study"><span class="toc-section-number">25.2</span> Real-world case study</a>
<ul>
<li><a href="Validation.html#estimation-of-the-population-mean-error-and-mean-squared-error" id="toc-estimation-of-the-population-mean-error-and-mean-squared-error"><span class="toc-section-number">25.2.1</span> Estimation of the population mean error and mean squared error</a></li>
<li><a href="Validation.html#estimation-of-the-standard-error-of-the-estimator-of-the-population-mean-error-and-mean-squared-error" id="toc-estimation-of-the-standard-error-of-the-estimator-of-the-population-mean-error-and-mean-squared-error"><span class="toc-section-number">25.2.2</span> Estimation of the standard error of the estimator of the population mean error and mean squared error</a></li>
<li><a href="Validation.html#estimation-of-model-efficiency-coefficient" id="toc-estimation-of-model-efficiency-coefficient"><span class="toc-section-number">25.2.3</span> Estimation of model efficiency coefficient</a></li>
<li><a href="Validation.html#statistical-testing-of-hypothesis-about-population-me-and-mse" id="toc-statistical-testing-of-hypothesis-about-population-me-and-mse"><span class="toc-section-number">25.2.4</span> Statistical testing of hypothesis about population ME and MSE</a></li>
</ul></li>
</ul></li>
<li><a href="Approaches.html#Approaches" id="toc-Approaches"><span class="toc-section-number">26</span> Design-based, model-based, and model-assisted approach for sampling and inference</a>
<ul>
<li><a href="Approaches.html#two-sources-of-randomness" id="toc-two-sources-of-randomness"><span class="toc-section-number">26.1</span> Two sources of randomness</a></li>
<li><a href="Approaches.html#iid" id="toc-iid"><span class="toc-section-number">26.2</span> Identically and independently distributed</a></li>
<li><a href="Approaches.html#BiasandVariance" id="toc-BiasandVariance"><span class="toc-section-number">26.3</span> Bias and variance</a></li>
<li><a href="Approaches.html#effectivesamplesize" id="toc-effectivesamplesize"><span class="toc-section-number">26.4</span> Effective sample size</a></li>
<li><a href="Approaches.html#ExploitSpatialStructure" id="toc-ExploitSpatialStructure"><span class="toc-section-number">26.5</span> Exploiting spatial structure in design-based approach</a></li>
<li><a href="Approaches.html#ModelassistedvsModeldependent" id="toc-ModelassistedvsModeldependent"><span class="toc-section-number">26.6</span> Model-assisted vs. model-dependent</a></li>
</ul></li>
<li><a href="#appendix-appendices" id="toc-appendix-appendices">(APPENDIX) Appendices</a></li>
<li><a href="Answers.html#Answers" id="toc-Answers"><span class="toc-section-number">27</span> Answers to exercises</a>
<ul>
<li><a href="Answers.html#introduction-to-probability-sampling" id="toc-introduction-to-probability-sampling">Introduction to probability sampling</a></li>
<li><a href="Answers.html#simple-random-sampling-1" id="toc-simple-random-sampling-1">Simple random sampling</a></li>
<li><a href="Answers.html#stratified-simple-random-sampling-1" id="toc-stratified-simple-random-sampling-1">Stratified simple random sampling</a></li>
<li><a href="Answers.html#systematic-random-sampling-2" id="toc-systematic-random-sampling-2">Systematic random sampling</a></li>
<li><a href="Answers.html#cluster-random-sampling" id="toc-cluster-random-sampling">Cluster random sampling</a></li>
<li><a href="Answers.html#two-stage-cluster-random-sampling-1" id="toc-two-stage-cluster-random-sampling-1">Two-stage cluster random sampling</a></li>
<li><a href="Answers.html#sampling-with-probabilities-proportional-to-size" id="toc-sampling-with-probabilities-proportional-to-size">Sampling with probabilities proportional to size</a></li>
<li><a href="Answers.html#balanced-and-well-spread-sampling" id="toc-balanced-and-well-spread-sampling">Balanced and well-spread sampling</a></li>
<li><a href="Answers.html#model-assisted-estimation" id="toc-model-assisted-estimation">Model-assisted estimation</a></li>
<li><a href="Answers.html#two-phase-random-sampling" id="toc-two-phase-random-sampling">Two-phase random sampling</a></li>
<li><a href="Answers.html#computing-the-required-sample-size" id="toc-computing-the-required-sample-size">Computing the required sample size</a></li>
<li><a href="Answers.html#model-based-optimisation-of-probability-sampling-designs" id="toc-model-based-optimisation-of-probability-sampling-designs">Model-based optimisation of probability sampling designs</a></li>
<li><a href="Answers.html#repeated-sample-surveys-for-monitoring-population-parameters" id="toc-repeated-sample-surveys-for-monitoring-population-parameters">Repeated sample surveys for monitoring population parameters</a></li>
<li><a href="Answers.html#regular-grid-and-spatial-coverage-sampling" id="toc-regular-grid-and-spatial-coverage-sampling">Regular grid and spatial coverage sampling</a></li>
<li><a href="Answers.html#covariate-space-coverage-sampling" id="toc-covariate-space-coverage-sampling">Covariate space coverage sampling</a></li>
<li><a href="Answers.html#conditioned-latin-hypercube-sampling" id="toc-conditioned-latin-hypercube-sampling">Conditioned Latin hypercube sampling</a></li>
<li><a href="Answers.html#model-based-optimisation-of-the-grid-spacing" id="toc-model-based-optimisation-of-the-grid-spacing">Model-based optimisation of the grid spacing</a></li>
<li><a href="Answers.html#model-based-optimisation-of-the-sampling-pattern" id="toc-model-based-optimisation-of-the-sampling-pattern">Model-based optimisation of the sampling pattern</a></li>
<li><a href="Answers.html#sampling-for-estimating-the-semivariogram" id="toc-sampling-for-estimating-the-semivariogram">Sampling for estimating the semivariogram</a></li>
<li><a href="Answers.html#sampling-for-validation-of-maps" id="toc-sampling-for-validation-of-maps">Sampling for validation of maps</a></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/DickBrus/">Dick Brus</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial sampling with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="SY" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Systematic random sampling<a href="SY.html#SY" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>A simple way of drawing probability samples whose units are spread uniformly over the study area is systematic random sampling (SY), which from a two-dimensional spatial population entails the selection of a regular grid randomly placed on the area. A systematic sample can be selected with function <code>spsample</code> of package <strong>sp</strong> with argument <code>type = "regular"</code> <span class="citation">(<a href="#ref-Bivand2013" role="doc-biblioref">Bivand, Pebesma, and Gómez-Rubio 2013</a>)</span>. Argument <code>offset</code> is not used, so that the grid is randomly placed on the study area. This is illustrated with Voorst. First, <code>data.frame</code> <code>grdVoorst</code> is converted to <code>SpatialPixelsDataFrame</code> with function <code>gridded</code>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="SY.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb75-2"><a href="SY.html#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gridded</span>(grdVoorst) <span class="ot">&lt;-</span> <span class="er">~</span> s1 <span class="sc">+</span> s2</span>
<span id="cb75-3"><a href="SY.html#cb75-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb75-4"><a href="SY.html#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">777</span>)</span>
<span id="cb75-5"><a href="SY.html#cb75-5" aria-hidden="true" tabindex="-1"></a>mySYsample <span class="ot">&lt;-</span> <span class="fu">spsample</span>(<span class="at">x =</span> grdVoorst, <span class="at">n =</span> n, <span class="at">type =</span> <span class="st">&quot;regular&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-6"><a href="SY.html#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as</span>(<span class="st">&quot;data.frame&quot;</span>)</span></code></pre></div>
<p>Figure <a href="SY.html#fig:sampleSY">5.1</a> shows the randomly selected systematic sample. The shape of the grid is square, and the orientation is East-West (E-W), North-South (N-S). There is no strict need for random selection of the orientation of the grid. Random placement of the grid on the study area suffices for design-based estimation.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sampleSY"></span>
<img src="SpatialSampling_files/figure-html/sampleSY-1.png" alt="Systematic random sample (square grid) from Voorst." width="100%" />
<p class="caption">
Figure 5.1: Systematic random sample (square grid) from Voorst.
</p>
</div>
<p>Argument <code>n</code> in function <code>spsample</code> is used to set the sample size. Note that this is the <em>expected</em> sample size, i.e., on average over repeated sampling the sample size is 40. In Figure <a href="SY.html#fig:sampleSY">5.1</a> the number of selected sampling points equals 38. Given the expected sample size, the spacing of the square grid can be computed with <span class="math inline">\(\sqrt{A/n}\)</span>, with <span class="math inline">\(A\)</span> the area of the study area. This area <span class="math inline">\(A\)</span> can be computed by the total number of cells of the discretisation grid multiplied by the area of a grid cell. Note that the area of the study area is smaller than the number of grid cells in the horizontal direction multiplied by the number of grid cells in the vertical direction multiplied by the grid cell area, as we have non-availables (built-up areas, roads, etc.).</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="SY.html#cb76-1" aria-hidden="true" tabindex="-1"></a>cell_size <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb76-2"><a href="SY.html#cb76-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">nrow</span>(grdVoorst) <span class="sc">*</span> cell_size<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb76-3"><a href="SY.html#cb76-3" aria-hidden="true" tabindex="-1"></a>(spacing <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(A <span class="sc">/</span> n))</span></code></pre></div>
<pre><code>[1] 342.965</code></pre>
<p>Instead of argument <code>n</code> we may use argument <code>cell_size</code> to select a grid with a specified spacing. The expected sample size of a square grid can then be computed with <span class="math inline">\(A/spacing^2\)</span>.</p>
<p>The spatial coverage with random grid sampling is better than that with stratified random sampling using compact geographical strata (Section <a href="STSI.html#geostrata">4.6</a>), even with one sampling unit per geostratum. Consequently, in general systematic random sampling results in more precise estimates of the mean or total.</p>
<p>However, there are also two disadvantages of systematic random sampling compared to geographically stratified random sampling. First, for systematic random sampling, no design-unbiased estimator of the sampling variance exists. Second, the number of sampling units with random grid sampling is not fixed, but varies among randomly drawn samples. We may choose the grid spacing such that <em>on average</em> the number of sampling units equals the required (allowed) number of sampling units, but for the actually drawn sample, this number can be smaller or larger. In Voorst the variation of the sample size is quite large. The approximated sampling distribution, obtained by repeating the sampling 10,000 times, is bimodal (Figure <a href="SY.html#fig:samplesizeSY">5.2</a>). The smaller sample sizes are of square grids with only two E-W oriented rows of points instead of three rows.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:samplesizeSY"></span>
<img src="SpatialSampling_files/figure-html/samplesizeSY-1.png" alt="Approximated sampling distribution of the sample size of systematic random samples from Voorst. The expected sample size is 40." width="80%" />
<p class="caption">
Figure 5.2: Approximated sampling distribution of the sample size of systematic random samples from Voorst. The expected sample size is 40.
</p>
</div>
<p>A large variation in sample size over repeated selection with the sampling design under study is undesirable and should be avoided when possible. In the case of Voorst, a simple solution is to select a rectangular grid instead of a square grid, with a spacing in the N-S direction that results in a fixed number of E-W oriented rows of sampling points over repeated selection of grids. This is achieved with a N-S spacing equal to the dimension of the study area in N-S direction divided by an integer. The spacing in E-W direction is then adapted so that on average a given number of sampling points is selected. As the N-S dimension of Voorst is 1,000 m, a N-S spacing of 1,000/3 m is chosen, so that the number of E-W oriented rows of sampling points in the systematic sample equals three for any randomly selected rectangular grid.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="SY.html#cb78-1" aria-hidden="true" tabindex="-1"></a>dy <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">3</span></span>
<span id="cb78-2"><a href="SY.html#cb78-2" aria-hidden="true" tabindex="-1"></a>dx <span class="ot">&lt;-</span> A <span class="sc">/</span> (n <span class="sc">*</span> dy)</span>
<span id="cb78-3"><a href="SY.html#cb78-3" aria-hidden="true" tabindex="-1"></a>mySYsample_rect <span class="ot">&lt;-</span> <span class="fu">spsample</span>(</span>
<span id="cb78-4"><a href="SY.html#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> grdVoorst, <span class="at">cellsize =</span> <span class="fu">c</span>(dx, dy), <span class="at">type =</span> <span class="st">&quot;regular&quot;</span>)</span></code></pre></div>
<p>The E-W spacing is somewhat larger than the N-S spacing: 352.875 m vs. 333.333 m. The variation in sample size with the random rectangular grid is much smaller than that of the square grid. The sample size now ranges from 33 to 46, whereas with the square grid the range varies from 20 to 48.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="SY.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sampleSizes)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  33.00   38.00   40.00   39.99   42.00   46.00 </code></pre>
<p>An alternative shape for the sampling grid is triangular. Triangular grids can be selected with argument <code>type = "hexagonal"</code>. The centres of hexagonal sampling grid cells form a triangular grid. The triangular grid was shown to yield most precise estimates of the population mean given the expected sample size <span class="citation">(<a href="#ref-mat86" role="doc-biblioref">Matérn 1986</a>)</span>. Given the spacing of a triangular grid, the expected sample size can be computed by the area <span class="math inline">\(A\)</span> of the study area divided by the area of hexagonal grid cells with the sampling points at their centres. The area of a hexagon equals <span class="math inline">\(6\sqrt{3}/4\;r^2\)</span>, with <span class="math inline">\(r\)</span> the radius of the circle circumscribing the hexagon (distance from centre to a corner of the hexagon). So, by choosing a radius of <span class="math inline">\(\sqrt{A/(6\sqrt{3}/4)\;n}\)</span> the expected sample equals <span class="math inline">\(n\)</span>. The distance between neighbouring points of the triangular grid in the E-W direction, <span class="math inline">\(dx\)</span>, then equals <span class="math inline">\(r \sqrt{3}\)</span>. The N-S distance equals <span class="math inline">\(\sqrt{3}/2 \; dx\)</span>.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="SY.html#cb81-1" aria-hidden="true" tabindex="-1"></a>cnst <span class="ot">&lt;-</span> <span class="dv">6</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">3</span>) <span class="sc">/</span> <span class="dv">4</span></span>
<span id="cb81-2"><a href="SY.html#cb81-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(A <span class="sc">/</span> (cnst <span class="sc">*</span> n))</span>
<span id="cb81-3"><a href="SY.html#cb81-3" aria-hidden="true" tabindex="-1"></a>dx <span class="ot">&lt;-</span> r <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">3</span>)</span>
<span id="cb81-4"><a href="SY.html#cb81-4" aria-hidden="true" tabindex="-1"></a>dy <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">3</span>) <span class="sc">/</span> <span class="dv">2</span> <span class="sc">*</span> dx</span></code></pre></div>
<p>Function <code>spsample</code> does not work properly in combination with argument <code>type = "hexagonal"</code>. Over repeated sampling, the average sample size is not equal to the chosen sample size passed to function <code>spsample</code> with argument <code>n</code>. The same problem remains when using argument <code>cellsize</code>.</p>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  18.00   23.00   26.00   28.39   35.00   41.00 </code></pre>
<p>The following code can be used for random selection of triangular grids.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="SY.html#cb83-1" aria-hidden="true" tabindex="-1"></a>SY_triangular <span class="ot">&lt;-</span> <span class="cf">function</span>(dx, grd) {</span>
<span id="cb83-2"><a href="SY.html#cb83-2" aria-hidden="true" tabindex="-1"></a>  dy <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">3</span>) <span class="sc">/</span> <span class="dv">2</span> <span class="sc">*</span> dx</span>
<span id="cb83-3"><a href="SY.html#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#randomly select offset</span></span>
<span id="cb83-4"><a href="SY.html#cb83-4" aria-hidden="true" tabindex="-1"></a>  offset_x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> dx)</span>
<span id="cb83-5"><a href="SY.html#cb83-5" aria-hidden="true" tabindex="-1"></a>  offset_y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> dy)</span>
<span id="cb83-6"><a href="SY.html#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#compute x-coordinates of 1 row and y-coordinates of 1 column</span></span>
<span id="cb83-7"><a href="SY.html#cb83-7" aria-hidden="true" tabindex="-1"></a>  bbox <span class="ot">&lt;-</span> <span class="fu">bbox</span>(grd)</span>
<span id="cb83-8"><a href="SY.html#cb83-8" aria-hidden="true" tabindex="-1"></a>  nx <span class="ot">&lt;-</span> <span class="fu">ceiling</span>((bbox[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">-</span> bbox[<span class="dv">1</span>, <span class="dv">1</span>]) <span class="sc">/</span> dx)</span>
<span id="cb83-9"><a href="SY.html#cb83-9" aria-hidden="true" tabindex="-1"></a>  ny <span class="ot">&lt;-</span> <span class="fu">ceiling</span>((bbox[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">-</span> bbox[<span class="dv">2</span>, <span class="dv">1</span>]) <span class="sc">/</span> dy)</span>
<span id="cb83-10"><a href="SY.html#cb83-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span><span class="sc">:</span>nx) <span class="sc">*</span> dx <span class="sc">+</span> offset_x</span>
<span id="cb83-11"><a href="SY.html#cb83-11" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> (<span class="dv">0</span><span class="sc">:</span>ny) <span class="sc">*</span> dy <span class="sc">+</span> offset_y</span>
<span id="cb83-12"><a href="SY.html#cb83-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#compute coordinates of rectangular grid</span></span>
<span id="cb83-13"><a href="SY.html#cb83-13" aria-hidden="true" tabindex="-1"></a>  xy <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(x, y)</span>
<span id="cb83-14"><a href="SY.html#cb83-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(xy) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb83-15"><a href="SY.html#cb83-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#shift points of even rows in horizontal direction</span></span>
<span id="cb83-16"><a href="SY.html#cb83-16" aria-hidden="true" tabindex="-1"></a>  units <span class="ot">&lt;-</span> <span class="fu">which</span>(xy<span class="sc">$</span>y <span class="sc">%in%</span> y[<span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">2</span>, <span class="at">to =</span> ny, <span class="at">by =</span> <span class="dv">2</span>)])</span>
<span id="cb83-17"><a href="SY.html#cb83-17" aria-hidden="true" tabindex="-1"></a>  xy<span class="sc">$</span>x[units] <span class="ot">&lt;-</span> xy<span class="sc">$</span>x[units] <span class="sc">+</span> dx <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb83-18"><a href="SY.html#cb83-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#add coordinates of origin</span></span>
<span id="cb83-19"><a href="SY.html#cb83-19" aria-hidden="true" tabindex="-1"></a>  xy<span class="sc">$</span>x <span class="ot">&lt;-</span> xy<span class="sc">$</span>x <span class="sc">+</span> bbox[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb83-20"><a href="SY.html#cb83-20" aria-hidden="true" tabindex="-1"></a>  xy<span class="sc">$</span>y <span class="ot">&lt;-</span> xy<span class="sc">$</span>y <span class="sc">+</span> bbox[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb83-21"><a href="SY.html#cb83-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#overlay with grid</span></span>
<span id="cb83-22"><a href="SY.html#cb83-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coordinates</span>(xy) <span class="ot">&lt;-</span> <span class="er">~</span> x <span class="sc">+</span> y</span>
<span id="cb83-23"><a href="SY.html#cb83-23" aria-hidden="true" tabindex="-1"></a>  mysample <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">coordinates</span>(xy), <span class="fu">over</span>(xy, grd))</span>
<span id="cb83-24"><a href="SY.html#cb83-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#delete points with NA</span></span>
<span id="cb83-25"><a href="SY.html#cb83-25" aria-hidden="true" tabindex="-1"></a>  mysample <span class="ot">&lt;-</span> mysample[<span class="sc">!</span><span class="fu">is.na</span>(mysample[, <span class="dv">3</span>]), ]</span>
<span id="cb83-26"><a href="SY.html#cb83-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-27"><a href="SY.html#cb83-27" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb83-28"><a href="SY.html#cb83-28" aria-hidden="true" tabindex="-1"></a>mySYsample_tri <span class="ot">&lt;-</span> <span class="fu">SY_triangular</span>(<span class="at">dx =</span> dx, <span class="at">grd =</span> grdVoorst)</span></code></pre></div>
<p>Figure <a href="SY.html#fig:Triangulargrid">5.3</a> shows a triangular grid, selected randomly from Voorst with an expected sample size of 40. The selected triangular grid has 42 points.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Triangulargrid"></span>
<img src="SpatialSampling_files/figure-html/Triangulargrid-1.png" alt="Systematic random sample (triangular grid) from Voorst." width="100%" />
<p class="caption">
Figure 5.3: Systematic random sample (triangular grid) from Voorst.
</p>
</div>
<div id="EstVarSY" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Estimation of population parameters<a href="SY.html#EstVarSY" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With systematic random sampling, all units have the same inclusion probability, equal to <span class="math inline">\(E[n]/N\)</span>, with <span class="math inline">\(E[n]\)</span> the expected sample size. Consequently, the population total can be estimated by</p>
<p><span class="math display" id="eq:HTTotalSY">\[\begin{equation}
\hat{t}(z)=\sum_{k \in \mathcal{S}}\frac{z_k}{\pi_k} = N \sum_{k \in \mathcal{S}}\frac{z_k}{E[n]} \;.
\tag{5.1}
\end{equation}\]</span></p>
<p>The population mean can be estimated by dividing this <span class="math inline">\(\pi\)</span> estimator of the population total by the population size:</p>
<p><span class="math display" id="eq:HTMeanSY">\[\begin{equation}
\hat{\bar{z}}=\sum_{k \in \mathcal{S}}\frac{z_k}{E[n]} \;.
\tag{5.2}
\end{equation}\]</span></p>
<p>In this <span class="math inline">\(\pi\)</span> estimator of the population mean the sample sum of the observations is not divided by the number of selected units <span class="math inline">\(n\)</span>, but by the expected number of units <span class="math inline">\(E[n]\)</span>.</p>
<p>An alternative estimator is obtained by dividing the <span class="math inline">\(\pi\)</span> estimator of the population total by the <span class="math inline">\(\pi\)</span> estimator of the population size:</p>
<p><span class="math display" id="eq:EstimatorNSY">\[\begin{equation}
\hat{N}=\sum_{k \in \mathcal{S}}\frac{1}{\pi_k} = n \frac{N}{E[n]} \;.
\tag{5.3}
\end{equation}\]</span></p>
<p>This yields the ratio estimator of the population mean:</p>
<p><span class="math display" id="eq:RatioMeanSY">\[\begin{equation}
\hat{\bar{z}}_{\text{ratio}}=\frac{\hat{t}(z)}{\hat{N}} = \frac{1}{n}\sum_{k \in \mathcal{S}}z_k \;.
\tag{5.4}
\end{equation}\]</span></p>
<p>So, the ratio estimator of the population total is equal to the unweighted sample mean. In general, the variance of this ratio estimator is smaller than that of the <span class="math inline">\(\pi\)</span> estimator. On the other hand the <span class="math inline">\(\pi\)</span> estimator is design-unbiased, whereas the ratio estimator is not, although its bias can be negligibly small. Only in the very special case where the sample size with systematic random sampling is fixed, the two estimators are equivalent.</p>
<p>Recall that for Voorst we have exhaustive knowledge of the study variable <span class="math inline">\(z\)</span>: values of the soil organic matter (SOM) concentration were simulated for all grid cells. To determine the <span class="math inline">\(z\)</span>-values at the selected sampling points, an overlay of the systematic random sample and the <code>SpatialPixelsDataFrame</code> is made, using function <code>over</code> of package <strong>sp</strong>.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="SY.html#cb84-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">over</span>(mySYsample, grdVoorst)</span>
<span id="cb84-2"><a href="SY.html#cb84-2" aria-hidden="true" tabindex="-1"></a>mySYsample <span class="ot">&lt;-</span> <span class="fu">as</span>(mySYsample, <span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb84-3"><a href="SY.html#cb84-3" aria-hidden="true" tabindex="-1"></a>mySYsample<span class="sc">$</span>z <span class="ot">&lt;-</span> res<span class="sc">$</span>z</span>
<span id="cb84-4"><a href="SY.html#cb84-4" aria-hidden="true" tabindex="-1"></a>mz_HT <span class="ot">&lt;-</span> <span class="fu">sum</span>(mySYsample<span class="sc">$</span>z) <span class="sc">/</span> n</span>
<span id="cb84-5"><a href="SY.html#cb84-5" aria-hidden="true" tabindex="-1"></a>mz_ratio <span class="ot">&lt;-</span> <span class="fu">mean</span>(mySYsample<span class="sc">$</span>z)</span></code></pre></div>
<p>Using the systematic random sample of Figure <a href="SY.html#fig:sampleSY">5.1</a>, the <span class="math inline">\(\pi\)</span> estimated mean SOM concentration equals 69.8 g kg<sup>-1</sup>, the ratio estimate equals 73.5 g kg<sup>-1</sup>. The ratio estimate is larger than the <span class="math inline">\(\pi\)</span> estimate, because the size of the selected sample is two units smaller (38) than the expected sample size (40).</p>
</div>
<div id="approximating-the-sampling-variance-of-the-estimator-of-the-mean" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Approximating the sampling variance of the estimator of the mean<a href="SY.html#approximating-the-sampling-variance-of-the-estimator-of-the-mean" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An unbiased estimator of the sampling variance of the estimator of the mean is not available. A simple, often applied procedure is to calculate the sampling variance as if the sample were a simple random sample (Equation <a href="SI.html#eq:EstVarMeanSIR">(3.10)</a> or <a href="SI.html#eq:EstVarMeanSI">(3.11)</a>). In general, this procedure overestimates the sampling variance, so that we are on the safe side.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="SY.html#cb85-1" aria-hidden="true" tabindex="-1"></a>av_SI_mz <span class="ot">&lt;-</span> <span class="fu">var</span>(mySYsample<span class="sc">$</span>z) <span class="sc">/</span> <span class="fu">nrow</span>(mySYsample)</span></code></pre></div>
<p>The approximated variance equals 50.3 (g kg<sup>-1</sup>)<sup>2</sup>.</p>
<p>Alternatively, the sampling variance can be estimated by treating the systematic random sample as if it were a stratified simple random sample (Equation <a href="STSI.html#eq:EstVarMeanSTSI">(4.4)</a>). The sampling units are clustered on the basis of their spatial coordinates into <span class="math inline">\(H=n/2\)</span> clusters (<span class="math inline">\(n\)</span> even) or <span class="math inline">\(H=(n-1)/2\)</span> clusters (<span class="math inline">\(n\)</span> odd). In the next code chunk, a simple k-means function is defined to cluster the sampling units of the grid into equal-sized clusters. Arguments <code>s1</code> and <code>s2</code> are the spatial coordinates of the sampling units, <code>k</code> is the number of clusters. First, in this function the ids of equal-sized clusters are randomly assigned to the sampling units on the nodes of the sampling grid (initial clustering). Next, the centres of the clusters, i.e., the means of the spatial coordinates of the clusters (initial cluster centres), are computed. There are two for-loops. In the inner loop it is determined whether the cluster id of the unit selected in the outer loop should be swopped with the cluster id of the next unit. If both units have the same cluster id the next unit is selected, until a unit of a different cluster is found. The cluster ids of the two units are swopped when the sum of the squared distances of the two units to their corresponding cluster centres is reduced. When the cluster ids are swopped, the centres are recomputed. The two loops are repeated until no swops are made anymore.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="SY.html#cb86-1" aria-hidden="true" tabindex="-1"></a>.kmeans_equal_size <span class="ot">&lt;-</span> <span class="cf">function</span>(s1, s2, k) {</span>
<span id="cb86-2"><a href="SY.html#cb86-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(s1)</span>
<span id="cb86-3"><a href="SY.html#cb86-3" aria-hidden="true" tabindex="-1"></a>  cluster_id <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="at">times =</span> <span class="fu">ceiling</span>(n <span class="sc">/</span> k))</span>
<span id="cb86-4"><a href="SY.html#cb86-4" aria-hidden="true" tabindex="-1"></a>  cluster_id <span class="ot">&lt;-</span> cluster_id[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb86-5"><a href="SY.html#cb86-5" aria-hidden="true" tabindex="-1"></a>  cluster_id <span class="ot">&lt;-</span> cluster_id[<span class="fu">sample</span>(n, <span class="at">size =</span> n)]</span>
<span id="cb86-6"><a href="SY.html#cb86-6" aria-hidden="true" tabindex="-1"></a>  s1_c <span class="ot">&lt;-</span> <span class="fu">tapply</span>(s1, <span class="at">INDEX =</span> cluster_id, <span class="at">FUN =</span> mean)</span>
<span id="cb86-7"><a href="SY.html#cb86-7" aria-hidden="true" tabindex="-1"></a>  s2_c <span class="ot">&lt;-</span> <span class="fu">tapply</span>(s2, <span class="at">INDEX =</span> cluster_id, <span class="at">FUN =</span> mean)</span>
<span id="cb86-8"><a href="SY.html#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">repeat</span> {</span>
<span id="cb86-9"><a href="SY.html#cb86-9" aria-hidden="true" tabindex="-1"></a>    n_swop <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb86-10"><a href="SY.html#cb86-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb86-11"><a href="SY.html#cb86-11" aria-hidden="true" tabindex="-1"></a>      ci <span class="ot">&lt;-</span> cluster_id[i]</span>
<span id="cb86-12"><a href="SY.html#cb86-12" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> (i <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb86-13"><a href="SY.html#cb86-13" aria-hidden="true" tabindex="-1"></a>        cj <span class="ot">&lt;-</span> cluster_id[j]</span>
<span id="cb86-14"><a href="SY.html#cb86-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (ci <span class="sc">==</span> cj) {</span>
<span id="cb86-15"><a href="SY.html#cb86-15" aria-hidden="true" tabindex="-1"></a>          <span class="cf">next</span></span>
<span id="cb86-16"><a href="SY.html#cb86-16" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb86-17"><a href="SY.html#cb86-17" aria-hidden="true" tabindex="-1"></a>        d1 <span class="ot">&lt;-</span> (s1[i] <span class="sc">-</span> s1_c[ci])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (s2[i] <span class="sc">-</span> s2_c[ci])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb86-18"><a href="SY.html#cb86-18" aria-hidden="true" tabindex="-1"></a>          (s1[j] <span class="sc">-</span> s1_c[cj])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (s2[j] <span class="sc">-</span> s2_c[cj])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb86-19"><a href="SY.html#cb86-19" aria-hidden="true" tabindex="-1"></a>        d2 <span class="ot">&lt;-</span> (s1[i] <span class="sc">-</span> s1_c[cj])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (s2[i] <span class="sc">-</span> s2_c[cj])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb86-20"><a href="SY.html#cb86-20" aria-hidden="true" tabindex="-1"></a>          (s1[j] <span class="sc">-</span> s1_c[ci])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (s2[j] <span class="sc">-</span> s2_c[ci])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb86-21"><a href="SY.html#cb86-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (d1 <span class="sc">&gt;</span> d2) {</span>
<span id="cb86-22"><a href="SY.html#cb86-22" aria-hidden="true" tabindex="-1"></a>          <span class="co">#swop cluster ids and recompute cluster centres</span></span>
<span id="cb86-23"><a href="SY.html#cb86-23" aria-hidden="true" tabindex="-1"></a>          cluster_id[i] <span class="ot">&lt;-</span> cj; cluster_id[j] <span class="ot">&lt;-</span> ci</span>
<span id="cb86-24"><a href="SY.html#cb86-24" aria-hidden="true" tabindex="-1"></a>          s1_c <span class="ot">&lt;-</span> <span class="fu">tapply</span>(s1, cluster_id, mean)</span>
<span id="cb86-25"><a href="SY.html#cb86-25" aria-hidden="true" tabindex="-1"></a>          s2_c <span class="ot">&lt;-</span> <span class="fu">tapply</span>(s2, cluster_id, mean)</span>
<span id="cb86-26"><a href="SY.html#cb86-26" aria-hidden="true" tabindex="-1"></a>          n_swop <span class="ot">&lt;-</span> n_swop <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb86-27"><a href="SY.html#cb86-27" aria-hidden="true" tabindex="-1"></a>          <span class="cf">break</span></span>
<span id="cb86-28"><a href="SY.html#cb86-28" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb86-29"><a href="SY.html#cb86-29" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb86-30"><a href="SY.html#cb86-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb86-31"><a href="SY.html#cb86-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n_swop <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb86-32"><a href="SY.html#cb86-32" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb86-33"><a href="SY.html#cb86-33" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb86-34"><a href="SY.html#cb86-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb86-35"><a href="SY.html#cb86-35" aria-hidden="true" tabindex="-1"></a>  D <span class="ot">&lt;-</span> fields<span class="sc">::</span><span class="fu">rdist</span>(<span class="at">x1 =</span> <span class="fu">cbind</span>(s1_c, s2_c), <span class="at">x2 =</span> <span class="fu">cbind</span>(s1, s2))</span>
<span id="cb86-36"><a href="SY.html#cb86-36" aria-hidden="true" tabindex="-1"></a>  dmin <span class="ot">&lt;-</span> <span class="fu">apply</span>(D, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> min)</span>
<span id="cb86-37"><a href="SY.html#cb86-37" aria-hidden="true" tabindex="-1"></a>  MSSD <span class="ot">&lt;-</span> <span class="fu">mean</span>(dmin<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb86-38"><a href="SY.html#cb86-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">clusters =</span> cluster_id, <span class="at">MSSD =</span> MSSD)</span>
<span id="cb86-39"><a href="SY.html#cb86-39" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The clustering is repeated 100 times (<code>ntry = 100</code>). The clustering with the smallest mean of the squared distances of the sampling units to their cluster centres (mean squared shortest distance, MSSD) is selected.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="SY.html#cb87-1" aria-hidden="true" tabindex="-1"></a>kmeans_equal_size <span class="ot">&lt;-</span> <span class="cf">function</span>(s1, s2, k, ntry) {</span>
<span id="cb87-2"><a href="SY.html#cb87-2" aria-hidden="true" tabindex="-1"></a>  res_opt <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb87-3"><a href="SY.html#cb87-3" aria-hidden="true" tabindex="-1"></a>  MSSD_min <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb87-4"><a href="SY.html#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ntry) {</span>
<span id="cb87-5"><a href="SY.html#cb87-5" aria-hidden="true" tabindex="-1"></a>      res <span class="ot">&lt;-</span> <span class="fu">.kmeans_equal_size</span>(s1, s2, k)</span>
<span id="cb87-6"><a href="SY.html#cb87-6" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (res<span class="sc">$</span>MSSD <span class="sc">&lt;</span> MSSD_min) {</span>
<span id="cb87-7"><a href="SY.html#cb87-7" aria-hidden="true" tabindex="-1"></a>        MSSD_min <span class="ot">&lt;-</span> res<span class="sc">$</span>MSSD</span>
<span id="cb87-8"><a href="SY.html#cb87-8" aria-hidden="true" tabindex="-1"></a>        res_opt <span class="ot">&lt;-</span> res</span>
<span id="cb87-9"><a href="SY.html#cb87-9" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb87-10"><a href="SY.html#cb87-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-11"><a href="SY.html#cb87-11" aria-hidden="true" tabindex="-1"></a>  res_opt</span>
<span id="cb87-12"><a href="SY.html#cb87-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-13"><a href="SY.html#cb87-13" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mySYsample); k <span class="ot">&lt;-</span> <span class="fu">floor</span>(n <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb87-14"><a href="SY.html#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb87-15"><a href="SY.html#cb87-15" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">kmeans_equal_size</span>(<span class="at">s1 =</span> mySYsample<span class="sc">$</span>x1 <span class="sc">/</span> <span class="dv">1000</span>, <span class="at">s2 =</span> mySYsample<span class="sc">$</span>x2 <span class="sc">/</span> <span class="dv">1000</span>,</span>
<span id="cb87-16"><a href="SY.html#cb87-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> k, <span class="at">ntry =</span> <span class="dv">100</span>)</span>
<span id="cb87-17"><a href="SY.html#cb87-17" aria-hidden="true" tabindex="-1"></a>mySYsample<span class="sc">$</span>cluster <span class="ot">&lt;-</span> res<span class="sc">$</span>clusters</span></code></pre></div>
<p>Figure <a href="SY.html#fig:varapproxSY">5.4</a> shows the clustering of the systematic random sample of Figure <a href="SY.html#fig:sampleSY">5.1</a>. The two or three sampling units of a cluster are treated as a simple random sample from a stratum, and the variance estimator for stratified random sampling is used. The weights are computed by <span class="math inline">\(w_h=n_h/n\)</span>. With <span class="math inline">\(n\)</span> even the stratum weight is <span class="math inline">\(1/H\)</span> for all strata. For more details on variance estimation with stratified simple random sampling, refer to Section <a href="STSI.html#EstimatorsSTSI">4.1</a>.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="SY.html#cb88-1" aria-hidden="true" tabindex="-1"></a>S2z_h <span class="ot">&lt;-</span> <span class="fu">tapply</span>(mySYsample<span class="sc">$</span>z, <span class="at">INDEX =</span> mySYsample<span class="sc">$</span>cluster, <span class="at">FUN =</span> var)</span>
<span id="cb88-2"><a href="SY.html#cb88-2" aria-hidden="true" tabindex="-1"></a>nh <span class="ot">&lt;-</span> <span class="fu">tapply</span>(mySYsample<span class="sc">$</span>z, <span class="at">INDEX =</span> mySYsample<span class="sc">$</span>cluster, <span class="at">FUN =</span> length)</span>
<span id="cb88-3"><a href="SY.html#cb88-3" aria-hidden="true" tabindex="-1"></a>v_mz_h <span class="ot">&lt;-</span> S2z_h <span class="sc">/</span> nh</span>
<span id="cb88-4"><a href="SY.html#cb88-4" aria-hidden="true" tabindex="-1"></a>w_h <span class="ot">&lt;-</span> nh <span class="sc">/</span> <span class="fu">sum</span>(nh)</span>
<span id="cb88-5"><a href="SY.html#cb88-5" aria-hidden="true" tabindex="-1"></a>av_STSI_mz <span class="ot">&lt;-</span> <span class="fu">sum</span>(w_h<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> v_mz_h)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:varapproxSY"></span>
<img src="SpatialSampling_files/figure-html/varapproxSY-1.png" alt="Clustering of grid points for approximating the variance of the ratio estimator of the mean SOM concentration in Voorst." width="100%" />
<p class="caption">
Figure 5.4: Clustering of grid points for approximating the variance of the ratio estimator of the mean SOM concentration in Voorst.
</p>
</div>
<p>This method yields an approximated variance of 51.2 (g kg<sup>-1</sup>)<sup>2</sup>, which is for the selected triangular grid slightly larger than the simple random sample approximation. Hereafter, we will see that on average the stratified simple random sample approximation of the variance is smaller than the simple random sample approximation. For an individual sample, the reverse can be true.</p>
<p>A similar approach for approximating the variance was proposed by Matérn <span class="citation">(<a href="#ref-Matern1947" role="doc-biblioref">Matérn 1947</a>)</span> a long time ago. In this approach the variance is approximated by computing the squared difference of two local means. A local mean is computed by linear interpolation of the observations at the two nodes on the diagonal of a square sampling grid cell. The four corners of a sampling grid cell serve as a group. Every sampling grid node belongs to four groups, and so the observation at a sampling grid node is used four times in computing a local mean. Near the edges of the study area, we have incomplete groups: one, two, or even three observations are missing. To compute a squared difference, these missing values are replaced by the sample mean. This results in as many squared differences as we have groups. Note that the number of groups is larger than the sample size. The squared differences are computed by</p>
<p><span class="math display" id="eq:sqdiflocalmean">\[\begin{equation}
\begin{split}
d^2_{r,s} &amp; = \left(\frac{z_{r,s}+z_{r+1,s+1}}{2}-\frac{z_{r+1,s}+z_{r,s+1}}{2}\right)^2 \\
&amp; =\frac{(z_{r,s}-z_{r+1,s}-z_{r,s+1}+z_{r+1,s+1})^2}{4}\;,
\end{split}
\tag{5.5}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(r = 0,1, \dots ,R\)</span> an index for the column number and <span class="math inline">\(s=0,1, \dots, S\)</span> an index for the row number of the extended grid. The variance of the estimator of the mean (sample mean) is then approximated by the sum of the squared differences divided by the squared sample size:</p>
<p><span class="math display" id="eq:VarMatern">\[\begin{equation}
\widehat{V}(\bar{z}_{\mathcal{S}}) = \frac{\sum_{g=1}^G d^2_g}{n^2}\;,
\tag{5.6}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(d^2_g\)</span> the squared difference of group unit <span class="math inline">\(g\)</span>, and <span class="math inline">\(G\)</span> the total number of groups.</p>
<p>To approximate the variance with Matérn’s method, a function is defined.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="SY.html#cb89-1" aria-hidden="true" tabindex="-1"></a>matern <span class="ot">&lt;-</span> <span class="cf">function</span>(s) {</span>
<span id="cb89-2"><a href="SY.html#cb89-2" aria-hidden="true" tabindex="-1"></a>  g_11 <span class="ot">&lt;-</span> <span class="fu">within</span>(s, {gr <span class="ot">&lt;-</span> i; gs <span class="ot">&lt;-</span> j; z11 <span class="ot">&lt;-</span> z})[, <span class="fu">c</span>(<span class="st">&quot;gr&quot;</span>, <span class="st">&quot;gs&quot;</span>, <span class="st">&quot;z11&quot;</span>)]</span>
<span id="cb89-3"><a href="SY.html#cb89-3" aria-hidden="true" tabindex="-1"></a>  g_12 <span class="ot">&lt;-</span> <span class="fu">within</span>(s, {gr <span class="ot">&lt;-</span> i; gs <span class="ot">&lt;-</span> j <span class="sc">-</span> <span class="dv">1</span>; z12 <span class="ot">&lt;-</span> z})[, <span class="fu">c</span>(<span class="st">&quot;gr&quot;</span>, <span class="st">&quot;gs&quot;</span>, <span class="st">&quot;z12&quot;</span>)]</span>
<span id="cb89-4"><a href="SY.html#cb89-4" aria-hidden="true" tabindex="-1"></a>  g_21 <span class="ot">&lt;-</span> <span class="fu">within</span>(s, {gr <span class="ot">&lt;-</span> i <span class="sc">-</span> <span class="dv">1</span>; gs <span class="ot">&lt;-</span> j; z21 <span class="ot">&lt;-</span> z})[, <span class="fu">c</span>(<span class="st">&quot;gr&quot;</span>, <span class="st">&quot;gs&quot;</span>, <span class="st">&quot;z21&quot;</span>)]</span>
<span id="cb89-5"><a href="SY.html#cb89-5" aria-hidden="true" tabindex="-1"></a>  g_22 <span class="ot">&lt;-</span> <span class="fu">within</span>(s, {gr <span class="ot">&lt;-</span> i <span class="sc">-</span> <span class="dv">1</span>; gs <span class="ot">&lt;-</span> j <span class="sc">-</span> <span class="dv">1</span>; z22 <span class="ot">&lt;-</span> z})[, <span class="fu">c</span>(<span class="st">&quot;gr&quot;</span>, <span class="st">&quot;gs&quot;</span>, <span class="st">&quot;z22&quot;</span>)]</span>
<span id="cb89-6"><a href="SY.html#cb89-6" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="cf">function</span>(x, y) <span class="fu">merge</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;gr&quot;</span>, <span class="st">&quot;gs&quot;</span>), <span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-7"><a href="SY.html#cb89-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">list</span>(g_11, g_12, g_21, g_22))</span>
<span id="cb89-8"><a href="SY.html#cb89-8" aria-hidden="true" tabindex="-1"></a>  g[<span class="fu">is.na</span>(g)] <span class="ot">&lt;-</span> <span class="fu">mean</span>(s<span class="sc">$</span>z)</span>
<span id="cb89-9"><a href="SY.html#cb89-9" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">within</span>(g, T <span class="ot">&lt;-</span> (z11 <span class="sc">-</span> z12 <span class="sc">-</span> z21 <span class="sc">+</span> z22)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>)</span>
<span id="cb89-10"><a href="SY.html#cb89-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(g<span class="sc">$</span>T) <span class="sc">/</span> ((<span class="fu">nrow</span>(s))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb89-11"><a href="SY.html#cb89-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Before using this function the data frame with the sample data must be extended with two variables: an index <span class="math inline">\(i\)</span> for the column number and an index <span class="math inline">\(j\)</span> for the row number of the square grid.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="SY.html#cb90-1" aria-hidden="true" tabindex="-1"></a>mySYsample <span class="ot">&lt;-</span> mySYsample <span class="sc">%&gt;%</span></span>
<span id="cb90-2"><a href="SY.html#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb90-3"><a href="SY.html#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">i =</span> <span class="fu">round</span>((x1 <span class="sc">-</span> <span class="fu">min</span>(x1)) <span class="sc">/</span> spacing),</span>
<span id="cb90-4"><a href="SY.html#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">j =</span> <span class="fu">round</span>((x2 <span class="sc">-</span> <span class="fu">min</span>(x2)) <span class="sc">/</span> spacing))</span>
<span id="cb90-5"><a href="SY.html#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matern</span>(mySYsample)</span></code></pre></div>
<pre><code>[1] 41.63163</code></pre>
<p>Figure <a href="SY.html#fig:SamplingDistributionSY">5.5</a> shows the approximated sampling distributions of estimators of the mean SOM concentration for systematic random sampling, using a randomly placed square grid with fixed orientation and an expected sample size of 40, and for simple random sampling, obtained by repeating the random sampling with each design and estimation 10,000 times. To estimate the population mean from the systematic random samples, both the <span class="math inline">\(\pi\)</span> estimator and the ratio estimator are used.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:SamplingDistributionSY"></span>
<img src="SpatialSampling_files/figure-html/SamplingDistributionSY-1.png" alt="Approximated sampling distribution of estimators of the mean SOM concentration (g kg-1) in Voorst, for systematic random sampling (square grid) and simple random sampling and an expected sample size of 40. With systematic random sampling, both the \(\pi\) estimator (SY.HT) and the ratio estimator (SY.ratio) are used in estimation." width="80%" />
<p class="caption">
Figure 5.5: Approximated sampling distribution of estimators of the mean SOM concentration (g kg<sup>-1</sup>) in Voorst, for systematic random sampling (square grid) and simple random sampling and an expected sample size of 40. With systematic random sampling, both the <span class="math inline">\(\pi\)</span> estimator (SY.HT) and the ratio estimator (SY.ratio) are used in estimation.
</p>
</div>
<p>The boxplots of the estimated means indicate that systematic random sampling in combination with the ratio estimator is more precise than simple random sampling. The variance of the 10,000 ratio estimates equals 49.0 (g kg<sup>-1</sup>)<sup>2</sup>, whereas for simple random sampling this variance equals 55.4 (g kg<sup>-1</sup>)<sup>2</sup>. Systematic random sampling in combination with the <span class="math inline">\(\pi\)</span> estimator performs very poorly: the variance equals 142.6 (g kg<sup>-1</sup>)<sup>2</sup>. This can be explained by the strong variation in sample size (Figure <a href="SY.html#fig:samplesizeSY">5.2</a>), which is not accounted for in the <span class="math inline">\(\pi\)</span> estimator.</p>
<p>The mean of the 10,000 ratio estimates is 81.2 g kg<sup>-1</sup>, which is about equal to the population mean 81.1 g kg<sup>-1</sup>, showing that in this case the design-bias of the ratio estimator is negligibly small indeed.</p>
<p>The average of the 10,000 approximated variances treating the systematic sample as a simple random sample equals 56.4 (g kg<sup>-1</sup>)<sup>2</sup>. This is larger than the variance of the ratio estimator (49.0 (g kg<sup>-1</sup>)<sup>2</sup>). The stratified simple random sample approximation of the variance somewhat underestimates the variance: the mean of this variance approximation equals 47.1 (g kg<sup>-1</sup>)<sup>2</sup>. Also with Matérn’s method, the variance is underestimated in this case: the mean of the 10,000 variances equals 45.6 (g kg<sup>-1</sup>)<sup>2</sup>. Figure <a href="SY.html#fig:SamplingDistributionApproxVarSY">5.6</a> shows boxplots of the approximated standard error of the ratio estimator of the population mean. The horizontal red line is at the standard deviation of the 10,000 ratio estimates of the population mean. Differences between the three approximation methods are small in this case.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:SamplingDistributionApproxVarSY"></span>
<img src="SpatialSampling_files/figure-html/SamplingDistributionApproxVarSY-1.png" alt="Sampling distribution of the approximated standard error of the ratio estimator of the mean SOM concentration (g kg-1) in Voorst, with systematic random sampling (square grid) and an expected sample size of 40. Approximations are obtained by treating the systematic sample as a simple random sample (SI) or a stratified simple random sample (STSI), and with Matérn’s method (Mat)." width="80%" />
<p class="caption">
Figure 5.6: Sampling distribution of the approximated standard error of the ratio estimator of the mean SOM concentration (g kg<sup>-1</sup>) in Voorst, with systematic random sampling (square grid) and an expected sample size of 40. Approximations are obtained by treating the systematic sample as a simple random sample (SI) or a stratified simple random sample (STSI), and with Matérn’s method (Mat).
</p>
</div>
<p>The variance of the 10,000 ratio estimates of the population mean with the triangular grid and an expected sample size of 40 equals 46.9 (g kg<sup>-1</sup>)<sup>2</sup>. Treating the triangular grid as a simple random sample strongly overestimates the variance: the average approximated variance equals 60.1 (g kg<sup>-1</sup>)<sup>2</sup>. The stratified simple random sample approximation performs much better in this case: the average of the 10,000 approximated variances equals 46.8 (g kg<sup>-1</sup>)<sup>2</sup>. Matérn’s method cannot be used to approximate the variance with a triangular grid.</p>
<p>The approximated variance for this clustering equals 90.3.</p>
<p><span class="citation">Brus and Saby (<a href="#ref-Brus2016c" role="doc-biblioref">2016</a>)</span> compared various variance approximations for systematic random sampling, among which model-based prediction of the variance, using a semivariogram that is estimated from the systematic sample, see Chapter <a href="MBpredictionofDesignVariance.html#MBpredictionofDesignVariance">13</a>.</p>
<div id="exercises-8" class="section level4 unnumbered hasAnchor">
<h4>Exercises<a href="SY.html#exercises-8" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>One solution to the problem of variance estimation with systematic random sampling is to select multiple systematic random samples independently from each other. So, for instance, instead of one systematic random sample with an expected sample size of 40, we may select two systematic random samples with an expected size of 20.
<ul>
<li>Write an <strong>R</strong> script to select two systematic random samples (random square grids) both with an expected size of 20 from Voorst.</li>
<li>Use each sample to estimate the population mean, so that you obtain two estimated means. Overlay the points of each sample with <code>grdVoorst</code>, using function <code>over</code> and extract the <span class="math inline">\(z\)</span>-values.</li>
<li>Use the two estimated means to estimate the sampling variance of the estimator of the mean for systematic random sampling <em>with an expected sample size of 20</em>.</li>
<li>Use the two estimated means to compute a single, final estimate of the population mean, as estimated from <em>two systematic random samples, each with an expected sample size of 20</em>.</li>
<li>Estimate the sampling variance of the final estimate of the population mean.<br />
</li>
</ul></li>
<li>Do you like this solution? What about the variance of the estimator of the mean, obtained by selecting two systematic random samples of half the expected size, as compared with the variance of the estimator of the mean, obtained with a single systematic random sample? Hint: plot the two random square grids. What do you think of the spatial coverage of the two samples?</li>
</ol>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Bivand2013" class="csl-entry">
Bivand, Roger S., Edzer Pebesma, and Virgilio Gómez-Rubio. 2013. <em>Applied Spatial Data Analysis with <span>R</span></em>. Second. New York: Springer. <a href="https://asdar-book.org/">https://asdar-book.org/</a>.
</div>
<div id="ref-Brus2016c" class="csl-entry">
Brus, D. J., and N. P. A. Saby. 2016. <span>“<span class="nocase">Approximating the variance of estimated means for systematic random sampling, illustrated with data of the French Soil Monitoring Network</span>.”</span> <em>Geoderma</em> 279: 77–86. https://doi.org/<a href="http://dx.doi.org/10.1016/j.geoderma.2016.05.016">http://dx.doi.org/10.1016/j.geoderma.2016.05.016</a>.
</div>
<div id="ref-Matern1947" class="csl-entry">
Matérn, B. 1947. <span>“Methods of Estimating the Accuracy of Line and Sample Plot Surveys.”</span> <em>Meddelanden Från Statens Skogsforskningsinstitut</em> 36 (1).
</div>
<div id="ref-mat86" class="csl-entry">
———. 1986. <em>Spatial Variation</em>. Second. Vol. 36. Lecture Notes in Statistics. Berlin: Springer-Verlag.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="STSI.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Cl.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/DickBrus/SpatialSamplingwithR/edit/master/05-SY.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SpatialSampling.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
