<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Balanced and well-spread sampling | Spatial sampling with R</title>
  <meta name="description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Balanced and well-spread sampling | Spatial sampling with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.pdf" />
  <meta property="og:description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="github-repo" content="DickBrus/SpatialSamplingwithR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Balanced and well-spread sampling | Spatial sampling with R" />
  
  <meta name="twitter:description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="twitter:image" content="/images/cover.pdf" />

<meta name="author" content="Dick J. Brus" />


<meta name="date" content="2023-06-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pps.html"/>
<link rel="next" href="Modelassisted.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial sampling with R</a></li>

<li class="divider"></li>
<li><a href="index.html#preface" id="toc-preface">Preface</a>
<ul>
<li><a href="index.html#acknowledgments" id="toc-acknowledgments">Acknowledgments</a></li>
</ul></li>
<li><a href="GeneralIntro.html#GeneralIntro" id="toc-GeneralIntro"><span class="toc-section-number">1</span> Introduction</a>
<ul>
<li><a href="GeneralIntro.html#BasicConcepts" id="toc-BasicConcepts"><span class="toc-section-number">1.1</span> Basic sampling concepts</a>
<ul>
<li><a href="GeneralIntro.html#PopulationParameters" id="toc-PopulationParameters"><span class="toc-section-number">1.1.1</span> Population parameters</a></li>
<li><a href="GeneralIntro.html#descriptive-statistics-vs.-inference-about-a-population" id="toc-descriptive-statistics-vs.-inference-about-a-population"><span class="toc-section-number">1.1.2</span> Descriptive statistics vs. inference about a population</a></li>
<li><a href="GeneralIntro.html#random-sampling-vs.-probability-sampling" id="toc-random-sampling-vs.-probability-sampling"><span class="toc-section-number">1.1.3</span> Random sampling vs. probability sampling</a></li>
</ul></li>
<li><a href="GeneralIntro.html#DBvsMB" id="toc-DBvsMB"><span class="toc-section-number">1.2</span> Design-based vs. model-based approach</a></li>
<li><a href="GeneralIntro.html#Datasets" id="toc-Datasets"><span class="toc-section-number">1.3</span> Populations used in sampling experiments</a>
<ul>
<li><a href="GeneralIntro.html#Voorst" id="toc-Voorst"><span class="toc-section-number">1.3.1</span> Soil organic matter in Voorst, the Netherlands</a></li>
<li><a href="GeneralIntro.html#Poppy" id="toc-Poppy"><span class="toc-section-number">1.3.2</span> Poppy fields in Kandahar, Afghanistan</a></li>
<li><a href="GeneralIntro.html#Amazonia" id="toc-Amazonia"><span class="toc-section-number">1.3.3</span> Aboveground biomass in Eastern Amazonia, Brazil</a></li>
<li><a href="GeneralIntro.html#TASIberia" id="toc-TASIberia"><span class="toc-section-number">1.3.4</span> Annual mean air temperature in Iberia</a></li>
</ul></li>
</ul></li>
<li><a href="#part-probability-sampling-for-estimating-population-parameters" id="toc-part-probability-sampling-for-estimating-population-parameters">(PART) Probability sampling for estimating population parameters</a></li>
<li><a href="IntroProbabilitySampling.html#IntroProbabilitySampling" id="toc-IntroProbabilitySampling"><span class="toc-section-number">2</span> Introduction to probability sampling</a>
<ul>
<li><a href="IntroProbabilitySampling.html#arbitrary-haphazard-sampling-vs.-probability-sampling" id="toc-arbitrary-haphazard-sampling-vs.-probability-sampling">Arbitrary (haphazard) sampling vs. probability sampling</a></li>
<li><a href="IntroProbabilitySampling.html#HTestimator" id="toc-HTestimator"><span class="toc-section-number">2.1</span> Horvitz-Thompson estimator</a></li>
<li><a href="IntroProbabilitySampling.html#hansen-hurwitz-estimator" id="toc-hansen-hurwitz-estimator"><span class="toc-section-number">2.2</span> Hansen-Hurwitz estimator</a></li>
<li><a href="IntroProbabilitySampling.html#using-models-in-design-based-approach" id="toc-using-models-in-design-based-approach"><span class="toc-section-number">2.3</span> Using models in design-based approach</a></li>
</ul></li>
<li><a href="SI.html#SI" id="toc-SI"><span class="toc-section-number">3</span> Simple random sampling</a>
<ul>
<li><a href="SI.html#HTestimatorSI" id="toc-HTestimatorSI"><span class="toc-section-number">3.1</span> Estimation of population parameters</a>
<ul>
<li><a href="SI.html#PopProportion" id="toc-PopProportion"><span class="toc-section-number">3.1.1</span> Population proportion</a></li>
<li><a href="SI.html#CDF" id="toc-CDF"><span class="toc-section-number">3.1.2</span> Cumulative distribution function and quantiles</a></li>
</ul></li>
<li><a href="SI.html#VarMeanSI" id="toc-VarMeanSI"><span class="toc-section-number">3.2</span> Sampling variance of estimator of population parameters</a></li>
<li><a href="SI.html#ConfidenceInterval" id="toc-ConfidenceInterval"><span class="toc-section-number">3.3</span> Confidence interval estimate</a>
<ul>
<li><a href="SI.html#ConfidenceIntervalProportion" id="toc-ConfidenceIntervalProportion"><span class="toc-section-number">3.3.1</span> Confidence interval for a proportion</a></li>
</ul></li>
<li><a href="SI.html#SIcircularplots" id="toc-SIcircularplots"><span class="toc-section-number">3.4</span> Simple random sampling of circular plots</a>
<ul>
<li><a href="SI.html#sampling-from-a-finite-set-of-fixed-circles" id="toc-sampling-from-a-finite-set-of-fixed-circles"><span class="toc-section-number">3.4.1</span> Sampling from a finite set of fixed circles</a></li>
<li><a href="SI.html#sampling-from-an-infinite-set-of-floating-circles" id="toc-sampling-from-an-infinite-set-of-floating-circles"><span class="toc-section-number">3.4.2</span> Sampling from an infinite set of floating circles</a></li>
</ul></li>
</ul></li>
<li><a href="STSI.html#STSI" id="toc-STSI"><span class="toc-section-number">4</span> Stratified simple random sampling</a>
<ul>
<li><a href="STSI.html#EstimatorsSTSI" id="toc-EstimatorsSTSI"><span class="toc-section-number">4.1</span> Estimation of population parameters</a>
<ul>
<li><a href="STSI.html#population-proportion-cumulative-distribution-function-and-quantiles" id="toc-population-proportion-cumulative-distribution-function-and-quantiles"><span class="toc-section-number">4.1.1</span> Population proportion, cumulative distribution function, and quantiles</a></li>
<li><a href="STSI.html#WhyStratify" id="toc-WhyStratify"><span class="toc-section-number">4.1.2</span> Why should we stratify?</a></li>
</ul></li>
<li><a href="STSI.html#CISTSI" id="toc-CISTSI"><span class="toc-section-number">4.2</span> Confidence interval estimate</a></li>
<li><a href="STSI.html#STSIallocation" id="toc-STSIallocation"><span class="toc-section-number">4.3</span> Allocation of sample size to strata</a></li>
<li><a href="STSI.html#cumrootf" id="toc-cumrootf"><span class="toc-section-number">4.4</span> <em>Cum-root-f</em> stratification</a></li>
<li><a href="STSI.html#kmeansstratification" id="toc-kmeansstratification"><span class="toc-section-number">4.5</span> Stratification with multiple covariates</a></li>
<li><a href="STSI.html#geostrata" id="toc-geostrata"><span class="toc-section-number">4.6</span> Geographical stratification</a></li>
<li><a href="STSI.html#multiway-stratification" id="toc-multiway-stratification"><span class="toc-section-number">4.7</span> Multiway stratification</a></li>
<li><a href="STSI.html#MultivariateStratification" id="toc-MultivariateStratification"><span class="toc-section-number">4.8</span> Multivariate stratification</a></li>
</ul></li>
<li><a href="SY.html#SY" id="toc-SY"><span class="toc-section-number">5</span> Systematic random sampling</a>
<ul>
<li><a href="SY.html#EstVarSY" id="toc-EstVarSY"><span class="toc-section-number">5.1</span> Estimation of population parameters</a></li>
<li><a href="SY.html#approximating-the-sampling-variance-of-the-estimator-of-the-mean" id="toc-approximating-the-sampling-variance-of-the-estimator-of-the-mean"><span class="toc-section-number">5.2</span> Approximating the sampling variance of the estimator of the mean</a></li>
</ul></li>
<li><a href="Cl.html#Cl" id="toc-Cl"><span class="toc-section-number">6</span> Cluster random sampling</a>
<ul>
<li><a href="Cl.html#clustersamplingestimators" id="toc-clustersamplingestimators"><span class="toc-section-number">6.1</span> Estimation of population parameters</a></li>
<li><a href="Cl.html#clusters-selected-with-probabilities-proportional-to-size-without-replacement" id="toc-clusters-selected-with-probabilities-proportional-to-size-without-replacement"><span class="toc-section-number">6.2</span> Clusters selected with probabilities proportional to size, without replacement</a></li>
<li><a href="Cl.html#SIC" id="toc-SIC"><span class="toc-section-number">6.3</span> Simple random sampling of clusters</a></li>
<li><a href="Cl.html#StratifiedCl" id="toc-StratifiedCl"><span class="toc-section-number">6.4</span> Stratified cluster random sampling</a></li>
</ul></li>
<li><a href="Twostage.html#Twostage" id="toc-Twostage"><span class="toc-section-number">7</span> Two-stage cluster random sampling</a>
<ul>
<li><a href="Twostage.html#twostagesamplingestimators" id="toc-twostagesamplingestimators"><span class="toc-section-number">7.1</span> Estimation of population parameters</a></li>
<li><a href="Twostage.html#primary-sampling-units-selected-without-replacement" id="toc-primary-sampling-units-selected-without-replacement"><span class="toc-section-number">7.2</span> Primary sampling units selected without replacement</a></li>
<li><a href="Twostage.html#TwostageSISI" id="toc-TwostageSISI"><span class="toc-section-number">7.3</span> Simple random sampling of primary sampling units</a></li>
<li><a href="Twostage.html#StratifiedTwostage" id="toc-StratifiedTwostage"><span class="toc-section-number">7.4</span> Stratified two-stage cluster random sampling</a></li>
</ul></li>
<li><a href="pps.html#pps" id="toc-pps"><span class="toc-section-number">8</span> Sampling with probabilities proportional to size</a>
<ul>
<li><a href="pps.html#ppswr" id="toc-ppswr"><span class="toc-section-number">8.1</span> Probability-proportional-to-size sampling with replacement</a></li>
<li><a href="pps.html#ppswor" id="toc-ppswor"><span class="toc-section-number">8.2</span> Probability-proportional-to-size sampling without replacement</a>
<ul>
<li><a href="pps.html#Systematicpps" id="toc-Systematicpps"><span class="toc-section-number">8.2.1</span> Systematic pps sampling without replacement</a></li>
<li><a href="pps.html#pivotalmethod" id="toc-pivotalmethod"><span class="toc-section-number">8.2.2</span> The pivotal method</a></li>
</ul></li>
</ul></li>
<li><a href="BalancedSpreaded.html#BalancedSpreaded" id="toc-BalancedSpreaded"><span class="toc-section-number">9</span> Balanced and well-spread sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#Balanced" id="toc-Balanced"><span class="toc-section-number">9.1</span> Balanced sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#balanced-sample-vs.-balanced-sampling-design" id="toc-balanced-sample-vs.-balanced-sampling-design"><span class="toc-section-number">9.1.1</span> Balanced sample vs. balanced sampling design</a></li>
<li><a href="BalancedSpreaded.html#unequal-inclusion-probabilities" id="toc-unequal-inclusion-probabilities"><span class="toc-section-number">9.1.2</span> Unequal inclusion probabilities</a></li>
<li><a href="BalancedSpreaded.html#StratifiedsamplingasBalancedsampling" id="toc-StratifiedsamplingasBalancedsampling"><span class="toc-section-number">9.1.3</span> Stratified random sampling</a></li>
<li><a href="BalancedSpreaded.html#Multiwaystratification" id="toc-Multiwaystratification"><span class="toc-section-number">9.1.4</span> Multiway stratification</a></li>
</ul></li>
<li><a href="BalancedSpreaded.html#Spreaded" id="toc-Spreaded"><span class="toc-section-number">9.2</span> Well-spread sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#LPM" id="toc-LPM"><span class="toc-section-number">9.2.1</span> Local pivotal method</a></li>
<li><a href="BalancedSpreaded.html#GRTS" id="toc-GRTS"><span class="toc-section-number">9.2.2</span> Generalised random-tessellation stratified sampling</a></li>
</ul></li>
<li><a href="BalancedSpreaded.html#BalancedandSpreaded" id="toc-BalancedandSpreaded"><span class="toc-section-number">9.3</span> Balanced sampling with spreading</a></li>
</ul></li>
<li><a href="Modelassisted.html#Modelassisted" id="toc-Modelassisted"><span class="toc-section-number">10</span> Model-assisted estimation</a>
<ul>
<li><a href="Modelassisted.html#GREG" id="toc-GREG"><span class="toc-section-number">10.1</span> Generalised regression estimator</a>
<ul>
<li><a href="Modelassisted.html#RegressionEstimator" id="toc-RegressionEstimator"><span class="toc-section-number">10.1.1</span> Simple and multiple regression estimators</a></li>
<li><a href="Modelassisted.html#penalised-least-squares-estimation" id="toc-penalised-least-squares-estimation"><span class="toc-section-number">10.1.2</span> Penalised least squares estimation</a></li>
<li><a href="Modelassisted.html#RegressionEstimatorSTSI" id="toc-RegressionEstimatorSTSI"><span class="toc-section-number">10.1.3</span> Regression estimator with stratified simple random sampling</a></li>
</ul></li>
<li><a href="Modelassisted.html#RatioEstimator" id="toc-RatioEstimator"><span class="toc-section-number">10.2</span> Ratio estimator</a>
<ul>
<li><a href="Modelassisted.html#RatioEstimatorSTSI" id="toc-RatioEstimatorSTSI"><span class="toc-section-number">10.2.1</span> Ratio estimators with stratified simple random sampling</a></li>
</ul></li>
<li><a href="Modelassisted.html#PoststratifiedEstimator" id="toc-PoststratifiedEstimator"><span class="toc-section-number">10.3</span> Poststratified estimator</a></li>
<li><a href="Modelassisted.html#RandomForest" id="toc-RandomForest"><span class="toc-section-number">10.4</span> Model-assisted estimation using machine learning techniques</a>
<ul>
<li><a href="Modelassisted.html#predicting-with-a-regression-tree" id="toc-predicting-with-a-regression-tree"><span class="toc-section-number">10.4.1</span> Predicting with a regression tree</a></li>
<li><a href="Modelassisted.html#predicting-with-a-random-forest" id="toc-predicting-with-a-random-forest"><span class="toc-section-number">10.4.2</span> Predicting with a random forest</a></li>
</ul></li>
<li><a href="Modelassisted.html#big-data-and-volunteer-data" id="toc-big-data-and-volunteer-data"><span class="toc-section-number">10.5</span> Big data and volunteer data</a></li>
</ul></li>
<li><a href="Twophase.html#Twophase" id="toc-Twophase"><span class="toc-section-number">11</span> Two-phase random sampling</a>
<ul>
<li><a href="Twophase.html#TwophaseStratification" id="toc-TwophaseStratification"><span class="toc-section-number">11.1</span> Two-phase random sampling for stratification</a></li>
<li><a href="Twophase.html#TwophaseRegression" id="toc-TwophaseRegression"><span class="toc-section-number">11.2</span> Two-phase random sampling for regression</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#RequiredSampleSize" id="toc-RequiredSampleSize"><span class="toc-section-number">12</span> Computing the required sample size</a>
<ul>
<li><a href="RequiredSampleSize.html#standard-error" id="toc-standard-error"><span class="toc-section-number">12.1</span> Standard error</a></li>
<li><a href="RequiredSampleSize.html#ReqSampleSizeLengthCI" id="toc-ReqSampleSizeLengthCI"><span class="toc-section-number">12.2</span> Length of confidence interval</a>
<ul>
<li><a href="RequiredSampleSize.html#length-of-confidence-interval-for-a-proportion" id="toc-length-of-confidence-interval-for-a-proportion"><span class="toc-section-number">12.2.1</span> Length of confidence interval for a proportion</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#statistical-testing-of-hypothesis" id="toc-statistical-testing-of-hypothesis"><span class="toc-section-number">12.3</span> Statistical testing of hypothesis</a>
<ul>
<li><a href="RequiredSampleSize.html#sample-size-for-testing-a-proportion" id="toc-sample-size-for-testing-a-proportion"><span class="toc-section-number">12.3.1</span> Sample size for testing a proportion</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#DesignEffect" id="toc-DesignEffect"><span class="toc-section-number">12.4</span> Accounting for design effect</a></li>
<li><a href="RequiredSampleSize.html#BayesianSampleSize" id="toc-BayesianSampleSize"><span class="toc-section-number">12.5</span> Bayesian sample size determination</a>
<ul>
<li><a href="RequiredSampleSize.html#bayesian-criteria-for-sample-size-computation" id="toc-bayesian-criteria-for-sample-size-computation"><span class="toc-section-number">12.5.1</span> Bayesian criteria for sample size computation</a></li>
<li><a href="RequiredSampleSize.html#mixed-bayesian-likelihood-approach" id="toc-mixed-bayesian-likelihood-approach"><span class="toc-section-number">12.5.2</span> Mixed Bayesian-likelihood approach</a></li>
<li><a href="RequiredSampleSize.html#estimation-of-population-mean" id="toc-estimation-of-population-mean"><span class="toc-section-number">12.5.3</span> Estimation of population mean</a></li>
<li><a href="RequiredSampleSize.html#estimation-of-a-population-proportion" id="toc-estimation-of-a-population-proportion"><span class="toc-section-number">12.5.4</span> Estimation of a population proportion</a></li>
</ul></li>
</ul></li>
<li><a href="MBpredictionofDesignVariance.html#MBpredictionofDesignVariance" id="toc-MBpredictionofDesignVariance"><span class="toc-section-number">13</span> Model-based optimisation of probability sampling designs</a>
<ul>
<li><a href="MBpredictionofDesignVariance.html#model-based-optimisation-of-sampling-design-type-and-sample-size" id="toc-model-based-optimisation-of-sampling-design-type-and-sample-size"><span class="toc-section-number">13.1</span> Model-based optimisation of sampling design type and sample size</a>
<ul>
<li><a href="MBpredictionofDesignVariance.html#AnalyticalApproach" id="toc-AnalyticalApproach"><span class="toc-section-number">13.1.1</span> Analytical approach</a></li>
<li><a href="MBpredictionofDesignVariance.html#GeostatisticalSimulationApproach" id="toc-GeostatisticalSimulationApproach"><span class="toc-section-number">13.1.2</span> Geostatistical simulation approach</a></li>
<li><a href="MBpredictionofDesignVariance.html#MBpredSamplingVarBayes" id="toc-MBpredSamplingVarBayes"><span class="toc-section-number">13.1.3</span> Bayesian approach</a></li>
</ul></li>
<li><a href="MBpredictionofDesignVariance.html#Ospats" id="toc-Ospats"><span class="toc-section-number">13.2</span> Model-based optimisation of spatial strata</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#SmallAreaEstimation" id="toc-SmallAreaEstimation"><span class="toc-section-number">14</span> Sampling for estimating parameters of domains</a>
<ul>
<li><a href="SmallAreaEstimation.html#LargeDomainsDirectEstimator" id="toc-LargeDomainsDirectEstimator"><span class="toc-section-number">14.1</span> Direct estimator for large domains</a></li>
<li><a href="SmallAreaEstimation.html#SmallDomainsModelAssisted" id="toc-SmallDomainsModelAssisted"><span class="toc-section-number">14.2</span> Model-assisted estimators for small domains</a>
<ul>
<li><a href="SmallAreaEstimation.html#RegressionestimatorSmallDomain" id="toc-RegressionestimatorSmallDomain"><span class="toc-section-number">14.2.1</span> Regression estimator</a></li>
<li><a href="SmallAreaEstimation.html#SyntheticestimatorSmallDomain" id="toc-SyntheticestimatorSmallDomain"><span class="toc-section-number">14.2.2</span> Synthetic estimator</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#SmallAreaModelBased" id="toc-SmallAreaModelBased"><span class="toc-section-number">14.3</span> Model-based prediction</a>
<ul>
<li><a href="SmallAreaEstimation.html#random-intercept-model" id="toc-random-intercept-model"><span class="toc-section-number">14.3.1</span> Random intercept model</a></li>
<li><a href="SmallAreaEstimation.html#geostatistical-model" id="toc-geostatistical-model"><span class="toc-section-number">14.3.2</span> Geostatistical model</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#supplemental-probability-sampling-of-small-domains" id="toc-supplemental-probability-sampling-of-small-domains"><span class="toc-section-number">14.4</span> Supplemental probability sampling of small domains</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#RepeatedSurveys" id="toc-RepeatedSurveys"><span class="toc-section-number">15</span> Repeated sample surveys for monitoring population parameters</a>
<ul>
<li><a href="RepeatedSurveys.html#space-time-designs" id="toc-space-time-designs"><span class="toc-section-number">15.1</span> Space-time designs</a></li>
<li><a href="RepeatedSurveys.html#SpaceTimeparameters" id="toc-SpaceTimeparameters"><span class="toc-section-number">15.2</span> Space-time population parameters</a></li>
<li><a href="RepeatedSurveys.html#design-based-generalised-least-squares-estimation-of-spatial-means" id="toc-design-based-generalised-least-squares-estimation-of-spatial-means"><span class="toc-section-number">15.3</span> Design-based generalised least squares estimation of spatial means</a>
<ul>
<li><a href="RepeatedSurveys.html#current-mean" id="toc-current-mean"><span class="toc-section-number">15.3.1</span> Current mean</a></li>
<li><a href="RepeatedSurveys.html#change-of-the-spatial-mean" id="toc-change-of-the-spatial-mean"><span class="toc-section-number">15.3.2</span> Change of the spatial mean</a></li>
<li><a href="RepeatedSurveys.html#temporal-trend-of-the-spatial-mean" id="toc-temporal-trend-of-the-spatial-mean"><span class="toc-section-number">15.3.3</span> Temporal trend of the spatial mean</a></li>
<li><a href="RepeatedSurveys.html#space-time-mean" id="toc-space-time-mean"><span class="toc-section-number">15.3.4</span> Space-time mean</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#case-study-annual-mean-daily-temperature-in-iberia" id="toc-case-study-annual-mean-daily-temperature-in-iberia"><span class="toc-section-number">15.4</span> Case study: annual mean daily temperature in Iberia</a>
<ul>
<li><a href="RepeatedSurveys.html#static-synchronous-design" id="toc-static-synchronous-design"><span class="toc-section-number">15.4.1</span> Static-synchronous design</a></li>
<li><a href="RepeatedSurveys.html#independent-synchronous-design" id="toc-independent-synchronous-design"><span class="toc-section-number">15.4.2</span> Independent synchronous design</a></li>
<li><a href="RepeatedSurveys.html#serially-alternating-design" id="toc-serially-alternating-design"><span class="toc-section-number">15.4.3</span> Serially alternating design</a></li>
<li><a href="RepeatedSurveys.html#supplemented-panel-design" id="toc-supplemented-panel-design"><span class="toc-section-number">15.4.4</span> Supplemented panel design</a></li>
<li><a href="RepeatedSurveys.html#rotating-panel-design" id="toc-rotating-panel-design"><span class="toc-section-number">15.4.5</span> Rotating panel design</a></li>
<li><a href="RepeatedSurveys.html#sampling-experiment" id="toc-sampling-experiment"><span class="toc-section-number">15.4.6</span> Sampling experiment</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#space-time-sampling-with-stratified-random-sampling-in-space" id="toc-space-time-sampling-with-stratified-random-sampling-in-space"><span class="toc-section-number">15.5</span> Space-time sampling with stratified random sampling in space</a></li>
</ul></li>
<li><a href="#part-sampling-for-mapping" id="toc-part-sampling-for-mapping">(PART) Sampling for mapping</a></li>
<li><a href="IntroSamplingforMapping.html#IntroSamplingforMapping" id="toc-IntroSamplingforMapping"><span class="toc-section-number">16</span> Introduction to sampling for mapping</a>
<ul>
<li><a href="IntroSamplingforMapping.html#when-is-probability-sampling-not-required" id="toc-when-is-probability-sampling-not-required"><span class="toc-section-number">16.1</span> When is probability sampling not required?</a></li>
<li><a href="IntroSamplingforMapping.html#sampling-for-simultaneously-mapping-and-estimating-means" id="toc-sampling-for-simultaneously-mapping-and-estimating-means"><span class="toc-section-number">16.2</span> Sampling for simultaneously mapping and estimating means</a></li>
<li><a href="IntroSamplingforMapping.html#broad-overview-of-sampling-designs-for-mapping" id="toc-broad-overview-of-sampling-designs-for-mapping"><span class="toc-section-number">16.3</span> Broad overview of sampling designs for mapping</a></li>
</ul></li>
<li><a href="RegularGridSpatialCoverage.html#RegularGridSpatialCoverage" id="toc-RegularGridSpatialCoverage"><span class="toc-section-number">17</span> Regular grid and spatial coverage sampling</a>
<ul>
<li><a href="RegularGridSpatialCoverage.html#Regulargrid" id="toc-Regulargrid"><span class="toc-section-number">17.1</span> Regular grid sampling</a></li>
<li><a href="RegularGridSpatialCoverage.html#SpatialCoverage" id="toc-SpatialCoverage"><span class="toc-section-number">17.2</span> Spatial coverage sampling</a></li>
<li><a href="RegularGridSpatialCoverage.html#SpatialInfill" id="toc-SpatialInfill"><span class="toc-section-number">17.3</span> Spatial infill sampling</a></li>
</ul></li>
<li><a href="kmeans.html#kmeans" id="toc-kmeans"><span class="toc-section-number">18</span> Covariate space coverage sampling</a>
<ul>
<li><a href="kmeans.html#covariate-space-infill-sampling" id="toc-covariate-space-infill-sampling"><span class="toc-section-number">18.1</span> Covariate space infill sampling</a></li>
<li><a href="kmeans.html#PerformanceCSC" id="toc-PerformanceCSC"><span class="toc-section-number">18.2</span> Performance of covariate space coverage sampling in random forest prediction</a></li>
</ul></li>
<li><a href="cLHS.html#cLHS" id="toc-cLHS"><span class="toc-section-number">19</span> Conditioned Latin hypercube sampling</a>
<ul>
<li><a href="cLHS.html#cLHIS" id="toc-cLHIS"><span class="toc-section-number">19.1</span> Conditioned Latin hypercube infill sampling</a></li>
<li><a href="cLHS.html#performance-of-conditioned-latin-hypercube-sampling-in-random-forest-prediction" id="toc-performance-of-conditioned-latin-hypercube-sampling-in-random-forest-prediction"><span class="toc-section-number">19.2</span> Performance of conditioned Latin hypercube sampling in random forest prediction</a></li>
</ul></li>
<li><a href="SpatialResponseSurface.html#SpatialResponseSurface" id="toc-SpatialResponseSurface"><span class="toc-section-number">20</span> Spatial response surface sampling</a>
<ul>
<li><a href="SpatialResponseSurface.html#IncreaseSampleSize" id="toc-IncreaseSampleSize"><span class="toc-section-number">20.1</span> Increasing the sample size</a></li>
<li><a href="SpatialResponseSurface.html#stratified-spatial-response-surface-sampling" id="toc-stratified-spatial-response-surface-sampling"><span class="toc-section-number">20.2</span> Stratified spatial response surface sampling</a></li>
<li><a href="SpatialResponseSurface.html#mapping" id="toc-mapping"><span class="toc-section-number">20.3</span> Mapping</a></li>
</ul></li>
<li><a href="Introkriging.html#Introkriging" id="toc-Introkriging"><span class="toc-section-number">21</span> Introduction to kriging</a>
<ul>
<li><a href="Introkriging.html#OrdinaryKriging" id="toc-OrdinaryKriging"><span class="toc-section-number">21.1</span> Ordinary kriging</a></li>
<li><a href="Introkriging.html#BlockKriging" id="toc-BlockKriging"><span class="toc-section-number">21.2</span> Block-kriging</a></li>
<li><a href="Introkriging.html#IntroKED" id="toc-IntroKED"><span class="toc-section-number">21.3</span> Kriging with an external drift</a></li>
<li><a href="Introkriging.html#VariogramEstimation" id="toc-VariogramEstimation"><span class="toc-section-number">21.4</span> Estimating the semivariogram</a>
<ul>
<li><a href="Introkriging.html#MoM" id="toc-MoM"><span class="toc-section-number">21.4.1</span> Method-of-moments</a></li>
<li><a href="Introkriging.html#MLestimationVariogram" id="toc-MLestimationVariogram"><span class="toc-section-number">21.4.2</span> Maximum likelihood</a></li>
</ul></li>
<li><a href="Introkriging.html#ResidualVariogram" id="toc-ResidualVariogram"><span class="toc-section-number">21.5</span> Estimating the residual semivariogram</a>
<ul>
<li><a href="Introkriging.html#IterativeMoM" id="toc-IterativeMoM"><span class="toc-section-number">21.5.1</span> Iterative method-of-moments</a></li>
<li><a href="Introkriging.html#REML" id="toc-REML"><span class="toc-section-number">21.5.2</span> Restricted maximum likelihood</a></li>
</ul></li>
</ul></li>
<li><a href="MBgridspacing.html#MBgridspacing" id="toc-MBgridspacing"><span class="toc-section-number">22</span> Model-based optimisation of the grid spacing</a>
<ul>
<li><a href="MBgridspacing.html#GridspacingOK" id="toc-GridspacingOK"><span class="toc-section-number">22.1</span> Optimal grid spacing for ordinary kriging</a></li>
<li><a href="MBgridspacing.html#controlling-the-mean-or-a-quantile-of-the-ordinary-kriging-variance" id="toc-controlling-the-mean-or-a-quantile-of-the-ordinary-kriging-variance"><span class="toc-section-number">22.2</span> Controlling the mean or a quantile of the ordinary kriging variance</a></li>
<li><a href="MBgridspacing.html#optimal-grid-spacing-for-block-kriging" id="toc-optimal-grid-spacing-for-block-kriging"><span class="toc-section-number">22.3</span> Optimal grid spacing for block-kriging</a></li>
<li><a href="MBgridspacing.html#MBgridspacingKED" id="toc-MBgridspacingKED"><span class="toc-section-number">22.4</span> Optimal grid spacing for kriging with an external drift</a></li>
<li><a href="MBgridspacing.html#BayesianGridSpacing" id="toc-BayesianGridSpacing"><span class="toc-section-number">22.5</span> Bayesian approach</a></li>
</ul></li>
<li><a href="MBSamplePattern.html#MBSamplePattern" id="toc-MBSamplePattern"><span class="toc-section-number">23</span> Model-based optimisation of the sampling pattern</a>
<ul>
<li><a href="MBSamplePattern.html#SSA" id="toc-SSA"><span class="toc-section-number">23.1</span> Spatial simulated annealing</a></li>
<li><a href="MBSamplePattern.html#SamplePatternOK" id="toc-SamplePatternOK"><span class="toc-section-number">23.2</span> Optimising the sampling pattern for ordinary kriging</a></li>
<li><a href="MBSamplePattern.html#SamplePatternKED" id="toc-SamplePatternKED"><span class="toc-section-number">23.3</span> Optimising the sampling pattern for kriging with an external drift</a></li>
<li><a href="MBSamplePattern.html#model-based-infill-sampling-for-ordinary-kriging" id="toc-model-based-infill-sampling-for-ordinary-kriging"><span class="toc-section-number">23.4</span> Model-based infill sampling for ordinary kriging</a></li>
<li><a href="MBSamplePattern.html#model-based-infill-sampling-for-kriging-with-an-external-drift" id="toc-model-based-infill-sampling-for-kriging-with-an-external-drift"><span class="toc-section-number">23.5</span> Model-based infill sampling for kriging with an external drift</a></li>
</ul></li>
<li><a href="SamplingVariogram.html#SamplingVariogram" id="toc-SamplingVariogram"><span class="toc-section-number">24</span> Sampling for estimating the semivariogram</a>
<ul>
<li><a href="SamplingVariogram.html#NestedSampling" id="toc-NestedSampling"><span class="toc-section-number">24.1</span> Nested sampling</a></li>
<li><a href="SamplingVariogram.html#IndependentSamplingPairs" id="toc-IndependentSamplingPairs"><span class="toc-section-number">24.2</span> Independent sampling of pairs of points</a></li>
<li><a href="SamplingVariogram.html#samplingforvariogram" id="toc-samplingforvariogram"><span class="toc-section-number">24.3</span> Optimisation of sampling pattern for semivariogram estimation</a>
<ul>
<li><a href="SamplingVariogram.html#UncertainSemivariogramParameters" id="toc-UncertainSemivariogramParameters"><span class="toc-section-number">24.3.1</span> Uncertainty about semivariogram parameters</a></li>
<li><a href="SamplingVariogram.html#UncertainKrigingVariance" id="toc-UncertainKrigingVariance"><span class="toc-section-number">24.3.2</span> Uncertainty about the kriging variance</a></li>
</ul></li>
<li><a href="SamplingVariogram.html#SamplingEstimationandPrediction" id="toc-SamplingEstimationandPrediction"><span class="toc-section-number">24.4</span> Optimisation of sampling pattern for semivariogram estimation and mapping</a></li>
<li><a href="SamplingVariogram.html#a-practical-solution" id="toc-a-practical-solution"><span class="toc-section-number">24.5</span> A practical solution</a></li>
</ul></li>
<li><a href="Validation.html#Validation" id="toc-Validation"><span class="toc-section-number">25</span> Sampling for validation of maps</a>
<ul>
<li><a href="Validation.html#map-quality-indices" id="toc-map-quality-indices"><span class="toc-section-number">25.1</span> Map quality indices</a>
<ul>
<li><a href="Validation.html#estimation-of-map-quality-indices" id="toc-estimation-of-map-quality-indices"><span class="toc-section-number">25.1.1</span> Estimation of map quality indices</a></li>
</ul></li>
<li><a href="Validation.html#real-world-case-study" id="toc-real-world-case-study"><span class="toc-section-number">25.2</span> Real-world case study</a>
<ul>
<li><a href="Validation.html#estimation-of-the-population-mean-error-and-mean-squared-error" id="toc-estimation-of-the-population-mean-error-and-mean-squared-error"><span class="toc-section-number">25.2.1</span> Estimation of the population mean error and mean squared error</a></li>
<li><a href="Validation.html#estimation-of-the-standard-error-of-the-estimator-of-the-population-mean-error-and-mean-squared-error" id="toc-estimation-of-the-standard-error-of-the-estimator-of-the-population-mean-error-and-mean-squared-error"><span class="toc-section-number">25.2.2</span> Estimation of the standard error of the estimator of the population mean error and mean squared error</a></li>
<li><a href="Validation.html#estimation-of-model-efficiency-coefficient" id="toc-estimation-of-model-efficiency-coefficient"><span class="toc-section-number">25.2.3</span> Estimation of model efficiency coefficient</a></li>
<li><a href="Validation.html#statistical-testing-of-hypothesis-about-population-me-and-mse" id="toc-statistical-testing-of-hypothesis-about-population-me-and-mse"><span class="toc-section-number">25.2.4</span> Statistical testing of hypothesis about population ME and MSE</a></li>
</ul></li>
</ul></li>
<li><a href="Approaches.html#Approaches" id="toc-Approaches"><span class="toc-section-number">26</span> Design-based, model-based, and model-assisted approach for sampling and inference</a>
<ul>
<li><a href="Approaches.html#two-sources-of-randomness" id="toc-two-sources-of-randomness"><span class="toc-section-number">26.1</span> Two sources of randomness</a></li>
<li><a href="Approaches.html#iid" id="toc-iid"><span class="toc-section-number">26.2</span> Identically and independently distributed</a></li>
<li><a href="Approaches.html#BiasandVariance" id="toc-BiasandVariance"><span class="toc-section-number">26.3</span> Bias and variance</a></li>
<li><a href="Approaches.html#effectivesamplesize" id="toc-effectivesamplesize"><span class="toc-section-number">26.4</span> Effective sample size</a></li>
<li><a href="Approaches.html#ExploitSpatialStructure" id="toc-ExploitSpatialStructure"><span class="toc-section-number">26.5</span> Exploiting spatial structure in design-based approach</a></li>
<li><a href="Approaches.html#ModelassistedvsModeldependent" id="toc-ModelassistedvsModeldependent"><span class="toc-section-number">26.6</span> Model-assisted vs. model-dependent</a></li>
</ul></li>
<li><a href="#appendix-appendices" id="toc-appendix-appendices">(APPENDIX) Appendices</a></li>
<li><a href="Answers.html#Answers" id="toc-Answers"><span class="toc-section-number">27</span> Answers to exercises</a>
<ul>
<li><a href="Answers.html#introduction-to-probability-sampling" id="toc-introduction-to-probability-sampling">Introduction to probability sampling</a></li>
<li><a href="Answers.html#simple-random-sampling-1" id="toc-simple-random-sampling-1">Simple random sampling</a></li>
<li><a href="Answers.html#stratified-simple-random-sampling-1" id="toc-stratified-simple-random-sampling-1">Stratified simple random sampling</a></li>
<li><a href="Answers.html#systematic-random-sampling-2" id="toc-systematic-random-sampling-2">Systematic random sampling</a></li>
<li><a href="Answers.html#cluster-random-sampling" id="toc-cluster-random-sampling">Cluster random sampling</a></li>
<li><a href="Answers.html#two-stage-cluster-random-sampling-1" id="toc-two-stage-cluster-random-sampling-1">Two-stage cluster random sampling</a></li>
<li><a href="Answers.html#sampling-with-probabilities-proportional-to-size" id="toc-sampling-with-probabilities-proportional-to-size">Sampling with probabilities proportional to size</a></li>
<li><a href="Answers.html#balanced-and-well-spread-sampling" id="toc-balanced-and-well-spread-sampling">Balanced and well-spread sampling</a></li>
<li><a href="Answers.html#model-assisted-estimation" id="toc-model-assisted-estimation">Model-assisted estimation</a></li>
<li><a href="Answers.html#two-phase-random-sampling" id="toc-two-phase-random-sampling">Two-phase random sampling</a></li>
<li><a href="Answers.html#computing-the-required-sample-size" id="toc-computing-the-required-sample-size">Computing the required sample size</a></li>
<li><a href="Answers.html#model-based-optimisation-of-probability-sampling-designs" id="toc-model-based-optimisation-of-probability-sampling-designs">Model-based optimisation of probability sampling designs</a></li>
<li><a href="Answers.html#repeated-sample-surveys-for-monitoring-population-parameters" id="toc-repeated-sample-surveys-for-monitoring-population-parameters">Repeated sample surveys for monitoring population parameters</a></li>
<li><a href="Answers.html#regular-grid-and-spatial-coverage-sampling" id="toc-regular-grid-and-spatial-coverage-sampling">Regular grid and spatial coverage sampling</a></li>
<li><a href="Answers.html#covariate-space-coverage-sampling" id="toc-covariate-space-coverage-sampling">Covariate space coverage sampling</a></li>
<li><a href="Answers.html#conditioned-latin-hypercube-sampling" id="toc-conditioned-latin-hypercube-sampling">Conditioned Latin hypercube sampling</a></li>
<li><a href="Answers.html#model-based-optimisation-of-the-grid-spacing" id="toc-model-based-optimisation-of-the-grid-spacing">Model-based optimisation of the grid spacing</a></li>
<li><a href="Answers.html#model-based-optimisation-of-the-sampling-pattern" id="toc-model-based-optimisation-of-the-sampling-pattern">Model-based optimisation of the sampling pattern</a></li>
<li><a href="Answers.html#sampling-for-estimating-the-semivariogram" id="toc-sampling-for-estimating-the-semivariogram">Sampling for estimating the semivariogram</a></li>
<li><a href="Answers.html#sampling-for-validation-of-maps" id="toc-sampling-for-validation-of-maps">Sampling for validation of maps</a></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/DickBrus/">Dick Brus</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial sampling with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="BalancedSpreaded" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Balanced and well-spread sampling<a href="BalancedSpreaded.html#BalancedSpreaded" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter two related but fundamentally different sampling designs are described and illustrated. The similarity and difference are shortly outlined below, but hopefully will become clearer in following sections.</p>
<p>Roughly speaking, for a balanced sample the sample means of covariates are equal to the population means of these covariates. When the covariates are linearly related to the study variable, this may yield a more precise estimate of the population mean or total of the study variable.</p>
<p>A well-spread sample is a sample with a large range of values for the covariates, from small to large values, but also including intermediate values. In more technical terms: the sampling units are well-spread along the axes spanned by the covariates. If the spatial coordinates are used as covariates (spreading variables), this results in samples that are well-spread in geographical space. Such samples are commonly referred to as spatially balanced samples, which is somewhat confusing, as the geographical spreading is not implemented through balancing on the geographical coordinates. On the other hand, the averages of the spatial coordinates of a sample well-spread in geographical space will be close to the population means of the coordinates. Therefore, the sample will be approximately balanced on the spatial coordinates <span class="citation">(<a href="#ref-Grafstrom2014" role="doc-biblioref">Grafström and Schelin 2014</a>)</span>. The reverse is not true: with balanced sampling, the spreading of the sampling units in the space spanned by the balancing variables can be poor. A sample with all values of a covariate used in balancing near the population mean of that variable has a poor spreading along the covariate axis, but can still be perfectly balanced.</p>
<div id="Balanced" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Balanced sampling<a href="BalancedSpreaded.html#Balanced" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Balanced sampling is a sampling method that exploits one or more quantitative covariates that are related to the study variable. The idea behind balanced sampling is that, if we know the mean of the covariates, then the sampling efficiency can be increased by selecting a sample whose averages of the covariates must be equal to the population means of the covariates.</p>
<p>Let me illustrate balanced sampling with a small simulation study. The simulated population shown in Figure <a href="BalancedSpreaded.html#fig:simpleexample">9.1</a> shows a linear trend from West to East and besides a trend from South to North. Due to the West-East trend, the simulated study variable <span class="math inline">\(z\)</span> is correlated with the covariate Easting and, due to the South-North trend, also with the covariate Northing. To estimate the population mean of the simulated study variable, intuitively it is attractive to select a sample with an average of the Easting coordinate that is equal to the population mean of Easting (which is 10). Figure <a href="BalancedSpreaded.html#fig:simpleexample">9.1</a> (subfigure on the left) shows such a sample of size four; we say that the sample is `balanced’ on the covariate Easting. The sample in the subfigure on the right is balanced on Easting as well as on Northing.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:simpleexample"></span>
<img src="SpatialSampling_files/figure-html/simpleexample-1.png" alt="Sample balanced on Easting (E) and on Easting and Northing (E and N)." width="100%" />
<p class="caption">
Figure 9.1: Sample balanced on Easting (E) and on Easting and Northing (E and N).
</p>
</div>
<div id="balanced-sample-vs.-balanced-sampling-design" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Balanced sample vs. balanced sampling design<a href="BalancedSpreaded.html#balanced-sample-vs.-balanced-sampling-design" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We must distinguish a balanced <em>sample</em> from a balanced sampling <em>design</em>. A sampling design is balanced on a covariate <span class="math inline">\(x\)</span> when <em>all possible</em> samples that can be generated by the design are balanced on <span class="math inline">\(x\)</span>.</p>

<div class="rmdnote">
Simple random sampling is not a balanced sampling design, because for many simple random samples the sample mean of the balancing variable <span class="math inline">\(x\)</span> is not equal to the population mean of <span class="math inline">\(x\)</span>. Only the <em>expectation</em> of the sample mean of <span class="math inline">\(x\)</span>, i.e., the mean of the sample means obtained by selecting an infinite number of simple random samples, equals the population mean of <span class="math inline">\(x\)</span>.
</div>
<p>Figure <a href="BalancedSpreaded.html#fig:scatterplotsqerror">9.2</a> shows for 1,000 simple random samples the squared error of the estimated population mean of the study variable <span class="math inline">\(z\)</span> against the difference between the sample mean of balancing variable Easting and the population mean of Easting. Clearly, the larger the absolute value of the difference, the larger on average the squared error. So, to obtain a precise and accurate estimate of the population mean of <span class="math inline">\(z\)</span>, we better select samples with a difference close to 0.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:scatterplotsqerror"></span>
<img src="SpatialSampling_files/figure-html/scatterplotsqerror-1.png" alt="Squared error in the estimated population mean of \(z\) against the difference between the sample mean and the population mean of Easting, for 1,000 simple random samples of size four selected from the population shown in Figure 9.1." width="80%" />
<p class="caption">
Figure 9.2: Squared error in the estimated population mean of <span class="math inline">\(z\)</span> against the difference between the sample mean and the population mean of Easting, for 1,000 simple random samples of size four selected from the population shown in Figure <a href="BalancedSpreaded.html#fig:simpleexample">9.1</a>.
</p>
</div>
<p>Using only Easting as a balancing variable reduces the sampling variance of the estimator of the mean substantially. Using Easting and Northing as balancing variables further reduces the sampling variance. See Table <a href="BalancedSpreaded.html#tab:tablebalanced">9.1</a>.</p>
<table class=" lightable-classic" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; margin-left: auto; margin-right: auto;'>
<caption>
<span id="tab:tablebalanced">Table 9.1: </span>Sampling variance of the <span class="math inline">\(\pi\)</span> estimator of the mean for simple random sampling (SI) and balanced sampling of four units.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Sampling design
</th>
<th style="text-align:left;">
Balancing variables
</th>
<th style="text-align:right;">
Sampling variance
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
SI
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:right;">
39.70
</td>
</tr>
<tr>
<td style="text-align:left;">
Balanced
</td>
<td style="text-align:left;">
Easting
</td>
<td style="text-align:right;">
14.40
</td>
</tr>
<tr>
<td style="text-align:left;">
Balanced
</td>
<td style="text-align:left;">
Easting and Northing
</td>
<td style="text-align:right;">
9.77
</td>
</tr>
</tbody>
</table></li>
</ul>
</div>
<div id="unequal-inclusion-probabilities" class="section level3 hasAnchor" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Unequal inclusion probabilities<a href="BalancedSpreaded.html#unequal-inclusion-probabilities" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Until now we have assumed that the inclusion probabilities of the population units are equal, but this is not a requirement for balanced sampling designs. A more general definition of a balanced sampling design is as follows. A sampling design is balanced on variable <span class="math inline">\(x\)</span> when for all samples generated by the design the <span class="math inline">\(\pi\)</span> estimate of the population total of <span class="math inline">\(x\)</span> equals the population total of <span class="math inline">\(x\)</span>:</p>
<p><span class="math display" id="eq:generaldefinitionbalanced">\[\begin{equation}
\sum_{k \in \mathcal{S}} \frac{x_k}{\pi_k}= \sum_{k=1}^{N} x_k \;.
\tag{9.1}
\end{equation}\]</span></p>
<p>Similar to the regression estimator explained in the next chapter (Subsection <a href="Modelassisted.html#RegressionEstimator">10.1.1</a>), balanced sampling exploits the linear relation between the study variable and one or more covariates. When using the regression estimator, this is done at the estimation stage. Balanced sampling does so at the sampling stage. For a single covariate the regression estimator of the population total equals (see Equation <a href="Modelassisted.html#eq:SimpleRegressionEstimatorSI">(10.10)</a>)</p>
<p><span class="math display" id="eq:RegressionEstimatoranydesign">\[\begin{equation}
\hat{t}_{\mathrm{regr}}(z) = \hat{t}_{\pi}(z) + \hat{b}\left(t(x) - \hat{t}_{\pi}(x)\right) \;,
\tag{9.2}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(\hat{t}_{\pi}(z)\)</span> and <span class="math inline">\(\hat{t}_{\pi}(x)\)</span> the <span class="math inline">\(\pi\)</span> estimators of the population total of the study variable <span class="math inline">\(z\)</span> and the covariate <span class="math inline">\(x\)</span>, respectively, <span class="math inline">\(t(x)\)</span> the population total of the covariate, and <span class="math inline">\(\hat{b}\)</span> the estimated slope parameter (see hereafter). With a perfectly balanced sample the second term in the regression estimator, which adjusts the <span class="math inline">\(\pi\)</span> estimator, equals zero.</p>
<p>Balanced samples can be selected with the cube algorithm of <span class="citation">Deville and Tillé (<a href="#ref-Deville2004" role="doc-biblioref">2004</a>)</span>. The population total and mean can be estimated by the <span class="math inline">\(\pi\)</span> estimator. The approximated variance of the <span class="math inline">\(\pi\)</span> estimator of the population mean can be estimated by (<span class="citation">Deville and Tillé (<a href="#ref-Deville2005" role="doc-biblioref">2005</a>)</span>, <span class="citation">Grafström and Tillé (<a href="#ref-Grafstrom2013" role="doc-biblioref">2013</a>)</span>)</p>
<p><span class="math display" id="eq:approxvarianceBalanced">\[\begin{equation}
\widehat{V}(\hat{\bar{z}}) = \frac{1}{N^2}\frac{n}{n-p} \sum_{k \in \mathcal{S}} c_k \left(\frac{e_k}{\pi_k}\right)^2 \;,
\tag{9.3}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(p\)</span> the number of balancing variables, <span class="math inline">\(c_k\)</span> a weight for unit <span class="math inline">\(k\)</span> (see hereafter), and <span class="math inline">\(e_k\)</span> the residual of unit <span class="math inline">\(k\)</span> given by</p>
<p><span class="math display" id="eq:residualsBalanced">\[\begin{equation}
e_k = z_k - \mathbf{x}_k^{\text{T}}\hat{\mathbf{b}} \;,
\tag{9.4}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(\mathbf{x}_k\)</span> a vector of length <span class="math inline">\(p\)</span> with the balancing variables for unit <span class="math inline">\(k\)</span>, and <span class="math inline">\(\hat{\mathbf{b}}\)</span> the estimated population regression coefficients, given by</p>
<p><span class="math display" id="eq:betasbalanced">\[\begin{equation}
\hat{\mathbf{b}} = \left(\sum_{k \in \mathcal{S}} c_k \frac{\mathbf{x}_k}{\pi_k} \frac{\mathbf{x}_k}{\pi_k}^{\text{T}} \right)^{-1} \sum_{k \in \mathcal{S}} c_k \frac{\mathbf{x}_k}{\pi_k} \frac{z_k}{\pi_k} \;.
\tag{9.5}
\end{equation}\]</span></p>
<p>Working this out for balanced sampling without replacement with equal inclusion probabilities, <span class="math inline">\(\pi_k = n/N,\; k = 1, \dots , N\)</span>, yields</p>
<p><span class="math display" id="eq:approxvarianceBalancedSI">\[\begin{equation}
\widehat{V}(\hat{\bar{z}}) = \frac{1}{n(n-p)} \sum_{k \in \mathcal{S}} c_k e_k^2 \;.
\tag{9.6}
\end{equation}\]</span></p>
<p><span class="citation">Deville and Tillé (<a href="#ref-Deville2005" role="doc-biblioref">2005</a>)</span> give several formulas for computing the weights <span class="math inline">\(c_k\)</span>, one of which is <span class="math inline">\(c_k = (1-\pi_k)\)</span>.</p>
<p>Balanced sampling is now illustrated with aboveground biomass (AGB) data of Eastern Amazonia, see Figure <a href="GeneralIntro.html#fig:mapsAmazonia">1.8</a>. Log-transformed short-wave infrared radiation (lnSWIR2) is used as a balancing variable. The <code>samplecube</code> function of the <strong>sampling</strong> package <span class="citation">(<a href="#ref-Tille2016" role="doc-biblioref">Tillé and Matei 2021</a>)</span> implements the cube algorithm. Argument <code>X</code> of this function specifies the matrix of ancillary variables on which the sample must be balanced. The first column of this matrix is filled with ones, so that the sample size is fixed. To speed up the computations, a 5 km <span class="math inline">\(\times\)</span> 5 km subgrid of <code>grdAmazonia</code> is used.</p>

<div class="rmdnote">
Recall that a sample is balanced on a covariate <span class="math inline">\(x\)</span> if the <span class="math inline">\(\pi\)</span> estimate of the population total of <span class="math inline">\(x\)</span> is equal to the known true population total of <span class="math inline">\(x\)</span> (Equation <a href="BalancedSpreaded.html#eq:generaldefinitionbalanced">(9.1)</a>). If we know the total number of units in a population, <span class="math inline">\(N\)</span>, we can balance the sample on this known total using a constant with value 1 as a balancing variable. Only for samples of size <span class="math inline">\(n\)</span> the <span class="math inline">\(\pi\)</span> estimate of the total number of population units equals <span class="math inline">\(N\)</span>: <span class="math inline">\(\sum_{k \in \mathcal{S}} 1/\pi_k = N\)</span> for <span class="math inline">\(|\mathcal{S}| = n\)</span>.
</div>
<p>Equal inclusion probabilities are used, i.e., for all population units the inclusion probability equals <span class="math inline">\(n/N\)</span>.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="BalancedSpreaded.html#cb173-1" aria-hidden="true" tabindex="-1"></a>grdAmazonia <span class="ot">&lt;-</span> grdAmazonia <span class="sc">%&gt;%</span></span>
<span id="cb173-2"><a href="BalancedSpreaded.html#cb173-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lnSWIR2 =</span> <span class="fu">log</span>(SWIR2))</span>
<span id="cb173-3"><a href="BalancedSpreaded.html#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sampling)</span>
<span id="cb173-4"><a href="BalancedSpreaded.html#cb173-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(grdAmazonia)</span>
<span id="cb173-5"><a href="BalancedSpreaded.html#cb173-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb173-6"><a href="BalancedSpreaded.html#cb173-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="at">times =</span> N), grdAmazonia<span class="sc">$</span>lnSWIR2)</span>
<span id="cb173-7"><a href="BalancedSpreaded.html#cb173-7" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">rep</span>(n <span class="sc">/</span> N, <span class="at">times =</span> N)</span>
<span id="cb173-8"><a href="BalancedSpreaded.html#cb173-8" aria-hidden="true" tabindex="-1"></a>sample_ind <span class="ot">&lt;-</span> <span class="fu">samplecube</span>(<span class="at">X =</span> X, <span class="at">pik =</span> pi, <span class="at">comment =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="dv">1</span>)</span>
<span id="cb173-9"><a href="BalancedSpreaded.html#cb173-9" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb173-10"><a href="BalancedSpreaded.html#cb173-10" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">which</span>(sample_ind <span class="sc">&gt;</span> (<span class="dv">1</span> <span class="sc">-</span> eps))</span>
<span id="cb173-11"><a href="BalancedSpreaded.html#cb173-11" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> grdAmazonia[units, ]</span></code></pre></div>
<p>The population mean can be estimated by the sample mean.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="BalancedSpreaded.html#cb174-1" aria-hidden="true" tabindex="-1"></a>mz <span class="ot">&lt;-</span> <span class="fu">mean</span>(mysample<span class="sc">$</span>AGB)</span></code></pre></div>
<p>To estimate the variance, a function is defined for estimating the population regression coefficients.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="BalancedSpreaded.html#cb175-1" aria-hidden="true" tabindex="-1"></a>estimate_b <span class="ot">&lt;-</span> <span class="cf">function</span>(z, X, c) {</span>
<span id="cb175-2"><a href="BalancedSpreaded.html#cb175-2" aria-hidden="true" tabindex="-1"></a>  cXX <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">ncol</span>(X), <span class="at">ncol =</span> <span class="fu">ncol</span>(X), <span class="at">data =</span> <span class="dv">0</span>)</span>
<span id="cb175-3"><a href="BalancedSpreaded.html#cb175-3" aria-hidden="true" tabindex="-1"></a>  cXz <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="fu">ncol</span>(X), <span class="at">data =</span> <span class="dv">0</span>)</span>
<span id="cb175-4"><a href="BalancedSpreaded.html#cb175-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">length</span>(z))) {</span>
<span id="cb175-5"><a href="BalancedSpreaded.html#cb175-5" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> X[i, ]</span>
<span id="cb175-6"><a href="BalancedSpreaded.html#cb175-6" aria-hidden="true" tabindex="-1"></a>    cXX_i <span class="ot">&lt;-</span> c[i] <span class="sc">*</span> (x <span class="sc">%*%</span> <span class="fu">t</span>(x))</span>
<span id="cb175-7"><a href="BalancedSpreaded.html#cb175-7" aria-hidden="true" tabindex="-1"></a>    cXX <span class="ot">&lt;-</span> cXX <span class="sc">+</span> cXX_i</span>
<span id="cb175-8"><a href="BalancedSpreaded.html#cb175-8" aria-hidden="true" tabindex="-1"></a>    cXz_i <span class="ot">&lt;-</span> c[i] <span class="sc">*</span> <span class="fu">t</span>(x) <span class="sc">*</span> z[i]</span>
<span id="cb175-9"><a href="BalancedSpreaded.html#cb175-9" aria-hidden="true" tabindex="-1"></a>    cXz <span class="ot">&lt;-</span> cXz <span class="sc">+</span> cXz_i</span>
<span id="cb175-10"><a href="BalancedSpreaded.html#cb175-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb175-11"><a href="BalancedSpreaded.html#cb175-11" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">solve</span>(cXX, <span class="fu">t</span>(cXz))</span>
<span id="cb175-12"><a href="BalancedSpreaded.html#cb175-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b)</span>
<span id="cb175-13"><a href="BalancedSpreaded.html#cb175-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The next code chunk shows how the estimated variance of the <span class="math inline">\(\pi\)</span> estimator of the population mean can be computed.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="BalancedSpreaded.html#cb176-1" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">rep</span>(n <span class="sc">/</span> N, n)</span>
<span id="cb176-2"><a href="BalancedSpreaded.html#cb176-2" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> pi)</span>
<span id="cb176-3"><a href="BalancedSpreaded.html#cb176-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">estimate_b</span>(<span class="at">z =</span> mysample<span class="sc">$</span>AGB <span class="sc">/</span> pi, <span class="at">X =</span> X[units, ] <span class="sc">/</span> pi, <span class="at">c =</span> c)</span>
<span id="cb176-4"><a href="BalancedSpreaded.html#cb176-4" aria-hidden="true" tabindex="-1"></a>zpred <span class="ot">&lt;-</span> X <span class="sc">%*%</span> b</span>
<span id="cb176-5"><a href="BalancedSpreaded.html#cb176-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> mysample<span class="sc">$</span>AGB <span class="sc">-</span> zpred[units]</span>
<span id="cb176-6"><a href="BalancedSpreaded.html#cb176-6" aria-hidden="true" tabindex="-1"></a>v_tz <span class="ot">&lt;-</span> n <span class="sc">/</span> (n <span class="sc">-</span> <span class="fu">ncol</span>(X)) <span class="sc">*</span> <span class="fu">sum</span>(c <span class="sc">*</span> (e <span class="sc">/</span> pi)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb176-7"><a href="BalancedSpreaded.html#cb176-7" aria-hidden="true" tabindex="-1"></a>v_mz <span class="ot">&lt;-</span> v_tz <span class="sc">/</span> N<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<p>Figure <a href="BalancedSpreaded.html#fig:BalancedSampleAmazonia">9.3</a> shows the selected balanced sample. Note the spatial clustering of some units. The estimated population mean (as estimated by the sample mean) of AGB equals 224.5 10<sup>9</sup> kg ha<sup>-1</sup>. The population mean of AGB equals 225.3 10<sup>9</sup> kg ha<sup>-1</sup>. The standard error of the estimated mean equals 6.1 10<sup>9</sup> kg ha<sup>-1</sup>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:BalancedSampleAmazonia"></span>
<img src="SpatialSampling_files/figure-html/BalancedSampleAmazonia-1.png" alt="Sample balanced on lnSWIR2 from Eastern Amazonia." width="100%" />
<p class="caption">
Figure 9.3: Sample balanced on lnSWIR2 from Eastern Amazonia.
</p>
</div>
<p>Figure <a href="BalancedSpreaded.html#fig:SamplingDistributionBalanced">9.4</a> shows the approximated sampling distribution of the <span class="math inline">\(\pi\)</span> estimator of the mean AGB with balanced sampling and simple random sampling, obtained by repeating the random sampling with both designs and estimation 1,000 times.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:SamplingDistributionBalanced"></span>
<img src="SpatialSampling_files/figure-html/SamplingDistributionBalanced-1.png" alt="Approximated sampling distribution of the \(\pi\) estimator of the mean AGB (109 kg ha-1) in Eastern Amazonia, with balanced sampling, balanced on lnSWIR2 and using equal inclusion probabilities, and simple random sampling without replacement (SI) of 100 units." width="80%" />
<p class="caption">
Figure 9.4: Approximated sampling distribution of the <span class="math inline">\(\pi\)</span> estimator of the mean AGB (10<sup>9</sup> kg ha<sup>-1</sup>) in Eastern Amazonia, with balanced sampling, balanced on lnSWIR2 and using equal inclusion probabilities, and simple random sampling without replacement (SI) of 100 units.
</p>
</div>
<p>The variance of the 1,000 estimates of the population mean of the study variable AGB equals 28.8 (10<sup>9</sup> kg ha<sup>-1</sup>)<sup>2</sup>. The gain in precision compared to simple random sampling equals 2.984 (design effect is 0.335), so with simple random sampling about three times more sampling units are needed to estimate the population mean with the same precision. The mean of the 1,000 estimated variances equals 26.4 (10<sup>9</sup> kg ha<sup>-1</sup>)<sup>2</sup>, indicating that the approximated variance estimator somewhat underestimates the true variance in this case. The population mean of the balancing variable lnSWIR2 equals 6.414. The sample mean of lnSWIR2 varies a bit among the samples. Figure <a href="BalancedSpreaded.html#fig:histSampleMeanSWIR">9.5</a> shows the approximated sampling distribution of the sample mean of lnSWIR2. In other words, many samples are not perfectly balanced on lnSWIR2. This is not exceptional; in most cases perfect balance is impossible.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:histSampleMeanSWIR"></span>
<img src="SpatialSampling_files/figure-html/histSampleMeanSWIR-1.png" alt="Approximated sampling distribution of the sample mean of balancing variable lnSWIR2 in Eastern Amazonia with balanced sampling of size 100 and equal inclusion probabilities." width="80%" />
<p class="caption">
Figure 9.5: Approximated sampling distribution of the sample mean of balancing variable lnSWIR2 in Eastern Amazonia with balanced sampling of size 100 and equal inclusion probabilities.
</p>
</div>
<div id="exercises-14" class="section level4 unnumbered hasAnchor">
<h4>Exercises<a href="BalancedSpreaded.html#exercises-14" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>Select a sample of size 100 balanced on lnSWIR2 and Terra_PP from Eastern Amazonia, using equal inclusion probabilities for all units.
<ul>
<li>First, select a subgrid of 5 km <span class="math inline">\(\times\)</span> 5 km using function <code>spsample</code>, see Chapter <a href="SY.html#SY">5</a>.</li>
<li>Estimate the population mean.</li>
<li>Estimate the standard error of the <span class="math inline">\(\pi\)</span> estimator. First, estimate the regression coefficients, using function <code>estimate_b</code> defined above, then compute the residuals, and finally compute the variance.<br />
</li>
</ul></li>
<li>Spatial clustering of sampling units is not avoided in balanced sampling. What effect do you expect of this spatial clustering on the precision of the estimated mean? Can you think of a situation where this effect does not occur?</li>
</ol>
</div>
</div>
<div id="StratifiedsamplingasBalancedsampling" class="section level3 hasAnchor" number="9.1.3">
<h3><span class="header-section-number">9.1.3</span> Stratified random sampling<a href="BalancedSpreaded.html#StratifiedsamplingasBalancedsampling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Much in the same way as we controlled in the previous subsection the sample size <span class="math inline">\(n\)</span> by balancing the sample on the known total number of population units <span class="math inline">\(N\)</span>, we can balance a sample on the known total number of units in subpopulations. A sample balanced on the sizes of subpopulations is a stratified random sample. Figure <a href="BalancedSpreaded.html#fig:BalancedSampleCategorical">9.6</a> shows four subpopulations or strata. These four strata can be used in balanced sampling by constructing the following design matrix <span class="math inline">\(\mathbf{X}\)</span> with as many columns as there are strata and as many rows as there are population units:</p>
<p><span class="math display" id="eq:DesignMatrixBalanced">\[\begin{equation}
\mathbf{X}=
\begin{bmatrix}
1 &amp;0 &amp;0 &amp;0 \\
1 &amp;0 &amp;0 &amp;0 \\
1 &amp;0 &amp;0 &amp;0 \\
1 &amp;0 &amp;0 &amp;0 \\
0 &amp;1 &amp;0 &amp;0 \\
0 &amp;1 &amp;0 &amp;0 \\
0 &amp;0 &amp;1 &amp;0 \\
\vdots &amp;\vdots &amp;\vdots &amp;\vdots\\
0 &amp; 0 &amp; 0 &amp; 1 \\
\end{bmatrix}  \;.
\tag{9.7}
\end{equation}\]</span></p>
<p>The first four rows refer to the four leftmost bottom row population units in Figure <a href="BalancedSpreaded.html#fig:BalancedSampleCategorical">9.6</a>. These units belong to class A, which explains that the first column for these units contain ones. The other three columns for these rows contain all zeroes. The fifth and sixth unit belong to stratum B, so that the second column for these rows contain ones, and so on. The final row is the upperright sampling unit in stratum D, so the first three columns contain zeroes, and the fourth column is filled with a one. The sum of the indicators in the columns is the total number of population units in the strata.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:BalancedSampleCategorical"></span>
<img src="SpatialSampling_files/figure-html/BalancedSampleCategorical-1.png" alt="Sample balanced on a categorical variable with four classes." width="80%" />
<p class="caption">
Figure 9.6: Sample balanced on a categorical variable with four classes.
</p>
</div>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="BalancedSpreaded.html#cb177-1" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> s2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span> <span class="sc">-</span> <span class="fl">0.5</span></span>
<span id="cb177-2"><a href="BalancedSpreaded.html#cb177-2" aria-hidden="true" tabindex="-1"></a>mypop <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(s1, s2)</span>
<span id="cb177-3"><a href="BalancedSpreaded.html#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mypop) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;s1&quot;</span>, <span class="st">&quot;s2&quot;</span>)</span>
<span id="cb177-4"><a href="BalancedSpreaded.html#cb177-4" aria-hidden="true" tabindex="-1"></a>mypop<span class="sc">$</span>stratum <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">findInterval</span>(mypop<span class="sc">$</span>s1, <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">14</span>)))</span>
<span id="cb177-5"><a href="BalancedSpreaded.html#cb177-5" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(mypop<span class="sc">$</span>stratum) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span></code></pre></div>
<p>In the next code chunk, the inclusion probabilities are computed by <span class="math inline">\(\pi_{hk}=n_h/N_h,\; k=1, \dots , N_h\)</span>, with <span class="math inline">\(n_h=5\)</span> for all four strata. The stratum sample sizes are equal, but the number of population units of a stratum differ among the strata, so the inclusion probabilities also differ among the strata. The ten leftmost units on the bottom row of Figure <a href="BalancedSpreaded.html#fig:BalancedSampleCategorical">9.6</a> are shown below.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="BalancedSpreaded.html#cb178-1" aria-hidden="true" tabindex="-1"></a>mypop <span class="ot">&lt;-</span> mypop <span class="sc">%&gt;%</span></span>
<span id="cb178-2"><a href="BalancedSpreaded.html#cb178-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(stratum) <span class="sc">%&gt;%</span></span>
<span id="cb178-3"><a href="BalancedSpreaded.html#cb178-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">N_h =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb178-4"><a href="BalancedSpreaded.html#cb178-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pi_h =</span> <span class="fu">rep</span>(<span class="dv">5</span>, <span class="dv">4</span>) <span class="sc">/</span> N_h) <span class="sc">%&gt;%</span></span>
<span id="cb178-5"><a href="BalancedSpreaded.html#cb178-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">right_join</span>(mypop, <span class="at">by =</span> <span class="st">&quot;stratum&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb178-6"><a href="BalancedSpreaded.html#cb178-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(s2, s1)</span>
<span id="cb178-7"><a href="BalancedSpreaded.html#cb178-7" aria-hidden="true" tabindex="-1"></a>mypop</span></code></pre></div>
<pre><code># A tibble: 400 x 5
   stratum   N_h   pi_h    s1    s2
   &lt;fct&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 A          80 0.0625   0.5   0.5
 2 A          80 0.0625   1.5   0.5
 3 A          80 0.0625   2.5   0.5
 4 A          80 0.0625   3.5   0.5
 5 B          40 0.125    4.5   0.5
 6 B          40 0.125    5.5   0.5
 7 C         160 0.0312   6.5   0.5
 8 C         160 0.0312   7.5   0.5
 9 C         160 0.0312   8.5   0.5
10 C         160 0.0312   9.5   0.5
# ... with 390 more rows</code></pre>
<p>Next, the design matrix <span class="math inline">\(\mathbf{X}\)</span> is computed with function <code>model.matrix</code>, expanding the factor <code>stratum</code> to a set of dummy variables, see code chunk below. By adding <code>- 1</code> to the formula, the usual first column with ones in the design matrix is omitted. The design matrix has four columns with dummy variables (indicators), indicating to which stratum a unit belongs.</p>
<p>The columns in the design matrix with dummy variables are multiplied by the vector with inclusion probabilities, using function <code>sweep</code>, resulting in the following design matrix:</p>
<p><span class="math display" id="eq:DesignMatrixBalanced2">\[\begin{equation}
\mathbf{X}=
\begin{bmatrix}
0.0625 &amp;0 &amp;0 &amp;0 \\
0.0625 &amp;0 &amp;0 &amp;0 \\
0.0625 &amp;0 &amp;0 &amp;0 \\
0.0625 &amp;0 &amp;0 &amp;0 \\
0 &amp;0.125 &amp;0 &amp;0 \\
0 &amp;0.125 &amp;0 &amp;0 \\
0 &amp;0 &amp;0.03125 &amp;0 \\
\vdots &amp;\vdots &amp;\vdots &amp;\vdots\\
0 &amp; 0 &amp; 0 &amp;0.04167 \\
\end{bmatrix}  \;.
\tag{9.8}
\end{equation}\]</span></p>
<p>The multiplication by the inclusion probabilities is not strictly needed. Using the design matrix with dummy variables implies that we balance the sample on the known total number of population units in the strata, <span class="math inline">\(N_h\)</span>. For samples with stratum sample sizes equal to <span class="math inline">\(n_h\)</span>, the sample sums of the dummy variables used in balancing, divided by the inclusion probability, are equal to <span class="math inline">\(N_h\)</span>.</p>
<p>Multiplication of the dummy variables by the vector with inclusion probabilities implies that we balance the sample on the population totals of the inclusion probabilities, which are equal to the targeted stratum sample sizes. For samples with stratum sample sizes <span class="math inline">\(n_h\)</span> equal to these targeted sample sizes, the sample sums of the balancing variables, divided by the inclusion probability (having value <span class="math inline">\(\pi_{hk}/\pi_{hk}=1\)</span> or 0), are equal to the targeted sample sizes.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="BalancedSpreaded.html#cb180-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> stratum <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> mypop)</span>
<span id="cb180-2"><a href="BalancedSpreaded.html#cb180-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">sweep</span>(X, <span class="at">MARGIN =</span> <span class="dv">1</span>, mypop<span class="sc">$</span>pi_h, <span class="st">`</span><span class="at">*</span><span class="st">`</span>)</span>
<span id="cb180-3"><a href="BalancedSpreaded.html#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb180-4"><a href="BalancedSpreaded.html#cb180-4" aria-hidden="true" tabindex="-1"></a>sample_ind <span class="ot">&lt;-</span> <span class="fu">samplecube</span>(<span class="at">X =</span> X, <span class="at">pik =</span> mypop<span class="sc">$</span>pi_h, <span class="at">comment =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="dv">1</span>)</span>
<span id="cb180-5"><a href="BalancedSpreaded.html#cb180-5" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb180-6"><a href="BalancedSpreaded.html#cb180-6" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> mypop[sample_ind <span class="sc">&gt;</span> (<span class="dv">1</span> <span class="sc">-</span> eps), ]</span></code></pre></div>
<p>In the above example all units in a stratum have the same inclusion probability, yielding a stratified simple random sample. We may also use variable inclusion probabilities, for instance proportional to a size measure of the units, yielding a stratified ppswor random sample (Section <a href="pps.html#ppswor">8.2</a>).</p>
<p>The advantage of selecting a stratified random sample by balancing the sample on a categorical variable becomes clear in case we have multiple classifications that we would like to use in stratification, and we cannot afford to use all cross-classifications as strata. This is the topic of the next subsection.</p>
</div>
<div id="Multiwaystratification" class="section level3 hasAnchor" number="9.1.4">
<h3><span class="header-section-number">9.1.4</span> Multiway stratification<a href="BalancedSpreaded.html#Multiwaystratification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="citation">Falorsi and Righi (<a href="#ref-Falorsi2008" role="doc-biblioref">2008</a>)</span> describe how a multiway stratified sample can be selected as a balanced sample. Multiway stratification is of interest when one has multiple stratification variables, each stratification variable leading to several strata, so that the total number of cross-classification strata becomes so large that the stratum sample sizes are strongly disproportional to their size or even exceed the total sample size. For instance, suppose we have three maps with 4, 3, and 5 map units. Further, suppose that all combinations of map units are non-empty, so that we have 4 <span class="math inline">\(\times\)</span> 3 <span class="math inline">\(\times\)</span> 5 = 60 combinations. We may not like to use all combinations (cross-classifications) as strata. The alternative is then to use the <span class="math inline">\(4+3+5=12\)</span> map units as “strata”. This is not a stratification in the usual sense since the strata are overlapping.</p>
<p>The sample sizes of the marginal strata can be controlled using a design matrix with as many columns as there are strata. The units of an individual map used for stratification are referred to as marginal strata. Each row <span class="math inline">\(k = 1, \dots, N\)</span> in the design matrix <span class="math inline">\(\mathbf{X}\)</span> has as many non-zero values as we have maps, in entries corresponding to the cross-classification map unit of population unit <span class="math inline">\(k\)</span>, and zeroes in the remaining entries. The non-zero value is the inclusion probability of that unit. Each column of the design matrix has non-zero values in entries corresponding to the population units in that marginal stratum and zeroes in all other entries.</p>
<p>Two-way stratified random sampling is illustrated with a simulated population of 400 units (Figure <a href="BalancedSpreaded.html#fig:TwowaystratifiedPopulation">9.7</a>). Figure <a href="BalancedSpreaded.html#fig:Twowaystratifiedsample">9.8</a> shows two classifications of the population units. Classification A consists of four classes (map units), classification B of three classes. Instead of using <span class="math inline">\(4 \times 3 = 12\)</span> cross-classifications as strata in random sampling, only <span class="math inline">\(4+3=7\)</span> marginal strata are used in two-way stratified random sampling.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:TwowaystratifiedPopulation"></span>
<img src="SpatialSampling_files/figure-html/TwowaystratifiedPopulation-1.png" alt="Simulated population used for illustration of two-way stratified random sampling." width="80%" />
<p class="caption">
Figure 9.7: Simulated population used for illustration of two-way stratified random sampling.
</p>
</div>
<p>As a first step, the inclusion probabilities are added to <code>data.frame</code> <code>mypop</code> with the spatial coordinates and simulated values. To keep it simple, I computed inclusion probabilities equal to 2 divided by the number of population units in a cross-classification stratum. Note that this does not imply that a sample is selected with two units per cross-classification stratum. As we will see later, it is possible that in some cross-classification strata no units are selected at all, while in other cross-classification strata more than two units are selected. In multiway stratified sampling, the marginal stratum sample sizes are controlled. The inclusion probabilities should result in six selected units for all four units of map A and eight selected units for all three units of map B.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="BalancedSpreaded.html#cb181-1" aria-hidden="true" tabindex="-1"></a>mypop <span class="ot">&lt;-</span> mypop <span class="sc">%&gt;%</span></span>
<span id="cb181-2"><a href="BalancedSpreaded.html#cb181-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(A, B) <span class="sc">%&gt;%</span></span>
<span id="cb181-3"><a href="BalancedSpreaded.html#cb181-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">N_h =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-4"><a href="BalancedSpreaded.html#cb181-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pi_h =</span> <span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">12</span>) <span class="sc">/</span> N_h) <span class="sc">%&gt;%</span></span>
<span id="cb181-5"><a href="BalancedSpreaded.html#cb181-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">right_join</span>(mypop, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>))</span></code></pre></div>
<p>The next step is to create the design matrix. Two submatrices are computed, one per stratification. The two submatrices are joined columnwise, using function <code>cbind</code>. The columns are multiplied by the vector with inclusion probabilities.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="BalancedSpreaded.html#cb182-1" aria-hidden="true" tabindex="-1"></a>XA <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> A <span class="sc">-</span> <span class="dv">1</span>, mypop)</span>
<span id="cb182-2"><a href="BalancedSpreaded.html#cb182-2" aria-hidden="true" tabindex="-1"></a>XB <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> B <span class="sc">-</span> <span class="dv">1</span>, mypop)</span>
<span id="cb182-3"><a href="BalancedSpreaded.html#cb182-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(XA, XB)</span>
<span id="cb182-4"><a href="BalancedSpreaded.html#cb182-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">sweep</span>(X, <span class="at">MARGIN =</span> <span class="dv">1</span>, mypop<span class="sc">$</span>pi_h, <span class="st">`</span><span class="at">*</span><span class="st">`</span>)</span></code></pre></div>
<p>Matrix <span class="math inline">\(\mathbf{X}\)</span> can be reduced by one column if in the first column the inclusion probabilities of <em>all</em> population units are inserted. This first column contains no zeroes. Balancing on this variable implies that the total sample size is controlled. Now there is no need anymore to control the sample sizes of all marginal strata. It is sufficient to control the sample sizes of three marginal strata of map A (A2, A3, and A4) and two marginal strata of map B (B2 and B3). Given the total sample size, the sample sizes of map units A1 and B1 then cannot be chosen freely anymore.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="BalancedSpreaded.html#cb183-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> A <span class="sc">+</span> B, mypop)</span>
<span id="cb183-2"><a href="BalancedSpreaded.html#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(X)</span></code></pre></div>
<pre><code>[1] &quot;(Intercept)&quot; &quot;AA2&quot;         &quot;AA3&quot;         &quot;AA4&quot;         &quot;BB2&quot;        
[6] &quot;BB3&quot;        </code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="BalancedSpreaded.html#cb185-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">sweep</span>(X, <span class="at">MARGIN =</span> <span class="dv">1</span>, mypop<span class="sc">$</span>pi_h, <span class="st">`</span><span class="at">*</span><span class="st">`</span>)</span></code></pre></div>
<p>This reduced design matrix is not strictly needed for selecting a multiway stratified sample, but it must be used in estimation. If in estimation, as many balancing variables are used as we have marginal strata, the matrix with the sum of squares of the balancing variables (first sum in Equation <a href="BalancedSpreaded.html#eq:betasbalanced">(9.5)</a>) cannot be inverted (the matrix is singular), and as a consequence the population regression coefficients cannot be estimated.</p>
<p>Finally, the two-way stratified random sample is selected with function <code>samplecube</code> of package <strong>sampling</strong>.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="BalancedSpreaded.html#cb186-1" aria-hidden="true" tabindex="-1"></a>sample_ind <span class="ot">&lt;-</span> <span class="fu">samplecube</span>(<span class="at">X =</span> X, <span class="at">pik =</span> mypop<span class="sc">$</span>pi_h, <span class="at">method =</span> <span class="dv">1</span>, <span class="at">comment =</span> <span class="cn">FALSE</span>)</span>
<span id="cb186-2"><a href="BalancedSpreaded.html#cb186-2" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">which</span>(sample_ind <span class="sc">&gt;</span> (<span class="dv">1</span> <span class="sc">-</span> eps))</span>
<span id="cb186-3"><a href="BalancedSpreaded.html#cb186-3" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> mypop[units, ]</span></code></pre></div>
<p>Figure <a href="BalancedSpreaded.html#fig:Twowaystratifiedsample">9.8</a> shows the selected sample.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Twowaystratifiedsample"></span>
<img src="SpatialSampling_files/figure-html/Twowaystratifiedsample-1.png" alt="Two-way stratified sample." width="100%" />
<p class="caption">
Figure 9.8: Two-way stratified sample.
</p>
</div>
<p>All marginal stratum sample sizes of map A are six and all marginal stratum sample sizes of map B are eight, as expected. The sample sizes of the cross-classification strata vary from zero to four.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="BalancedSpreaded.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">table</span>(mysample<span class="sc">$</span>A, mysample<span class="sc">$</span>B))</span></code></pre></div>
<pre><code>     
      B1 B2 B3 Sum
  A1   2  0  4   6
  A2   2  3  1   6
  A3   3  1  2   6
  A4   1  4  1   6
  Sum  8  8  8  24</code></pre>
<p>The population mean can be estimated by the <span class="math inline">\(\pi\)</span> estimator.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="BalancedSpreaded.html#cb189-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mypop)</span>
<span id="cb189-2"><a href="BalancedSpreaded.html#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(mysample<span class="sc">$</span>z <span class="sc">/</span> mysample<span class="sc">$</span>pi_h) <span class="sc">/</span> N)</span></code></pre></div>
<pre><code>[1] 8.688435</code></pre>
<p>The variance is estimated as before (Equation <a href="BalancedSpreaded.html#eq:approxvarianceBalanced">(9.3)</a>).</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="BalancedSpreaded.html#cb191-1" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> mysample<span class="sc">$</span>pi_h)</span>
<span id="cb191-2"><a href="BalancedSpreaded.html#cb191-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">estimate_b</span>(</span>
<span id="cb191-3"><a href="BalancedSpreaded.html#cb191-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> mysample<span class="sc">$</span>z <span class="sc">/</span> mysample<span class="sc">$</span>pi_h, <span class="at">X =</span> X[units, ] <span class="sc">/</span> mysample<span class="sc">$</span>pi_h, <span class="at">c =</span> c)</span>
<span id="cb191-4"><a href="BalancedSpreaded.html#cb191-4" aria-hidden="true" tabindex="-1"></a>zpred <span class="ot">&lt;-</span> X <span class="sc">%*%</span> b</span>
<span id="cb191-5"><a href="BalancedSpreaded.html#cb191-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> mysample<span class="sc">$</span>z <span class="sc">-</span> zpred[units]</span>
<span id="cb191-6"><a href="BalancedSpreaded.html#cb191-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mysample)</span>
<span id="cb191-7"><a href="BalancedSpreaded.html#cb191-7" aria-hidden="true" tabindex="-1"></a>v_tz <span class="ot">&lt;-</span> n <span class="sc">/</span> (n <span class="sc">-</span> <span class="fu">ncol</span>(X)) <span class="sc">*</span> <span class="fu">sum</span>(c <span class="sc">*</span> (e <span class="sc">/</span> mysample<span class="sc">$</span>pi_h)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb191-8"><a href="BalancedSpreaded.html#cb191-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(v_mz <span class="ot">&lt;-</span> v_tz <span class="sc">/</span> N<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>[1] 0.1723688</code></pre>
</div>
</div>
<div id="Spreaded" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Well-spread sampling<a href="BalancedSpreaded.html#Spreaded" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With balanced sampling, the spreading of the sampling units in the space spanned by the balancing variables can be poor. For instance, in Figure <a href="BalancedSpreaded.html#fig:simpleexample">9.1</a> the Easting coordinates of all units of a sample balanced on Easting can be equal or close to the population mean of 10. So, in this example, balancing does not guarantee a good geographical spreading. Stated more generally, a balanced sample can be selected that shows strong clustering in the space spanned by the balancing variables. This clustering may inflate the standard error of the estimated population total and mean. The clustering in geographical or covariate space can be avoided by the local pivotal method <span class="citation">(<a href="#ref-Grafstrom2012" role="doc-biblioref">Grafström, Lundström, and Schelin 2012</a>)</span> and the spatially correlated Poisson sampling method <span class="citation">(<a href="#ref-Grafstrom2012b" role="doc-biblioref">Grafström 2012</a>)</span>.</p>

<div class="rmdnote">
For spreading in <em>geographical</em> space various other designs are available. A simple design is stratified random sampling from compact geographical strata, see Section <a href="STSI.html#geostrata">4.6</a>. Alternative designs are generalised random-tessellation stratified sampling <span class="citation">(<a href="#ref-stevens2004" role="doc-biblioref">Stevens and Olson 2004</a>)</span>, see Subsection <a href="BalancedSpreaded.html#GRTS">9.2.2</a>, and balanced acceptance sampling <span class="citation">(<a href="#ref-Robertson2013" role="doc-biblioref">Robertson et al. 2013</a>)</span>.
</div>
<div id="LPM" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Local pivotal method<a href="BalancedSpreaded.html#LPM" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The local pivotal method (LPM) is a modification of the pivotal method explained in Subsection <a href="pps.html#pivotalmethod">8.2.2</a>. The only difference with the pivotal method is the selection of the pairs of units. In the pivotal method, at each step two units are selected, for instance, the first two units in the vector with inclusion probabilities after randomising the order of the units. In the local pivotal method, the first unit is selected fully randomly, and the nearest neighbour of this unit is used as its counterpart. Recall that when one unit of a pair is included in the sample, the inclusion probability of its counterpart is decreased. This leads to a better spreading of the sampling units in the space spanned by the spreading variables.</p>
<p>LPM can be used for arbitrary inclusion probabilities. The inclusion probabilities can be equal, but as with the pivotal method these probabilities may also differ among the population units.</p>
<p>Selecting samples with LPM can be done with functions <code>lpm</code>, <code>lpm1</code>, or <code>lpm2</code> of package <strong>BalancedSampling</strong> <span class="citation">(<a href="#ref-Grafstrom2016" role="doc-biblioref">Grafström and Lisic 2019</a>)</span>. Functions <code>lpm1</code> and <code>lpm2</code> only differ in the selection of neighbours that are allowed to compete, for details see <span class="citation">Grafström, Lundström, and Schelin (<a href="#ref-Grafstrom2012" role="doc-biblioref">2012</a>)</span>. For most populations, the two algorithms perform similarly. The algorithm implemented in function <code>lpm</code> is only recommended when the population size is too large for <code>lpm1</code> or <code>lpm2</code>. It only uses a subset of the population in search for nearest neighbours and is thus not as good. Another function <code>lpm2_kdtree</code> of package <strong>SamplingBigData</strong> <span class="citation">(<a href="#ref-samplingBigData" role="doc-biblioref">Lisic and Grafström 2018</a>)</span> is developed for big data sets.</p>
<p>Inclusion probabilities are computed with function <code>inclusionprobabilities</code> of package <strong>sampling</strong>. A matrix <span class="math inline">\(\mathbf{X}\)</span> must be defined with the values of the spreading variables of the population units. Figure <a href="BalancedSpreaded.html#fig:LPMKandahar">9.9</a> shows a ppswor sample of 40 units selected from the sampling frame of Kandahar, using the spatial coordinates of the population units as spreading variables. Inclusion probabilities are proportional to the agricultural area within the population units. The geographical spreading is improved compared with the sample shown in Figure <a href="pps.html#fig:ppswrKandahar">8.1</a>.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="BalancedSpreaded.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BalancedSampling)</span>
<span id="cb193-2"><a href="BalancedSpreaded.html#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sampling)</span>
<span id="cb193-3"><a href="BalancedSpreaded.html#cb193-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb193-4"><a href="BalancedSpreaded.html#cb193-4" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">inclusionprobabilities</span>(grdKandahar<span class="sc">$</span>agri, n)</span>
<span id="cb193-5"><a href="BalancedSpreaded.html#cb193-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grdKandahar<span class="sc">$</span>s1, grdKandahar<span class="sc">$</span>s2)</span>
<span id="cb193-6"><a href="BalancedSpreaded.html#cb193-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb193-7"><a href="BalancedSpreaded.html#cb193-7" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">lpm1</span>(pi, X)</span>
<span id="cb193-8"><a href="BalancedSpreaded.html#cb193-8" aria-hidden="true" tabindex="-1"></a>myLPMsample <span class="ot">&lt;-</span> grdKandahar[units, ]</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:LPMKandahar"></span>
<img src="SpatialSampling_files/figure-html/LPMKandahar-1.png" alt="Spatial ppswor sample of size 40 from Kandahar, selected by the local pivotal method, using agricultural area as a size variable." width="100%" />
<p class="caption">
Figure 9.9: Spatial ppswor sample of size 40 from Kandahar, selected by the local pivotal method, using agricultural area as a size variable.
</p>
</div>
<p>The total poppy area can be estimated with the <span class="math inline">\(\pi\)</span> estimator (Equation <a href="IntroProbabilitySampling.html#eq:HTTotal">(2.2)</a>).</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="BalancedSpreaded.html#cb194-1" aria-hidden="true" tabindex="-1"></a>myLPMsample<span class="sc">$</span>pi <span class="ot">&lt;-</span> pi[units]</span>
<span id="cb194-2"><a href="BalancedSpreaded.html#cb194-2" aria-hidden="true" tabindex="-1"></a>tz_HT <span class="ot">&lt;-</span> <span class="fu">sum</span>(myLPMsample<span class="sc">$</span>poppy <span class="sc">/</span> myLPMsample<span class="sc">$</span>pi)</span></code></pre></div>
<p>The estimated total poppy area equals 62,232 ha. The sampling variance of the estimator of the population total with the local pivotal method can be estimated by <span class="citation">(<a href="#ref-Grafstrom2014" role="doc-biblioref">Grafström and Schelin 2014</a>)</span></p>
<p><span class="math display" id="eq:VartotalLPM">\[\begin{equation}
\widehat{V}(\hat{t}(z)) = \frac{1}{2} \sum_{k \in \mathcal{S}} \left( \frac{z_k}{\pi_k} - \frac{z_{k_j}}{\pi_{k_j}} \right)^2 \;,
\tag{9.9}
\end{equation}\]</span></p>
<p>with <span class="math inline">\({k_j}\)</span> the nearest neighbour of unit <span class="math inline">\(k\)</span> in the sample. This variance estimator is for the case where we have only one nearest neighbour.</p>
<p>Function <code>vsb</code> of package <strong>BalancedSampling</strong> is an implementation of a more general variance estimator that accounts for more than one nearest neighbour (equation (6) in <span class="citation">Grafström and Schelin (<a href="#ref-Grafstrom2014" role="doc-biblioref">2014</a>)</span>). We expect a somewhat smaller variance compared to pps sampling, so we may use the variance of the pwr estimator (Equation <a href="pps.html#eq:VarHHTotalppswr">(8.2)</a>) as a conservative variance estimator.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="BalancedSpreaded.html#cb195-1" aria-hidden="true" tabindex="-1"></a>Xsample <span class="ot">&lt;-</span> X[units, ]</span>
<span id="cb195-2"><a href="BalancedSpreaded.html#cb195-2" aria-hidden="true" tabindex="-1"></a>se_tz_HT <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">vsb</span>(pi[units], myLPMsample<span class="sc">$</span>poppy, Xsample))</span>
<span id="cb195-3"><a href="BalancedSpreaded.html#cb195-3" aria-hidden="true" tabindex="-1"></a>pk <span class="ot">&lt;-</span> myLPMsample<span class="sc">$</span>pi <span class="sc">/</span> n</span>
<span id="cb195-4"><a href="BalancedSpreaded.html#cb195-4" aria-hidden="true" tabindex="-1"></a>se_tz_pwr <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(myLPMsample<span class="sc">$</span>poppy <span class="sc">/</span> pk) <span class="sc">/</span> n)</span></code></pre></div>
<p>The standard error obtained with function <code>vsb</code> equals 12,850 ha, the standard error of the pwr estimator equals 14,094 ha.</p>
<p>As explained above, the LPM design can also be used to select a probability sample well-spread in the space spanned by one or more quantitative covariates. Matrix <span class="math inline">\(\mathbf{X}\)</span> then should contain the values of the <em>scaled</em> (standardised) covariates instead of the spatial coordinates.</p>
<div id="exercises-15" class="section level4 unnumbered hasAnchor">
<h4>Exercises<a href="BalancedSpreaded.html#exercises-15" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol start="3" style="list-style-type: decimal">
<li>Geographical spreading of the sampling units can also be achieved by random sampling from compact geographical strata (geostrata) (Section <a href="STSI.html#geostrata">4.6</a>). Can you think of one or more advantages of LPM sampling over random sampling from geostrata?</li>
</ol>
</div>
</div>
<div id="GRTS" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Generalised random-tessellation stratified sampling<a href="BalancedSpreaded.html#GRTS" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Generalised random-tessellation stratified (GRTS) sampling is designed for sampling discrete objects scattered throughout space, think for instance of the lakes in Finland, segments of hedgerows in England, etc. Each object is represented by a point in 2D-space. It is a complicated design, and for sampling points from a continuous universe or raster cells from a finite population, I recommend more simple designs such as the local pivotal method (Subsection <a href="BalancedSpreaded.html#LPM">9.2.1</a>), balanced sampling with geographical spreading (Section <a href="BalancedSpreaded.html#BalancedandSpreaded">9.3</a>), or sampling from compact geographical strata (Section <a href="STSI.html#geostrata">4.6</a>). Let me try to explain the GRTS design with a simple example of a finite population of point objects in a circular study area (Figure <a href="BalancedSpreaded.html#fig:GRTSNumbering">9.10</a>). For a more detailed description of this design, refer to <span class="citation">Hankin, Mohr, and Newman (<a href="#ref-Hankin2019" role="doc-biblioref">2019</a>)</span>. As a first step, a square bounding box of the study area is constructed. This bounding box is recursively partitioned into square grid cells. First, 2 <span class="math inline">\(\times\)</span> 2 grid cells are constructed. These grid cells are numbered in a predefined order. In Figure <a href="BalancedSpreaded.html#fig:GRTSNumbering">9.10</a> this numbering is from lower left, lower right, upper left to upper right. Each grid cell is then subdivided into four subcells; the subcells are numbered using the same order. This is repeated until at most one population unit occurs in each subcell. For our population only two iterations were needed, leading to 4 <span class="math inline">\(\times\)</span> 4 subcells. Note that two subcells are empty. Each address of a subcell consists of two digits: the first digit refers to the grid cell, the second digit to the subcell.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:GRTSNumbering"></span>
<img src="SpatialSampling_files/figure-html/GRTSNumbering-1.png" alt="Numbering of grid cells and subcells for GRTS sampling." width="100%" />
<p class="caption">
Figure 9.10: Numbering of grid cells and subcells for GRTS sampling.
</p>
</div>
<p>The next step is to place the 16 subcells on a line in a random order. The randomisation is done hierarchically. First, the four grid cells at the highest level are randomised. In our example, the randomised order is 1, 2, 3, 0 (Figure <a href="BalancedSpreaded.html#fig:GRTS">9.11</a>). Next, within each grid cell, the order of the subcells is randomised. This is done independently for the grid cells. In our example, for grid cell 1 the randomised order of the subcells is 2, 1, 3, 0 (Figure <a href="BalancedSpreaded.html#fig:GRTS">9.11</a>). Note that the empty subcells (0,0) and (3,3) are removed from the line.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="BalancedSpreaded.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb196-2"><a href="BalancedSpreaded.html#cb196-2" aria-hidden="true" tabindex="-1"></a>ord <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb196-3"><a href="BalancedSpreaded.html#cb196-3" aria-hidden="true" tabindex="-1"></a>myfinpop_rand <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb196-4"><a href="BalancedSpreaded.html#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ord) {</span>
<span id="cb196-5"><a href="BalancedSpreaded.html#cb196-5" aria-hidden="true" tabindex="-1"></a>  units <span class="ot">&lt;-</span> <span class="fu">which</span>(myfinpop<span class="sc">$</span>partit1 <span class="sc">==</span> i)</span>
<span id="cb196-6"><a href="BalancedSpreaded.html#cb196-6" aria-hidden="true" tabindex="-1"></a>  units_rand <span class="ot">&lt;-</span> <span class="fu">sample</span>(units, <span class="at">size =</span> <span class="fu">length</span>(units))</span>
<span id="cb196-7"><a href="BalancedSpreaded.html#cb196-7" aria-hidden="true" tabindex="-1"></a>  myfinpop_rand <span class="ot">&lt;-</span> <span class="fu">rbind</span>(myfinpop_rand, myfinpop[units_rand, ])</span>
<span id="cb196-8"><a href="BalancedSpreaded.html#cb196-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>After the subcells have been placed on a line, a one-dimensional systematic random sample is selected (Figure <a href="BalancedSpreaded.html#fig:GRTS">9.11</a>), see also Subsection <a href="pps.html#Systematicpps">8.2.1</a>. This can be done either with equal or unequal inclusion probabilities. With equal inclusion probabilities, the length of the intervals representing the population units is constant. With unequal inclusion probabilities, the interval lengths are proportional to a size variable. For a sample size of <span class="math inline">\(n\)</span>, the total line is divided into <span class="math inline">\(n\)</span> segments of equal length. A random point is selected in the first segment, and the other points of the systematic sample are determined. Finally, the population units corresponding to the selected systematic sample are identified. With equal probabilities, the five selected units are the units in subcells 11, 23, 22, 32, and 03 (Figure <a href="BalancedSpreaded.html#fig:GRTS">9.11</a>).</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="BalancedSpreaded.html#cb197-1" aria-hidden="true" tabindex="-1"></a>size <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, N)</span>
<span id="cb197-2"><a href="BalancedSpreaded.html#cb197-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb197-3"><a href="BalancedSpreaded.html#cb197-3" aria-hidden="true" tabindex="-1"></a>interval <span class="ot">&lt;-</span> <span class="fu">sum</span>(size) <span class="sc">/</span> n</span>
<span id="cb197-4"><a href="BalancedSpreaded.html#cb197-4" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">*</span> interval, <span class="dv">2</span>)</span>
<span id="cb197-5"><a href="BalancedSpreaded.html#cb197-5" aria-hidden="true" tabindex="-1"></a>mysys <span class="ot">&lt;-</span> <span class="fu">c</span>(start, <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> interval <span class="sc">+</span> start)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:GRTS"></span>
<img src="SpatialSampling_files/figure-html/GRTS-1.png" alt="Systematic random sample along a line with equal inclusion probabilities." width="100%" />
<p class="caption">
Figure 9.11: Systematic random sample along a line with equal inclusion probabilities.
</p>
</div>
<p>Figure <a href="BalancedSpreaded.html#fig:GRTSpps">9.12</a> shows a systematic random sample along a line with unequal inclusion probabilities. The inclusion probabilities are proportional to a size variable, with values 1, 2, 3, or 4. The selected population units are the units in subcells 10, 20, 31, 01, and 02.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:GRTSpps"></span>
<img src="SpatialSampling_files/figure-html/GRTSpps-1.png" alt="Systematic random sample along a line with inclusion probabilities proportional to size." width="100%" />
<p class="caption">
Figure 9.12: Systematic random sample along a line with inclusion probabilities proportional to size.
</p>
</div>
<p>GRTS samples can be selected with function <code>grts</code> of package <strong>spsurvey</strong> <span class="citation">(<a href="#ref-spsurvey" role="doc-biblioref">Dumelle et al. 2021</a>)</span>. The next code chunk shows the selection of a GRTS sample of 40 units from Kandahar. Tibble <code>grdKandahar</code> is first converted to an <code>sf</code> object with function <code>st_as_sf</code> of package <strong>sf</strong> <span class="citation">(<a href="#ref-sf" role="doc-biblioref">E. Pebesma 2018</a>)</span>. The data set is using a UTM projection (zone 41N) with WGS84 datum. This projection is passed to function <code>st_as_df</code> with argument <code>crs</code> (<code>crs = 32641</code>). Argument <code>sframe</code> of function <code>grts</code> specifies the sampling frame. The sample size is passed to function <code>grts</code> with argument <code>n_base</code>. Argument <code>seltype</code> is set to <code>proportional</code> to select units with probabilities proportional to an ancillary variable which is passed to function <code>grts</code> with argument <code>aux_var</code>.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="BalancedSpreaded.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spsurvey)</span>
<span id="cb198-2"><a href="BalancedSpreaded.html#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb198-3"><a href="BalancedSpreaded.html#cb198-3" aria-hidden="true" tabindex="-1"></a>sframe_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(grdKandahar, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;s1&quot;</span>, <span class="st">&quot;s2&quot;</span>), <span class="at">crs =</span> <span class="dv">32641</span>)</span>
<span id="cb198-4"><a href="BalancedSpreaded.html#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb198-5"><a href="BalancedSpreaded.html#cb198-5" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">grts</span>(</span>
<span id="cb198-6"><a href="BalancedSpreaded.html#cb198-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sframe =</span> sframe_sf, <span class="at">n_base =</span> <span class="dv">40</span>, <span class="at">seltype =</span> <span class="st">&quot;proportional&quot;</span>, <span class="at">aux_var =</span> <span class="st">&quot;agri&quot;</span>)</span>
<span id="cb198-7"><a href="BalancedSpreaded.html#cb198-7" aria-hidden="true" tabindex="-1"></a>myGRTSsample <span class="ot">&lt;-</span> res<span class="sc">$</span>sites_base</span></code></pre></div>
<p>Function <code>cont_analysis</code> computes the ratio estimator of the population mean and its standard error. The estimated mean is multiplied by the total number of population units to obtain a ratio estimate of the population total.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="BalancedSpreaded.html#cb199-1" aria-hidden="true" tabindex="-1"></a>myGRTSsample<span class="sc">$</span>siteID <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;siteID&quot;</span>, <span class="fu">seq_len</span>(<span class="fu">nrow</span>(myGRTSsample)))</span>
<span id="cb199-2"><a href="BalancedSpreaded.html#cb199-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">cont_analysis</span>(myGRTSsample,</span>
<span id="cb199-3"><a href="BalancedSpreaded.html#cb199-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">vars =</span> <span class="st">&quot;poppy&quot;</span>, <span class="at">siteID =</span> <span class="st">&quot;siteID&quot;</span>, <span class="at">weight =</span> <span class="st">&quot;wgt&quot;</span>, <span class="at">statistics =</span> <span class="st">&quot;Mean&quot;</span>)</span>
<span id="cb199-4"><a href="BalancedSpreaded.html#cb199-4" aria-hidden="true" tabindex="-1"></a>tz_ratio <span class="ot">&lt;-</span> res<span class="sc">$</span>Mean<span class="sc">$</span>Estimate <span class="sc">*</span> <span class="fu">nrow</span>(grdKandahar)</span>
<span id="cb199-5"><a href="BalancedSpreaded.html#cb199-5" aria-hidden="true" tabindex="-1"></a>se_tz_ratio <span class="ot">&lt;-</span> res<span class="sc">$</span>Mean<span class="sc">$</span>StdError <span class="sc">*</span> <span class="fu">nrow</span>(grdKandahar)</span></code></pre></div>
<p>The estimated total poppy area is 109,809 ha, and the estimated standard error is 24,327 ha.</p>
<p>The alternative is to estimate the total poppy area by the <span class="math inline">\(\pi\)</span> estimator. Function <code>vsb</code> of package <strong>BalancedSampling</strong> can be used to estimate the standard error of the <span class="math inline">\(\pi\)</span> estimator.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="BalancedSpreaded.html#cb200-1" aria-hidden="true" tabindex="-1"></a>tz_HT <span class="ot">&lt;-</span> <span class="fu">sum</span>(myGRTSsample<span class="sc">$</span>poppy <span class="sc">/</span> myGRTSsample<span class="sc">$</span>ip)</span>
<span id="cb200-2"><a href="BalancedSpreaded.html#cb200-2" aria-hidden="true" tabindex="-1"></a>Xsample <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(myGRTSsample)</span>
<span id="cb200-3"><a href="BalancedSpreaded.html#cb200-3" aria-hidden="true" tabindex="-1"></a>se_tz_HT <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">vsb</span>(myGRTSsample<span class="sc">$</span>ip, myGRTSsample<span class="sc">$</span>poppy, Xsample))</span></code></pre></div>
<p>The estimated total is 71,634 ha, and the estimated standard error is 12,593 ha.</p>
</div>
</div>
<div id="BalancedandSpreaded" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Balanced sampling with spreading<a href="BalancedSpreaded.html#BalancedandSpreaded" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As mentioned in the introduction to this chapter, a sample balanced on a covariate still may have a poor spreading along the axis spanned by the covariate. <span class="citation">Grafström and Tillé (<a href="#ref-Grafstrom2013" role="doc-biblioref">2013</a>)</span> presented a method for selecting balanced samples that are also well-spread in the space spanned by the covariates, which they refer to as doubly balanced sampling. If we take one or more covariates as balancing variables and, besides, Easting and Northing as spreading variables, this leads to balanced samples with good <em>geographical</em> spreading. When the residuals of the regression model show spatial structure (are spatially correlated), the estimated population mean of the study variable becomes more precise thanks to the improved geographical spreading. Balanced samples with spreading can be selected with function <code>lcube</code> of package <strong>BalancedSampling</strong>. This is illustrated with Eastern Amazonia, using as before lnSWIR2 for balancing the sample.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="BalancedSpreaded.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BalancedSampling)</span>
<span id="cb201-2"><a href="BalancedSpreaded.html#cb201-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(grdAmazonia)</span>
<span id="cb201-3"><a href="BalancedSpreaded.html#cb201-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb201-4"><a href="BalancedSpreaded.html#cb201-4" aria-hidden="true" tabindex="-1"></a>Xbal <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="at">times =</span> N), grdAmazonia<span class="sc">$</span>lnSWIR2)</span>
<span id="cb201-5"><a href="BalancedSpreaded.html#cb201-5" aria-hidden="true" tabindex="-1"></a>Xspread <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grdAmazonia<span class="sc">$</span>x1, grdAmazonia<span class="sc">$</span>x2)</span>
<span id="cb201-6"><a href="BalancedSpreaded.html#cb201-6" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">rep</span>(n <span class="sc">/</span> N, <span class="at">times =</span> N)</span>
<span id="cb201-7"><a href="BalancedSpreaded.html#cb201-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb201-8"><a href="BalancedSpreaded.html#cb201-8" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">lcube</span>(<span class="at">Xbal =</span> Xbal, <span class="at">Xspread =</span> Xspread, <span class="at">prob =</span> pi)</span>
<span id="cb201-9"><a href="BalancedSpreaded.html#cb201-9" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> grdAmazonia[units, ]</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:DoublyBalancedSampleAmazonia"></span>
<img src="SpatialSampling_files/figure-html/DoublyBalancedSampleAmazonia-1.png" alt="Sample balanced on lnSWIR2 with geographical spreading from Eastern Amazonia." width="100%" />
<p class="caption">
Figure 9.13: Sample balanced on lnSWIR2 with geographical spreading from Eastern Amazonia.
</p>
</div>
<p>The selected sample is shown in Figure <a href="BalancedSpreaded.html#fig:DoublyBalancedSampleAmazonia">9.13</a>. Comparing this sample with the balanced sample of Figure <a href="BalancedSpreaded.html#fig:BalancedSampleAmazonia">9.3</a> shows that the geographical spreading of the sample is improved, although there still are some close points. I used equal inclusion probabilities, so the <span class="math inline">\(\pi\)</span> estimate of the mean is equal to the sample mean, which is equal to 225.6 10<sup>9</sup> kg ha<sup>-1</sup>.</p>
<p>The variance of the <span class="math inline">\(\pi\)</span> estimator of the mean can be estimated by (equation (7) of <span class="citation">Grafström and Tillé (<a href="#ref-Grafstrom2013" role="doc-biblioref">2013</a>)</span>)</p>
<p><span class="math display" id="eq:VarmeanDoublyBalanced">\[\begin{equation}
\widehat{V}(\hat{\bar{z}}) = \frac{n}{n-p}\frac{p}{p+1} \sum_{k \in \mathcal{S}}(1-\pi_k) \left(\frac{e_k}{\pi_k}-\bar{e}_k \right)^2 \;,
\tag{9.10}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(p\)</span> the number of balancing variables, <span class="math inline">\(e_k\)</span> the regression model residual of unit <span class="math inline">\(k\)</span> (Equation <a href="BalancedSpreaded.html#eq:residualsBalanced">(9.4)</a>), and <span class="math inline">\(\bar{e}_k\)</span> the local mean of the residuals of this unit, computed by</p>
<p><span class="math display" id="eq:localmeanresdual">\[\begin{equation}
\bar{e}_k = \frac{\sum_{j=1}^{p+1}(1-\pi_j)\frac{e_j}{\pi_j}}{\sum_{j=1}^{p+1}(1-\pi_j)}\;.
\tag{9.11}
\end{equation}\]</span></p>
<p>The variance estimator can be computed with functions <code>localmean_weight</code> and <code>localmean_var</code> of package <strong>spsurvey</strong> <span class="citation">(<a href="#ref-spsurvey" role="doc-biblioref">Dumelle et al. 2021</a>)</span>.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="BalancedSpreaded.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spsurvey)</span>
<span id="cb202-2"><a href="BalancedSpreaded.html#cb202-2" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">rep</span>(n <span class="sc">/</span> N, n)</span>
<span id="cb202-3"><a href="BalancedSpreaded.html#cb202-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> pi)</span>
<span id="cb202-4"><a href="BalancedSpreaded.html#cb202-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">estimate_b</span>(<span class="at">z =</span> mysample<span class="sc">$</span>AGB <span class="sc">/</span> pi, <span class="at">X =</span> Xbal[units, ] <span class="sc">/</span> pi, <span class="at">c =</span> c)</span>
<span id="cb202-5"><a href="BalancedSpreaded.html#cb202-5" aria-hidden="true" tabindex="-1"></a>zpred <span class="ot">&lt;-</span> Xbal <span class="sc">%*%</span> b</span>
<span id="cb202-6"><a href="BalancedSpreaded.html#cb202-6" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> mysample<span class="sc">$</span>AGB <span class="sc">-</span> zpred[units]</span>
<span id="cb202-7"><a href="BalancedSpreaded.html#cb202-7" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">localmean_weight</span>(<span class="at">x =</span> mysample<span class="sc">$</span>x1, <span class="at">y =</span> mysample<span class="sc">$</span>x2, <span class="at">prb =</span> pi, <span class="at">nbh =</span> <span class="dv">3</span>)</span>
<span id="cb202-8"><a href="BalancedSpreaded.html#cb202-8" aria-hidden="true" tabindex="-1"></a>v_mz <span class="ot">&lt;-</span> <span class="fu">localmean_var</span>(<span class="at">z =</span> e <span class="sc">/</span> pi, <span class="at">weight_1st =</span> weights) <span class="sc">/</span> N<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<p>The estimated standard error is 2.8 10<sup>9</sup> kg ha<sup>-1</sup>, which is considerably smaller than the estimated standard error of the balanced sample without geographical spreading.</p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Deville2004" class="csl-entry">
———. 2004. <span>“Efficient Balanced Sampling: The Cube Method.”</span> <em>Biometrika</em> 91 (4): 893–912.
</div>
<div id="ref-Deville2005" class="csl-entry">
———. 2005. <span>“Variance Approximation Under Balanced Sampling.”</span> <em>Journal of Statistical Planning and Inference</em> 128 (2): 569–91.
</div>
<div id="ref-spsurvey" class="csl-entry">
Dumelle, M., T. M. Kincaid, A. R. Olsen, and M. H. Weber. 2021. <em><span class="nocase">spsurvey: Spatial Sampling Design and Analysis</span></em>.
</div>
<div id="ref-Falorsi2008" class="csl-entry">
Falorsi, P. D., and P. Righi. 2008. <span>“A Balanced Sampling Approach for Multi-Way Stratification Designs for Small Area Estimation.”</span> <em>Survey Methodology</em> 34 (2): 223–34.
</div>
<div id="ref-Grafstrom2012b" class="csl-entry">
Grafström, A. 2012. <span>“<span class="nocase">Spatially correlated Poisson sampling</span>.”</span> <em>Journal of Statistical Planning and Inference</em> 142 (1): 139–47.
</div>
<div id="ref-Grafstrom2016" class="csl-entry">
Grafström, A., and J. Lisic. 2019. <em>BalancedSampling: Balanced and Spatially Balanced Sampling</em>. <a href="https://CRAN.R-project.org/package=BalancedSampling">https://CRAN.R-project.org/package=BalancedSampling</a>.
</div>
<div id="ref-Grafstrom2012" class="csl-entry">
Grafström, A., N. L. P. Lundström, and L. Schelin. 2012. <span>“Spatially Balanced Sampling Through the Pivotal Method.”</span> <em>Biometrics</em> 68 (2): 514–20.
</div>
<div id="ref-Grafstrom2014" class="csl-entry">
Grafström, A., and L. Schelin. 2014. <span>“How to Select Representative Samples.”</span> <em>Scandinavian Journal of Statistics</em> 41 (2): 277–90. <a href="https://doi.org/10.1111/sjos.12016">https://doi.org/10.1111/sjos.12016</a>.
</div>
<div id="ref-Grafstrom2013" class="csl-entry">
Grafström, A., and Y. Tillé. 2013. <span>“Doubly Balanced Spatial Sampling with Spreading and Restitution of Auxiliary Totals.”</span> <em>Environmetrics</em> 24 (2): 120–31. <a href="https://doi.org/10.1002/env.2194">https://doi.org/10.1002/env.2194</a>.
</div>
<div id="ref-Hankin2019" class="csl-entry">
Hankin, D. G., M. S. Mohr, and K. B. Newman. 2019. <em>Sampling Theory: For the Ecological and Natural Resource Sciences</em>. United Kingdom: Oxford University Press.
</div>
<div id="ref-samplingBigData" class="csl-entry">
Lisic, Jonathan, and Anton Grafström. 2018. <em>SamplingBigData: Sampling Methods for Big Data</em>. <a href="https://CRAN.R-project.org/package=SamplingBigData">https://CRAN.R-project.org/package=SamplingBigData</a>.
</div>
<div id="ref-sf" class="csl-entry">
Pebesma, Edzer. 2018. <span>“Simple Features for <span>R</span>: Standardized Support for Spatial Vector Data.”</span> <em><span>The R Journal</span></em> 10 (1): 439–46. <a href="https://doi.org/10.32614/RJ-2018-009">https://doi.org/10.32614/RJ-2018-009</a>.
</div>
<div id="ref-Robertson2013" class="csl-entry">
Robertson, B. L., J. A. Brown, T. McDonald, and P. Jaksons. 2013. <span>“<span class="nocase">BAS: Balanced Acceptance Sampling of Natural Resources</span>.”</span> <em>Biometrics</em> 69 (3): 776–84. <a href="https://doi.org/DOI: 10.1111/biom.12059">https://doi.org/DOI: 10.1111/biom.12059</a>.
</div>
<div id="ref-stevens2004" class="csl-entry">
Stevens, D. L., and A. R. Olson. 2004. <span>“Spatially Balanced Sampling of Natural Resources.”</span> <em>Journal of the American Statistical Association</em> 99 (465): 262–78.
</div>
<div id="ref-Tille2016" class="csl-entry">
Tillé, Y., and A. Matei. 2021. <em><span class="nocase">sampling: Survey Sampling</span></em>. <a href="https://CRAN.R-project.org/package=sampling">https://CRAN.R-project.org/package=sampling</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pps.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Modelassisted.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/DickBrus/SpatialSamplingwithR/edit/master/09-BalancedandSpreaded.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SpatialSampling.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
