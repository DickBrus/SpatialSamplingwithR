<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Balanced and well-spread sampling | Spatial sampling with R</title>
  <meta name="description" content="This book is for students, scientists, researchers and consultants who want to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Balanced and well-spread sampling | Spatial sampling with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/images/cover.pdf" />
  <meta property="og:description" content="This book is for students, scientists, researchers and consultants who want to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="github-repo" content="DickBrus/SpatialSamplingwithR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Balanced and well-spread sampling | Spatial sampling with R" />
  
  <meta name="twitter:description" content="This book is for students, scientists, researchers and consultants who want to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="twitter:image" content="/images/cover.pdf" />

<meta name="author" content="Dick J. Brus" />


<meta name="date" content="2021-09-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pps.html"/>
<link rel="next" href="Modelassisted.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial sampling with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="GeneralIntro.html"><a href="GeneralIntro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="GeneralIntro.html"><a href="GeneralIntro.html#BasicConcepts"><i class="fa fa-check"></i><b>1.1</b> Basic sampling concepts</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="GeneralIntro.html"><a href="GeneralIntro.html#PopulationParameters"><i class="fa fa-check"></i><b>1.1.1</b> Population parameters</a></li>
<li class="chapter" data-level="1.1.2" data-path="GeneralIntro.html"><a href="GeneralIntro.html#descriptive-statistics-versus-inference-about-a-population"><i class="fa fa-check"></i><b>1.1.2</b> Descriptive statistics versus inference about a population</a></li>
<li class="chapter" data-level="1.1.3" data-path="GeneralIntro.html"><a href="GeneralIntro.html#random-sampling-versus-probability-sampling"><i class="fa fa-check"></i><b>1.1.3</b> Random sampling versus probability sampling</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="GeneralIntro.html"><a href="GeneralIntro.html#DBvsMB"><i class="fa fa-check"></i><b>1.2</b> Design-based versus model-based approach</a></li>
<li class="chapter" data-level="1.3" data-path="GeneralIntro.html"><a href="GeneralIntro.html#Datasets"><i class="fa fa-check"></i><b>1.3</b> Populations used in sampling experiments</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="GeneralIntro.html"><a href="GeneralIntro.html#Voorst"><i class="fa fa-check"></i><b>1.3.1</b> Soil organic matter in Voorst (Netherlands)</a></li>
<li class="chapter" data-level="1.3.2" data-path="GeneralIntro.html"><a href="GeneralIntro.html#Poppy"><i class="fa fa-check"></i><b>1.3.2</b> Poppy fields in Kandahar (Afghanistan)</a></li>
<li class="chapter" data-level="1.3.3" data-path="GeneralIntro.html"><a href="GeneralIntro.html#aboveground-biomass-in-eastern-amazonia"><i class="fa fa-check"></i><b>1.3.3</b> Aboveground biomass in Eastern Amazonia</a></li>
<li class="chapter" data-level="1.3.4" data-path="GeneralIntro.html"><a href="GeneralIntro.html#TASSpainPortugal"><i class="fa fa-check"></i><b>1.3.4</b> Annual mean air temperature in Spain and Portugal</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Probability sampling for estimating (sub)population parameters</b></span></li>
<li class="chapter" data-level="2" data-path="IntroProbabilitySampling.html"><a href="IntroProbabilitySampling.html"><i class="fa fa-check"></i><b>2</b> Introduction to probability sampling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="IntroProbabilitySampling.html"><a href="IntroProbabilitySampling.html#HTestimator"><i class="fa fa-check"></i><b>2.1</b> Horvitz-Thompson estimator</a></li>
<li class="chapter" data-level="2.2" data-path="IntroProbabilitySampling.html"><a href="IntroProbabilitySampling.html#hansen-hurwitz-estimator"><i class="fa fa-check"></i><b>2.2</b> Hansen-Hurwitz estimator</a></li>
<li class="chapter" data-level="2.3" data-path="IntroProbabilitySampling.html"><a href="IntroProbabilitySampling.html#using-models-in-design-based-approach"><i class="fa fa-check"></i><b>2.3</b> Using models in design-based approach</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="SI.html"><a href="SI.html"><i class="fa fa-check"></i><b>3</b> Simple random sampling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="SI.html"><a href="SI.html#HTestimatorSI"><i class="fa fa-check"></i><b>3.1</b> Estimation of population parameters</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="SI.html"><a href="SI.html#PopProportion"><i class="fa fa-check"></i><b>3.1.1</b> Population proportion</a></li>
<li class="chapter" data-level="3.1.2" data-path="SI.html"><a href="SI.html#CDF"><i class="fa fa-check"></i><b>3.1.2</b> Cumulative distribution function and quantiles</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="SI.html"><a href="SI.html#VarMeanSI"><i class="fa fa-check"></i><b>3.2</b> Sampling variance of estimator of population mean, total and proportion</a></li>
<li class="chapter" data-level="3.3" data-path="SI.html"><a href="SI.html#ConfidenceInterval"><i class="fa fa-check"></i><b>3.3</b> Confidence interval estimates</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="SI.html"><a href="SI.html#ConfidenceIntervalProportion"><i class="fa fa-check"></i><b>3.3.1</b> Confidence interval for proportion</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="SI.html"><a href="SI.html#SIcircularplots"><i class="fa fa-check"></i><b>3.4</b> Simple random sampling of circular plots</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="SI.html"><a href="SI.html#sampling-from-a-finite-set-of-fixed-circles"><i class="fa fa-check"></i><b>3.4.1</b> Sampling from a finite set of fixed circles</a></li>
<li class="chapter" data-level="3.4.2" data-path="SI.html"><a href="SI.html#sampling-from-an-infinite-set-of-floating-circles"><i class="fa fa-check"></i><b>3.4.2</b> Sampling from an infinite set of floating circles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="STSI.html"><a href="STSI.html"><i class="fa fa-check"></i><b>4</b> Stratified simple random sampling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="STSI.html"><a href="STSI.html#EstimatorsSTSI"><i class="fa fa-check"></i><b>4.1</b> Estimation of population parameters</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="STSI.html"><a href="STSI.html#estimation-of-population-proportion-cumulative-distribution-function-and-quantiles"><i class="fa fa-check"></i><b>4.1.1</b> Estimation of population proportion, cumulative distribution function and quantiles</a></li>
<li class="chapter" data-level="4.1.2" data-path="STSI.html"><a href="STSI.html#WhyStratify"><i class="fa fa-check"></i><b>4.1.2</b> Why should we stratify?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="STSI.html"><a href="STSI.html#CISTSI"><i class="fa fa-check"></i><b>4.2</b> Confidence interval estimate</a></li>
<li class="chapter" data-level="4.3" data-path="STSI.html"><a href="STSI.html#STSIallocation"><i class="fa fa-check"></i><b>4.3</b> Allocation of sample size to strata</a></li>
<li class="chapter" data-level="4.4" data-path="STSI.html"><a href="STSI.html#cumrootf"><i class="fa fa-check"></i><b>4.4</b> <em>Cum-root-f</em> stratification</a></li>
<li class="chapter" data-level="4.5" data-path="STSI.html"><a href="STSI.html#kmeansstratification"><i class="fa fa-check"></i><b>4.5</b> Stratification with multiple covariates</a></li>
<li class="chapter" data-level="4.6" data-path="STSI.html"><a href="STSI.html#geostrata"><i class="fa fa-check"></i><b>4.6</b> Geographical stratification</a></li>
<li class="chapter" data-level="4.7" data-path="STSI.html"><a href="STSI.html#multi-way-stratification"><i class="fa fa-check"></i><b>4.7</b> Multi-way stratification</a></li>
<li class="chapter" data-level="4.8" data-path="STSI.html"><a href="STSI.html#MultivariateStratification"><i class="fa fa-check"></i><b>4.8</b> Multivariate stratification</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="SY.html"><a href="SY.html"><i class="fa fa-check"></i><b>5</b> Systematic random sampling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="SY.html"><a href="SY.html#EstVarSY"><i class="fa fa-check"></i><b>5.1</b> Estimation of population parameters</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="SY.html"><a href="SY.html#approximating-the-sampling-variance-of-the-estimator-of-the-mean"><i class="fa fa-check"></i><b>5.1.1</b> Approximating the sampling variance of the estimator of the mean</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Cl.html"><a href="Cl.html"><i class="fa fa-check"></i><b>6</b> Cluster random sampling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="Cl.html"><a href="Cl.html#clustersamplingestimators"><i class="fa fa-check"></i><b>6.1</b> Estimation of population parameters</a></li>
<li class="chapter" data-level="6.2" data-path="Cl.html"><a href="Cl.html#clusters-selected-with-probabilities-proportional-to-size-without-replacement"><i class="fa fa-check"></i><b>6.2</b> Clusters selected with probabilities proportional to size, without replacement</a></li>
<li class="chapter" data-level="6.3" data-path="Cl.html"><a href="Cl.html#simple-random-sampling-of-clusters"><i class="fa fa-check"></i><b>6.3</b> Simple random sampling of clusters</a></li>
<li class="chapter" data-level="6.4" data-path="Cl.html"><a href="Cl.html#StratifiedCl"><i class="fa fa-check"></i><b>6.4</b> Stratified cluster random sampling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Twostage.html"><a href="Twostage.html"><i class="fa fa-check"></i><b>7</b> Two-stage cluster random sampling</a>
<ul>
<li class="chapter" data-level="7.1" data-path="Twostage.html"><a href="Twostage.html#twostagesamplingestimators"><i class="fa fa-check"></i><b>7.1</b> Estimation of population parameters</a></li>
<li class="chapter" data-level="7.2" data-path="Twostage.html"><a href="Twostage.html#primary-sampling-units-selected-with-probabilities-proportional-to-size-without-replacement"><i class="fa fa-check"></i><b>7.2</b> Primary sampling units selected with probabilities proportional to size, without replacement</a></li>
<li class="chapter" data-level="7.3" data-path="Twostage.html"><a href="Twostage.html#simple-random-sampling-of-primary-sampling-units"><i class="fa fa-check"></i><b>7.3</b> Simple random sampling of primary sampling units</a></li>
<li class="chapter" data-level="7.4" data-path="Twostage.html"><a href="Twostage.html#StratifiedTwostage"><i class="fa fa-check"></i><b>7.4</b> Stratified two-stage cluster random sampling</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="pps.html"><a href="pps.html"><i class="fa fa-check"></i><b>8</b> Sampling with probabilities proportional to size</a>
<ul>
<li class="chapter" data-level="8.1" data-path="pps.html"><a href="pps.html#ppswr"><i class="fa fa-check"></i><b>8.1</b> Probability-proportional-to-size sampling with replacement</a></li>
<li class="chapter" data-level="8.2" data-path="pps.html"><a href="pps.html#ppswor"><i class="fa fa-check"></i><b>8.2</b> Probability-proportional-to-size sampling without replacement</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="pps.html"><a href="pps.html#Systematicpps"><i class="fa fa-check"></i><b>8.2.1</b> Systematic pps sampling without replacement</a></li>
<li class="chapter" data-level="8.2.2" data-path="pps.html"><a href="pps.html#pivotalmethod"><i class="fa fa-check"></i><b>8.2.2</b> The pivotal method</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html"><i class="fa fa-check"></i><b>9</b> Balanced and well-spread sampling</a>
<ul>
<li class="chapter" data-level="9.1" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#Balanced"><i class="fa fa-check"></i><b>9.1</b> Balanced sampling</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#balanced-sample-versus-balanced-sampling-design"><i class="fa fa-check"></i><b>9.1.1</b> Balanced sample versus balanced sampling design</a></li>
<li class="chapter" data-level="9.1.2" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#unequal-inclusion-probabilities"><i class="fa fa-check"></i><b>9.1.2</b> Unequal inclusion probabilities</a></li>
<li class="chapter" data-level="9.1.3" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#StratifiedsamplingasBalancedsampling"><i class="fa fa-check"></i><b>9.1.3</b> Stratified random sampling</a></li>
<li class="chapter" data-level="9.1.4" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#Multiwaystratification"><i class="fa fa-check"></i><b>9.1.4</b> Multi-way stratification</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#Spreaded"><i class="fa fa-check"></i><b>9.2</b> Well-spread sampling</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#LPM"><i class="fa fa-check"></i><b>9.2.1</b> Local pivotal method</a></li>
<li class="chapter" data-level="9.2.2" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#GRTS"><i class="fa fa-check"></i><b>9.2.2</b> Generalised random-tessellation stratified sampling</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#BalancedandSpreaded"><i class="fa fa-check"></i><b>9.3</b> Balanced sampling with spreading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Modelassisted.html"><a href="Modelassisted.html"><i class="fa fa-check"></i><b>10</b> Model-assisted estimation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="Modelassisted.html"><a href="Modelassisted.html#GREG"><i class="fa fa-check"></i><b>10.1</b> Generalised regression estimator</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="Modelassisted.html"><a href="Modelassisted.html#RegressionEstimator"><i class="fa fa-check"></i><b>10.1.1</b> Simple and multiple regression estimators</a></li>
<li class="chapter" data-level="10.1.2" data-path="Modelassisted.html"><a href="Modelassisted.html#penalised-least-squares-estimation"><i class="fa fa-check"></i><b>10.1.2</b> Penalised least squares estimation</a></li>
<li class="chapter" data-level="10.1.3" data-path="Modelassisted.html"><a href="Modelassisted.html#RegressionEstimatorSTSI"><i class="fa fa-check"></i><b>10.1.3</b> Regression estimator with stratified simple random sampling</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="Modelassisted.html"><a href="Modelassisted.html#RatioEstimator"><i class="fa fa-check"></i><b>10.2</b> Ratio estimator</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="Modelassisted.html"><a href="Modelassisted.html#RatioEstimatorSTSI"><i class="fa fa-check"></i><b>10.2.1</b> Ratio estimators with stratified simple random sampling</a></li>
<li class="chapter" data-level="10.2.2" data-path="Modelassisted.html"><a href="Modelassisted.html#PoststratifiedEstimator"><i class="fa fa-check"></i><b>10.2.2</b> Poststratified estimator</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="Modelassisted.html"><a href="Modelassisted.html#RandomForest"><i class="fa fa-check"></i><b>10.3</b> Model-assisted estimation using machine learning techniques</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="Modelassisted.html"><a href="Modelassisted.html#predicting-with-a-regression-tree"><i class="fa fa-check"></i><b>10.3.1</b> Predicting with a regression tree</a></li>
<li class="chapter" data-level="10.3.2" data-path="Modelassisted.html"><a href="Modelassisted.html#predicting-with-a-random-forest"><i class="fa fa-check"></i><b>10.3.2</b> Predicting with a random forest</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="Modelassisted.html"><a href="Modelassisted.html#big-data-and-volunteer-data"><i class="fa fa-check"></i><b>10.4</b> Big data and volunteer data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Twophase.html"><a href="Twophase.html"><i class="fa fa-check"></i><b>11</b> Two-phase random sampling</a>
<ul>
<li class="chapter" data-level="11.1" data-path="Twophase.html"><a href="Twophase.html#TwophaseStratification"><i class="fa fa-check"></i><b>11.1</b> Two-phase random sampling for stratification</a></li>
<li class="chapter" data-level="11.2" data-path="Twophase.html"><a href="Twophase.html#TwophaseRegression"><i class="fa fa-check"></i><b>11.2</b> Two-phase random sampling for regression</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html"><i class="fa fa-check"></i><b>12</b> Computing the required sample size</a>
<ul>
<li class="chapter" data-level="12.1" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#standard-error-of-estimator"><i class="fa fa-check"></i><b>12.1</b> Standard error of estimator</a></li>
<li class="chapter" data-level="12.2" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#ReqSampleSizeLengthCI"><i class="fa fa-check"></i><b>12.2</b> Length of confidence interval</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#length-of-confidence-interval-for-a-proportion"><i class="fa fa-check"></i><b>12.2.1</b> Length of confidence interval for a proportion</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#statistical-testing-of-hypothesis"><i class="fa fa-check"></i><b>12.3</b> Statistical testing of hypothesis</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#sample-size-for-testing-a-proportion"><i class="fa fa-check"></i><b>12.3.1</b> Sample size for testing a proportion</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#DesignEffect"><i class="fa fa-check"></i><b>12.4</b> Accounting for design effect</a></li>
<li class="chapter" data-level="12.5" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#BayesianSampleSize"><i class="fa fa-check"></i><b>12.5</b> Bayesian sample size determination</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#bayesian-criteria-for-sample-size-computation"><i class="fa fa-check"></i><b>12.5.1</b> Bayesian criteria for sample size computation</a></li>
<li class="chapter" data-level="12.5.2" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#mixed-bayesian-likelihood-approach"><i class="fa fa-check"></i><b>12.5.2</b> Mixed Bayesian-likelihood approach</a></li>
<li class="chapter" data-level="12.5.3" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#estimation-of-population-mean"><i class="fa fa-check"></i><b>12.5.3</b> Estimation of population mean</a></li>
<li class="chapter" data-level="12.5.4" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#estimation-of-a-population-proportion"><i class="fa fa-check"></i><b>12.5.4</b> Estimation of a population proportion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html"><i class="fa fa-check"></i><b>13</b> Model-based optimisation of probability sampling designs</a>
<ul>
<li class="chapter" data-level="13.1" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#model-based-optimisation-of-sampling-design-type-and-sample-size"><i class="fa fa-check"></i><b>13.1</b> Model-based optimisation of sampling design type and sample size</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#AnalyticalApproach"><i class="fa fa-check"></i><b>13.1.1</b> Analytical approach</a></li>
<li class="chapter" data-level="13.1.2" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#GeostatisticalSimulationApproach"><i class="fa fa-check"></i><b>13.1.2</b> Geostatistical simulation approach</a></li>
<li class="chapter" data-level="13.1.3" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#MBpredSamplingVarBayes"><i class="fa fa-check"></i><b>13.1.3</b> Bayesian approach</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#Ospats"><i class="fa fa-check"></i><b>13.2</b> Model-based optimisation of spatial strata</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html"><i class="fa fa-check"></i><b>14</b> Sampling for estimating parameters of (small) domains</a>
<ul>
<li class="chapter" data-level="14.1" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#LargeDomainsDirectEstimator"><i class="fa fa-check"></i><b>14.1</b> Direct estimator for large domains</a></li>
<li class="chapter" data-level="14.2" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#SmallDomainsModelAssisted"><i class="fa fa-check"></i><b>14.2</b> Model-assisted estimators for small domains</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#RegressionestimatorSmallDomain"><i class="fa fa-check"></i><b>14.2.1</b> Regression estimator</a></li>
<li class="chapter" data-level="14.2.2" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#SyntheticestimatorSmallDomain"><i class="fa fa-check"></i><b>14.2.2</b> Synthetic estimator</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#SmallAreaModelBased"><i class="fa fa-check"></i><b>14.3</b> Model-based prediction</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#random-intercept-model"><i class="fa fa-check"></i><b>14.3.1</b> Random intercept model</a></li>
<li class="chapter" data-level="14.3.2" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#geostatistical-model"><i class="fa fa-check"></i><b>14.3.2</b> Geostatistical model</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#supplemental-probability-sampling-of-small-domains"><i class="fa fa-check"></i><b>14.4</b> Supplemental probability sampling of small domains</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html"><i class="fa fa-check"></i><b>15</b> Repeated sample surveys for monitoring population parameters</a>
<ul>
<li class="chapter" data-level="15.1" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#space-time-designs"><i class="fa fa-check"></i><b>15.1</b> Space-time designs</a></li>
<li class="chapter" data-level="15.2" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#SpaceTimeparameters"><i class="fa fa-check"></i><b>15.2</b> Space-time population parameters</a></li>
<li class="chapter" data-level="15.3" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#design-based-generalised-least-squares-estimation-of-spatial-means"><i class="fa fa-check"></i><b>15.3</b> Design-based generalised least squares estimation of spatial means</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#current-mean"><i class="fa fa-check"></i><b>15.3.1</b> Current mean</a></li>
<li class="chapter" data-level="15.3.2" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#change-of-the-spatial-mean"><i class="fa fa-check"></i><b>15.3.2</b> Change of the spatial mean</a></li>
<li class="chapter" data-level="15.3.3" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#trend-of-the-spatial-mean"><i class="fa fa-check"></i><b>15.3.3</b> Trend of the spatial mean</a></li>
<li class="chapter" data-level="15.3.4" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#space-time-mean"><i class="fa fa-check"></i><b>15.3.4</b> Space-time mean</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#case-study-annual-mean-daily-temperature-in-spain"><i class="fa fa-check"></i><b>15.4</b> Case study: annual mean daily temperature in Spain</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#static-synchronous-design"><i class="fa fa-check"></i><b>15.4.1</b> Static-synchronous design</a></li>
<li class="chapter" data-level="15.4.2" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#independent-synchonous-design"><i class="fa fa-check"></i><b>15.4.2</b> Independent synchonous design</a></li>
<li class="chapter" data-level="15.4.3" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#serially-alternating-design"><i class="fa fa-check"></i><b>15.4.3</b> Serially alternating design</a></li>
<li class="chapter" data-level="15.4.4" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#supplemented-panel-design"><i class="fa fa-check"></i><b>15.4.4</b> Supplemented panel design</a></li>
<li class="chapter" data-level="15.4.5" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#rotating-panel-design"><i class="fa fa-check"></i><b>15.4.5</b> Rotating panel design</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#space-time-sampling-with-stratified-random-sampling-in-space"><i class="fa fa-check"></i><b>15.5</b> Space-time sampling with stratified random sampling in space</a></li>
</ul></li>
<li class="part"><span><b>II Sampling for mapping</b></span></li>
<li class="chapter" data-level="16" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html"><i class="fa fa-check"></i><b>16</b> Introduction to sampling for mapping</a>
<ul>
<li class="chapter" data-level="16.1" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html#when-is-probability-sampling-not-required"><i class="fa fa-check"></i><b>16.1</b> When is probability sampling not required?</a></li>
<li class="chapter" data-level="16.2" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html#sampling-for-simultaneously-mapping-and-estimating-means"><i class="fa fa-check"></i><b>16.2</b> Sampling for simultaneously mapping and estimating means</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html#balanced-stratified-random-sampling"><i class="fa fa-check"></i><b>16.2.1</b> Balanced stratified random sampling</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html#broad-overview-of-sampling-designs-for-mapping"><i class="fa fa-check"></i><b>16.3</b> Broad overview of sampling designs for mapping</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="RegularSpatialCoverage.html"><a href="RegularSpatialCoverage.html"><i class="fa fa-check"></i><b>17</b> Regular grid and spatial coverage sampling</a>
<ul>
<li class="chapter" data-level="17.1" data-path="RegularSpatialCoverage.html"><a href="RegularSpatialCoverage.html#Regulargrid"><i class="fa fa-check"></i><b>17.1</b> Regular grid sampling</a></li>
<li class="chapter" data-level="17.2" data-path="RegularSpatialCoverage.html"><a href="RegularSpatialCoverage.html#SpatialCoverage"><i class="fa fa-check"></i><b>17.2</b> Spatial coverage sampling</a></li>
<li class="chapter" data-level="17.3" data-path="RegularSpatialCoverage.html"><a href="RegularSpatialCoverage.html#SpatialInfill"><i class="fa fa-check"></i><b>17.3</b> Spatial infill sampling</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="kmeans.html"><a href="kmeans.html"><i class="fa fa-check"></i><b>18</b> Covariate space coverage sampling</a>
<ul>
<li class="chapter" data-level="18.1" data-path="kmeans.html"><a href="kmeans.html#covariate-space-infill-sampling"><i class="fa fa-check"></i><b>18.1</b> Covariate space infill sampling</a></li>
<li class="chapter" data-level="18.2" data-path="kmeans.html"><a href="kmeans.html#performance-of-covariate-space-coverage-sampling-in-random-forest-prediction"><i class="fa fa-check"></i><b>18.2</b> Performance of covariate space coverage sampling in random forest prediction</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="cLHS.html"><a href="cLHS.html"><i class="fa fa-check"></i><b>19</b> Conditioned Latin hypercube sampling</a>
<ul>
<li class="chapter" data-level="19.1" data-path="cLHS.html"><a href="cLHS.html#cLHIS"><i class="fa fa-check"></i><b>19.1</b> Conditioned Latin hypercube infill sampling</a></li>
<li class="chapter" data-level="19.2" data-path="cLHS.html"><a href="cLHS.html#performance-of-conditioned-latin-hypercube-sampling-in-random-forest-prediction"><i class="fa fa-check"></i><b>19.2</b> Performance of conditioned Latin hypercube sampling in random forest prediction</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="SpatialResponseSurface.html"><a href="SpatialResponseSurface.html"><i class="fa fa-check"></i><b>20</b> Spatial response surface sampling</a>
<ul>
<li class="chapter" data-level="20.1" data-path="SpatialResponseSurface.html"><a href="SpatialResponseSurface.html#IncreaseSampleSize"><i class="fa fa-check"></i><b>20.1</b> Increasing the sample size</a></li>
<li class="chapter" data-level="20.2" data-path="SpatialResponseSurface.html"><a href="SpatialResponseSurface.html#stratified-spatial-response-surface-sampling"><i class="fa fa-check"></i><b>20.2</b> Stratified spatial response surface sampling</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="Introkriging.html"><a href="Introkriging.html"><i class="fa fa-check"></i><b>21</b> Introduction to kriging</a>
<ul>
<li class="chapter" data-level="21.1" data-path="Introkriging.html"><a href="Introkriging.html#BlockKriging"><i class="fa fa-check"></i><b>21.1</b> Block-kriging</a></li>
<li class="chapter" data-level="21.2" data-path="Introkriging.html"><a href="Introkriging.html#IntroKED"><i class="fa fa-check"></i><b>21.2</b> Kriging with an external drift</a></li>
<li class="chapter" data-level="21.3" data-path="Introkriging.html"><a href="Introkriging.html#VariogramEstimation"><i class="fa fa-check"></i><b>21.3</b> Estimating the semivariogram</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="Introkriging.html"><a href="Introkriging.html#MoM"><i class="fa fa-check"></i><b>21.3.1</b> Method-of-moments</a></li>
<li class="chapter" data-level="21.3.2" data-path="Introkriging.html"><a href="Introkriging.html#MLestimationVariogram"><i class="fa fa-check"></i><b>21.3.2</b> Maximum likelihood</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="Introkriging.html"><a href="Introkriging.html#ResidualVariogram"><i class="fa fa-check"></i><b>21.4</b> Estimating the residual semivariogram</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="Introkriging.html"><a href="Introkriging.html#IterativeMoM"><i class="fa fa-check"></i><b>21.4.1</b> Iterative method-of-moments</a></li>
<li class="chapter" data-level="21.4.2" data-path="Introkriging.html"><a href="Introkriging.html#REML"><i class="fa fa-check"></i><b>21.4.2</b> Restricted maximum likelihood</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="MBgridspacing.html"><a href="MBgridspacing.html"><i class="fa fa-check"></i><b>22</b> Model-based optimisation of the grid spacing</a>
<ul>
<li class="chapter" data-level="22.1" data-path="MBgridspacing.html"><a href="MBgridspacing.html#GridspacingOK"><i class="fa fa-check"></i><b>22.1</b> Optimal grid spacing for ordinary kriging</a></li>
<li class="chapter" data-level="22.2" data-path="MBgridspacing.html"><a href="MBgridspacing.html#controlling-the-mean-or-a-quantile-of-the-ordinary-kriging-variance"><i class="fa fa-check"></i><b>22.2</b> Controlling the mean or a quantile of the ordinary kriging variance</a></li>
<li class="chapter" data-level="22.3" data-path="MBgridspacing.html"><a href="MBgridspacing.html#optimal-grid-spacing-for-block-kriging"><i class="fa fa-check"></i><b>22.3</b> Optimal grid spacing for block-kriging</a></li>
<li class="chapter" data-level="22.4" data-path="MBgridspacing.html"><a href="MBgridspacing.html#MBgridspacingKED"><i class="fa fa-check"></i><b>22.4</b> Optimal grid spacing for kriging with an external drift</a></li>
<li class="chapter" data-level="22.5" data-path="MBgridspacing.html"><a href="MBgridspacing.html#BayesianGridSpacing"><i class="fa fa-check"></i><b>22.5</b> Bayesian approach</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html"><i class="fa fa-check"></i><b>23</b> Model-based optimisation of the sampling pattern</a>
<ul>
<li class="chapter" data-level="23.1" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#SSA"><i class="fa fa-check"></i><b>23.1</b> Spatial simulated annealing</a></li>
<li class="chapter" data-level="23.2" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#SamplePatternOK"><i class="fa fa-check"></i><b>23.2</b> Optimising the sampling pattern for ordinary kriging</a></li>
<li class="chapter" data-level="23.3" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#SamplePatternKED"><i class="fa fa-check"></i><b>23.3</b> Optimising the sampling pattern for kriging with an external drift</a></li>
<li class="chapter" data-level="23.4" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#model-based-infill-sampling"><i class="fa fa-check"></i><b>23.4</b> Model-based infill sampling</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#model-based-infill-sampling-for-kriging-with-an-external-drift"><i class="fa fa-check"></i><b>23.4.1</b> Model-based infill sampling for kriging with an external drift</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html"><i class="fa fa-check"></i><b>24</b> Sampling for estimating the semivariogram</a>
<ul>
<li class="chapter" data-level="24.1" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#nested-sampling"><i class="fa fa-check"></i><b>24.1</b> Nested sampling</a></li>
<li class="chapter" data-level="24.2" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#independent-sampling-of-pairs-of-points"><i class="fa fa-check"></i><b>24.2</b> Independent sampling of pairs of points</a></li>
<li class="chapter" data-level="24.3" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#samplingforvariogram"><i class="fa fa-check"></i><b>24.3</b> Model-based optimisation of sampling pattern for semivariogram estimation</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#UncertainSemivariogramParameters"><i class="fa fa-check"></i><b>24.3.1</b> Uncertainty about semivariogram parameters</a></li>
<li class="chapter" data-level="24.3.2" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#UncertainKrigingVariance"><i class="fa fa-check"></i><b>24.3.2</b> Uncertainty about the kriging variance</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#SamplingEstimationandPrediction"><i class="fa fa-check"></i><b>24.4</b> Model-based optimisation of pattern of a single sample for both semivariogram estimation and prediction</a></li>
<li class="chapter" data-level="24.5" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#a-practical-solution"><i class="fa fa-check"></i><b>24.5</b> A practical solution</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="Validation.html"><a href="Validation.html"><i class="fa fa-check"></i><b>25</b> Sampling for validation of maps</a>
<ul>
<li class="chapter" data-level="25.1" data-path="Validation.html"><a href="Validation.html#map-quality-indices"><i class="fa fa-check"></i><b>25.1</b> Map quality indices</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="Validation.html"><a href="Validation.html#estimation-of-map-quality-indices"><i class="fa fa-check"></i><b>25.1.1</b> Estimation of map quality indices</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="Validation.html"><a href="Validation.html#real-world-case-study"><i class="fa fa-check"></i><b>25.2</b> Real-world case study</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="Validation.html"><a href="Validation.html#estimation-of-the-population-mean-error-and-mean-squared-error"><i class="fa fa-check"></i><b>25.2.1</b> Estimation of the population Mean Error and Mean Squared Error</a></li>
<li class="chapter" data-level="25.2.2" data-path="Validation.html"><a href="Validation.html#estimation-of-the-standard-error-of-the-estimated-population-me-and-mse"><i class="fa fa-check"></i><b>25.2.2</b> Estimation of the standard error of the estimated population ME and MSE</a></li>
<li class="chapter" data-level="25.2.3" data-path="Validation.html"><a href="Validation.html#estimation-of-mec"><i class="fa fa-check"></i><b>25.2.3</b> Estimation of MEC</a></li>
<li class="chapter" data-level="25.2.4" data-path="Validation.html"><a href="Validation.html#statistical-testing-of-hypothesis-about-population-me-and-mse"><i class="fa fa-check"></i><b>25.2.4</b> Statistical testing of hypothesis about population ME and MSE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="Approaches.html"><a href="Approaches.html"><i class="fa fa-check"></i><b>26</b> Design-based, model-based and model-assisted approach for sampling and inference</a>
<ul>
<li class="chapter" data-level="26.1" data-path="Approaches.html"><a href="Approaches.html#two-sources-of-randomness"><i class="fa fa-check"></i><b>26.1</b> Two sources of randomness</a></li>
<li class="chapter" data-level="26.2" data-path="Approaches.html"><a href="Approaches.html#identically-and-independently-distributed-i.i.d."><i class="fa fa-check"></i><b>26.2</b> “Identically and independently distributed” (i.i.d.)</a></li>
<li class="chapter" data-level="26.3" data-path="Approaches.html"><a href="Approaches.html#BiasandVariance"><i class="fa fa-check"></i><b>26.3</b> Bias and variance</a></li>
<li class="chapter" data-level="26.4" data-path="Approaches.html"><a href="Approaches.html#effectivesamplesize"><i class="fa fa-check"></i><b>26.4</b> Effective sample size</a></li>
<li class="chapter" data-level="26.5" data-path="Approaches.html"><a href="Approaches.html#ExploitSpatialStructure"><i class="fa fa-check"></i><b>26.5</b> Exploiting spatial structure in design-based approach</a></li>
<li class="chapter" data-level="26.6" data-path="Approaches.html"><a href="Approaches.html#ModelassistedvsModeldependent"><i class="fa fa-check"></i><b>26.6</b> Model-assisted versus model-dependent</a></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="Answers.html"><a href="Answers.html"><i class="fa fa-check"></i><b>A</b> Answers to exercises</a>
<ul>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#introduction-to-probability-sampling"><i class="fa fa-check"></i>Introduction to probability sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#simple-random-sampling"><i class="fa fa-check"></i>Simple random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#stratified-random-sampling"><i class="fa fa-check"></i>Stratified random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#systematic-random-sampling"><i class="fa fa-check"></i>Systematic random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#cluster-random-sampling"><i class="fa fa-check"></i>Cluster random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#two-stage-random-sampling"><i class="fa fa-check"></i>Two-stage random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#sampling-with-probabilities-proportional-to-size"><i class="fa fa-check"></i>Sampling with probabilities proportional to size</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#balanced-and-well-spread-sampling"><i class="fa fa-check"></i>Balanced and well-spread sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#model-assisted-estimation"><i class="fa fa-check"></i>Model-assisted estimation</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#two-phase-random-sampling"><i class="fa fa-check"></i>Two-phase random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#computing-the-required-sample-size"><i class="fa fa-check"></i>Computing the required sample size</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#model-based-optimisation-of-probability-sampling-designs"><i class="fa fa-check"></i>Model-based optimisation of probability sampling designs</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#repeated-sample-surveys-for-monitoring-population-parameters"><i class="fa fa-check"></i>Repeated sample surveys for monitoring population parameters</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#regular-grid-sampling"><i class="fa fa-check"></i>Regular grid sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#spatial-coverage-sampling"><i class="fa fa-check"></i>Spatial coverage sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#covariate-space-coverage-sampling"><i class="fa fa-check"></i>Covariate space coverage sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#conditioned-latin-hypercube-sampling"><i class="fa fa-check"></i>Conditioned Latin hypercube sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#model-based-optimisation-of-the-grid-spacing"><i class="fa fa-check"></i>Model-based optimisation of the grid spacing</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#model-based-optimisation-of-the-sampling-pattern"><i class="fa fa-check"></i>Model-based optimisation of the sampling pattern</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#sampling-for-estimating-the-semivariogram"><i class="fa fa-check"></i>Sampling for estimating the semivariogram</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#sampling-for-validation-of-maps"><i class="fa fa-check"></i>Sampling for validation of maps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/DickBrus/">Dick Brus</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial sampling with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="BalancedSpreaded" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Balanced and well-spread sampling</h1>
<p>In this chapter two sampling designs are described and illustrated that are related but also fundamentally different. The similarities and difference are shortly described, but will become more clear in following sections. Roughly speaking, a balanced sample is a sample of which the sample mean of one or more covariates is equal to the population means of these covariates. When the covariates are linearly related to the study variable this may yield a more precise estimate of the population mean or total.</p>
<p>A well-spread sample is a sample with a large range of values for the covariates, from small to large values, but also intermediate values. In more technical terms: the sampling units are well-spread along the axes spanned by the covariates. If the spatial coordinates are used as covariates (spreading variables), this results in samples that are well-spread in geographical space. Such samples are commonly referred to as spatially balanced samples, which is somewhat confusing, as the geographical spreading is not implemented through balancing on the geographical coordinates. On the other hand, the averages of the spatial coordinates of a sample well-spread in geographical space will be close to the population means of the coordinates, and therefore will be approximately balanced on the spatial coordinates <span class="citation">(<a href="#ref-Grafstrom2014" role="doc-biblioref">Grafström and Schelin 2014</a>)</span>. The reverse is not true: with balanced sampling the spreading of the sampling units in the space spanned by the balancing variables can be poor. A sample with all values of a covariate used in balancing near the population mean of that variable has a poor spreading along the covariate axis, but can still be perfectly balanced.</p>
<div id="Balanced" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Balanced sampling</h2>
<p>Balanced sampling is a sampling method that exploits one or more quantitative covariates that are related to the study variable. The idea behind balanced sampling is that, if we know the mean of the covariates, then the sampling efficiency can be increased by selecting a sample whose averages of the covariates must be equal to the population means of the covariates.</p>
<p>Let me illustrate balanced sampling with a small simulation study. The simulated population shown in Figure <a href="BalancedSpreaded.html#fig:simpleexample">9.1</a> shows a linear trend from West to East, and also a trend from South to North. Due to the West-East trend the simulated study variable <span class="math inline">\(z\)</span> is correlated with the covariate Easting, and due to the South-North trend also with the covariate Northing. To estimate the population mean of the simulated study variable, intuitively it is attractive to select a sample with an average of the Easting coordinate that is equal to the population mean of Easting (which is 10). Figure <a href="BalancedSpreaded.html#fig:simpleexample">9.1</a> (subfigure on the left) shows such a sample; we say that the sample is `balanced’ on the covariate Easting. The sample in the subfigure on the right is balanced on Easting as well as on Northing.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:simpleexample"></span>
<img src="SpatialSampling_files/figure-html/simpleexample-1.png" alt="Sample balanced on Easting (E) and on Easting and Northing (E and N)." width="100%" />
<p class="caption">
Figure 9.1: Sample balanced on Easting (E) and on Easting and Northing (E and N).
</p>
</div>
<div id="balanced-sample-versus-balanced-sampling-design" class="section level3" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Balanced sample versus balanced sampling design</h3>
<p>We must distinguish a balanced <em>sample</em> from a balanced sampling <em>design</em>. A sampling design is balanced on a covariate <span class="math inline">\(x\)</span> when <em>all possible</em> samples that can be generated by the design are balanced on <span class="math inline">\(x\)</span>.</p>

<div class="rmdnote">
Simple random sampling is not a balanced sampling design, because for many simple random samples the sample mean of the balancing variable <span class="math inline">\(x\)</span> is not equal to the population mean of <span class="math inline">\(x\)</span>. Only the <em>expectation</em> of the sample mean of <span class="math inline">\(x\)</span>, i.e. the mean of the sample means obtained by selecting an infinite number of simple random samples, equals the population mean of <span class="math inline">\(x\)</span>.
</div>
<p>Figure <a href="BalancedSpreaded.html#fig:scatterplotsqerror">9.2</a> shows for one thousand simple random samples the squared error of the estimated population mean of the study variable <span class="math inline">\(z\)</span> against the difference between the sample mean of covariate balancing variable Easting and the population mean of Easting. Clearly, the larger the absolute value of the difference, the larger on average the squared error. So to obtain a precise and accurate estimate of the population mean of <span class="math inline">\(z\)</span>, we better select samples with a difference close to 0.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:scatterplotsqerror"></span>
<img src="SpatialSampling_files/figure-html/scatterplotsqerror-1.png" alt="Squared error in estimated mean of $z$ against difference between population and sample mean of Easting, for simple random sampling of size 4 from population shown in Figure 9.1." width="80%" />
<p class="caption">
Figure 9.2: Squared error in estimated mean of <span class="math inline">\(z\)</span> against difference between population and sample mean of Easting, for simple random sampling of size 4 from population shown in Figure 9.1.
</p>
</div>
<p>Using only Easting as a balancing variable reduced the sampling variance of the estimator of the mean substantially, see Table <a href="BalancedSpreaded.html#tab:tablebalanced">9.1</a>. Using Northing as a second balancing variable further reduced the sampling variance.</p>
<table class=" lightable-classic" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; margin-left: auto; margin-right: auto;'>
<caption>
<span id="tab:tablebalanced">Table 9.1: </span>Sampling variances of estimated mean for simple random sampling and balanced sampling of four units.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Sampling design
</th>
<th style="text-align:left;">
Balancing variables
</th>
<th style="text-align:right;">
Sampling variance
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
SI
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:right;">
39.70
</td>
</tr>
<tr>
<td style="text-align:left;">
Balanced
</td>
<td style="text-align:left;">
Easting
</td>
<td style="text-align:right;">
14.40
</td>
</tr>
<tr>
<td style="text-align:left;">
Balanced
</td>
<td style="text-align:left;">
Easting and Northing
</td>
<td style="text-align:right;">
9.77
</td>
</tr>
</tbody>
</table></li>
</ul>
</div>
<div id="unequal-inclusion-probabilities" class="section level3" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Unequal inclusion probabilities</h3>
<p>Until now we assumed that the inclusion probabilities of the population units are equal, but this is not a requirement for balanced sampling designs. A more general definition of a balanced sampling design is as follows. A sampling design is balanced on variable <span class="math inline">\(x\)</span> when for all samples generated by the design the <span class="math inline">\(\pi\)</span> estimator of the population total of <span class="math inline">\(x\)</span> equals the population total of <span class="math inline">\(x\)</span>,</p>
<p><span class="math display" id="eq:generaldefinitionbalanced">\[\begin{equation}
\sum_{k \in \mathcal{S}} \frac{x_k}{\pi_k}= \sum_{k=1}^{N} x_k \;.
\tag{9.1}
\end{equation}\]</span></p>
<p>Similar to the regression estimator explained in the next chapter (Section <a href="Modelassisted.html#RegressionEstimator">10.1.1</a>), balanced sampling exploits the linear relation between the study variable and one or more covariates. In the regression estimator this is done at the estimation stage. Balanced sampling does so at the sampling stage. For a single covariate the regression estimator of the population total equals (see Equation <a href="Modelassisted.html#eq:SimpleRegressionEstimatorSI">(10.10)</a>)</p>
<p><span class="math display" id="eq:RegressionEstimatoranydesign">\[\begin{equation}
\hat{t}_{\mathrm{regr}}(z) = \hat{t}_{\pi}(z) + \hat{b}\left(t(x) - \hat{t}_{\pi}(x)\right) \;,
\tag{9.2}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(\hat{t}_{\pi}(z)\)</span> and <span class="math inline">\(\hat{t}_{\pi}(x)\)</span> the <span class="math inline">\(\pi\)</span> estimators of the population total of the study variable <span class="math inline">\(z\)</span> and the covariate <span class="math inline">\(x\)</span>, respectively, <span class="math inline">\(t(x)\)</span> the population total of the covariate, and <span class="math inline">\(\hat{b}\)</span> the estimated slope parameter (see hereafter). With a perfectly balanced sample the second term in the regression estimator, which adjusts the <span class="math inline">\(\pi\)</span> estimator, equals zero.</p>
<p>Balanced samples can be selected with the cube algorithm of <span class="citation"><a href="#ref-Deville2004" role="doc-biblioref">Deville and Tillé</a> (<a href="#ref-Deville2004" role="doc-biblioref">2004</a>)</span>. The population total and mean can be estimated by the <span class="math inline">\(\pi\)</span> estimator. The approximate variance of the <span class="math inline">\(\pi\)</span> estimator of the population mean can be estimated by (<span class="citation"><a href="#ref-Deville2005" role="doc-biblioref">Deville and Tillé</a> (<a href="#ref-Deville2005" role="doc-biblioref">2005</a>)</span>, <span class="citation"><a href="#ref-Grafstrom2013" role="doc-biblioref">Grafström and Tillé</a> (<a href="#ref-Grafstrom2013" role="doc-biblioref">2013</a>)</span>)</p>
<p><span class="math display" id="eq:approxvarianceBalanced">\[\begin{equation}
\widehat{V}(\hat{\bar{z}}) = \frac{1}{N^2}\frac{n}{n-p} \sum_{k \in \mathcal{S}} c_k \left(\frac{\epsilon_k}{\pi_k}\right)^2 \;,
\tag{9.3}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(p\)</span> the number of balancing variables, <span class="math inline">\(c_k\)</span> a weight for unit <span class="math inline">\(k\)</span> (see hereafter), and <span class="math inline">\(\epsilon_k\)</span> the residual of unit <span class="math inline">\(k\)</span> given by</p>
<p><span class="math display" id="eq:residualsBalanced">\[\begin{equation}
\epsilon_k = z_k - \mathbf{x}_k^{\text{T}}\hat{\mathbf{b}} \;,
\tag{9.4}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(\mathbf{x}_k\)</span> a vector of length <span class="math inline">\(p\)</span> with the balancing variables for unit <span class="math inline">\(k\)</span>, and <span class="math inline">\(\hat{\mathbf{b}}\)</span> the estimated population regression coefficients, given by</p>
<p><span class="math display" id="eq:betasbalanced">\[\begin{equation}
\hat{\mathbf{b}} = \left(\sum_{k \in \mathcal{S}} c_k \frac{\mathbf{x}_k}{\pi_k} \frac{\mathbf{x}_k}{\pi_k}^{\text{T}} \right)^{-1} \sum_{k \in \mathcal{S}} c_k \frac{\mathbf{x}_k}{\pi_k} \frac{z_k}{\pi_k} \;.
\tag{9.5}
\end{equation}\]</span></p>
<p>Working this out for balanced sampling without replacement with equal inclusion probabilities, <span class="math inline">\(\pi_k = n/N, k = 1, \dots , N\)</span>, yields</p>
<p><span class="math display" id="eq:approxvarianceBalancedSI">\[\begin{equation}
\widehat{V}(\hat{\bar{z}}) = \frac{1}{n(n-p)} \sum_{k \in \mathcal{S}} c_k \epsilon_k^2 \;.
\tag{9.6}
\end{equation}\]</span></p>
<p><span class="citation"><a href="#ref-Deville2005" role="doc-biblioref">Deville and Tillé</a> (<a href="#ref-Deville2005" role="doc-biblioref">2005</a>)</span> give several formulas for computing the weights <span class="math inline">\(c_k\)</span>, one of which is <span class="math inline">\(c_k = (1-\pi_k)\)</span>.</p>
<p>Balanced sampling is now illustrated with the aboveground biomass (AGB) data of Eastern Amazonia, see Figure <a href="GeneralIntro.html#fig:mapsAmazonia">1.8</a>. Log-transformed short-wave infrared radiation (lnSWIR2) is used as a balancing variable. The <code>samplecube</code> function of the <strong>sampling</strong> package <span class="citation">(<a href="#ref-Tille2016" role="doc-biblioref">Tillé and Matei 2016</a>)</span> implements the cube algorithm. Argument <code>X</code> of this function specifies the matrix of ancillary variables on which the sample must be balanced. The first column of this matrix is filled with ones, so that the sample size is fixed.</p>

<div class="rmdnote">
Recall that a sample is balanced on a covariate <span class="math inline">\(x\)</span> if the <span class="math inline">\(\pi\)</span> estimate of the population total of <span class="math inline">\(x\)</span> is equal to the known true population total of <span class="math inline">\(x\)</span> (Equation <a href="BalancedSpreaded.html#eq:generaldefinitionbalanced">(9.1)</a>. If we know the total number of units in a population, <span class="math inline">\(N\)</span>, we can balance the sample on this known total by using as a balancing variable a constant with value 1. Only for samples of size <span class="math inline">\(n\)</span> the <span class="math inline">\(\pi\)</span> estimate of the total number of population units equals <span class="math inline">\(N\)</span>: <span class="math inline">\(\sum_{k \in \mathcal{S}} 1/\pi_k = N\)</span> for samples of size <span class="math inline">\(n\)</span>.
</div>
<p>Equal inclusion probabilities are used, i.e. for all population units the inclusion probability equals <span class="math inline">\(n/N\)</span>.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="BalancedSpreaded.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Amazonia_5km.RData&quot;</span>)</span>
<span id="cb172-2"><a href="BalancedSpreaded.html#cb172-2" aria-hidden="true" tabindex="-1"></a>gridAmazonia<span class="sc">$</span>lnSWIR2 <span class="ot">&lt;-</span> <span class="fu">log</span>(gridAmazonia<span class="sc">$</span>SWIR2)</span>
<span id="cb172-3"><a href="BalancedSpreaded.html#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sampling)</span>
<span id="cb172-4"><a href="BalancedSpreaded.html#cb172-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(gridAmazonia)</span>
<span id="cb172-5"><a href="BalancedSpreaded.html#cb172-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb172-6"><a href="BalancedSpreaded.html#cb172-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="at">times=</span>N), gridAmazonia<span class="sc">$</span>lnSWIR2)</span>
<span id="cb172-7"><a href="BalancedSpreaded.html#cb172-7" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">rep</span>(n<span class="sc">/</span>N,<span class="at">times=</span>N)</span>
<span id="cb172-8"><a href="BalancedSpreaded.html#cb172-8" aria-hidden="true" tabindex="-1"></a>sample_ind <span class="ot">&lt;-</span> <span class="fu">samplecube</span>(<span class="at">X=</span>X, <span class="at">pik=</span>pi, <span class="at">comment=</span><span class="cn">FALSE</span>, <span class="at">method=</span><span class="dv">1</span>)</span>
<span id="cb172-9"><a href="BalancedSpreaded.html#cb172-9" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb172-10"><a href="BalancedSpreaded.html#cb172-10" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">which</span>(sample_ind<span class="sc">&gt;</span>(<span class="dv">1</span><span class="sc">-</span>eps))</span>
<span id="cb172-11"><a href="BalancedSpreaded.html#cb172-11" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> gridAmazonia[units,]</span></code></pre></div>
<p>The population mean can be estimated by the sample mean.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="BalancedSpreaded.html#cb173-1" aria-hidden="true" tabindex="-1"></a>mz <span class="ot">&lt;-</span> <span class="fu">mean</span>(mysample<span class="sc">$</span>AGB)</span></code></pre></div>
<p>To estimate the variance a function is defined for estimating the population regression coefficients.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="BalancedSpreaded.html#cb174-1" aria-hidden="true" tabindex="-1"></a>estimate_b <span class="ot">&lt;-</span> <span class="cf">function</span>(z,X,c) {</span>
<span id="cb174-2"><a href="BalancedSpreaded.html#cb174-2" aria-hidden="true" tabindex="-1"></a>  cXX <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">ncol</span>(X), <span class="at">ncol=</span><span class="fu">ncol</span>(X), <span class="at">data=</span><span class="dv">0</span>)</span>
<span id="cb174-3"><a href="BalancedSpreaded.html#cb174-3" aria-hidden="true" tabindex="-1"></a>  cXz <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(X), <span class="at">data=</span><span class="dv">0</span>)</span>
<span id="cb174-4"><a href="BalancedSpreaded.html#cb174-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(z)) {</span>
<span id="cb174-5"><a href="BalancedSpreaded.html#cb174-5" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> X[i,]</span>
<span id="cb174-6"><a href="BalancedSpreaded.html#cb174-6" aria-hidden="true" tabindex="-1"></a>    cXX_i <span class="ot">&lt;-</span> c[i]<span class="sc">*</span>(x <span class="sc">%*%</span> <span class="fu">t</span>(x))</span>
<span id="cb174-7"><a href="BalancedSpreaded.html#cb174-7" aria-hidden="true" tabindex="-1"></a>    cXX <span class="ot">&lt;-</span> cXX<span class="sc">+</span>cXX_i</span>
<span id="cb174-8"><a href="BalancedSpreaded.html#cb174-8" aria-hidden="true" tabindex="-1"></a>    cXz_i <span class="ot">&lt;-</span> c[i]<span class="sc">*</span><span class="fu">t</span>(x)<span class="sc">*</span>z[i]</span>
<span id="cb174-9"><a href="BalancedSpreaded.html#cb174-9" aria-hidden="true" tabindex="-1"></a>    cXz <span class="ot">&lt;-</span> cXz<span class="sc">+</span>cXz_i</span>
<span id="cb174-10"><a href="BalancedSpreaded.html#cb174-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb174-11"><a href="BalancedSpreaded.html#cb174-11" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">solve</span>(cXX) <span class="sc">%*%</span> <span class="fu">t</span>(cXz)</span>
<span id="cb174-12"><a href="BalancedSpreaded.html#cb174-12" aria-hidden="true" tabindex="-1"></a>  b</span>
<span id="cb174-13"><a href="BalancedSpreaded.html#cb174-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The next code chunk shows how the estimated variance of the <span class="math inline">\(\pi\)</span> estimator of the population mean can be computed.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="BalancedSpreaded.html#cb175-1" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">rep</span>(n<span class="sc">/</span>N,n)</span>
<span id="cb175-2"><a href="BalancedSpreaded.html#cb175-2" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>pi)</span>
<span id="cb175-3"><a href="BalancedSpreaded.html#cb175-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">estimate_b</span>(<span class="at">z=</span>mysample<span class="sc">$</span>AGB<span class="sc">/</span>pi, <span class="at">X=</span>X[units,]<span class="sc">/</span>pi, <span class="at">c=</span>c)</span>
<span id="cb175-4"><a href="BalancedSpreaded.html#cb175-4" aria-hidden="true" tabindex="-1"></a>zpred <span class="ot">&lt;-</span> X<span class="sc">%*%</span>b</span>
<span id="cb175-5"><a href="BalancedSpreaded.html#cb175-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> mysample<span class="sc">$</span>AGB<span class="sc">-</span>zpred[units]</span>
<span id="cb175-6"><a href="BalancedSpreaded.html#cb175-6" aria-hidden="true" tabindex="-1"></a>v_tz <span class="ot">&lt;-</span> n<span class="sc">/</span>(n<span class="sc">-</span><span class="fu">ncol</span>(X))<span class="sc">*</span><span class="fu">sum</span>(c<span class="sc">*</span>(e<span class="sc">/</span>pi)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb175-7"><a href="BalancedSpreaded.html#cb175-7" aria-hidden="true" tabindex="-1"></a>v_mz <span class="ot">&lt;-</span> v_tz<span class="sc">/</span>N<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<p>Figure <a href="BalancedSpreaded.html#fig:BalancedSampleAmazonia">9.3</a> shows the selected balanced sample. Note the spatial clustering of some units. The estimated population mean (as estimated by the sample mean) of AGB equals 224.5. The population mean of AGB equals 225.3. The standard error of the estimated mean equals 6.1.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:BalancedSampleAmazonia"></span>
<img src="SpatialSampling_files/figure-html/BalancedSampleAmazonia-1.png" alt="Balanced sample from Eastern Amazonia (Brazil), balanced on covariate lnSWIR2." width="100%" />
<p class="caption">
Figure 9.3: Balanced sample from Eastern Amazonia (Brazil), balanced on covariate lnSWIR2.
</p>
</div>
<p>Figure <a href="BalancedSpreaded.html#fig:SamplingDistributionBalanced">9.4</a> shows the sampling distributions of the <span class="math inline">\(\pi\)</span> estimator of the mean of AGB with balanced sampling and simple random sampling, obtained by repeating the random sampling with both designs and estimation 1,000 times.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:SamplingDistributionBalanced"></span>
<img src="SpatialSampling_files/figure-html/SamplingDistributionBalanced-1.png" alt="Sampling distribution of $\pi$ estimator of the mean aboveground biomass in Eastern Amazonia, with balanced sampling (balanced on lnSWIR2) and simple random sampling, bot designs with a sample size of 100 units." width="80%" />
<p class="caption">
Figure 9.4: Sampling distribution of <span class="math inline">\(\pi\)</span> estimator of the mean aboveground biomass in Eastern Amazonia, with balanced sampling (balanced on lnSWIR2) and simple random sampling, bot designs with a sample size of 100 units.
</p>
</div>
<p>The variance of the 1,000 estimates of the population mean of the study variable AGB equals 28.8. The gain in precision compared to simple random sampling, equals 3, so with simple random sampling three times more sampling units are needed to estimate the population mean with the same precision. The mean of the 1,000 estimated variances equals 26.4, indicating that the approximate variance estimator somewhat underestimates the true variance in this case. The population mean of the balancing variable lnSWIR2 equals 6.414. The sample mean of lnSWIR2 varies a bit among the samples (Figure <a href="BalancedSpreaded.html#fig:histSampleMeanSWIR">9.5</a>). In other words, many samples are not perfectly balanced on lnSWIR2. This is not exceptional, in most cases perfect balance is impossible.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:histSampleMeanSWIR"></span>
<img src="SpatialSampling_files/figure-html/histSampleMeanSWIR-1.png" alt="Sampling distribution of the estimated population mean (sample mean) of balancing variable lnSWIR2." width="80%" />
<p class="caption">
Figure 9.5: Sampling distribution of the estimated population mean (sample mean) of balancing variable lnSWIR2.
</p>
</div>
<div id="exercises-13" class="section level4 unnumbered">
<h4>Exercises</h4>
<ol style="list-style-type: decimal">
<li>Load the data of Amazonia (Amazonia_5km.RData) to select a sample of size 100 balanced on lnSWIR2 and Terra_PP, using equal inclusion probabilities for all units.
<ul>
<li>Estimate the population mean.<br />
</li>
<li>Estimate the standard error of the <span class="math inline">\(\pi\)</span> estimator. First estimate the regression coefficients, using function <code>estimate\_b</code> defined above, then compute the residuals, and finally compute the variance.<br />
</li>
</ul></li>
<li>Spatial clustering of sampling units is not avoided in balanced sampling. What effect do you expect of this spatial clustering on the precision of the estimated mean? Can you think of a situation where this effect does not occur?</li>
</ol>
</div>
</div>
<div id="StratifiedsamplingasBalancedsampling" class="section level3" number="9.1.3">
<h3><span class="header-section-number">9.1.3</span> Stratified random sampling</h3>
<p>Much in the same way as we controlled in the previous section the sample size <span class="math inline">\(n\)</span> by balancing the sample on the known total number of population units <span class="math inline">\(N\)</span>, we can balance a sample on the known total number of units in subpopulations. A sample balanced on the sizes of subpopulations is a stratified random sample. Figure <a href="BalancedSpreaded.html#fig:BalancedSampleCategorical">9.6</a> shows four subpopulations or strata. These four strata can be used in balanced sampling by constructing the following design matrix <span class="math inline">\(\mathbf{X}\)</span> with as many columns as there are strata and as many rows as there are population units,</p>
<p><span class="math display">\[\begin{equation*}
\mathbf{X}=
\begin{bmatrix}
1 &amp;0 &amp;0 &amp;0 \\
1 &amp;0 &amp;0 &amp;0 \\
1 &amp;0 &amp;0 &amp;0 \\
1 &amp;0 &amp;0 &amp;0 \\
0 &amp;1 &amp;0 &amp;0 \\
0 &amp;1 &amp;0 &amp;0 \\
0 &amp;0 &amp;1 &amp;0 \\
\vdots &amp;\vdots &amp;\vdots &amp;\vdots\\
0 &amp; 0 &amp; 0 &amp; 1 \\
\end{bmatrix}  \;.
\end{equation*}\]</span></p>
<p>The first four rows refer to the four leftmost bottom row population units in Figure <a href="BalancedSpreaded.html#fig:BalancedSampleCategorical">9.6</a>. These units belong to class A, which explains that the first column for these units contain ones. The other three columns for these rows contain all zeroes. The fifth and sixth unit belong to stratum B, so that the second column for these rows contain ones, and so on. The final row is the upper-right sampling unit in stratum D, so the first three columns contain zeroes, and the fourth column is filled with a one. The sum of the indicators in the columns is the total number of population units in the strata.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:BalancedSampleCategorical"></span>
<img src="SpatialSampling_files/figure-html/BalancedSampleCategorical-1.png" alt="Sample balanced on a categorical variable with four classes." width="80%" />
<p class="caption">
Figure 9.6: Sample balanced on a categorical variable with four classes.
</p>
</div>
<p>In the next code chunk inclusion probabilities are computed by <span class="math inline">\(\pi_{hk}=n_h/N_h, k=1, \dots , N_h\)</span>, with <span class="math inline">\(n_h=5\)</span> for all four strata. The stratum sample sizes are equal, but the number of population units of a stratum differ among the strata, so the inclusion probabilities also differ among the strata.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="BalancedSpreaded.html#cb176-1" aria-hidden="true" tabindex="-1"></a>N_h <span class="ot">&lt;-</span> <span class="fu">tapply</span>(mypop<span class="sc">$</span>s1,<span class="at">INDEX=</span>mypop<span class="sc">$</span>stratum,<span class="at">FUN=</span>length)</span>
<span id="cb176-2"><a href="BalancedSpreaded.html#cb176-2" aria-hidden="true" tabindex="-1"></a>n_h <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">5</span>, <span class="at">times=</span><span class="dv">4</span>)</span>
<span id="cb176-3"><a href="BalancedSpreaded.html#cb176-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">sum</span>(n_h)</span>
<span id="cb176-4"><a href="BalancedSpreaded.html#cb176-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pi_h <span class="ot">&lt;-</span> n_h<span class="sc">/</span>N_h)</span></code></pre></div>
<p>The inclusion probabilities are added to the data frame <code>mypop</code> with the 400 population units, using a lookup table <code>lut</code> and function <code>merge</code>. The seven leftmost units on the bottom row are shown below. Variables s1 and s2 are the spatial coordinates of the centers of the units.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="BalancedSpreaded.html#cb177-1" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(mypop<span class="sc">$</span>stratum))</span>
<span id="cb177-2"><a href="BalancedSpreaded.html#cb177-2" aria-hidden="true" tabindex="-1"></a>lut <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">stratum=</span>labels, <span class="at">pi=</span>n_h<span class="sc">/</span>N_h)</span>
<span id="cb177-3"><a href="BalancedSpreaded.html#cb177-3" aria-hidden="true" tabindex="-1"></a>mypop<span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x=</span>mypop, <span class="at">y=</span>lut, <span class="at">by=</span><span class="st">&quot;stratum&quot;</span>)</span>
<span id="cb177-4"><a href="BalancedSpreaded.html#cb177-4" aria-hidden="true" tabindex="-1"></a>ord <span class="ot">&lt;-</span> <span class="fu">order</span>(mypop<span class="sc">$</span>s2,mypop<span class="sc">$</span>s1)</span>
<span id="cb177-5"><a href="BalancedSpreaded.html#cb177-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mypop[ord,],<span class="dv">7</span>)</span></code></pre></div>
<pre><code>    stratum  s1  s2      pi
1         A 0.5 0.5 0.06250
2         A 1.5 0.5 0.06250
3         A 2.5 0.5 0.06250
4         A 3.5 0.5 0.06250
96        B 4.5 0.5 0.12500
84        B 5.5 0.5 0.12500
150       C 6.5 0.5 0.03125</code></pre>
<p>Next, the design matrix <span class="math inline">\(\mathbf{X}\)</span> is computed with function <code>model.matrix</code>, expanding the factor <code>stratum</code> to a set of dummy variables, see code chunk below. By adding <code>-1</code> to the formula, we avoid that the first column in the design matrix has all ones. The design matrix has four columns with dummy variables (indicators), indicating to which stratum a unit belongs.</p>
<p>The columns in the design matrix with dummy variables are multiplied by the vector with inclusion probabilities, using function <code>sweep</code>, resulting in the following design matrix,</p>
<p><span class="math display">\[\begin{equation*}
\mathbf{X}=
\begin{bmatrix}
0.0625 &amp;0 &amp;0 &amp;0 \\
0.0625 &amp;0 &amp;0 &amp;0 \\
0.0625 &amp;0 &amp;0 &amp;0 \\
0.0625 &amp;0 &amp;0 &amp;0 \\
0 &amp;0.125 &amp;0 &amp;0 \\
0 &amp;0.125 &amp;0 &amp;0 \\
0 &amp;0 &amp;0.03125 &amp;0 \\
\vdots &amp;\vdots &amp;\vdots &amp;\vdots\\
0 &amp; 0 &amp; 0 &amp;0.04167 \\
\end{bmatrix}  \;.
\end{equation*}\]</span></p>
<p>This multiplication with the inclusion probabilities is not strictly needed. Using the design matrix with dummy variables implies that we balance the sample on the known total number of population units in the strata, <span class="math inline">\(N_h\)</span>. For samples with stratum sample sizes equal to <span class="math inline">\(n_h\)</span>, the sample sums of the dummy variables used in balancing, divided by the inclusion probability are equal to <span class="math inline">\(N_h\)</span>.</p>
<p>Multiplication of the dummy variables with the vector with inclusion probabilities implies that we balance the sample on the population totals of the inclusion probabilities, which are equal to the targeted stratum sample sizes. For samples with stratum sample sizes <span class="math inline">\(n_h\)</span> equal to these targeted sample sizes, the sample sums of the balancing variable divided by the inclusion probability (having value <span class="math inline">\(\pi_{hk}/\pi_{hk}=1\)</span> or 0), are equal to targeted sample sizes.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="BalancedSpreaded.html#cb179-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> stratum<span class="dv">-1</span>, <span class="at">data=</span>mypop)</span>
<span id="cb179-2"><a href="BalancedSpreaded.html#cb179-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">sweep</span>(X, <span class="at">MARGIN=</span> <span class="dv">1</span>, mypop<span class="sc">$</span>pi, <span class="st">`</span><span class="at">*</span><span class="st">`</span>)</span>
<span id="cb179-3"><a href="BalancedSpreaded.html#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb179-4"><a href="BalancedSpreaded.html#cb179-4" aria-hidden="true" tabindex="-1"></a>sample_ind <span class="ot">&lt;-</span> <span class="fu">samplecube</span>(<span class="at">X=</span>X, <span class="at">pik=</span>mypop<span class="sc">$</span>pi, <span class="at">comment=</span><span class="cn">FALSE</span>, <span class="at">method=</span><span class="dv">1</span>)</span>
<span id="cb179-5"><a href="BalancedSpreaded.html#cb179-5" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> mypop[sample_ind<span class="sc">&gt;</span>(<span class="dv">1</span><span class="sc">-</span>eps),]</span></code></pre></div>
<p>In this case all units in a stratum have the same inclusion probability, yielding a stratified simple random sample. We may also use variable inclusion probabilities, for instance proportional to a size measure of the units, yielding a stratified ppswor random sample.</p>
<p>The advantage of selecting a stratified random sample by balancing the sample on a categorical variable becomes clear in case we have multiple classifications that we would like to use in stratification, and we cannot afford to use all cross-classifications as strata. This is the topic of the next section.</p>
</div>
<div id="Multiwaystratification" class="section level3" number="9.1.4">
<h3><span class="header-section-number">9.1.4</span> Multi-way stratification</h3>
<p><span class="citation"><a href="#ref-Falorsi2008" role="doc-biblioref">Falorsi and Righi</a> (<a href="#ref-Falorsi2008" role="doc-biblioref">2008</a>)</span> describe how a multi-way stratified sample can be selected as a balanced sample. Multi-way stratification is of interest when one has multiple stratification variables, each stratification variable leading to several strata, so that the total number of cross-classification strata becomes so large that the stratum sample sizes are strongly disproportional to their size, or even exceed the total sample size. For instance, suppose we have three maps with 4, 3 and 5 map units. Further, suppose that all combinations of map units are nonempty, so that we have <span class="math inline">\(4 \times 3 \times 5=60\)</span> combinations. We may not like to use all combinations (cross-classifications) as strata. The alternative is then to use the <span class="math inline">\(4+3+5=12\)</span> map units as strata.</p>
<p>The sample sizes of the marginal strata can be controlled by using a design matrix with as many columns as there are strata. The units of an individual map used for stratification are referred to as marginal strata. Each row <span class="math inline">\(k = 1, \dots, N\)</span> in the design matrix <span class="math inline">\(\mathbf{X}\)</span> has as many non-zero values as we have maps, in entries corresponding with the cross-classification map unit of population unit <span class="math inline">\(k\)</span>, and zeroes in the remaining entries. The non-zero value is the inclusion probability of that unit. Each column of the design matrix has non-zero values at entries corresponding with the population units in that marginal stratum, and zeroes at all other entries.</p>
<p>Two-way stratified random sampling is illustrated with a simulated population of 400 units (Figure <a href="BalancedSpreaded.html#fig:TwowaystratifiedPopulation">9.7</a>). Figure <a href="BalancedSpreaded.html#fig:Twowaystratifiedsample">9.8</a> shows two classifications of the population units. Classification A consists of four classes (map units), classification B of three classes. Instead of using <span class="math inline">\(4 \times 3 = 12\)</span> cross-classifications as strata in random sampling, only <span class="math inline">\(4+3=7\)</span> marginal strata are used in two-way stratified random sampling.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:TwowaystratifiedPopulation"></span>
<img src="SpatialSampling_files/figure-html/TwowaystratifiedPopulation-1.png" alt="Simulated population, used for illustration of two-way stratified random sampling." width="80%" />
<p class="caption">
Figure 9.7: Simulated population, used for illustration of two-way stratified random sampling.
</p>
</div>
<p>As a first step the inclusion probabilities are added to the data frame <code>mypop</code> with the spatial coordinates and simulated values. To keep it simple I computed inclusion probabilities equal to two divided by the number of population units in a cross-classification stratum. Note that this does not imply that a sample is selected with two units per cross-stratum. As we will see later it is possible that in some cross-classification stratum no units are selected at all, while in other cross-classification strata more than two units are selected. In multi-way stratified sampling the marginal stratum sample sizes are controlled. The inclusion probabilities should result in six selected units for all four units of map A, and eight selected units for all three units of map B.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="BalancedSpreaded.html#cb180-1" aria-hidden="true" tabindex="-1"></a>mypop <span class="ot">&lt;-</span> mypop <span class="sc">%&gt;%</span></span>
<span id="cb180-2"><a href="BalancedSpreaded.html#cb180-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(A, B) <span class="sc">%&gt;%</span></span>
<span id="cb180-3"><a href="BalancedSpreaded.html#cb180-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">N_h=</span><span class="fu">n</span>(), <span class="at">.groups=</span><span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb180-4"><a href="BalancedSpreaded.html#cb180-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pih=</span><span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">12</span>)<span class="sc">/</span>N_h) <span class="sc">%&gt;%</span></span>
<span id="cb180-5"><a href="BalancedSpreaded.html#cb180-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">right_join</span>(mypop, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>))</span></code></pre></div>
<p>The next step is to create the design matrix. Two submatrices are computed, one per stratification. The two submatrices are joined column-wise, using function <code>cbind</code>. The columns are multiplied by the vector with inclusion probabilities.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="BalancedSpreaded.html#cb181-1" aria-hidden="true" tabindex="-1"></a>XA <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>A<span class="dv">-1</span>, mypop)</span>
<span id="cb181-2"><a href="BalancedSpreaded.html#cb181-2" aria-hidden="true" tabindex="-1"></a>XB <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>B<span class="dv">-1</span>, mypop)</span>
<span id="cb181-3"><a href="BalancedSpreaded.html#cb181-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(XA,XB)</span>
<span id="cb181-4"><a href="BalancedSpreaded.html#cb181-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">sweep</span>(X, <span class="at">MARGIN=</span> <span class="dv">1</span>, mypop<span class="sc">$</span>pih, <span class="st">`</span><span class="at">*</span><span class="st">`</span>)</span></code></pre></div>
<p>Matrix <span class="math inline">\(\mathbf{X}\)</span> can be reduced by one column if in the first column the inclusion probabilities of <em>all</em> population units are inserted. This first column contains no zeroes. Balancing on this variable implies that the total sample size is controlled. Now there is no need anymore to control the sample sizes of all marginal strata. It is sufficient to control the sample sizes of three marginal strata of map A (A2, A3 and A4) and two marginal strata of map B (B2 and B3). Given the total sample size, the sample sizes of map units A1 and B1 then cannot be chosen freely anymore.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="BalancedSpreaded.html#cb182-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>A<span class="sc">+</span>B, mypop)</span>
<span id="cb182-2"><a href="BalancedSpreaded.html#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(X)</span></code></pre></div>
<pre><code>[1] &quot;(Intercept)&quot; &quot;AA2&quot;         &quot;AA3&quot;         &quot;AA4&quot;         &quot;BB2&quot;        
[6] &quot;BB3&quot;        </code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="BalancedSpreaded.html#cb184-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">sweep</span>(X, <span class="at">MARGIN=</span> <span class="dv">1</span>, mypop<span class="sc">$</span>pih, <span class="st">`</span><span class="at">*</span><span class="st">`</span>)</span></code></pre></div>
<p>This reduced design matrix is not strictly needed for selecting a multi-way stratified sample, but must be used in estimation. If in estimation as many balancing variables are used as we have marginal strata, the matrix with the sum of squares of balancing variables in Equation <a href="BalancedSpreaded.html#eq:betasbalanced">(9.5)</a>) cannot be inverted (matrix is singular), and as a consequence the population regression coefficients cannot be estimated.</p>
<p>Finally, the two-way stratified random sample is selected with function <code>samplecube</code> of package <strong>sampling</strong>.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="BalancedSpreaded.html#cb185-1" aria-hidden="true" tabindex="-1"></a>sample_ind <span class="ot">&lt;-</span> <span class="fu">samplecube</span>(<span class="at">X=</span>X, <span class="at">pik=</span>mypop<span class="sc">$</span>pih, <span class="at">method=</span><span class="dv">1</span>, <span class="at">comment=</span><span class="cn">FALSE</span>)</span>
<span id="cb185-2"><a href="BalancedSpreaded.html#cb185-2" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb185-3"><a href="BalancedSpreaded.html#cb185-3" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">which</span>(sample_ind<span class="sc">&gt;</span>(<span class="dv">1</span><span class="sc">-</span>eps))</span>
<span id="cb185-4"><a href="BalancedSpreaded.html#cb185-4" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> mypop[units,]</span></code></pre></div>
<p>Figure <a href="BalancedSpreaded.html#fig:Twowaystratifiedsample">9.8</a> shows the selected sample.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Twowaystratifiedsample"></span>
<img src="SpatialSampling_files/figure-html/Twowaystratifiedsample-1.png" alt="Two-way stratified sample." width="100%" />
<p class="caption">
Figure 9.8: Two-way stratified sample.
</p>
</div>
<p>All marginal sample sizes of map A are six, and all marginal sample sizes of map B are eight, as expected. The sample sizes of the cross-classification strata vary from zero to four.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="BalancedSpreaded.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">table</span>(mysample<span class="sc">$</span>A, mysample<span class="sc">$</span>B))</span></code></pre></div>
<pre><code>     
      B1 B2 B3 Sum
  A1   2  0  4   6
  A2   2  3  1   6
  A3   3  1  2   6
  A4   1  4  1   6
  Sum  8  8  8  24</code></pre>
<p>The population mean can be estimated by the <span class="math inline">\(\pi\)</span> estimator.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="BalancedSpreaded.html#cb188-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mypop)</span>
<span id="cb188-2"><a href="BalancedSpreaded.html#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(mysample<span class="sc">$</span>z<span class="sc">/</span>mysample<span class="sc">$</span>pih)<span class="sc">/</span>N)</span></code></pre></div>
<pre><code>[1] 8.688435</code></pre>
<p>The variance is estimated as before (Equation <a href="BalancedSpreaded.html#eq:approxvarianceBalanced">(9.3)</a>).</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="BalancedSpreaded.html#cb190-1" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>mysample<span class="sc">$</span>pih)</span>
<span id="cb190-2"><a href="BalancedSpreaded.html#cb190-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">estimate_b</span>(<span class="at">z=</span>mysample<span class="sc">$</span>z<span class="sc">/</span>mysample<span class="sc">$</span>pih, <span class="at">X=</span>X[units,]<span class="sc">/</span>mysample<span class="sc">$</span>pih, <span class="at">c=</span>c)</span>
<span id="cb190-3"><a href="BalancedSpreaded.html#cb190-3" aria-hidden="true" tabindex="-1"></a>zpred <span class="ot">&lt;-</span> X<span class="sc">%*%</span>b</span>
<span id="cb190-4"><a href="BalancedSpreaded.html#cb190-4" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> mysample<span class="sc">$</span>z<span class="sc">-</span>zpred[units]</span>
<span id="cb190-5"><a href="BalancedSpreaded.html#cb190-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mysample)</span>
<span id="cb190-6"><a href="BalancedSpreaded.html#cb190-6" aria-hidden="true" tabindex="-1"></a>v_tz <span class="ot">&lt;-</span> n<span class="sc">/</span>(n<span class="sc">-</span><span class="fu">ncol</span>(X))<span class="sc">*</span><span class="fu">sum</span>(c<span class="sc">*</span>(e<span class="sc">/</span>mysample<span class="sc">$</span>pih)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb190-7"><a href="BalancedSpreaded.html#cb190-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(v_mz <span class="ot">&lt;-</span> v_tz<span class="sc">/</span>N<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>[1] 0.1723688</code></pre>
</div>
</div>
<div id="Spreaded" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Well-spread sampling</h2>
<p>With balanced sampling the spreading of the sampling units in the space spanned by the balancing variables can be poor. For instance, in Figure <a href="BalancedSpreaded.html#fig:simpleexample">9.1</a> the Easting coordinates of all units of a sample balanced on Easting can be equal or close to the population mean of 10. So, in this example balancing does not guarantee a good geographical spreading. A balanced sample can be selected that shows strong clustering in the space spanned by the balancing variables. This clustering may inflate the standard error of the estimated population total and mean. The clustering in geographical or covariate space can be avoided by the local pivotal method <span class="citation">(<a href="#ref-Grafstrom2012" role="doc-biblioref">Grafström, Lundström, and Schelin 2012</a>)</span>, and the spatially correlated Poisson sampling method <span class="citation">(<a href="#ref-Grafstrom2012b" role="doc-biblioref">Grafström 2012</a>)</span>.</p>

<div class="rmdnote">
For spreading in <em>geographical</em> space various other designs are available. A simple design is stratified random sampling from compact geographical strata, see Section <a href="STSI.html#geostrata">4.6</a>. Alternative designs are generalised random-tessellation stratified sampling <span class="citation">(<a href="#ref-stevens2004" role="doc-biblioref">Stevens and Olson 2004</a>)</span>, see Section <a href="BalancedSpreaded.html#GRTS">9.2.2</a>, and balanced acceptance sampling <span class="citation">(<a href="#ref-Robertson2013" role="doc-biblioref">Robertson et al. 2013</a>)</span>.
</div>
<div id="LPM" class="section level3" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Local pivotal method</h3>
<p>The local pivotal method (LPM) is a modification of the pivotal method explained in Section <a href="pps.html#ppswor">8.2</a>. The only difference with the pivotal method is the selection of the pairs of units. In the pivotal method at each step two units are selected, for instance, the first two units in the vector with inclusion probabilities after randomizing the order of the units. In the local pivotal method the first unit is selected fully randomly and the nearest neighbour of this unit is used as its counterpart. Recall that when one unit of a pair is included in the sample, the inclusion probability of its counterpart is decreased. This leads to a better spreading of the sampling units in the space spanned by the spreading variables.</p>
<p>LPM can be used for arbitrary inclusion probabilities. The inclusion probabilities can be equal, but as in the pivotal method these probabilities may also differ among the population units.</p>
<p>Selecting samples with LPM can be done with functions <code>lpm</code>, <code>lpm1</code> or <code>lpm2</code> of package <strong>BalancedSampling</strong> <span class="citation">(<a href="#ref-Grafstrom2016" role="doc-biblioref">Grafström and Lisic 2016</a>)</span>. The functions <code>lpm1</code> and <code>lpm2</code> only differ in the selection of neighbours that are allowed to compete, for details see <span class="citation"><a href="#ref-Grafstrom2012" role="doc-biblioref">Grafström, Lundström, and Schelin</a> (<a href="#ref-Grafstrom2012" role="doc-biblioref">2012</a>)</span>. For most populations the two algorithms perform similar (personal communication Anton Grafström). The algorithm implemented in the function <code>lpm</code> is only recommended when the population size is too large for <code>lpm1</code> or <code>lpm2</code>. It only uses a subset of the population in search for nearest neighbours, and is thus not as good. Another function <code>lpm2_kdtree</code> of package <strong>SamplingBigData</strong> <span class="citation">(<a href="#ref-samplingBigData" role="doc-biblioref">Lisic and Grafström 2018</a>)</span> is developed for big data sets.</p>
<p>Inclusion probabilities are computed with function <code>inclusionprobabilities</code> of package <strong>sampling</strong>. A matrix <span class="math inline">\(\mathbf{X}\)</span> must be defined with the values of the spreading variables of the population units. Figure <a href="BalancedSpreaded.html#fig:LPMKandahar">9.9</a> shows a sample of 40 units selected from the sampling frame of Kandahar, using the spatial coordinates of the population units as spreading variables. Inclusion probabilities are proportional to the agricultural area within the population units. The geographical spreading is improved compared with the sample shown in Figure <a href="pps.html#fig:ppswrKandahar">8.1</a>.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="BalancedSpreaded.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BalancedSampling)</span>
<span id="cb192-2"><a href="BalancedSpreaded.html#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sampling)</span>
<span id="cb192-3"><a href="BalancedSpreaded.html#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Kandahar.RData&quot;</span>)</span>
<span id="cb192-4"><a href="BalancedSpreaded.html#cb192-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb192-5"><a href="BalancedSpreaded.html#cb192-5" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">inclusionprobabilities</span>(grdKandahar<span class="sc">$</span>agri, n)</span>
<span id="cb192-6"><a href="BalancedSpreaded.html#cb192-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grdKandahar<span class="sc">$</span>x, grdKandahar<span class="sc">$</span>y)</span>
<span id="cb192-7"><a href="BalancedSpreaded.html#cb192-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb192-8"><a href="BalancedSpreaded.html#cb192-8" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">lpm1</span>(pi, X)</span>
<span id="cb192-9"><a href="BalancedSpreaded.html#cb192-9" aria-hidden="true" tabindex="-1"></a>myLPMsample <span class="ot">&lt;-</span> grdKandahar[units,]</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:LPMKandahar"></span>
<img src="SpatialSampling_files/figure-html/LPMKandahar-1.png" alt="Spatial ppswor sample selected by local pivotal method, using agricultural area as size variable." width="100%" />
<p class="caption">
Figure 9.9: Spatial ppswor sample selected by local pivotal method, using agricultural area as size variable.
</p>
</div>
<p>The total poppy area can be estimated with the <span class="math inline">\(\pi\)</span> estimator (Equation <a href="IntroProbabilitySampling.html#eq:HTTotal">(2.2)</a>).</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="BalancedSpreaded.html#cb193-1" aria-hidden="true" tabindex="-1"></a>myLPMsample<span class="sc">$</span>pi <span class="ot">&lt;-</span> pi[units]</span>
<span id="cb193-2"><a href="BalancedSpreaded.html#cb193-2" aria-hidden="true" tabindex="-1"></a>tz_HT <span class="ot">&lt;-</span> <span class="fu">sum</span>(myLPMsample<span class="sc">$</span>poppy<span class="sc">/</span>myLPMsample<span class="sc">$</span>pi)</span></code></pre></div>
<p>The estimated total poppy area equals 56420 ha. The sampling variance of the estimator of the population total with the local pivotal method can be estimated by <span class="citation">(<a href="#ref-Grafstrom2014" role="doc-biblioref">Grafström and Schelin 2014</a>)</span></p>
<p><span class="math display" id="eq:VartotalLPM">\[\begin{equation}
\widehat{V}(\hat{t}(z)) = \frac{1}{2} \sum_{k \in \mathcal{S}} \left( \frac{z_k}{\pi_k} - \frac{z_{k_j}}{\pi_{k_j}} \right)^2 \;,
\tag{9.7}
\end{equation}\]</span></p>
<p>with <span class="math inline">\({k_j}\)</span> the nearest neighbour of unit <span class="math inline">\(k\)</span> in the sample. This variance estimator is for the case where we have only one nearest neighbour.</p>
<p>Function <code>vsb</code> of package <strong>BalancedSampling</strong> is an implementation of a more general variance estimator that accounts for more than one nearest neighbour (Equation (6) in <span class="citation"><a href="#ref-Grafstrom2014" role="doc-biblioref">Grafström and Schelin</a> (<a href="#ref-Grafstrom2014" role="doc-biblioref">2014</a>)</span>). We expect a somewhat smaller variance compared to pps sampling, so we may use the variance of the pwr estimator (Equation <a href="pps.html#eq:VarHHTotalppswr">(8.2)</a>) as a conservative variance estimator.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="BalancedSpreaded.html#cb194-1" aria-hidden="true" tabindex="-1"></a>Xsample <span class="ot">&lt;-</span> X[units,]</span>
<span id="cb194-2"><a href="BalancedSpreaded.html#cb194-2" aria-hidden="true" tabindex="-1"></a>se_tz_HT <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">vsb</span>(pi[units], myLPMsample<span class="sc">$</span>poppy, Xsample))</span>
<span id="cb194-3"><a href="BalancedSpreaded.html#cb194-3" aria-hidden="true" tabindex="-1"></a>pk <span class="ot">&lt;-</span> myLPMsample<span class="sc">$</span>pi<span class="sc">/</span>n</span>
<span id="cb194-4"><a href="BalancedSpreaded.html#cb194-4" aria-hidden="true" tabindex="-1"></a>se_tz_pwr <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(myLPMsample<span class="sc">$</span>poppy<span class="sc">/</span>pk)<span class="sc">/</span>n)</span></code></pre></div>
<p>The standard error obtained with function <code>vsb</code> equals 14222, the standard error of the Hansen-Hurwitz estimator equals 13468. So in this case the Hansen-Hurwitz variance estimator is smaller than the other variance estimator, but on average it will be larger.</p>
<p>As explained above, the LPM design can also be used to select a probability sample well-spread in the space spanned by one or more quantitative covariates. Matrix <span class="math inline">\(\mathbf{X}\)</span> then should contain the values of the <em>scaled</em> (standardised) covariates instead of the spatial coordinates.</p>
<div id="exercises-14" class="section level4 unnumbered">
<h4>Exercises</h4>
<ol start="3" style="list-style-type: decimal">
<li>Geographical spreading of the sampling units can also be achieved by random sampling from compact geographical strata (geostrata) (Section <a href="STSI.html#geostrata">4.6</a>). Can you think of one or more advantages of LPM sampling over random sampling from geostrata?</li>
</ol>
</div>
</div>
<div id="GRTS" class="section level3" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Generalised random-tessellation stratified sampling</h3>
<p>Generalised random-tessellation stratified sampling (GRTS) is designed for sampling discrete objects scattered throughout space, think for instance of the lakes in Finland, segments of hedgerows in England etc. Each object is represented by a point in 2D-space. It is a complicated design, and for sampling points from a continuous universe, or raster cells from a finite population, I recommend more simple designs such as the local pivotal method (Section <a href="BalancedSpreaded.html#LPM">9.2.1</a>), balanced sampling with geographical spreading (Section <a href="BalancedSpreaded.html#BalancedandSpreaded">9.3</a>), or sampling from compact geographical strata (Section <a href="STSI.html#geostrata">4.6</a>). Let me try to explain the GRTS design with a simple example of a finite population of point objects in a circular study area (Figure <a href="BalancedSpreaded.html#fig:GRTSNumbering">9.10</a>). For a more detailed description of this design I refer to <span class="citation"><a href="#ref-Hankin2019" role="doc-biblioref">Hankin, Mohr, and Newman</a> (<a href="#ref-Hankin2019" role="doc-biblioref">2019</a>)</span>. As a first step a square bounding box of the study area is constructed. This bounding box is recursively partitioned into square grid cells. First 2 x 2 grid cells are constructed. These grid cells are numbered in a predefined order. In Figure <a href="BalancedSpreaded.html#fig:GRTSNumbering">9.10</a> this numbering is from lower left, lower right, upper left to upper right. Each grid cell is then subdivided into four subcells; the subcells are numbered using the same order. This is repeated until at most one population unit occurs in each subcell. For our population only two iterations were needed, leading to 4 x 4 subcells. Note that some subcells are empty. Each address of a subcell consists of two digits, the first digit is for the grid cell, the second digit for the subcell.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:GRTSNumbering"></span>
<img src="SpatialSampling_files/figure-html/GRTSNumbering-1.png" alt="Numbering of grid cells and subcells for GRTS sampling." width="100%" />
<p class="caption">
Figure 9.10: Numbering of grid cells and subcells for GRTS sampling.
</p>
</div>
<p>The next step is to place the sixteen subcells on a line in a random order. The randomisation is done hierarchically. First the four grid cells at the highest level are randomized. In our example the randomized order is 1, 2, 3, 0 (Figure <a href="BalancedSpreaded.html#fig:GRTS">9.11</a>). Then within each grid cell the order of the subcells is randomized. This is done independently for the grid cells. In our example for grid cell 1 the randomized order of the subcells is 2, 1, 3, 0 (Figure <a href="BalancedSpreaded.html#fig:GRTS">9.11</a>). Note that the empty subcells, subcells (0,0) and (3,3) are removed from the line.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="BalancedSpreaded.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb195-2"><a href="BalancedSpreaded.html#cb195-2" aria-hidden="true" tabindex="-1"></a>ord <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(<span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb195-3"><a href="BalancedSpreaded.html#cb195-3" aria-hidden="true" tabindex="-1"></a>myfinpop_rand <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb195-4"><a href="BalancedSpreaded.html#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ord) {</span>
<span id="cb195-5"><a href="BalancedSpreaded.html#cb195-5" aria-hidden="true" tabindex="-1"></a>  units <span class="ot">&lt;-</span> <span class="fu">which</span>(myfinpop<span class="sc">$</span>partit1<span class="sc">==</span>i)</span>
<span id="cb195-6"><a href="BalancedSpreaded.html#cb195-6" aria-hidden="true" tabindex="-1"></a>  units_rand <span class="ot">&lt;-</span> <span class="fu">sample</span>(units, <span class="at">size=</span><span class="fu">length</span>(units))</span>
<span id="cb195-7"><a href="BalancedSpreaded.html#cb195-7" aria-hidden="true" tabindex="-1"></a>  myfinpop_rand <span class="ot">&lt;-</span> <span class="fu">rbind</span>(myfinpop_rand, myfinpop[units_rand,])</span>
<span id="cb195-8"><a href="BalancedSpreaded.html#cb195-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>After the subcells are placed on a line, a one-dimensional systematic random sample is selected (Figure <a href="BalancedSpreaded.html#fig:GRTS">9.11</a>), see also Section <a href="pps.html#Systematicpps">8.2.1</a>. This can be done either with equal or unequal inclusion probabilities. With equal inclusion probabilities the length of the lines representing the population units is constant. With unequal inclusion probabilities the length of the lines is proportional to a size variable. For a sample size of <span class="math inline">\(n\)</span>, the total line is divided into <span class="math inline">\(n\)</span> segments of equal length. A random point is selected in the first segment, and the other points of the systematic sample are determined. Finally, the population units corresponding with the selected systematic sample are identified. With equal probabilities the five selected units are the units in subcells 11, 23, 22, 32 and 03 (Figure <a href="BalancedSpreaded.html#fig:GRTS">9.11</a>).</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="BalancedSpreaded.html#cb196-1" aria-hidden="true" tabindex="-1"></a>size <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,N)</span>
<span id="cb196-2"><a href="BalancedSpreaded.html#cb196-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb196-3"><a href="BalancedSpreaded.html#cb196-3" aria-hidden="true" tabindex="-1"></a>interval <span class="ot">&lt;-</span> <span class="fu">sum</span>(size)<span class="sc">/</span>n</span>
<span id="cb196-4"><a href="BalancedSpreaded.html#cb196-4" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">*</span>interval,<span class="dv">2</span>)</span>
<span id="cb196-5"><a href="BalancedSpreaded.html#cb196-5" aria-hidden="true" tabindex="-1"></a>mysys <span class="ot">&lt;-</span> <span class="fu">c</span>(start,<span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)<span class="sc">*</span>interval<span class="sc">+</span>start)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:GRTS"></span>
<img src="SpatialSampling_files/figure-html/GRTS-1.png" alt="Systematic random sample along a line with equal inclusion probabilities." width="80%" />
<p class="caption">
Figure 9.11: Systematic random sample along a line with equal inclusion probabilities.
</p>
</div>
<p>Figure <a href="BalancedSpreaded.html#fig:GRTSpps">9.12</a> shows a systematic random sample along a line with unequal inclusion probabilities. The inclusion probabilities are proportional to a size variable, with values 1, 2, 3 or 4. The selected population units are the units in subcells 10, 20, 31, 01 and 02.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:GRTSpps"></span>
<img src="SpatialSampling_files/figure-html/GRTSpps-1.png" alt="Systematic random sample along a line with inclusion probabilities proportional to size." width="80%" />
<p class="caption">
Figure 9.12: Systematic random sample along a line with inclusion probabilities proportional to size.
</p>
</div>
<p>GRTS samples can be selected with function <code>grts</code> of package <strong>spsurvey</strong> <span class="citation">(<a href="#ref-spsurvey" role="doc-biblioref">Kincaid, Olsen, and Weber 2019</a>)</span>. The next code chunk shows the selection of a GRTS sample of 40 units from Kandahar. First a data frame is created representing the sampling frame. With unequal inclusion probabilities this data frame must include a variable for the inclusion probabilities. Next, a named list specifying the sampling design is created. The first element specifies how many units must be selected. In case of stratified random sampling these sample sizes must be set per stratum. Also, more than one sample can be selected (per stratum), referred to as panels. Per sampling round only one panel is observed. After multiple rounds the sample data can be used for estimating the temporal change of the spatial mean or total. The element <code>seltype</code> in the design list must be set to “Continuous” for sampling with probabilities proportional to an ancillary variable specified with argument <code>mdcaty</code>. If the argument <code>shift.grd</code> is set to TRUE (the default value), the hierarchical grid is shifted to a random position.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="BalancedSpreaded.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spsurvey)</span>
<span id="cb197-2"><a href="BalancedSpreaded.html#cb197-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb197-3"><a href="BalancedSpreaded.html#cb197-3" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">inclusionprobabilities</span>(grdKandahar<span class="sc">$</span>agri, n)</span>
<span id="cb197-4"><a href="BalancedSpreaded.html#cb197-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(grdKandahar)</span>
<span id="cb197-5"><a href="BalancedSpreaded.html#cb197-5" aria-hidden="true" tabindex="-1"></a>samplingframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb197-6"><a href="BalancedSpreaded.html#cb197-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span>grdKandahar<span class="sc">$</span>x, <span class="at">y=</span>grdKandahar<span class="sc">$</span>y, <span class="at">mdcaty=</span>pi, <span class="at">ids=</span><span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb197-7"><a href="BalancedSpreaded.html#cb197-7" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">None=</span><span class="fu">list</span>(<span class="at">panel=</span><span class="fu">c</span>(<span class="at">PanelOne=</span>n), <span class="at">seltype=</span><span class="st">&quot;Continuous&quot;</span>))</span>
<span id="cb197-8"><a href="BalancedSpreaded.html#cb197-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb197-9"><a href="BalancedSpreaded.html#cb197-9" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">grts</span>(</span>
<span id="cb197-10"><a href="BalancedSpreaded.html#cb197-10" aria-hidden="true" tabindex="-1"></a>  design, <span class="at">type.frame=</span><span class="st">&quot;finite&quot;</span>, <span class="at">src.frame=</span><span class="st">&quot;att.frame&quot;</span>,</span>
<span id="cb197-11"><a href="BalancedSpreaded.html#cb197-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">att.frame=</span>samplingframe, <span class="at">xcoord=</span><span class="st">&quot;x&quot;</span>, <span class="at">ycoord=</span><span class="st">&quot;y&quot;</span>,</span>
<span id="cb197-12"><a href="BalancedSpreaded.html#cb197-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">mdcaty=</span><span class="st">&quot;mdcaty&quot;</span>, <span class="at">do.sample=</span><span class="cn">TRUE</span>, <span class="at">shapefile=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>
Stratum: None 
Current number of levels: 3 
Current number of levels: 5 
Current number of levels: 6 
Final number of levels: 6 </code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="BalancedSpreaded.html#cb199-1" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> res<span class="sc">$</span>ids</span>
<span id="cb199-2"><a href="BalancedSpreaded.html#cb199-2" aria-hidden="true" tabindex="-1"></a>myGRTSsample <span class="ot">&lt;-</span> grdKandahar[units,]</span></code></pre></div>
<p>The total poppy area is estimated by the <span class="math inline">\(\pi\)</span> estimator.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="BalancedSpreaded.html#cb200-1" aria-hidden="true" tabindex="-1"></a>tz_GRTS <span class="ot">&lt;-</span> <span class="fu">sum</span>(myGRTSsample<span class="sc">$</span>poppy<span class="sc">/</span>pi[units])</span></code></pre></div>
<p>The estimated total is 56979. Function <code>vsb</code> of package <strong>BalancedSampling</strong> can be used to estimate the standard error of the estimated total poppy area.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="BalancedSpreaded.html#cb201-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grdKandahar<span class="sc">$</span>x, grdKandahar<span class="sc">$</span>y)</span>
<span id="cb201-2"><a href="BalancedSpreaded.html#cb201-2" aria-hidden="true" tabindex="-1"></a>Xsample <span class="ot">&lt;-</span> X[units,]</span>
<span id="cb201-3"><a href="BalancedSpreaded.html#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">vsb</span>(pi[units], myGRTSsample<span class="sc">$</span>poppy, Xsample)) <span class="sc">%&gt;%</span> <span class="fu">round</span>(.,<span class="dv">0</span>)</span></code></pre></div>
<pre><code>[1] 12887</code></pre>
</div>
</div>
<div id="BalancedandSpreaded" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Balanced sampling with spreading</h2>
<p>As mentioned in the introduction to this chapter a sample balanced on a covariate still may have a poor spreading along the axis spanned by the covariate. <span class="citation"><a href="#ref-Grafstrom2013" role="doc-biblioref">Grafström and Tillé</a> (<a href="#ref-Grafstrom2013" role="doc-biblioref">2013</a>)</span> presented a method for selecting balanced samples that are also well-spread in the space spanned by the covariates, which they refer to as doubly-balanced sampling. If we take one or more covariates as balancing variables, and besides Easting and Northing as spreading variables, this leads to balanced samples with good <em>geographical</em> spreading. When the residuals of the regression model show spatial structure (are spatially correlated), the estimated population mean of the study variable becomes more precise thanks to the improved geographical spreading. Balanced samples with spreading can be selected with function <code>lcube</code> of package <strong>BalancedSampling</strong>. This is illustrated with Eastern Amazonia, using as before lnSWIR2 for balancing the sample.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="BalancedSpreaded.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BalancedSampling)</span>
<span id="cb203-2"><a href="BalancedSpreaded.html#cb203-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(gridAmazonia)</span>
<span id="cb203-3"><a href="BalancedSpreaded.html#cb203-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb203-4"><a href="BalancedSpreaded.html#cb203-4" aria-hidden="true" tabindex="-1"></a>Xbal <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="at">times=</span>N), gridAmazonia<span class="sc">$</span>lnSWIR2)</span>
<span id="cb203-5"><a href="BalancedSpreaded.html#cb203-5" aria-hidden="true" tabindex="-1"></a>Xspread <span class="ot">&lt;-</span> <span class="fu">cbind</span>(gridAmazonia<span class="sc">$</span>x1, gridAmazonia<span class="sc">$</span>x2)</span>
<span id="cb203-6"><a href="BalancedSpreaded.html#cb203-6" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">rep</span>(n<span class="sc">/</span>N, <span class="at">times=</span>N)</span>
<span id="cb203-7"><a href="BalancedSpreaded.html#cb203-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb203-8"><a href="BalancedSpreaded.html#cb203-8" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">lcube</span>(<span class="at">Xbal=</span>Xbal, <span class="at">Xspread=</span>Xspread, <span class="at">prob=</span>pi)</span>
<span id="cb203-9"><a href="BalancedSpreaded.html#cb203-9" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> gridAmazonia[units,]</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:DoublyBalanceSampleAmazonia"></span>
<img src="SpatialSampling_files/figure-html/DoublyBalanceSampleAmazonia-1.png" alt="Sample balanced on lnSWIR2 with geographical spreading from Eastern Amazonia (Brazil)." width="100%" />
<p class="caption">
Figure 9.13: Sample balanced on lnSWIR2 with geographical spreading from Eastern Amazonia (Brazil).
</p>
</div>
<p>The selected sample is shown in Figure <a href="BalancedSpreaded.html#fig:DoublyBalanceSampleAmazonia">9.13</a>. Comparing this sample with the balanced sample of Figure <a href="BalancedSpreaded.html#fig:BalancedSampleAmazonia">9.3</a> shows that the geographical spreading of the sample is improved, although there still are some close points. The <span class="math inline">\(\pi\)</span> estimate of the mean is 225.61.</p>
<p>The variance of the estimator of the mean can be estimated by (Equation (7), <span class="citation"><a href="#ref-Grafstrom2013" role="doc-biblioref">Grafström and Tillé</a> (<a href="#ref-Grafstrom2013" role="doc-biblioref">2013</a>)</span>)</p>
<p><span class="math display" id="eq:VarmeanDoublyBalanced">\[\begin{equation}
\widehat{V}(\hat{\bar{z}}) = \frac{n}{n-p}\frac{p}{p+1} \sum_{k \in \mathcal{S}}(1-\pi_k) \left(\frac{\epsilon_k}{\pi_k}-\bar{\epsilon}_k \right)^2 \;,
\tag{9.8}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(p\)</span> the number of balancing variables, <span class="math inline">\(\epsilon_k\)</span> the regression model residual of unit <span class="math inline">\(k\)</span> (Equation <a href="BalancedSpreaded.html#eq:residualsBalanced">(9.4)</a>), and <span class="math inline">\(\bar{\epsilon}_k\)</span> the local mean of the residuals of this unit, computed by</p>
<p><span class="math display" id="eq:localmeanresdual">\[\begin{equation}
\bar{\epsilon}_k = \frac{\sum_{j=1}^{p+1}(1-\pi_j)\frac{\epsilon_j}{\pi_j}}{\sum_{j=1}^{p+1}(1-\pi_j)}\;.
\tag{9.9}
\end{equation}\]</span></p>
<p>This variance estimator can be computed with functions <code>localmean.weight</code> and <code>localmean.var</code> of package <strong>spsurvey</strong> <span class="citation">(<a href="#ref-spsurvey" role="doc-biblioref">Kincaid, Olsen, and Weber 2019</a>)</span>.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="BalancedSpreaded.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spsurvey)</span>
<span id="cb204-2"><a href="BalancedSpreaded.html#cb204-2" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">rep</span>(n<span class="sc">/</span>N,n)</span>
<span id="cb204-3"><a href="BalancedSpreaded.html#cb204-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>pi)</span>
<span id="cb204-4"><a href="BalancedSpreaded.html#cb204-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">estimate_b</span>(<span class="at">z=</span>mysample<span class="sc">$</span>AGB<span class="sc">/</span>pi, <span class="at">X=</span>Xbal[units,]<span class="sc">/</span>pi, <span class="at">c=</span>c)</span>
<span id="cb204-5"><a href="BalancedSpreaded.html#cb204-5" aria-hidden="true" tabindex="-1"></a>zpred <span class="ot">&lt;-</span> Xbal<span class="sc">%*%</span>b</span>
<span id="cb204-6"><a href="BalancedSpreaded.html#cb204-6" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> mysample<span class="sc">$</span>AGB<span class="sc">-</span>zpred[units]</span>
<span id="cb204-7"><a href="BalancedSpreaded.html#cb204-7" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">localmean.weight</span>(<span class="at">x=</span>mysample<span class="sc">$</span>x1, <span class="at">y=</span>mysample<span class="sc">$</span>x2, <span class="at">prb=</span><span class="fu">rep</span>(pi,n), <span class="at">nbh=</span><span class="dv">3</span>)</span>
<span id="cb204-8"><a href="BalancedSpreaded.html#cb204-8" aria-hidden="true" tabindex="-1"></a>v_mz <span class="ot">&lt;-</span> <span class="fu">localmean.var</span>(<span class="at">z=</span>e<span class="sc">/</span>pi, <span class="at">weight.lst=</span>weights)<span class="sc">/</span>N<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<p>The estimated standard error is 2.8, which is considerably smaller than the estimated standard error of the balanced sample without geographical spreading.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Deville2004" class="csl-entry">
———. 2004. <span>“Efficient Balanced Sampling: The Cube Method.”</span> <em>Biometrika</em> 91: 893–912.
</div>
<div id="ref-Deville2005" class="csl-entry">
———. 2005. <span>“Variance Approximation Under Balanced Sampling.”</span> <em>Journal of Statistical Planning and Inference</em> 128: 569–91.
</div>
<div id="ref-Falorsi2008" class="csl-entry">
Falorsi, P. D., and P. Righi. 2008. <span>“A Balanced Sampling Approach for Multi-Way Stratification Designs for Small Area Estimation.”</span> <em>Survey Methodology</em> 34: 223–34.
</div>
<div id="ref-Grafstrom2012b" class="csl-entry">
Grafström, A. 2012. <span>“<span class="nocase">Spatially correlated Poisson sampling</span>.”</span> <em>Journal of Statistical Planning and Inference</em> 142 (1): 139–47.
</div>
<div id="ref-Grafstrom2016" class="csl-entry">
Grafström, A., and J. Lisic. 2016. <em>BalancedSampling: Balanced and Spatially Balanced Sampling</em>. <a href="https://CRAN.R-project.org/package=BalancedSampling">https://CRAN.R-project.org/package=BalancedSampling</a>.
</div>
<div id="ref-Grafstrom2012" class="csl-entry">
Grafström, A., N. L. P. Lundström, and L. Schelin. 2012. <span>“Spatially Balanced Sampling Through the Pivotal Method.”</span> <em>Biometrics</em> 68: 514–20.
</div>
<div id="ref-Grafstrom2014" class="csl-entry">
Grafström, A., and L. Schelin. 2014. <span>“How to Select Representative Samples.”</span> <em>Scandinavian Journal of Statistics</em> 41 (2): 277–90. <a href="https://doi.org/10.1111/sjos.12016">https://doi.org/10.1111/sjos.12016</a>.
</div>
<div id="ref-Grafstrom2013" class="csl-entry">
Grafström, A., and Y. Tillé. 2013. <span>“Doubly Balanced Spatial Sampling with Spreading and Restitution of Auxiliary Totals.”</span> <em>Environmetrics</em> 24 (2): 120–31. <a href="https://doi.org/10.1002/env.2194">https://doi.org/10.1002/env.2194</a>.
</div>
<div id="ref-Hankin2019" class="csl-entry">
Hankin, D. G., M. S. Mohr, and K. B. Newman. 2019. <em>Sampling Theory: For the Ecological and Natural Resource Sciences</em>. Oxford University Press.
</div>
<div id="ref-spsurvey" class="csl-entry">
Kincaid, T. M., A. R. Olsen, and M. H. Weber. 2019. <em><span class="nocase">spsurvey: Spatial Survey Design and Analysis</span></em>.
</div>
<div id="ref-samplingBigData" class="csl-entry">
Lisic, Jonathan, and Anton Grafström. 2018. <em>SamplingBigData: Sampling Methods for Big Data</em>. <a href="https://CRAN.R-project.org/package=SamplingBigData">https://CRAN.R-project.org/package=SamplingBigData</a>.
</div>
<div id="ref-Robertson2013" class="csl-entry">
Robertson, B. L., J. A. Brown, T. McDonald, and P. Jaksons. 2013. <span>“<span class="nocase">BAS: Balanced Acceptance Sampling of Natural Resources</span>.”</span> <em>Biometrics</em>. <a href="https://doi.org/DOI: 10.1111/biom.12059">https://doi.org/DOI: 10.1111/biom.12059</a>.
</div>
<div id="ref-stevens2004" class="csl-entry">
Stevens, D. L., and A. R. Olson. 2004. <span>“Spatially Balanced Sampling of Natural Resources.”</span> <em>Journal of American Statistical Association</em> 99: 262–78.
</div>
<div id="ref-Tille2016" class="csl-entry">
Tillé, Y., and A. Matei. 2016. <em><span class="nocase">sampling: Survey Sampling</span></em>. <a href="https://CRAN.R-project.org/package=sampling">https://CRAN.R-project.org/package=sampling</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pps.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Modelassisted.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/DickBrus/SpatialSamplingwithR/edit/master/09-BalancedandSpreaded.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SpatialSampling.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
