<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 17 Regular grid and spatial coverage sampling | Spatial sampling with R</title>
  <meta name="description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 17 Regular grid and spatial coverage sampling | Spatial sampling with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.pdf" />
  <meta property="og:description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="github-repo" content="DickBrus/SpatialSamplingwithR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 17 Regular grid and spatial coverage sampling | Spatial sampling with R" />
  
  <meta name="twitter:description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="twitter:image" content="/images/cover.pdf" />

<meta name="author" content="Dick J. Brus" />


<meta name="date" content="2023-06-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="IntroSamplingforMapping.html"/>
<link rel="next" href="kmeans.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial sampling with R</a></li>

<li class="divider"></li>
<li><a href="index.html#preface" id="toc-preface">Preface</a>
<ul>
<li><a href="index.html#acknowledgments" id="toc-acknowledgments">Acknowledgments</a></li>
</ul></li>
<li><a href="GeneralIntro.html#GeneralIntro" id="toc-GeneralIntro"><span class="toc-section-number">1</span> Introduction</a>
<ul>
<li><a href="GeneralIntro.html#BasicConcepts" id="toc-BasicConcepts"><span class="toc-section-number">1.1</span> Basic sampling concepts</a>
<ul>
<li><a href="GeneralIntro.html#PopulationParameters" id="toc-PopulationParameters"><span class="toc-section-number">1.1.1</span> Population parameters</a></li>
<li><a href="GeneralIntro.html#descriptive-statistics-vs.-inference-about-a-population" id="toc-descriptive-statistics-vs.-inference-about-a-population"><span class="toc-section-number">1.1.2</span> Descriptive statistics vs. inference about a population</a></li>
<li><a href="GeneralIntro.html#random-sampling-vs.-probability-sampling" id="toc-random-sampling-vs.-probability-sampling"><span class="toc-section-number">1.1.3</span> Random sampling vs. probability sampling</a></li>
</ul></li>
<li><a href="GeneralIntro.html#DBvsMB" id="toc-DBvsMB"><span class="toc-section-number">1.2</span> Design-based vs. model-based approach</a></li>
<li><a href="GeneralIntro.html#Datasets" id="toc-Datasets"><span class="toc-section-number">1.3</span> Populations used in sampling experiments</a>
<ul>
<li><a href="GeneralIntro.html#Voorst" id="toc-Voorst"><span class="toc-section-number">1.3.1</span> Soil organic matter in Voorst, the Netherlands</a></li>
<li><a href="GeneralIntro.html#Poppy" id="toc-Poppy"><span class="toc-section-number">1.3.2</span> Poppy fields in Kandahar, Afghanistan</a></li>
<li><a href="GeneralIntro.html#Amazonia" id="toc-Amazonia"><span class="toc-section-number">1.3.3</span> Aboveground biomass in Eastern Amazonia, Brazil</a></li>
<li><a href="GeneralIntro.html#TASIberia" id="toc-TASIberia"><span class="toc-section-number">1.3.4</span> Annual mean air temperature in Iberia</a></li>
</ul></li>
</ul></li>
<li><a href="#part-probability-sampling-for-estimating-population-parameters" id="toc-part-probability-sampling-for-estimating-population-parameters">(PART) Probability sampling for estimating population parameters</a></li>
<li><a href="IntroProbabilitySampling.html#IntroProbabilitySampling" id="toc-IntroProbabilitySampling"><span class="toc-section-number">2</span> Introduction to probability sampling</a>
<ul>
<li><a href="IntroProbabilitySampling.html#arbitrary-haphazard-sampling-vs.-probability-sampling" id="toc-arbitrary-haphazard-sampling-vs.-probability-sampling">Arbitrary (haphazard) sampling vs. probability sampling</a></li>
<li><a href="IntroProbabilitySampling.html#HTestimator" id="toc-HTestimator"><span class="toc-section-number">2.1</span> Horvitz-Thompson estimator</a></li>
<li><a href="IntroProbabilitySampling.html#hansen-hurwitz-estimator" id="toc-hansen-hurwitz-estimator"><span class="toc-section-number">2.2</span> Hansen-Hurwitz estimator</a></li>
<li><a href="IntroProbabilitySampling.html#using-models-in-design-based-approach" id="toc-using-models-in-design-based-approach"><span class="toc-section-number">2.3</span> Using models in design-based approach</a></li>
</ul></li>
<li><a href="SI.html#SI" id="toc-SI"><span class="toc-section-number">3</span> Simple random sampling</a>
<ul>
<li><a href="SI.html#HTestimatorSI" id="toc-HTestimatorSI"><span class="toc-section-number">3.1</span> Estimation of population parameters</a>
<ul>
<li><a href="SI.html#PopProportion" id="toc-PopProportion"><span class="toc-section-number">3.1.1</span> Population proportion</a></li>
<li><a href="SI.html#CDF" id="toc-CDF"><span class="toc-section-number">3.1.2</span> Cumulative distribution function and quantiles</a></li>
</ul></li>
<li><a href="SI.html#VarMeanSI" id="toc-VarMeanSI"><span class="toc-section-number">3.2</span> Sampling variance of estimator of population parameters</a></li>
<li><a href="SI.html#ConfidenceInterval" id="toc-ConfidenceInterval"><span class="toc-section-number">3.3</span> Confidence interval estimate</a>
<ul>
<li><a href="SI.html#ConfidenceIntervalProportion" id="toc-ConfidenceIntervalProportion"><span class="toc-section-number">3.3.1</span> Confidence interval for a proportion</a></li>
</ul></li>
<li><a href="SI.html#SIcircularplots" id="toc-SIcircularplots"><span class="toc-section-number">3.4</span> Simple random sampling of circular plots</a>
<ul>
<li><a href="SI.html#sampling-from-a-finite-set-of-fixed-circles" id="toc-sampling-from-a-finite-set-of-fixed-circles"><span class="toc-section-number">3.4.1</span> Sampling from a finite set of fixed circles</a></li>
<li><a href="SI.html#sampling-from-an-infinite-set-of-floating-circles" id="toc-sampling-from-an-infinite-set-of-floating-circles"><span class="toc-section-number">3.4.2</span> Sampling from an infinite set of floating circles</a></li>
</ul></li>
</ul></li>
<li><a href="STSI.html#STSI" id="toc-STSI"><span class="toc-section-number">4</span> Stratified simple random sampling</a>
<ul>
<li><a href="STSI.html#EstimatorsSTSI" id="toc-EstimatorsSTSI"><span class="toc-section-number">4.1</span> Estimation of population parameters</a>
<ul>
<li><a href="STSI.html#population-proportion-cumulative-distribution-function-and-quantiles" id="toc-population-proportion-cumulative-distribution-function-and-quantiles"><span class="toc-section-number">4.1.1</span> Population proportion, cumulative distribution function, and quantiles</a></li>
<li><a href="STSI.html#WhyStratify" id="toc-WhyStratify"><span class="toc-section-number">4.1.2</span> Why should we stratify?</a></li>
</ul></li>
<li><a href="STSI.html#CISTSI" id="toc-CISTSI"><span class="toc-section-number">4.2</span> Confidence interval estimate</a></li>
<li><a href="STSI.html#STSIallocation" id="toc-STSIallocation"><span class="toc-section-number">4.3</span> Allocation of sample size to strata</a></li>
<li><a href="STSI.html#cumrootf" id="toc-cumrootf"><span class="toc-section-number">4.4</span> <em>Cum-root-f</em> stratification</a></li>
<li><a href="STSI.html#kmeansstratification" id="toc-kmeansstratification"><span class="toc-section-number">4.5</span> Stratification with multiple covariates</a></li>
<li><a href="STSI.html#geostrata" id="toc-geostrata"><span class="toc-section-number">4.6</span> Geographical stratification</a></li>
<li><a href="STSI.html#multiway-stratification" id="toc-multiway-stratification"><span class="toc-section-number">4.7</span> Multiway stratification</a></li>
<li><a href="STSI.html#MultivariateStratification" id="toc-MultivariateStratification"><span class="toc-section-number">4.8</span> Multivariate stratification</a></li>
</ul></li>
<li><a href="SY.html#SY" id="toc-SY"><span class="toc-section-number">5</span> Systematic random sampling</a>
<ul>
<li><a href="SY.html#EstVarSY" id="toc-EstVarSY"><span class="toc-section-number">5.1</span> Estimation of population parameters</a></li>
<li><a href="SY.html#approximating-the-sampling-variance-of-the-estimator-of-the-mean" id="toc-approximating-the-sampling-variance-of-the-estimator-of-the-mean"><span class="toc-section-number">5.2</span> Approximating the sampling variance of the estimator of the mean</a></li>
</ul></li>
<li><a href="Cl.html#Cl" id="toc-Cl"><span class="toc-section-number">6</span> Cluster random sampling</a>
<ul>
<li><a href="Cl.html#clustersamplingestimators" id="toc-clustersamplingestimators"><span class="toc-section-number">6.1</span> Estimation of population parameters</a></li>
<li><a href="Cl.html#clusters-selected-with-probabilities-proportional-to-size-without-replacement" id="toc-clusters-selected-with-probabilities-proportional-to-size-without-replacement"><span class="toc-section-number">6.2</span> Clusters selected with probabilities proportional to size, without replacement</a></li>
<li><a href="Cl.html#SIC" id="toc-SIC"><span class="toc-section-number">6.3</span> Simple random sampling of clusters</a></li>
<li><a href="Cl.html#StratifiedCl" id="toc-StratifiedCl"><span class="toc-section-number">6.4</span> Stratified cluster random sampling</a></li>
</ul></li>
<li><a href="Twostage.html#Twostage" id="toc-Twostage"><span class="toc-section-number">7</span> Two-stage cluster random sampling</a>
<ul>
<li><a href="Twostage.html#twostagesamplingestimators" id="toc-twostagesamplingestimators"><span class="toc-section-number">7.1</span> Estimation of population parameters</a></li>
<li><a href="Twostage.html#primary-sampling-units-selected-without-replacement" id="toc-primary-sampling-units-selected-without-replacement"><span class="toc-section-number">7.2</span> Primary sampling units selected without replacement</a></li>
<li><a href="Twostage.html#TwostageSISI" id="toc-TwostageSISI"><span class="toc-section-number">7.3</span> Simple random sampling of primary sampling units</a></li>
<li><a href="Twostage.html#StratifiedTwostage" id="toc-StratifiedTwostage"><span class="toc-section-number">7.4</span> Stratified two-stage cluster random sampling</a></li>
</ul></li>
<li><a href="pps.html#pps" id="toc-pps"><span class="toc-section-number">8</span> Sampling with probabilities proportional to size</a>
<ul>
<li><a href="pps.html#ppswr" id="toc-ppswr"><span class="toc-section-number">8.1</span> Probability-proportional-to-size sampling with replacement</a></li>
<li><a href="pps.html#ppswor" id="toc-ppswor"><span class="toc-section-number">8.2</span> Probability-proportional-to-size sampling without replacement</a>
<ul>
<li><a href="pps.html#Systematicpps" id="toc-Systematicpps"><span class="toc-section-number">8.2.1</span> Systematic pps sampling without replacement</a></li>
<li><a href="pps.html#pivotalmethod" id="toc-pivotalmethod"><span class="toc-section-number">8.2.2</span> The pivotal method</a></li>
</ul></li>
</ul></li>
<li><a href="BalancedSpreaded.html#BalancedSpreaded" id="toc-BalancedSpreaded"><span class="toc-section-number">9</span> Balanced and well-spread sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#Balanced" id="toc-Balanced"><span class="toc-section-number">9.1</span> Balanced sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#balanced-sample-vs.-balanced-sampling-design" id="toc-balanced-sample-vs.-balanced-sampling-design"><span class="toc-section-number">9.1.1</span> Balanced sample vs. balanced sampling design</a></li>
<li><a href="BalancedSpreaded.html#unequal-inclusion-probabilities" id="toc-unequal-inclusion-probabilities"><span class="toc-section-number">9.1.2</span> Unequal inclusion probabilities</a></li>
<li><a href="BalancedSpreaded.html#StratifiedsamplingasBalancedsampling" id="toc-StratifiedsamplingasBalancedsampling"><span class="toc-section-number">9.1.3</span> Stratified random sampling</a></li>
<li><a href="BalancedSpreaded.html#Multiwaystratification" id="toc-Multiwaystratification"><span class="toc-section-number">9.1.4</span> Multiway stratification</a></li>
</ul></li>
<li><a href="BalancedSpreaded.html#Spreaded" id="toc-Spreaded"><span class="toc-section-number">9.2</span> Well-spread sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#LPM" id="toc-LPM"><span class="toc-section-number">9.2.1</span> Local pivotal method</a></li>
<li><a href="BalancedSpreaded.html#GRTS" id="toc-GRTS"><span class="toc-section-number">9.2.2</span> Generalised random-tessellation stratified sampling</a></li>
</ul></li>
<li><a href="BalancedSpreaded.html#BalancedandSpreaded" id="toc-BalancedandSpreaded"><span class="toc-section-number">9.3</span> Balanced sampling with spreading</a></li>
</ul></li>
<li><a href="Modelassisted.html#Modelassisted" id="toc-Modelassisted"><span class="toc-section-number">10</span> Model-assisted estimation</a>
<ul>
<li><a href="Modelassisted.html#GREG" id="toc-GREG"><span class="toc-section-number">10.1</span> Generalised regression estimator</a>
<ul>
<li><a href="Modelassisted.html#RegressionEstimator" id="toc-RegressionEstimator"><span class="toc-section-number">10.1.1</span> Simple and multiple regression estimators</a></li>
<li><a href="Modelassisted.html#penalised-least-squares-estimation" id="toc-penalised-least-squares-estimation"><span class="toc-section-number">10.1.2</span> Penalised least squares estimation</a></li>
<li><a href="Modelassisted.html#RegressionEstimatorSTSI" id="toc-RegressionEstimatorSTSI"><span class="toc-section-number">10.1.3</span> Regression estimator with stratified simple random sampling</a></li>
</ul></li>
<li><a href="Modelassisted.html#RatioEstimator" id="toc-RatioEstimator"><span class="toc-section-number">10.2</span> Ratio estimator</a>
<ul>
<li><a href="Modelassisted.html#RatioEstimatorSTSI" id="toc-RatioEstimatorSTSI"><span class="toc-section-number">10.2.1</span> Ratio estimators with stratified simple random sampling</a></li>
</ul></li>
<li><a href="Modelassisted.html#PoststratifiedEstimator" id="toc-PoststratifiedEstimator"><span class="toc-section-number">10.3</span> Poststratified estimator</a></li>
<li><a href="Modelassisted.html#RandomForest" id="toc-RandomForest"><span class="toc-section-number">10.4</span> Model-assisted estimation using machine learning techniques</a>
<ul>
<li><a href="Modelassisted.html#predicting-with-a-regression-tree" id="toc-predicting-with-a-regression-tree"><span class="toc-section-number">10.4.1</span> Predicting with a regression tree</a></li>
<li><a href="Modelassisted.html#predicting-with-a-random-forest" id="toc-predicting-with-a-random-forest"><span class="toc-section-number">10.4.2</span> Predicting with a random forest</a></li>
</ul></li>
<li><a href="Modelassisted.html#big-data-and-volunteer-data" id="toc-big-data-and-volunteer-data"><span class="toc-section-number">10.5</span> Big data and volunteer data</a></li>
</ul></li>
<li><a href="Twophase.html#Twophase" id="toc-Twophase"><span class="toc-section-number">11</span> Two-phase random sampling</a>
<ul>
<li><a href="Twophase.html#TwophaseStratification" id="toc-TwophaseStratification"><span class="toc-section-number">11.1</span> Two-phase random sampling for stratification</a></li>
<li><a href="Twophase.html#TwophaseRegression" id="toc-TwophaseRegression"><span class="toc-section-number">11.2</span> Two-phase random sampling for regression</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#RequiredSampleSize" id="toc-RequiredSampleSize"><span class="toc-section-number">12</span> Computing the required sample size</a>
<ul>
<li><a href="RequiredSampleSize.html#standard-error" id="toc-standard-error"><span class="toc-section-number">12.1</span> Standard error</a></li>
<li><a href="RequiredSampleSize.html#ReqSampleSizeLengthCI" id="toc-ReqSampleSizeLengthCI"><span class="toc-section-number">12.2</span> Length of confidence interval</a>
<ul>
<li><a href="RequiredSampleSize.html#length-of-confidence-interval-for-a-proportion" id="toc-length-of-confidence-interval-for-a-proportion"><span class="toc-section-number">12.2.1</span> Length of confidence interval for a proportion</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#statistical-testing-of-hypothesis" id="toc-statistical-testing-of-hypothesis"><span class="toc-section-number">12.3</span> Statistical testing of hypothesis</a>
<ul>
<li><a href="RequiredSampleSize.html#sample-size-for-testing-a-proportion" id="toc-sample-size-for-testing-a-proportion"><span class="toc-section-number">12.3.1</span> Sample size for testing a proportion</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#DesignEffect" id="toc-DesignEffect"><span class="toc-section-number">12.4</span> Accounting for design effect</a></li>
<li><a href="RequiredSampleSize.html#BayesianSampleSize" id="toc-BayesianSampleSize"><span class="toc-section-number">12.5</span> Bayesian sample size determination</a>
<ul>
<li><a href="RequiredSampleSize.html#bayesian-criteria-for-sample-size-computation" id="toc-bayesian-criteria-for-sample-size-computation"><span class="toc-section-number">12.5.1</span> Bayesian criteria for sample size computation</a></li>
<li><a href="RequiredSampleSize.html#mixed-bayesian-likelihood-approach" id="toc-mixed-bayesian-likelihood-approach"><span class="toc-section-number">12.5.2</span> Mixed Bayesian-likelihood approach</a></li>
<li><a href="RequiredSampleSize.html#estimation-of-population-mean" id="toc-estimation-of-population-mean"><span class="toc-section-number">12.5.3</span> Estimation of population mean</a></li>
<li><a href="RequiredSampleSize.html#estimation-of-a-population-proportion" id="toc-estimation-of-a-population-proportion"><span class="toc-section-number">12.5.4</span> Estimation of a population proportion</a></li>
</ul></li>
</ul></li>
<li><a href="MBpredictionofDesignVariance.html#MBpredictionofDesignVariance" id="toc-MBpredictionofDesignVariance"><span class="toc-section-number">13</span> Model-based optimisation of probability sampling designs</a>
<ul>
<li><a href="MBpredictionofDesignVariance.html#model-based-optimisation-of-sampling-design-type-and-sample-size" id="toc-model-based-optimisation-of-sampling-design-type-and-sample-size"><span class="toc-section-number">13.1</span> Model-based optimisation of sampling design type and sample size</a>
<ul>
<li><a href="MBpredictionofDesignVariance.html#AnalyticalApproach" id="toc-AnalyticalApproach"><span class="toc-section-number">13.1.1</span> Analytical approach</a></li>
<li><a href="MBpredictionofDesignVariance.html#GeostatisticalSimulationApproach" id="toc-GeostatisticalSimulationApproach"><span class="toc-section-number">13.1.2</span> Geostatistical simulation approach</a></li>
<li><a href="MBpredictionofDesignVariance.html#MBpredSamplingVarBayes" id="toc-MBpredSamplingVarBayes"><span class="toc-section-number">13.1.3</span> Bayesian approach</a></li>
</ul></li>
<li><a href="MBpredictionofDesignVariance.html#Ospats" id="toc-Ospats"><span class="toc-section-number">13.2</span> Model-based optimisation of spatial strata</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#SmallAreaEstimation" id="toc-SmallAreaEstimation"><span class="toc-section-number">14</span> Sampling for estimating parameters of domains</a>
<ul>
<li><a href="SmallAreaEstimation.html#LargeDomainsDirectEstimator" id="toc-LargeDomainsDirectEstimator"><span class="toc-section-number">14.1</span> Direct estimator for large domains</a></li>
<li><a href="SmallAreaEstimation.html#SmallDomainsModelAssisted" id="toc-SmallDomainsModelAssisted"><span class="toc-section-number">14.2</span> Model-assisted estimators for small domains</a>
<ul>
<li><a href="SmallAreaEstimation.html#RegressionestimatorSmallDomain" id="toc-RegressionestimatorSmallDomain"><span class="toc-section-number">14.2.1</span> Regression estimator</a></li>
<li><a href="SmallAreaEstimation.html#SyntheticestimatorSmallDomain" id="toc-SyntheticestimatorSmallDomain"><span class="toc-section-number">14.2.2</span> Synthetic estimator</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#SmallAreaModelBased" id="toc-SmallAreaModelBased"><span class="toc-section-number">14.3</span> Model-based prediction</a>
<ul>
<li><a href="SmallAreaEstimation.html#random-intercept-model" id="toc-random-intercept-model"><span class="toc-section-number">14.3.1</span> Random intercept model</a></li>
<li><a href="SmallAreaEstimation.html#geostatistical-model" id="toc-geostatistical-model"><span class="toc-section-number">14.3.2</span> Geostatistical model</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#supplemental-probability-sampling-of-small-domains" id="toc-supplemental-probability-sampling-of-small-domains"><span class="toc-section-number">14.4</span> Supplemental probability sampling of small domains</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#RepeatedSurveys" id="toc-RepeatedSurveys"><span class="toc-section-number">15</span> Repeated sample surveys for monitoring population parameters</a>
<ul>
<li><a href="RepeatedSurveys.html#space-time-designs" id="toc-space-time-designs"><span class="toc-section-number">15.1</span> Space-time designs</a></li>
<li><a href="RepeatedSurveys.html#SpaceTimeparameters" id="toc-SpaceTimeparameters"><span class="toc-section-number">15.2</span> Space-time population parameters</a></li>
<li><a href="RepeatedSurveys.html#design-based-generalised-least-squares-estimation-of-spatial-means" id="toc-design-based-generalised-least-squares-estimation-of-spatial-means"><span class="toc-section-number">15.3</span> Design-based generalised least squares estimation of spatial means</a>
<ul>
<li><a href="RepeatedSurveys.html#current-mean" id="toc-current-mean"><span class="toc-section-number">15.3.1</span> Current mean</a></li>
<li><a href="RepeatedSurveys.html#change-of-the-spatial-mean" id="toc-change-of-the-spatial-mean"><span class="toc-section-number">15.3.2</span> Change of the spatial mean</a></li>
<li><a href="RepeatedSurveys.html#temporal-trend-of-the-spatial-mean" id="toc-temporal-trend-of-the-spatial-mean"><span class="toc-section-number">15.3.3</span> Temporal trend of the spatial mean</a></li>
<li><a href="RepeatedSurveys.html#space-time-mean" id="toc-space-time-mean"><span class="toc-section-number">15.3.4</span> Space-time mean</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#case-study-annual-mean-daily-temperature-in-iberia" id="toc-case-study-annual-mean-daily-temperature-in-iberia"><span class="toc-section-number">15.4</span> Case study: annual mean daily temperature in Iberia</a>
<ul>
<li><a href="RepeatedSurveys.html#static-synchronous-design" id="toc-static-synchronous-design"><span class="toc-section-number">15.4.1</span> Static-synchronous design</a></li>
<li><a href="RepeatedSurveys.html#independent-synchronous-design" id="toc-independent-synchronous-design"><span class="toc-section-number">15.4.2</span> Independent synchronous design</a></li>
<li><a href="RepeatedSurveys.html#serially-alternating-design" id="toc-serially-alternating-design"><span class="toc-section-number">15.4.3</span> Serially alternating design</a></li>
<li><a href="RepeatedSurveys.html#supplemented-panel-design" id="toc-supplemented-panel-design"><span class="toc-section-number">15.4.4</span> Supplemented panel design</a></li>
<li><a href="RepeatedSurveys.html#rotating-panel-design" id="toc-rotating-panel-design"><span class="toc-section-number">15.4.5</span> Rotating panel design</a></li>
<li><a href="RepeatedSurveys.html#sampling-experiment" id="toc-sampling-experiment"><span class="toc-section-number">15.4.6</span> Sampling experiment</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#space-time-sampling-with-stratified-random-sampling-in-space" id="toc-space-time-sampling-with-stratified-random-sampling-in-space"><span class="toc-section-number">15.5</span> Space-time sampling with stratified random sampling in space</a></li>
</ul></li>
<li><a href="#part-sampling-for-mapping" id="toc-part-sampling-for-mapping">(PART) Sampling for mapping</a></li>
<li><a href="IntroSamplingforMapping.html#IntroSamplingforMapping" id="toc-IntroSamplingforMapping"><span class="toc-section-number">16</span> Introduction to sampling for mapping</a>
<ul>
<li><a href="IntroSamplingforMapping.html#when-is-probability-sampling-not-required" id="toc-when-is-probability-sampling-not-required"><span class="toc-section-number">16.1</span> When is probability sampling not required?</a></li>
<li><a href="IntroSamplingforMapping.html#sampling-for-simultaneously-mapping-and-estimating-means" id="toc-sampling-for-simultaneously-mapping-and-estimating-means"><span class="toc-section-number">16.2</span> Sampling for simultaneously mapping and estimating means</a></li>
<li><a href="IntroSamplingforMapping.html#broad-overview-of-sampling-designs-for-mapping" id="toc-broad-overview-of-sampling-designs-for-mapping"><span class="toc-section-number">16.3</span> Broad overview of sampling designs for mapping</a></li>
</ul></li>
<li><a href="RegularGridSpatialCoverage.html#RegularGridSpatialCoverage" id="toc-RegularGridSpatialCoverage"><span class="toc-section-number">17</span> Regular grid and spatial coverage sampling</a>
<ul>
<li><a href="RegularGridSpatialCoverage.html#Regulargrid" id="toc-Regulargrid"><span class="toc-section-number">17.1</span> Regular grid sampling</a></li>
<li><a href="RegularGridSpatialCoverage.html#SpatialCoverage" id="toc-SpatialCoverage"><span class="toc-section-number">17.2</span> Spatial coverage sampling</a></li>
<li><a href="RegularGridSpatialCoverage.html#SpatialInfill" id="toc-SpatialInfill"><span class="toc-section-number">17.3</span> Spatial infill sampling</a></li>
</ul></li>
<li><a href="kmeans.html#kmeans" id="toc-kmeans"><span class="toc-section-number">18</span> Covariate space coverage sampling</a>
<ul>
<li><a href="kmeans.html#covariate-space-infill-sampling" id="toc-covariate-space-infill-sampling"><span class="toc-section-number">18.1</span> Covariate space infill sampling</a></li>
<li><a href="kmeans.html#PerformanceCSC" id="toc-PerformanceCSC"><span class="toc-section-number">18.2</span> Performance of covariate space coverage sampling in random forest prediction</a></li>
</ul></li>
<li><a href="cLHS.html#cLHS" id="toc-cLHS"><span class="toc-section-number">19</span> Conditioned Latin hypercube sampling</a>
<ul>
<li><a href="cLHS.html#cLHIS" id="toc-cLHIS"><span class="toc-section-number">19.1</span> Conditioned Latin hypercube infill sampling</a></li>
<li><a href="cLHS.html#performance-of-conditioned-latin-hypercube-sampling-in-random-forest-prediction" id="toc-performance-of-conditioned-latin-hypercube-sampling-in-random-forest-prediction"><span class="toc-section-number">19.2</span> Performance of conditioned Latin hypercube sampling in random forest prediction</a></li>
</ul></li>
<li><a href="SpatialResponseSurface.html#SpatialResponseSurface" id="toc-SpatialResponseSurface"><span class="toc-section-number">20</span> Spatial response surface sampling</a>
<ul>
<li><a href="SpatialResponseSurface.html#IncreaseSampleSize" id="toc-IncreaseSampleSize"><span class="toc-section-number">20.1</span> Increasing the sample size</a></li>
<li><a href="SpatialResponseSurface.html#stratified-spatial-response-surface-sampling" id="toc-stratified-spatial-response-surface-sampling"><span class="toc-section-number">20.2</span> Stratified spatial response surface sampling</a></li>
<li><a href="SpatialResponseSurface.html#mapping" id="toc-mapping"><span class="toc-section-number">20.3</span> Mapping</a></li>
</ul></li>
<li><a href="Introkriging.html#Introkriging" id="toc-Introkriging"><span class="toc-section-number">21</span> Introduction to kriging</a>
<ul>
<li><a href="Introkriging.html#OrdinaryKriging" id="toc-OrdinaryKriging"><span class="toc-section-number">21.1</span> Ordinary kriging</a></li>
<li><a href="Introkriging.html#BlockKriging" id="toc-BlockKriging"><span class="toc-section-number">21.2</span> Block-kriging</a></li>
<li><a href="Introkriging.html#IntroKED" id="toc-IntroKED"><span class="toc-section-number">21.3</span> Kriging with an external drift</a></li>
<li><a href="Introkriging.html#VariogramEstimation" id="toc-VariogramEstimation"><span class="toc-section-number">21.4</span> Estimating the semivariogram</a>
<ul>
<li><a href="Introkriging.html#MoM" id="toc-MoM"><span class="toc-section-number">21.4.1</span> Method-of-moments</a></li>
<li><a href="Introkriging.html#MLestimationVariogram" id="toc-MLestimationVariogram"><span class="toc-section-number">21.4.2</span> Maximum likelihood</a></li>
</ul></li>
<li><a href="Introkriging.html#ResidualVariogram" id="toc-ResidualVariogram"><span class="toc-section-number">21.5</span> Estimating the residual semivariogram</a>
<ul>
<li><a href="Introkriging.html#IterativeMoM" id="toc-IterativeMoM"><span class="toc-section-number">21.5.1</span> Iterative method-of-moments</a></li>
<li><a href="Introkriging.html#REML" id="toc-REML"><span class="toc-section-number">21.5.2</span> Restricted maximum likelihood</a></li>
</ul></li>
</ul></li>
<li><a href="MBgridspacing.html#MBgridspacing" id="toc-MBgridspacing"><span class="toc-section-number">22</span> Model-based optimisation of the grid spacing</a>
<ul>
<li><a href="MBgridspacing.html#GridspacingOK" id="toc-GridspacingOK"><span class="toc-section-number">22.1</span> Optimal grid spacing for ordinary kriging</a></li>
<li><a href="MBgridspacing.html#controlling-the-mean-or-a-quantile-of-the-ordinary-kriging-variance" id="toc-controlling-the-mean-or-a-quantile-of-the-ordinary-kriging-variance"><span class="toc-section-number">22.2</span> Controlling the mean or a quantile of the ordinary kriging variance</a></li>
<li><a href="MBgridspacing.html#optimal-grid-spacing-for-block-kriging" id="toc-optimal-grid-spacing-for-block-kriging"><span class="toc-section-number">22.3</span> Optimal grid spacing for block-kriging</a></li>
<li><a href="MBgridspacing.html#MBgridspacingKED" id="toc-MBgridspacingKED"><span class="toc-section-number">22.4</span> Optimal grid spacing for kriging with an external drift</a></li>
<li><a href="MBgridspacing.html#BayesianGridSpacing" id="toc-BayesianGridSpacing"><span class="toc-section-number">22.5</span> Bayesian approach</a></li>
</ul></li>
<li><a href="MBSamplePattern.html#MBSamplePattern" id="toc-MBSamplePattern"><span class="toc-section-number">23</span> Model-based optimisation of the sampling pattern</a>
<ul>
<li><a href="MBSamplePattern.html#SSA" id="toc-SSA"><span class="toc-section-number">23.1</span> Spatial simulated annealing</a></li>
<li><a href="MBSamplePattern.html#SamplePatternOK" id="toc-SamplePatternOK"><span class="toc-section-number">23.2</span> Optimising the sampling pattern for ordinary kriging</a></li>
<li><a href="MBSamplePattern.html#SamplePatternKED" id="toc-SamplePatternKED"><span class="toc-section-number">23.3</span> Optimising the sampling pattern for kriging with an external drift</a></li>
<li><a href="MBSamplePattern.html#model-based-infill-sampling-for-ordinary-kriging" id="toc-model-based-infill-sampling-for-ordinary-kriging"><span class="toc-section-number">23.4</span> Model-based infill sampling for ordinary kriging</a></li>
<li><a href="MBSamplePattern.html#model-based-infill-sampling-for-kriging-with-an-external-drift" id="toc-model-based-infill-sampling-for-kriging-with-an-external-drift"><span class="toc-section-number">23.5</span> Model-based infill sampling for kriging with an external drift</a></li>
</ul></li>
<li><a href="SamplingVariogram.html#SamplingVariogram" id="toc-SamplingVariogram"><span class="toc-section-number">24</span> Sampling for estimating the semivariogram</a>
<ul>
<li><a href="SamplingVariogram.html#NestedSampling" id="toc-NestedSampling"><span class="toc-section-number">24.1</span> Nested sampling</a></li>
<li><a href="SamplingVariogram.html#IndependentSamplingPairs" id="toc-IndependentSamplingPairs"><span class="toc-section-number">24.2</span> Independent sampling of pairs of points</a></li>
<li><a href="SamplingVariogram.html#samplingforvariogram" id="toc-samplingforvariogram"><span class="toc-section-number">24.3</span> Optimisation of sampling pattern for semivariogram estimation</a>
<ul>
<li><a href="SamplingVariogram.html#UncertainSemivariogramParameters" id="toc-UncertainSemivariogramParameters"><span class="toc-section-number">24.3.1</span> Uncertainty about semivariogram parameters</a></li>
<li><a href="SamplingVariogram.html#UncertainKrigingVariance" id="toc-UncertainKrigingVariance"><span class="toc-section-number">24.3.2</span> Uncertainty about the kriging variance</a></li>
</ul></li>
<li><a href="SamplingVariogram.html#SamplingEstimationandPrediction" id="toc-SamplingEstimationandPrediction"><span class="toc-section-number">24.4</span> Optimisation of sampling pattern for semivariogram estimation and mapping</a></li>
<li><a href="SamplingVariogram.html#a-practical-solution" id="toc-a-practical-solution"><span class="toc-section-number">24.5</span> A practical solution</a></li>
</ul></li>
<li><a href="Validation.html#Validation" id="toc-Validation"><span class="toc-section-number">25</span> Sampling for validation of maps</a>
<ul>
<li><a href="Validation.html#map-quality-indices" id="toc-map-quality-indices"><span class="toc-section-number">25.1</span> Map quality indices</a>
<ul>
<li><a href="Validation.html#estimation-of-map-quality-indices" id="toc-estimation-of-map-quality-indices"><span class="toc-section-number">25.1.1</span> Estimation of map quality indices</a></li>
</ul></li>
<li><a href="Validation.html#real-world-case-study" id="toc-real-world-case-study"><span class="toc-section-number">25.2</span> Real-world case study</a>
<ul>
<li><a href="Validation.html#estimation-of-the-population-mean-error-and-mean-squared-error" id="toc-estimation-of-the-population-mean-error-and-mean-squared-error"><span class="toc-section-number">25.2.1</span> Estimation of the population mean error and mean squared error</a></li>
<li><a href="Validation.html#estimation-of-the-standard-error-of-the-estimator-of-the-population-mean-error-and-mean-squared-error" id="toc-estimation-of-the-standard-error-of-the-estimator-of-the-population-mean-error-and-mean-squared-error"><span class="toc-section-number">25.2.2</span> Estimation of the standard error of the estimator of the population mean error and mean squared error</a></li>
<li><a href="Validation.html#estimation-of-model-efficiency-coefficient" id="toc-estimation-of-model-efficiency-coefficient"><span class="toc-section-number">25.2.3</span> Estimation of model efficiency coefficient</a></li>
<li><a href="Validation.html#statistical-testing-of-hypothesis-about-population-me-and-mse" id="toc-statistical-testing-of-hypothesis-about-population-me-and-mse"><span class="toc-section-number">25.2.4</span> Statistical testing of hypothesis about population ME and MSE</a></li>
</ul></li>
</ul></li>
<li><a href="Approaches.html#Approaches" id="toc-Approaches"><span class="toc-section-number">26</span> Design-based, model-based, and model-assisted approach for sampling and inference</a>
<ul>
<li><a href="Approaches.html#two-sources-of-randomness" id="toc-two-sources-of-randomness"><span class="toc-section-number">26.1</span> Two sources of randomness</a></li>
<li><a href="Approaches.html#iid" id="toc-iid"><span class="toc-section-number">26.2</span> Identically and independently distributed</a></li>
<li><a href="Approaches.html#BiasandVariance" id="toc-BiasandVariance"><span class="toc-section-number">26.3</span> Bias and variance</a></li>
<li><a href="Approaches.html#effectivesamplesize" id="toc-effectivesamplesize"><span class="toc-section-number">26.4</span> Effective sample size</a></li>
<li><a href="Approaches.html#ExploitSpatialStructure" id="toc-ExploitSpatialStructure"><span class="toc-section-number">26.5</span> Exploiting spatial structure in design-based approach</a></li>
<li><a href="Approaches.html#ModelassistedvsModeldependent" id="toc-ModelassistedvsModeldependent"><span class="toc-section-number">26.6</span> Model-assisted vs. model-dependent</a></li>
</ul></li>
<li><a href="#appendix-appendices" id="toc-appendix-appendices">(APPENDIX) Appendices</a></li>
<li><a href="Answers.html#Answers" id="toc-Answers"><span class="toc-section-number">27</span> Answers to exercises</a>
<ul>
<li><a href="Answers.html#introduction-to-probability-sampling" id="toc-introduction-to-probability-sampling">Introduction to probability sampling</a></li>
<li><a href="Answers.html#simple-random-sampling-1" id="toc-simple-random-sampling-1">Simple random sampling</a></li>
<li><a href="Answers.html#stratified-simple-random-sampling-1" id="toc-stratified-simple-random-sampling-1">Stratified simple random sampling</a></li>
<li><a href="Answers.html#systematic-random-sampling-2" id="toc-systematic-random-sampling-2">Systematic random sampling</a></li>
<li><a href="Answers.html#cluster-random-sampling" id="toc-cluster-random-sampling">Cluster random sampling</a></li>
<li><a href="Answers.html#two-stage-cluster-random-sampling-1" id="toc-two-stage-cluster-random-sampling-1">Two-stage cluster random sampling</a></li>
<li><a href="Answers.html#sampling-with-probabilities-proportional-to-size" id="toc-sampling-with-probabilities-proportional-to-size">Sampling with probabilities proportional to size</a></li>
<li><a href="Answers.html#balanced-and-well-spread-sampling" id="toc-balanced-and-well-spread-sampling">Balanced and well-spread sampling</a></li>
<li><a href="Answers.html#model-assisted-estimation" id="toc-model-assisted-estimation">Model-assisted estimation</a></li>
<li><a href="Answers.html#two-phase-random-sampling" id="toc-two-phase-random-sampling">Two-phase random sampling</a></li>
<li><a href="Answers.html#computing-the-required-sample-size" id="toc-computing-the-required-sample-size">Computing the required sample size</a></li>
<li><a href="Answers.html#model-based-optimisation-of-probability-sampling-designs" id="toc-model-based-optimisation-of-probability-sampling-designs">Model-based optimisation of probability sampling designs</a></li>
<li><a href="Answers.html#repeated-sample-surveys-for-monitoring-population-parameters" id="toc-repeated-sample-surveys-for-monitoring-population-parameters">Repeated sample surveys for monitoring population parameters</a></li>
<li><a href="Answers.html#regular-grid-and-spatial-coverage-sampling" id="toc-regular-grid-and-spatial-coverage-sampling">Regular grid and spatial coverage sampling</a></li>
<li><a href="Answers.html#covariate-space-coverage-sampling" id="toc-covariate-space-coverage-sampling">Covariate space coverage sampling</a></li>
<li><a href="Answers.html#conditioned-latin-hypercube-sampling" id="toc-conditioned-latin-hypercube-sampling">Conditioned Latin hypercube sampling</a></li>
<li><a href="Answers.html#model-based-optimisation-of-the-grid-spacing" id="toc-model-based-optimisation-of-the-grid-spacing">Model-based optimisation of the grid spacing</a></li>
<li><a href="Answers.html#model-based-optimisation-of-the-sampling-pattern" id="toc-model-based-optimisation-of-the-sampling-pattern">Model-based optimisation of the sampling pattern</a></li>
<li><a href="Answers.html#sampling-for-estimating-the-semivariogram" id="toc-sampling-for-estimating-the-semivariogram">Sampling for estimating the semivariogram</a></li>
<li><a href="Answers.html#sampling-for-validation-of-maps" id="toc-sampling-for-validation-of-maps">Sampling for validation of maps</a></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/DickBrus/">Dick Brus</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial sampling with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="RegularGridSpatialCoverage" class="section level1 hasAnchor" number="17">
<h1><span class="header-section-number">Chapter 17</span> Regular grid and spatial coverage sampling<a href="RegularGridSpatialCoverage.html#RegularGridSpatialCoverage" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter describes and illustrates two sampling designs by which the sampling locations are evenly spread throughout the study area: regular grid sampling and spatial coverage sampling. In a final section, the spatial coverage sampling design is used to fill in the empty spaces of an existing sample.</p>
<div id="Regulargrid" class="section level2 hasAnchor" number="17.1">
<h2><span class="header-section-number">17.1</span> Regular grid sampling<a href="RegularGridSpatialCoverage.html#Regulargrid" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sampling on a regular grid is an attractive option for mapping because of its simplicity. The data collected on the grid nodes are not used for design-based estimation of the population mean or total. For this reason, the grid need not be placed randomly on the study area as in systematic random sampling (Chapter <a href="SY.html#SY">5</a>). The grid can be located such that the grid nodes optimally cover the study area in the sense of the average distance of the nodes of a fine discretisation grid to the nearest node of the sampling grid. Commonly used grid configurations are square and triangular. If the grid data are used in kriging (Chapter <a href="Introkriging.html#Introkriging">21</a>), the optimal configuration depends, among others, on the semivariogram model. If the study variable shows moderate to strong spatial autocorrelation (see Section <a href="Introkriging.html#OrdinaryKriging">21.1</a>), triangular grids outperform square grids.</p>
<p>Besides the shape of the sampling grid cells, we must decide on the grid spacing. The grid spacing determines the number of sampling units in the study area, i.e., the sample size. There are two options to decide on this spacing, either starting from the available budget or from a requirement on the quality of the map. The latter is explained in Chapter <a href="MBgridspacing.html#MBgridspacing">22</a>, as this requires a model of the spatial variation, and as a consequence this is an example of model-based sampling. Starting from the available budget and an estimate of the costs per sampling unit, we first compute the affordable sample size. Then we may derive from this number the grid spacing. For square grids, the grid spacing in meters is calculated as <span class="math inline">\(\sqrt{A/n}\)</span>, where <span class="math inline">\(A\)</span> is the area in m<sup>2</sup> and <span class="math inline">\(n\)</span> is the number of sampling units (sample size).</p>
<p>Grids can be selected with function <code>spsample</code> of package <strong>sp</strong> <span class="citation">(<a href="#ref-Pebesma2005" role="doc-biblioref">E. J. Pebesma and Bivand 2005</a>)</span>. Argument <code>offset</code> is used to select a grid non-randomly. Either a sample size can be specified, using argument <code>n</code>, or a grid spacing, using argument <code>cellsize</code>. In the next code chunk, a square grid is selected with a spacing of 200 m.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="RegularGridSpatialCoverage.html#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb424-2"><a href="RegularGridSpatialCoverage.html#cb424-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gridded</span>(grdVoorst) <span class="ot">&lt;-</span> <span class="er">~</span> s1 <span class="sc">+</span> s2</span>
<span id="cb424-3"><a href="RegularGridSpatialCoverage.html#cb424-3" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> <span class="fu">spsample</span>(</span>
<span id="cb424-4"><a href="RegularGridSpatialCoverage.html#cb424-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> grdVoorst, <span class="at">type =</span> <span class="st">&quot;regular&quot;</span>, <span class="at">cellsize =</span> <span class="fu">c</span>(<span class="dv">200</span>, <span class="dv">200</span>),</span>
<span id="cb424-5"><a href="RegularGridSpatialCoverage.html#cb424-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">offset =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>)) <span class="sc">%&gt;%</span> <span class="fu">as</span>(<span class="st">&quot;data.frame&quot;</span>)</span></code></pre></div>
<p>Figure <a href="RegularGridSpatialCoverage.html#fig:gridVoorst">17.1</a> shows the selected square grid.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:gridVoorst"></span>
<img src="SpatialSampling_files/figure-html/gridVoorst-1.png" alt="Non-random square grid sample with a grid spacing of 200 m from Voorst." width="100%" />
<p class="caption">
Figure 17.1: Non-random square grid sample with a grid spacing of 200 m from Voorst.
</p>
</div>
<p>The number of grid points in this example equals 115. Nodes of the square grid in parts of the area not belonging to the population of interest, such as built-up areas and roads, are discarded by <code>spsample</code> (these nodes are not included in the sampling frame file <code>grdVoorst</code>). As a consequence, there are some undersampled areas, for instance in the middle of the study area where two roads cross. If we use the square grid in spatial interpolation, e.g., by ordinary kriging, we are more uncertain about the predictions in these undersampled areas than in areas where the grid is complete. The next section will show how this local undersampling can be avoided.</p>
<div id="exercises-22" class="section level4 unnumbered hasAnchor">
<h4>Exercises<a href="RegularGridSpatialCoverage.html#exercises-22" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>Write an <strong>R</strong> script to select a square grid of size 100 from West-Amhara in Ethiopia. Use <code>grdAmhara</code> of package <strong>sswr</strong> as a sampling frame. Use a fixed starting point of the grid, i.e., do not select the grid randomly.
<ul>
<li>Compute the number of selected grid points. How comes it is not exactly equal to 100?</li>
<li>Select a square grid with a spacing of 10.2 km, and compute the sample size.</li>
<li>Write a for-loop to select 200 times a square grid of, on average, 100 points with random starting point. Set a seed so that the result can be reproduced. Determine for each randomly selected grid the number of selected grid points, and save this in a numeric. Compute summary statistics of the sample size, and plot a histogram.</li>
<li>Select a square grid of exactly 100 points.</li>
</ul></li>
</ol>
</div>
</div>
<div id="SpatialCoverage" class="section level2 hasAnchor" number="17.2">
<h2><span class="header-section-number">17.2</span> Spatial coverage sampling<a href="RegularGridSpatialCoverage.html#SpatialCoverage" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Local undersampling with regular grids can be avoided by relaxing the constraint that the sampling units are restricted to the nodes of a regular grid. This is what is done in <em>spatial coverage sampling</em> or, in case of a sample that is added to an existing sample, in <em>spatial infill sampling</em>. Spatial coverage and infill samples cover the area or fill in the empty space as uniformly as possible. The sampling units are obtained by minimising a criterion that is defined in terms of the geographic distances between the nodes of a fine discretisation grid and the sampling units. <span class="citation">Brus, de Gruijter, and van Groenigen (<a href="#ref-bru07c" role="doc-biblioref">2007</a>)</span> proposed to minimise the mean of the squared distances of the grid nodes to their nearest sampling unit (mean squared shortest distance, MSSD):</p>
<p><span class="math display" id="eq:MSSD">\[\begin{equation}
MSSD=\frac{1}{N}\sum_{k=1}^{N}\min_{j}\left(D_{kj}^{2}\right) \;,
\tag{17.1}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(N\)</span> is the total number of nodes of the discretisation grid and <span class="math inline">\(D_{kj}\)</span> is the distance between the <span class="math inline">\(k\)</span>th grid node and the <span class="math inline">\(j\)</span>th sampling point. This distance measure can be minimised by the k-means algorithm, which is a numerical, iterative procedure. Figure <a href="RegularGridSpatialCoverage.html#fig:spatialcoveragesamplefromsquare">17.2</a> illustrates the selection of a spatial coverage sample of four points from a square. In this simple example the optimal spatial coverage sample is known, being the centres of the four subsquares of equal size. A simple random sample of four points serves as the initial solution. Each raster cell is then assigned to the closest sampling point. This is the initial clustering. In the next iteration, the centres of the initial clusters are computed. Next, the raster cells are reassigned to the closest new centres. This continues until there is no change anymore. In this case only nine iterations are needed, where an iteration consists of computing the clusters by assigning the raster cells to the nearest centre (sampling unit), followed by computing the centres of these clusters. Figure <a href="RegularGridSpatialCoverage.html#fig:spatialcoveragesamplefromsquare">17.2</a> shows the first, second, and ninth iterations.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:spatialcoveragesamplefromsquare"></span>
<img src="SpatialSampling_files/figure-html/spatialcoveragesamplefromsquare-1.png" alt="First, second, and ninth iterations of the k-means algorithm to select a spatial coverage sample of four points from a square. Iterations are in rows from top to bottom. In the left column of subfigures, the clusters are computed by assigning the raster cells to the nearest centre. In the right column of subfigures, the centres of the clusters are computed." width="47%" /><img src="SpatialSampling_files/figure-html/spatialcoveragesamplefromsquare-2.png" alt="First, second, and ninth iterations of the k-means algorithm to select a spatial coverage sample of four points from a square. Iterations are in rows from top to bottom. In the left column of subfigures, the clusters are computed by assigning the raster cells to the nearest centre. In the right column of subfigures, the centres of the clusters are computed." width="47%" /><img src="SpatialSampling_files/figure-html/spatialcoveragesamplefromsquare-3.png" alt="First, second, and ninth iterations of the k-means algorithm to select a spatial coverage sample of four points from a square. Iterations are in rows from top to bottom. In the left column of subfigures, the clusters are computed by assigning the raster cells to the nearest centre. In the right column of subfigures, the centres of the clusters are computed." width="47%" /><img src="SpatialSampling_files/figure-html/spatialcoveragesamplefromsquare-4.png" alt="First, second, and ninth iterations of the k-means algorithm to select a spatial coverage sample of four points from a square. Iterations are in rows from top to bottom. In the left column of subfigures, the clusters are computed by assigning the raster cells to the nearest centre. In the right column of subfigures, the centres of the clusters are computed." width="47%" /><img src="SpatialSampling_files/figure-html/spatialcoveragesamplefromsquare-5.png" alt="First, second, and ninth iterations of the k-means algorithm to select a spatial coverage sample of four points from a square. Iterations are in rows from top to bottom. In the left column of subfigures, the clusters are computed by assigning the raster cells to the nearest centre. In the right column of subfigures, the centres of the clusters are computed." width="47%" /><img src="SpatialSampling_files/figure-html/spatialcoveragesamplefromsquare-6.png" alt="First, second, and ninth iterations of the k-means algorithm to select a spatial coverage sample of four points from a square. Iterations are in rows from top to bottom. In the left column of subfigures, the clusters are computed by assigning the raster cells to the nearest centre. In the right column of subfigures, the centres of the clusters are computed." width="47%" />
<p class="caption">
Figure 17.2: First, second, and ninth iterations of the k-means algorithm to select a spatial coverage sample of four points from a square. Iterations are in rows from top to bottom. In the left column of subfigures, the clusters are computed by assigning the raster cells to the nearest centre. In the right column of subfigures, the centres of the clusters are computed.
</p>
</div>
<p>The same algorithm was used in Chapter <a href="STSI.html#STSI">4</a> to construct compact geographical strata (briefly referred to as geostrata) for stratified random sampling. The clusters serve as strata. In stratified random sampling, one or more sampling units are selected randomly from each geostratum. However, for mapping purposes probability sampling is not required, so the random selection of a unit within each stratum is not needed. With random selection, the spatial coverage is suboptimal. Here, the centres of the final clusters (geostrata) are used as sampling points. This improves the spatial coverage compared to stratified <em>random</em> sampling.</p>
<p>In probability sampling, we may want to have strata of equal area (clusters of equal size) so that the sampling design becomes self-weighting. For mapping, equally sized clusters are not recommended, as this may lead to samples with suboptimal spatial coverage.</p>

<div class="rmdnote">
In Figure <a href="RegularGridSpatialCoverage.html#fig:spatialcoveragesamplefromsquare">17.2</a> the clusters are of equal size, but this is an artefact. Equally sized clusters are not guaranteed by the illustrated k-means algorithm. Clustering the raster cells of a square into four clusters is a very special case. In other cases, the clusters computed with the k-means algorithm described above might have unequal sizes. In package <strong>spcosa</strong> also a different k-means algorithm is implemented, using swops, enforcing compact clusters of equal size.
</div>
<p>Spatial coverage samples can be computed with package <strong>spcosa</strong> <span class="citation">(<a href="#ref-walvoort2010" role="doc-biblioref">D. J. J. Walvoort, Brus, and Gruijter 2010</a>)</span>, using functions <code>stratify</code> and <code>spsample</code>, see code chunk below. Argument <code>nTry</code> of function <code>stratify</code> specifies the number of initial stratifications in k-means clustering. Note that function <code>spsample</code> of package <strong>spcosa</strong> without optional argument <code>n</code> selects non-randomly one point in each cluster, being the centre. Figure <a href="RegularGridSpatialCoverage.html#fig:spatcovVoorst">17.3</a> shows a spatial coverage sample of the same size as the regular grid in study area Voorst (Figure <a href="RegularGridSpatialCoverage.html#fig:gridVoorst">17.1</a>). Note that the undersampled area in the centre of the study area is now covered by a sampling point.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="RegularGridSpatialCoverage.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spcosa)</span>
<span id="cb425-2"><a href="RegularGridSpatialCoverage.html#cb425-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">115</span></span>
<span id="cb425-3"><a href="RegularGridSpatialCoverage.html#cb425-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb425-4"><a href="RegularGridSpatialCoverage.html#cb425-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gridded</span>(grdVoorst) <span class="ot">&lt;-</span> <span class="er">~</span> s1 <span class="sc">+</span> s2</span>
<span id="cb425-5"><a href="RegularGridSpatialCoverage.html#cb425-5" aria-hidden="true" tabindex="-1"></a>mystrata <span class="ot">&lt;-</span> spcosa<span class="sc">::</span><span class="fu">stratify</span>(</span>
<span id="cb425-6"><a href="RegularGridSpatialCoverage.html#cb425-6" aria-hidden="true" tabindex="-1"></a>  grdVoorst, <span class="at">nStrata =</span> n, <span class="at">equalArea =</span> <span class="cn">FALSE</span>, <span class="at">nTry =</span> <span class="dv">10</span>)</span>
<span id="cb425-7"><a href="RegularGridSpatialCoverage.html#cb425-7" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> <span class="fu">spsample</span>(mystrata) <span class="sc">%&gt;%</span> <span class="fu">as</span>(<span class="st">&quot;data.frame&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:spatcovVoorst"></span>
<img src="SpatialSampling_files/figure-html/spatcovVoorst-1.png" alt="Spatial coverage sample from Voorst." width="100%" />
<p class="caption">
Figure 17.3: Spatial coverage sample from Voorst.
</p>
</div>
<p>If the clusters need not be of equal size, we may also use function <code>kmeans</code> of the <strong>stats</strong> package, using the spatial coordinates as clustering variables. This requires less computing time, especially with large data sets.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="RegularGridSpatialCoverage.html#cb426-1" aria-hidden="true" tabindex="-1"></a>grdVoorst <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(grdVoorst)</span>
<span id="cb426-2"><a href="RegularGridSpatialCoverage.html#cb426-2" aria-hidden="true" tabindex="-1"></a>mystrata_kmeans <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(</span>
<span id="cb426-3"><a href="RegularGridSpatialCoverage.html#cb426-3" aria-hidden="true" tabindex="-1"></a>  grdVoorst[, <span class="fu">c</span>(<span class="st">&quot;s1&quot;</span>, <span class="st">&quot;s2&quot;</span>)], <span class="at">centers =</span> n, <span class="at">iter.max =</span> <span class="dv">10000</span>, <span class="at">nstart =</span> <span class="dv">10</span>)</span>
<span id="cb426-4"><a href="RegularGridSpatialCoverage.html#cb426-4" aria-hidden="true" tabindex="-1"></a>mysample_kmeans <span class="ot">&lt;-</span> mystrata_kmeans<span class="sc">$</span>centers <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span></code></pre></div>
<p>When function <code>kmeans</code> is used to compute the spatial coverage sample, there is no guarantee that the computed centres of the clusters, used as sampling points, are inside the study area. In Figure <a href="RegularGridSpatialCoverage.html#fig:kmeanscenters">17.4</a> there are eight such centres.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:kmeanscenters"></span>
<img src="SpatialSampling_files/figure-html/kmeanscenters-1.png" alt="Centres of spatial clusters computed with function kmeans." width="100%" />
<p class="caption">
Figure 17.4: Centres of spatial clusters computed with function <code>kmeans</code>.
</p>
</div>
<p>This problem can easily be solved by selecting points inside the study area closest to the centres that are outside the study area. Function <code>rdist</code> of package <strong>fields</strong> is used to compute a matrix with distances between the centres outside the study area and the nodes of the discretisation grid. Then function <code>apply</code> is used with argument <code>FUN = which.min</code> to compute the discretisation nodes closest to the centres outside the study area. A similar procedure is implemented in function <code>spsample</code> of package <strong>spcosa</strong> when the centres of the clusters are selected as sampling points (so, when argument <code>n</code> of function <code>spsample</code> is not used).</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="RegularGridSpatialCoverage.html#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fields)</span>
<span id="cb427-2"><a href="RegularGridSpatialCoverage.html#cb427-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gridded</span>(grdVoorst) <span class="ot">&lt;-</span> <span class="er">~</span> s1 <span class="sc">+</span> s2</span>
<span id="cb427-3"><a href="RegularGridSpatialCoverage.html#cb427-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(mysample_kmeans) <span class="ot">&lt;-</span> <span class="er">~</span> s1 <span class="sc">+</span> s2</span>
<span id="cb427-4"><a href="RegularGridSpatialCoverage.html#cb427-4" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">over</span>(mysample_kmeans, grdVoorst)</span>
<span id="cb427-5"><a href="RegularGridSpatialCoverage.html#cb427-5" aria-hidden="true" tabindex="-1"></a>inside <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="sc">!</span><span class="fu">is.na</span>(res<span class="sc">$</span>z))</span>
<span id="cb427-6"><a href="RegularGridSpatialCoverage.html#cb427-6" aria-hidden="true" tabindex="-1"></a>units_out <span class="ot">&lt;-</span> <span class="fu">which</span>(inside <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb427-7"><a href="RegularGridSpatialCoverage.html#cb427-7" aria-hidden="true" tabindex="-1"></a>grdVoorst <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(grdVoorst)</span>
<span id="cb427-8"><a href="RegularGridSpatialCoverage.html#cb427-8" aria-hidden="true" tabindex="-1"></a>mysample_kmeans <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mysample_kmeans)</span>
<span id="cb427-9"><a href="RegularGridSpatialCoverage.html#cb427-9" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> fields<span class="sc">::</span><span class="fu">rdist</span>(<span class="at">x1 =</span> mysample_kmeans[units_out, ],</span>
<span id="cb427-10"><a href="RegularGridSpatialCoverage.html#cb427-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x2 =</span> grdVoorst[, <span class="fu">c</span>(<span class="st">&quot;s1&quot;</span>, <span class="st">&quot;s2&quot;</span>)])</span>
<span id="cb427-11"><a href="RegularGridSpatialCoverage.html#cb427-11" aria-hidden="true" tabindex="-1"></a>units_close <span class="ot">&lt;-</span> <span class="fu">apply</span>(D, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> which.min)</span>
<span id="cb427-12"><a href="RegularGridSpatialCoverage.html#cb427-12" aria-hidden="true" tabindex="-1"></a>mysample_kmeans[units_out, ] <span class="ot">&lt;-</span> grdVoorst[units_close, <span class="fu">c</span>(<span class="st">&quot;s1&quot;</span>, <span class="st">&quot;s2&quot;</span>)]</span></code></pre></div>
<div id="exercises-23" class="section level4 unnumbered hasAnchor">
<h4>Exercises<a href="RegularGridSpatialCoverage.html#exercises-23" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol start="2" style="list-style-type: decimal">
<li>In forestry and vegetation surveys, square and circular plots are often used as sampling units, for instance, 2 m squares or circles with a diameter of 2 m. To study the relation between the vegetation and the soil, soil samples must be collected from the vegetation plots. Suppose we want to collect four soil samples from a square plot. Where would you locate the four sampling points, so that they optimally cover the plot?<br />
</li>
<li>Suppose we are also interested in the accuracy of the estimated plot means of the soil properties, not just the means. In that case, the soil samples should not be bulked into a composite sample, but analysed separately. How would you select the sampling points in this case?<br />
</li>
<li>For circular vegetation plots, it is less clear where the sampling points with smallest MSSD are (Equation <a href="RegularGridSpatialCoverage.html#eq:MSSD">(17.1)</a>). Write an <strong>R</strong> script to compute a spatial coverage sample of five points from a circular plot discretised by the nodes of a fine square grid. Use argument <code>equalArea = FALSE</code>. Check the size (number of raster cells) of the strata. Repeat this for six sampling points.<br />
</li>
<li>Consider the case of six strata. The strata are not of equal size. If the soil samples are bulked into a composite sample, the measurement on this single sample is a biased estimator of the plot mean. How can this bias be avoided?</li>
</ol>
</div>
</div>
<div id="SpatialInfill" class="section level2 hasAnchor" number="17.3">
<h2><span class="header-section-number">17.3</span> Spatial infill sampling<a href="RegularGridSpatialCoverage.html#SpatialInfill" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If georeferenced data are available that can be used for mapping the study variable, but we need more data for mapping, it is attractive to account for these existing sampling units when selecting the additional units. The aim now is to fill in the empty spaces, i.e., the parts of the study area not covered by the existing sampling units. This is referred to as <em>spatial infill sampling</em>. Existing sampling units can easily be accommodated in the k-means algorithm, using them as fixed cluster centres.</p>
<p>Figure <a href="RegularGridSpatialCoverage.html#fig:spatialinfillEthiopia">17.5</a> shows a spatial infill sample for West-Amhara. A large set of legacy data on soil organic matter (SOM) in mass percentage (dag kg<sup>-1</sup>) is available, but these data come from strongly spatially clustered units along roads (prior points in Figure <a href="RegularGridSpatialCoverage.html#fig:spatialinfillEthiopia">17.5</a>). This is a nice example of a convenience sample. The legacy data are not ideal for mapping the SOM concentration throughout West-Amhara. Clearly, it is desirable to collect additional data in the off-road parts of the study area, with the exception of the northeastern part where we have already quite a few data that are not near the main roads. The legacy data are passed to function <code>stratify</code> of package <strong>spcosa</strong> with argument <code>priorPoints</code>. The object assigned to this argument must be of class <code>SpatialPoints</code> or <code>SpatialPointsDataFrame</code>. This optional argument fixes these points as cluster centres. A spatial infill sample of 100 points is selected, taking into account these fixed points.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="RegularGridSpatialCoverage.html#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gridded</span>(grdAmhara) <span class="ot">&lt;-</span> <span class="er">~</span> s1 <span class="sc">+</span> s2</span>
<span id="cb428-2"><a href="RegularGridSpatialCoverage.html#cb428-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb428-3"><a href="RegularGridSpatialCoverage.html#cb428-3" aria-hidden="true" tabindex="-1"></a>ntot <span class="ot">&lt;-</span> n <span class="sc">+</span> <span class="fu">nrow</span>(sampleAmhara)</span>
<span id="cb428-4"><a href="RegularGridSpatialCoverage.html#cb428-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(sampleAmhara) <span class="ot">&lt;-</span> <span class="er">~</span> s1 <span class="sc">+</span> s2</span>
<span id="cb428-5"><a href="RegularGridSpatialCoverage.html#cb428-5" aria-hidden="true" tabindex="-1"></a><span class="fu">proj4string</span>(sampleAmhara) <span class="ot">&lt;-</span> <span class="cn">NA_character_</span></span>
<span id="cb428-6"><a href="RegularGridSpatialCoverage.html#cb428-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb428-7"><a href="RegularGridSpatialCoverage.html#cb428-7" aria-hidden="true" tabindex="-1"></a>mystrata <span class="ot">&lt;-</span> spcosa<span class="sc">::</span><span class="fu">stratify</span>(grdAmhara, <span class="at">nStrata =</span> ntot,</span>
<span id="cb428-8"><a href="RegularGridSpatialCoverage.html#cb428-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">priorPoints =</span> sampleAmhara, <span class="at">nTry =</span> <span class="dv">10</span>)</span>
<span id="cb428-9"><a href="RegularGridSpatialCoverage.html#cb428-9" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> <span class="fu">spsample</span>(mystrata)</span>
<span id="cb428-10"><a href="RegularGridSpatialCoverage.html#cb428-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mystrata, mysample)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:spatialinfillEthiopia"></span>
<img src="SpatialSampling_files/figure-html/spatialinfillEthiopia-1.png" alt="Spatial infill sample of 100 points from West-Amhara." width="100%" />
<p class="caption">
Figure 17.5: Spatial infill sample of 100 points from West-Amhara.
</p>
</div>
<p>In the output object of <code>spsample</code>, both the prior and the new sampling points are included. The new points can be obtained as follows:</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="RegularGridSpatialCoverage.html#cb429-1" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">which</span>(mysample<span class="sc">@</span>isPriorPoint <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb429-2"><a href="RegularGridSpatialCoverage.html#cb429-2" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> <span class="fu">as</span>(mysample, <span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb429-3"><a href="RegularGridSpatialCoverage.html#cb429-3" aria-hidden="true" tabindex="-1"></a>mysample_new <span class="ot">&lt;-</span> mysample[units, ]</span></code></pre></div>
<div id="exercises-24" class="section level4 unnumbered hasAnchor">
<h4>Exercises<a href="RegularGridSpatialCoverage.html#exercises-24" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol start="6" style="list-style-type: decimal">
<li>Write an <strong>R</strong> script to select a spatial infill sample of size 100 from study area Xuancheng in China. Use the iPSM sample in tibble <code>sampleXuancheng</code> of package <strong>sswr</strong> as a legacy sample. To map the SOM concentration, we want to measure the SOM concentration at 100 more sampling points.
<ul>
<li>Read the file <code>data/Elevation_Xuancheng.rds</code> with function <code>rast</code> of package <strong>terra</strong>, and use this file as a discretisation of the study area.</li>
<li>For computational reasons, there are far too many raster cells. That many cells are not needed to select a spatial infill sample. Subsample the raster file by selecting a square grid with a spacing of 900 m <span class="math inline">\(\times\)</span> 900 m. First, convert the <code>SpatRaster</code> object to a <code>data.frame</code>, and then change it to a <code>SpatialPixelsDataFrame</code> using function <code>gridded</code>. Then use function <code>spsample</code> with argument <code>type = "regular"</code>.</li>
<li>Select a spatial infill sample using functions <code>stratify</code> and <code>sample</code> of package <strong>spcosa</strong>.</li>
</ul></li>
</ol>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bru07c" class="csl-entry">
Brus, D. J., J. J. de Gruijter, and J. W. van Groenigen. 2007. <span>“<span class="nocase">Designing Spatial Coverage Samples Using the k-means Clustering Algorithm</span>.”</span> In <em><span>Digital Soil Mapping. An Introductory Perspective</span></em>, edited by P. Lagacherie, A. B. McBratney, and M. Voltz, 183–92. Elsevier.
</div>
<div id="ref-Pebesma2005" class="csl-entry">
Pebesma, E. J., and R. S. Bivand. 2005. <span>“<span class="nocase">Classes and methods for spatial data in R</span>.”</span> <em>R News</em> 5 (2): 9–13. <a href="http://cran.r-project.org/doc/Rnews/">http://cran.r-project.org/doc/Rnews/</a>.
</div>
<div id="ref-walvoort2010" class="csl-entry">
Walvoort, D. J. J., D. J. Brus, and J. J. de Gruijter. 2010. <span>“An <span>R</span> Package for Spatial Coverage Sampling and Random Sampling from Compact Geographical Strata by k-Means.”</span> <em>Computers &amp; Geosciences</em> 36 (10): 1261–67. <a href="https://doi.org/10.1016/j.cageo.2010.04.005">https://doi.org/10.1016/j.cageo.2010.04.005</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="IntroSamplingforMapping.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="kmeans.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/DickBrus/SpatialSamplingwithR/edit/master/22-RegularGrid-SpatialCoverage.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SpatialSampling.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
