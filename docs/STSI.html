<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Stratified simple random sampling | Spatial sampling with R</title>
  <meta name="description" content="Chapter 4 Stratified simple random sampling | Spatial sampling with R" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Stratified simple random sampling | Spatial sampling with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/cover.png" />
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Stratified simple random sampling | Spatial sampling with R" />
  
  
  <meta name="twitter:image" content="/cover.png" />

<meta name="author" content="Dick J. Brus" />


<meta name="date" content="2021-08-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="SI.html"/>
<link rel="next" href="SY.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial sampling with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="GeneralIntro.html"><a href="GeneralIntro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="GeneralIntro.html"><a href="GeneralIntro.html#BasicConcepts"><i class="fa fa-check"></i><b>1.1</b> Basic sampling concepts</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="GeneralIntro.html"><a href="GeneralIntro.html#PopulationParameters"><i class="fa fa-check"></i><b>1.1.1</b> Population parameters</a></li>
<li class="chapter" data-level="1.1.2" data-path="GeneralIntro.html"><a href="GeneralIntro.html#descriptive-statistics-versus-inference-about-a-population"><i class="fa fa-check"></i><b>1.1.2</b> Descriptive statistics versus inference about a population</a></li>
<li class="chapter" data-level="1.1.3" data-path="GeneralIntro.html"><a href="GeneralIntro.html#random-sampling-versus-probability-sampling"><i class="fa fa-check"></i><b>1.1.3</b> Random sampling versus probability sampling</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="GeneralIntro.html"><a href="GeneralIntro.html#DBvsMB"><i class="fa fa-check"></i><b>1.2</b> Design-based versus model-based approach</a></li>
<li class="chapter" data-level="1.3" data-path="GeneralIntro.html"><a href="GeneralIntro.html#Datasets"><i class="fa fa-check"></i><b>1.3</b> Populations used in sampling experiments</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="GeneralIntro.html"><a href="GeneralIntro.html#Voorst"><i class="fa fa-check"></i><b>1.3.1</b> Soil organic matter in Voorst (Netherlands)</a></li>
<li class="chapter" data-level="1.3.2" data-path="GeneralIntro.html"><a href="GeneralIntro.html#Poppy"><i class="fa fa-check"></i><b>1.3.2</b> Poppy fields in Kandahar (Afghanistan)</a></li>
<li class="chapter" data-level="1.3.3" data-path="GeneralIntro.html"><a href="GeneralIntro.html#aboveground-biomass-in-eastern-amazonia"><i class="fa fa-check"></i><b>1.3.3</b> Aboveground biomass in Eastern Amazonia</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Probability sampling for estimating (sub)population parameters</b></span></li>
<li class="chapter" data-level="2" data-path="IntroProbabilitySampling.html"><a href="IntroProbabilitySampling.html"><i class="fa fa-check"></i><b>2</b> Introduction to probability sampling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="IntroProbabilitySampling.html"><a href="IntroProbabilitySampling.html#HTestimator"><i class="fa fa-check"></i><b>2.1</b> Horvitz-Thompson estimator</a></li>
<li class="chapter" data-level="2.2" data-path="IntroProbabilitySampling.html"><a href="IntroProbabilitySampling.html#hansen-hurwitz-estimator"><i class="fa fa-check"></i><b>2.2</b> Hansen-Hurwitz estimator</a></li>
<li class="chapter" data-level="2.3" data-path="IntroProbabilitySampling.html"><a href="IntroProbabilitySampling.html#using-models-in-design-based-approach"><i class="fa fa-check"></i><b>2.3</b> Using models in design-based approach</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="SI.html"><a href="SI.html"><i class="fa fa-check"></i><b>3</b> Simple random sampling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="SI.html"><a href="SI.html#HTestimatorSI"><i class="fa fa-check"></i><b>3.1</b> Estimation of population parameters</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="SI.html"><a href="SI.html#PopProportion"><i class="fa fa-check"></i><b>3.1.1</b> Population proportion</a></li>
<li class="chapter" data-level="3.1.2" data-path="SI.html"><a href="SI.html#CDF"><i class="fa fa-check"></i><b>3.1.2</b> Cumulative distribution function and quantiles</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="SI.html"><a href="SI.html#VarMeanSI"><i class="fa fa-check"></i><b>3.2</b> Sampling variance of estimator of population mean, total and proportion</a></li>
<li class="chapter" data-level="3.3" data-path="SI.html"><a href="SI.html#SIcircularplots"><i class="fa fa-check"></i><b>3.3</b> Simple random sampling of circular plots</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="SI.html"><a href="SI.html#sampling-from-a-finite-set-of-fixed-circles"><i class="fa fa-check"></i><b>3.3.1</b> Sampling from a finite set of fixed circles</a></li>
<li class="chapter" data-level="3.3.2" data-path="SI.html"><a href="SI.html#sampling-from-an-infinite-set-of-floating-circles"><i class="fa fa-check"></i><b>3.3.2</b> Sampling from an infinite set of floating circles</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="SI.html"><a href="SI.html#ConfidenceInterval"><i class="fa fa-check"></i><b>3.4</b> Confidence interval estimates</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="SI.html"><a href="SI.html#ConfidenceIntervalProportion"><i class="fa fa-check"></i><b>3.4.1</b> Confidence interval for proportion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="STSI.html"><a href="STSI.html"><i class="fa fa-check"></i><b>4</b> Stratified simple random sampling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="STSI.html"><a href="STSI.html#EstimatorsSTSI"><i class="fa fa-check"></i><b>4.1</b> Estimation of population parameters</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="STSI.html"><a href="STSI.html#estimation-of-population-proportion-cumulative-distribution-function-and-quantiles"><i class="fa fa-check"></i><b>4.1.1</b> Estimation of population proportion, cumulative distribution function and quantiles</a></li>
<li class="chapter" data-level="4.1.2" data-path="STSI.html"><a href="STSI.html#WhyStratify"><i class="fa fa-check"></i><b>4.1.2</b> Why should we stratify?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="STSI.html"><a href="STSI.html#CISTSI"><i class="fa fa-check"></i><b>4.2</b> Confidence interval estimate</a></li>
<li class="chapter" data-level="4.3" data-path="STSI.html"><a href="STSI.html#STSIallocation"><i class="fa fa-check"></i><b>4.3</b> Allocation of sample size to strata</a></li>
<li class="chapter" data-level="4.4" data-path="STSI.html"><a href="STSI.html#cumrootf"><i class="fa fa-check"></i><b>4.4</b> <em>Cum-root-f</em> stratification</a></li>
<li class="chapter" data-level="4.5" data-path="STSI.html"><a href="STSI.html#kmeansstratification"><i class="fa fa-check"></i><b>4.5</b> Stratification with multiple covariates</a></li>
<li class="chapter" data-level="4.6" data-path="STSI.html"><a href="STSI.html#geostrata"><i class="fa fa-check"></i><b>4.6</b> Geographical stratification</a></li>
<li class="chapter" data-level="4.7" data-path="STSI.html"><a href="STSI.html#multi-way-stratification"><i class="fa fa-check"></i><b>4.7</b> Multi-way stratification</a></li>
<li class="chapter" data-level="4.8" data-path="STSI.html"><a href="STSI.html#MultivariateStratification"><i class="fa fa-check"></i><b>4.8</b> Multivariate stratification</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="SY.html"><a href="SY.html"><i class="fa fa-check"></i><b>5</b> Systematic random sampling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="SY.html"><a href="SY.html#EstVarSY"><i class="fa fa-check"></i><b>5.1</b> Estimation of population parameters</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="SY.html"><a href="SY.html#approximating-the-sampling-variance-of-the-estimator-of-the-mean"><i class="fa fa-check"></i><b>5.1.1</b> Approximating the sampling variance of the estimator of the mean</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Cl.html"><a href="Cl.html"><i class="fa fa-check"></i><b>6</b> Cluster random sampling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="Cl.html"><a href="Cl.html#clustersamplingestimators"><i class="fa fa-check"></i><b>6.1</b> Estimation of population parameters</a></li>
<li class="chapter" data-level="6.2" data-path="Cl.html"><a href="Cl.html#clusters-selected-with-probabilities-proportional-to-size-without-replacement"><i class="fa fa-check"></i><b>6.2</b> Clusters selected with probabilities proportional to size, without replacement</a></li>
<li class="chapter" data-level="6.3" data-path="Cl.html"><a href="Cl.html#simple-random-sampling-of-clusters"><i class="fa fa-check"></i><b>6.3</b> Simple random sampling of clusters</a></li>
<li class="chapter" data-level="6.4" data-path="Cl.html"><a href="Cl.html#StratifiedCl"><i class="fa fa-check"></i><b>6.4</b> Stratified cluster random sampling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Twostage.html"><a href="Twostage.html"><i class="fa fa-check"></i><b>7</b> Two-stage cluster random sampling</a>
<ul>
<li class="chapter" data-level="7.1" data-path="Twostage.html"><a href="Twostage.html#twostagesamplingestimators"><i class="fa fa-check"></i><b>7.1</b> Estimation of population parameters</a></li>
<li class="chapter" data-level="7.2" data-path="Twostage.html"><a href="Twostage.html#primary-sampling-units-selected-with-probabilities-proportional-to-size-without-replacement"><i class="fa fa-check"></i><b>7.2</b> Primary sampling units selected with probabilities proportional to size, without replacement</a></li>
<li class="chapter" data-level="7.3" data-path="Twostage.html"><a href="Twostage.html#simple-random-sampling-of-primary-sampling-units"><i class="fa fa-check"></i><b>7.3</b> Simple random sampling of primary sampling units</a></li>
<li class="chapter" data-level="7.4" data-path="Twostage.html"><a href="Twostage.html#StratifiedTwostage"><i class="fa fa-check"></i><b>7.4</b> Stratified two-stage cluster random sampling</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="pps.html"><a href="pps.html"><i class="fa fa-check"></i><b>8</b> Sampling with probabilities proportional to size</a>
<ul>
<li class="chapter" data-level="8.1" data-path="pps.html"><a href="pps.html#ppswr"><i class="fa fa-check"></i><b>8.1</b> Probability-proportional-to-size sampling with replacement</a></li>
<li class="chapter" data-level="8.2" data-path="pps.html"><a href="pps.html#ppswor"><i class="fa fa-check"></i><b>8.2</b> Probability-proportional-to-size sampling without replacement</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="pps.html"><a href="pps.html#Systematicpps"><i class="fa fa-check"></i><b>8.2.1</b> Systematic pps sampling without replacement</a></li>
<li class="chapter" data-level="8.2.2" data-path="pps.html"><a href="pps.html#pivotalmethod"><i class="fa fa-check"></i><b>8.2.2</b> The pivotal method</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html"><i class="fa fa-check"></i><b>9</b> Balanced and well-spread sampling</a>
<ul>
<li class="chapter" data-level="9.1" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#Balanced"><i class="fa fa-check"></i><b>9.1</b> Balanced sampling</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#balanced-sample-versus-balanced-sampling-design"><i class="fa fa-check"></i><b>9.1.1</b> Balanced sample versus balanced sampling design</a></li>
<li class="chapter" data-level="9.1.2" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#unequal-inclusion-probabilities"><i class="fa fa-check"></i><b>9.1.2</b> Unequal inclusion probabilities</a></li>
<li class="chapter" data-level="9.1.3" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#StratifiedsamplingasBalancedsampling"><i class="fa fa-check"></i><b>9.1.3</b> Stratified random sampling</a></li>
<li class="chapter" data-level="9.1.4" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#Multiwaystratification"><i class="fa fa-check"></i><b>9.1.4</b> Multi-way stratification</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#Spreaded"><i class="fa fa-check"></i><b>9.2</b> Well-spread sampling</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#LPM"><i class="fa fa-check"></i><b>9.2.1</b> Local pivotal method</a></li>
<li class="chapter" data-level="9.2.2" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#GRTS"><i class="fa fa-check"></i><b>9.2.2</b> Generalised random-tessellation stratified sampling</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#BalancedandSpreaded"><i class="fa fa-check"></i><b>9.3</b> Balanced sampling with spreading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Modelassisted.html"><a href="Modelassisted.html"><i class="fa fa-check"></i><b>10</b> Model-assisted estimation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="Modelassisted.html"><a href="Modelassisted.html#GREG"><i class="fa fa-check"></i><b>10.1</b> Generalized regression estimator</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="Modelassisted.html"><a href="Modelassisted.html#RegressionEstimator"><i class="fa fa-check"></i><b>10.1.1</b> Simple and multiple regression estimators</a></li>
<li class="chapter" data-level="10.1.2" data-path="Modelassisted.html"><a href="Modelassisted.html#penalised-least-squares-estimation"><i class="fa fa-check"></i><b>10.1.2</b> Penalised least squares estimation</a></li>
<li class="chapter" data-level="10.1.3" data-path="Modelassisted.html"><a href="Modelassisted.html#RegressionEstimatorSTSI"><i class="fa fa-check"></i><b>10.1.3</b> Regression estimator with stratified simple random sampling</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="Modelassisted.html"><a href="Modelassisted.html#RatioEstimator"><i class="fa fa-check"></i><b>10.2</b> Ratio estimator</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="Modelassisted.html"><a href="Modelassisted.html#RatioEstimatorSTSI"><i class="fa fa-check"></i><b>10.2.1</b> Ratio estimators with stratified simple random sampling</a></li>
<li class="chapter" data-level="10.2.2" data-path="Modelassisted.html"><a href="Modelassisted.html#PoststratifiedEstimator"><i class="fa fa-check"></i><b>10.2.2</b> Poststratified estimator</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="Modelassisted.html"><a href="Modelassisted.html#RandomForest"><i class="fa fa-check"></i><b>10.3</b> Model-assisted estimation using machine learning techniques</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="Modelassisted.html"><a href="Modelassisted.html#predicting-with-a-regression-tree"><i class="fa fa-check"></i><b>10.3.1</b> Predicting with a regression tree</a></li>
<li class="chapter" data-level="10.3.2" data-path="Modelassisted.html"><a href="Modelassisted.html#predicting-with-a-random-forest"><i class="fa fa-check"></i><b>10.3.2</b> Predicting with a random forest</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="Modelassisted.html"><a href="Modelassisted.html#big-data-and-volunteer-data"><i class="fa fa-check"></i><b>10.4</b> Big data and volunteer data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Twophase.html"><a href="Twophase.html"><i class="fa fa-check"></i><b>11</b> Two-phase random sampling</a>
<ul>
<li class="chapter" data-level="11.1" data-path="Twophase.html"><a href="Twophase.html#TwophaseStratification"><i class="fa fa-check"></i><b>11.1</b> Two-phase random sampling for stratification</a></li>
<li class="chapter" data-level="11.2" data-path="Twophase.html"><a href="Twophase.html#TwophaseRegression"><i class="fa fa-check"></i><b>11.2</b> Two-phase random sampling for regression</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html"><i class="fa fa-check"></i><b>12</b> Computing the required sample size</a>
<ul>
<li class="chapter" data-level="12.1" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#standard-error-of-estimator"><i class="fa fa-check"></i><b>12.1</b> Standard error of estimator</a></li>
<li class="chapter" data-level="12.2" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#ReqSampleSizeLengthCI"><i class="fa fa-check"></i><b>12.2</b> Length of confidence interval</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#length-of-confidence-interval-for-a-proportion"><i class="fa fa-check"></i><b>12.2.1</b> Length of confidence interval for a proportion</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#statistical-testing-of-hypothesis"><i class="fa fa-check"></i><b>12.3</b> Statistical testing of hypothesis</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#sample-size-for-testing-a-proportion"><i class="fa fa-check"></i><b>12.3.1</b> Sample size for testing a proportion</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#DesignEffect"><i class="fa fa-check"></i><b>12.4</b> Accounting for design effect</a></li>
<li class="chapter" data-level="12.5" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#BayesianSampleSize"><i class="fa fa-check"></i><b>12.5</b> Bayesian sample size determination</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#bayesian-criteria-for-sample-size-computation"><i class="fa fa-check"></i><b>12.5.1</b> Bayesian criteria for sample size computation</a></li>
<li class="chapter" data-level="12.5.2" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#mixed-bayesian-likelihood-approach"><i class="fa fa-check"></i><b>12.5.2</b> Mixed Bayesian-likelihood approach</a></li>
<li class="chapter" data-level="12.5.3" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#estimation-of-population-mean"><i class="fa fa-check"></i><b>12.5.3</b> Estimation of population mean</a></li>
<li class="chapter" data-level="12.5.4" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#estimation-of-a-population-proportion"><i class="fa fa-check"></i><b>12.5.4</b> Estimation of a population proportion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html"><i class="fa fa-check"></i><b>13</b> Model-based optimisation of probability sampling designs</a>
<ul>
<li class="chapter" data-level="13.1" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#model-based-optimisation-of-sampling-design-type-and-sample-size"><i class="fa fa-check"></i><b>13.1</b> Model-based optimisation of sampling design type and sample size</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#AnalyticalApproach"><i class="fa fa-check"></i><b>13.1.1</b> Analytical approach</a></li>
<li class="chapter" data-level="13.1.2" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#GeostatisticalSimulationApproach"><i class="fa fa-check"></i><b>13.1.2</b> Geostatistical simulation approach</a></li>
<li class="chapter" data-level="13.1.3" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#MBpredSamplingVarBayes"><i class="fa fa-check"></i><b>13.1.3</b> Bayesian approach</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#Ospats"><i class="fa fa-check"></i><b>13.2</b> Model-based optimisation of spatial strata</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html"><i class="fa fa-check"></i><b>14</b> Sampling for estimating parameters of (small) domains</a>
<ul>
<li class="chapter" data-level="14.1" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#LargeDomainsDirectEstimator"><i class="fa fa-check"></i><b>14.1</b> Direct estimator for large domains</a></li>
<li class="chapter" data-level="14.2" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#SmallDomainsModelAssisted"><i class="fa fa-check"></i><b>14.2</b> Model-assisted estimators for small domains</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#RegressionestimatorSmallDomain"><i class="fa fa-check"></i><b>14.2.1</b> Regression estimator</a></li>
<li class="chapter" data-level="14.2.2" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#synthetic-estimator"><i class="fa fa-check"></i><b>14.2.2</b> Synthetic estimator</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#SmallAreaModelBased"><i class="fa fa-check"></i><b>14.3</b> Model-based prediction</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#random-intercept-model"><i class="fa fa-check"></i><b>14.3.1</b> Random intercept model</a></li>
<li class="chapter" data-level="14.3.2" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#geostatistical-model"><i class="fa fa-check"></i><b>14.3.2</b> Geostatistical model</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#supplemental-probability-sampling-of-small-domains"><i class="fa fa-check"></i><b>14.4</b> Supplemental probability sampling of small domains</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html"><i class="fa fa-check"></i><b>15</b> Repeated sample surveys for monitoring population parameters</a>
<ul>
<li class="chapter" data-level="15.1" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#space-time-designs"><i class="fa fa-check"></i><b>15.1</b> Space-time designs</a></li>
<li class="chapter" data-level="15.2" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#space-time-population-parameters"><i class="fa fa-check"></i><b>15.2</b> Space-time population parameters</a></li>
</ul></li>
<li class="part"><span><b>II Sampling for mapping</b></span></li>
<li class="chapter" data-level="16" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html"><i class="fa fa-check"></i><b>16</b> Introduction to sampling for mapping</a>
<ul>
<li class="chapter" data-level="16.1" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html#when-is-probability-sampling-not-required"><i class="fa fa-check"></i><b>16.1</b> When is probability sampling not required?</a></li>
<li class="chapter" data-level="16.2" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html#sampling-for-simultaneously-mapping-and-estimating-means"><i class="fa fa-check"></i><b>16.2</b> Sampling for simultaneously mapping and estimating means</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html#balanced-stratified-random-sampling"><i class="fa fa-check"></i><b>16.2.1</b> Balanced stratified random sampling</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html#broad-overview-of-sampling-designs-for-mapping"><i class="fa fa-check"></i><b>16.3</b> Broad overview of sampling designs for mapping</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="Regulargrid.html"><a href="Regulargrid.html"><i class="fa fa-check"></i><b>17</b> Sampling on a regular grid</a></li>
<li class="chapter" data-level="18" data-path="SpatialCoverage.html"><a href="SpatialCoverage.html"><i class="fa fa-check"></i><b>18</b> Spatial coverage sampling</a>
<ul>
<li class="chapter" data-level="18.1" data-path="SpatialCoverage.html"><a href="SpatialCoverage.html#SpatialInfill"><i class="fa fa-check"></i><b>18.1</b> Spatial infill sampling</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="kmeans.html"><a href="kmeans.html"><i class="fa fa-check"></i><b>19</b> Covariate space coverage sampling</a>
<ul>
<li class="chapter" data-level="19.1" data-path="kmeans.html"><a href="kmeans.html#covariate-space-infill-sampling"><i class="fa fa-check"></i><b>19.1</b> Covariate space infill sampling</a></li>
<li class="chapter" data-level="19.2" data-path="kmeans.html"><a href="kmeans.html#performance-of-covariate-space-coverage-sampling-in-random-forest-prediction"><i class="fa fa-check"></i><b>19.2</b> Performance of covariate space coverage sampling in random forest prediction</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="cLHS.html"><a href="cLHS.html"><i class="fa fa-check"></i><b>20</b> Conditioned Latin hypercube sampling</a>
<ul>
<li class="chapter" data-level="20.1" data-path="cLHS.html"><a href="cLHS.html#cLHIS"><i class="fa fa-check"></i><b>20.1</b> Conditioned Latin hypercube infill sampling</a></li>
<li class="chapter" data-level="20.2" data-path="cLHS.html"><a href="cLHS.html#performance-of-conditioned-latin-hypercube-sampling-in-random-forest-prediction"><i class="fa fa-check"></i><b>20.2</b> Performance of conditioned Latin hypercube sampling in random forest prediction</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="SpatialResponseSurface.html"><a href="SpatialResponseSurface.html"><i class="fa fa-check"></i><b>21</b> Spatial response surface sampling</a>
<ul>
<li class="chapter" data-level="21.1" data-path="SpatialResponseSurface.html"><a href="SpatialResponseSurface.html#IncreaseSampleSize"><i class="fa fa-check"></i><b>21.1</b> Increasing the sample size</a></li>
<li class="chapter" data-level="21.2" data-path="SpatialResponseSurface.html"><a href="SpatialResponseSurface.html#stratified-spatial-response-surface-sampling"><i class="fa fa-check"></i><b>21.2</b> Stratified spatial response surface sampling</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="Introkriging.html"><a href="Introkriging.html"><i class="fa fa-check"></i><b>22</b> Introduction to kriging</a>
<ul>
<li class="chapter" data-level="22.1" data-path="Introkriging.html"><a href="Introkriging.html#BlockKriging"><i class="fa fa-check"></i><b>22.1</b> Block-kriging</a></li>
<li class="chapter" data-level="22.2" data-path="Introkriging.html"><a href="Introkriging.html#IntroKED"><i class="fa fa-check"></i><b>22.2</b> Kriging with an external drift</a></li>
<li class="chapter" data-level="22.3" data-path="Introkriging.html"><a href="Introkriging.html#VariogramEstimation"><i class="fa fa-check"></i><b>22.3</b> Estimating the semivariogram</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="Introkriging.html"><a href="Introkriging.html#MoM"><i class="fa fa-check"></i><b>22.3.1</b> Method-of-moments</a></li>
<li class="chapter" data-level="22.3.2" data-path="Introkriging.html"><a href="Introkriging.html#MLestimationVariogram"><i class="fa fa-check"></i><b>22.3.2</b> Maximum likelihood</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="Introkriging.html"><a href="Introkriging.html#ResidualVariogram"><i class="fa fa-check"></i><b>22.4</b> Estimating the residual semivariogram</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="Introkriging.html"><a href="Introkriging.html#IterativeMoM"><i class="fa fa-check"></i><b>22.4.1</b> Iterative method-of-moments</a></li>
<li class="chapter" data-level="22.4.2" data-path="Introkriging.html"><a href="Introkriging.html#REML"><i class="fa fa-check"></i><b>22.4.2</b> Restricted maximum likelihood</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="MBgridspacing.html"><a href="MBgridspacing.html"><i class="fa fa-check"></i><b>23</b> Model-based optimisation of grid spacing</a>
<ul>
<li class="chapter" data-level="23.1" data-path="MBgridspacing.html"><a href="MBgridspacing.html#GridspacingOK"><i class="fa fa-check"></i><b>23.1</b> Optimal grid spacing for ordinary kriging</a></li>
<li class="chapter" data-level="23.2" data-path="MBgridspacing.html"><a href="MBgridspacing.html#controlling-the-mean-or-a-quantile-of-the-ordinary-kriging-variance"><i class="fa fa-check"></i><b>23.2</b> Controlling the mean or a quantile of the ordinary kriging variance</a></li>
<li class="chapter" data-level="23.3" data-path="MBgridspacing.html"><a href="MBgridspacing.html#optimal-grid-spacing-for-block-kriging"><i class="fa fa-check"></i><b>23.3</b> Optimal grid spacing for block-kriging</a></li>
<li class="chapter" data-level="23.4" data-path="MBgridspacing.html"><a href="MBgridspacing.html#MBgridspacingKED"><i class="fa fa-check"></i><b>23.4</b> Optimal grid spacing for kriging with an external drift</a></li>
<li class="chapter" data-level="23.5" data-path="MBgridspacing.html"><a href="MBgridspacing.html#BayesianGridSpacing"><i class="fa fa-check"></i><b>23.5</b> Bayesian approach</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html"><i class="fa fa-check"></i><b>24</b> Model-based optimisation of sampling pattern</a>
<ul>
<li class="chapter" data-level="24.1" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#SSA"><i class="fa fa-check"></i><b>24.1</b> Spatial simulated annealing</a></li>
<li class="chapter" data-level="24.2" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#SamplePatternOK"><i class="fa fa-check"></i><b>24.2</b> Optimising the sample pattern for ordinary kriging</a></li>
<li class="chapter" data-level="24.3" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#SamplePatternKED"><i class="fa fa-check"></i><b>24.3</b> Optimising the sample pattern for kriging with an external drift</a></li>
<li class="chapter" data-level="24.4" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#model-based-infill-sampling"><i class="fa fa-check"></i><b>24.4</b> Model-based infill sampling</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#model-based-infill-sampling-for-kriging-with-an-external-drift"><i class="fa fa-check"></i><b>24.4.1</b> Model-based infill sampling for kriging with an external drift</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html"><i class="fa fa-check"></i><b>25</b> Sampling for estimating the semivariogram</a>
<ul>
<li class="chapter" data-level="25.1" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#nested-sampling"><i class="fa fa-check"></i><b>25.1</b> Nested sampling</a></li>
<li class="chapter" data-level="25.2" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#independent-sampling-of-pairs-of-points"><i class="fa fa-check"></i><b>25.2</b> Independent sampling of pairs of points</a></li>
<li class="chapter" data-level="25.3" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#samplingforvariogram"><i class="fa fa-check"></i><b>25.3</b> Model-based optimisation of sample pattern for semivariogram estimation</a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#UncertainSemivariogramParameters"><i class="fa fa-check"></i><b>25.3.1</b> Uncertainty about semivariogram parameters</a></li>
<li class="chapter" data-level="25.3.2" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#uncertainty-about-the-kriging-variance"><i class="fa fa-check"></i><b>25.3.2</b> Uncertainty about the kriging variance</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#SamplingEstimationandPrediction"><i class="fa fa-check"></i><b>25.4</b> Model-based optimisation of a single sample pattern for both semivariogram estimation and prediction</a></li>
<li class="chapter" data-level="25.5" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#a-practical-solution"><i class="fa fa-check"></i><b>25.5</b> A practical solution</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="Validation.html"><a href="Validation.html"><i class="fa fa-check"></i><b>26</b> Sampling for validation of maps</a>
<ul>
<li class="chapter" data-level="26.1" data-path="Validation.html"><a href="Validation.html#map-quality-indices"><i class="fa fa-check"></i><b>26.1</b> Map quality indices</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="Validation.html"><a href="Validation.html#estimation-of-map-quality-indices"><i class="fa fa-check"></i><b>26.1.1</b> Estimation of map quality indices</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="Validation.html"><a href="Validation.html#real-world-case-study"><i class="fa fa-check"></i><b>26.2</b> Real-world case study</a>
<ul>
<li class="chapter" data-level="26.2.1" data-path="Validation.html"><a href="Validation.html#estimation-of-the-population-mean-error-and-mean-squared-error"><i class="fa fa-check"></i><b>26.2.1</b> Estimation of the population Mean Error and Mean Squared Error</a></li>
<li class="chapter" data-level="26.2.2" data-path="Validation.html"><a href="Validation.html#estimation-of-the-standard-error-of-the-estimated-population-me-and-mse"><i class="fa fa-check"></i><b>26.2.2</b> Estimation of the standard error of the estimated population ME and MSE</a></li>
<li class="chapter" data-level="26.2.3" data-path="Validation.html"><a href="Validation.html#estimation-of-mec"><i class="fa fa-check"></i><b>26.2.3</b> Estimation of MEC</a></li>
<li class="chapter" data-level="26.2.4" data-path="Validation.html"><a href="Validation.html#statistical-testing-of-hypothesis-about-population-me-and-mse"><i class="fa fa-check"></i><b>26.2.4</b> Statistical testing of hypothesis about population ME and MSE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="Approaches.html"><a href="Approaches.html"><i class="fa fa-check"></i><b>27</b> Design-based, model-based and model-assisted approach for sampling and inference</a>
<ul>
<li class="chapter" data-level="27.1" data-path="Approaches.html"><a href="Approaches.html#two-sources-of-randomness"><i class="fa fa-check"></i><b>27.1</b> Two sources of randomness</a></li>
<li class="chapter" data-level="27.2" data-path="Approaches.html"><a href="Approaches.html#identically-and-independently-distributed-i.i.d."><i class="fa fa-check"></i><b>27.2</b> “Identically and independently distributed” (i.i.d.)</a></li>
<li class="chapter" data-level="27.3" data-path="Approaches.html"><a href="Approaches.html#BiasandVariance"><i class="fa fa-check"></i><b>27.3</b> Bias and variance</a></li>
<li class="chapter" data-level="27.4" data-path="Approaches.html"><a href="Approaches.html#effectivesamplesize"><i class="fa fa-check"></i><b>27.4</b> Effective sample size</a></li>
<li class="chapter" data-level="27.5" data-path="Approaches.html"><a href="Approaches.html#ExploitSpatialStructure"><i class="fa fa-check"></i><b>27.5</b> Exploiting spatial structure in design-based approach</a></li>
<li class="chapter" data-level="27.6" data-path="Approaches.html"><a href="Approaches.html#ModelassistedvsModeldependent"><i class="fa fa-check"></i><b>27.6</b> Model-assisted versus model-dependent</a></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="Answers.html"><a href="Answers.html"><i class="fa fa-check"></i><b>A</b> Answers to exercises</a>
<ul>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#introduction-to-probability-sampling"><i class="fa fa-check"></i>Introduction to probability sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#simple-random-sampling"><i class="fa fa-check"></i>Simple random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#stratified-random-sampling"><i class="fa fa-check"></i>Stratified random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#systematic-random-sampling"><i class="fa fa-check"></i>Systematic random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#cluster-random-sampling"><i class="fa fa-check"></i>Cluster random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#two-stage-random-sampling"><i class="fa fa-check"></i>Two-stage random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#sampling-with-probabilities-proportional-to-size"><i class="fa fa-check"></i>Sampling with probabilities proportional to size</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#balanced-and-well-spread-sampling"><i class="fa fa-check"></i>Balanced and well-spread sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#ratio-and-regression-estimator"><i class="fa fa-check"></i>Ratio and regression estimator</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#two-phase-random-sampling"><i class="fa fa-check"></i>Two-phase random sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#required-sample-size"><i class="fa fa-check"></i>Required sample size</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#model-based-prediction-of-sampling-variance-of-estimated-mean"><i class="fa fa-check"></i>Model-based prediction of sampling variance of estimated mean</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#regular-grid-sampling"><i class="fa fa-check"></i>Regular grid sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#spatial-coverage-sampling"><i class="fa fa-check"></i>Spatial coverage sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#covariate-space-coverage-sampling"><i class="fa fa-check"></i>Covariate space coverage sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#conditioned-latin-hypercube-sampling"><i class="fa fa-check"></i>Conditioned Latin hypercube sampling</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#model-based-optimisation-of-the-grid-spacing"><i class="fa fa-check"></i>Model-based optimisation of the grid spacing</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#model-based-optimisation-of-sampling-pattern"><i class="fa fa-check"></i>Model-based optimisation of sampling pattern</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#sampling-for-estimating-the-semivariogram"><i class="fa fa-check"></i>Sampling for estimating the semivariogram</a></li>
<li class="chapter" data-level="" data-path="Answers.html"><a href="Answers.html#sampling-for-validation"><i class="fa fa-check"></i>Sampling for validation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial sampling with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="STSI" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Stratified simple random sampling</h1>
<p>In stratified random sampling the population is divided into subpopulations, for instance soil mapping units, areas with the same land use or land cover, administrative units, etc. The subareas are mutually exclusive, i.e. they do not overlap, and are jointly exhaustive, i.e. their union equals the entire population (study area). Within each subpopulation, referred to as a stratum, a probability sample is selected by some sampling design. If these probability samples are selected by simple random sampling, as described in the previous chapter, the design is stratified <em>simple</em> random sampling (STSI). If sampling units were selected by cluster random sampling, then the design is stratified <em>cluster</em> random sampling. This chapter is about stratified simple random sampling.</p>
<p>Stratified simple random sampling is illustrated with Voorst (Figure <a href="STSI.html#fig:SampleSTSI">4.1</a>). In the data frame with simulated data there is a column <code>stratum</code>. These are combinations of soil classes and land use, obtained by overlaying a soil map and a land use map. To select a stratified simple random sample, we set the total sample size <span class="math inline">\(n\)</span> and the sampling units must be apportioned to the strata. I chose to apportion the units proportionally to the size (area, number of pixels) of the strata (see for details Section <a href="STSI.html#STSIallocation">4.3</a> hereafter). The larger a stratum, the more units are selected from this stratum. The stratum sizes (total number of pixels) are computed with function <code>tapply</code>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="STSI.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sampling)</span>
<span id="cb31-2"><a href="STSI.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Voorst.RData&quot;</span>)</span>
<span id="cb31-3"><a href="STSI.html#cb31-3" aria-hidden="true" tabindex="-1"></a>N_h <span class="ot">&lt;-</span> <span class="fu">tapply</span>(grdVoorst<span class="sc">$</span>stratum, <span class="at">INDEX=</span>grdVoorst<span class="sc">$</span>stratum,</span>
<span id="cb31-4"><a href="STSI.html#cb31-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">FUN=</span>length)</span>
<span id="cb31-5"><a href="STSI.html#cb31-5" aria-hidden="true" tabindex="-1"></a>w_h <span class="ot">&lt;-</span> N_h<span class="sc">/</span><span class="fu">sum</span>(N_h)</span>
<span id="cb31-6"><a href="STSI.html#cb31-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb31-7"><a href="STSI.html#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(n_h <span class="ot">&lt;-</span> <span class="fu">round</span>(n <span class="sc">*</span> w_h))</span></code></pre></div>
<pre><code>BA EA PA RA XF 
13  8  9  4  7 </code></pre>
<p>The sum of the stratum sample sizes is 41, we want 40, so we reduce the largest stratum sample size by 1.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="STSI.html#cb33-1" aria-hidden="true" tabindex="-1"></a>n_h[<span class="dv">1</span>] <span class="ot">&lt;-</span> n_h[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span></span></code></pre></div>
<p>The stratified simple random sample is selected with the function <code>strata</code> of package <strong>sampling</strong> <span class="citation">(<a href="#ref-Tille2016" role="doc-biblioref">Tillé and Matei 2016</a>)</span>. The name of the package is added to the function (<code>sampling::strata</code>), as <code>strata</code> is also a function in another package. Not adding the name of the package may result in an error message. The argument <code>size</code> specifies the stratum sample sizes. These stratum sample sizes must be in the order in which the strata are encountered in the data frame <code>grdVoorst</code>, which is determined first with function <code>unique</code>. Within the strata the grid cells are selected by simple random sampling <em>with replacement</em> (<code>method="srswr"</code>), so that in principle more than one point can be selected within a grid cell, see Chapter <a href="SI.html#SI">3</a> for a motivation of this. The function <code>getdata</code> extracts the observations for the selected units from the sampling frame, as well as the spatial coordinates and the stratum of these units. The coordinates of the centers of the selected grid cells are jittered by an amount equal to half the side of the grid cells.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="STSI.html#cb34-1" aria-hidden="true" tabindex="-1"></a>ord <span class="ot">&lt;-</span> <span class="fu">unique</span>(grdVoorst<span class="sc">$</span>stratum)</span>
<span id="cb34-2"><a href="STSI.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb34-3"><a href="STSI.html#cb34-3" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> sampling<span class="sc">::</span><span class="fu">strata</span>(</span>
<span id="cb34-4"><a href="STSI.html#cb34-4" aria-hidden="true" tabindex="-1"></a>  grdVoorst, <span class="at">stratanames=</span><span class="st">&quot;stratum&quot;</span>, <span class="at">size=</span>n_h[ord], <span class="at">method=</span><span class="st">&quot;srswr&quot;</span>)</span>
<span id="cb34-5"><a href="STSI.html#cb34-5" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> <span class="fu">getdata</span>(grdVoorst, units)</span>
<span id="cb34-6"><a href="STSI.html#cb34-6" aria-hidden="true" tabindex="-1"></a>cellsize <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb34-7"><a href="STSI.html#cb34-7" aria-hidden="true" tabindex="-1"></a>mysample<span class="sc">$</span>s1 <span class="ot">&lt;-</span> <span class="fu">jitter</span>(mysample<span class="sc">$</span>s1, <span class="at">amount=</span>cellsize<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb34-8"><a href="STSI.html#cb34-8" aria-hidden="true" tabindex="-1"></a>mysample<span class="sc">$</span>s2 <span class="ot">&lt;-</span> <span class="fu">jitter</span>(mysample<span class="sc">$</span>s2, <span class="at">amount=</span>cellsize<span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
<p>Figure <a href="STSI.html#fig:SampleSTSI">4.1</a> shows the selected sample.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:SampleSTSI"></span>
<img src="SpatialSampling_files/figure-html/SampleSTSI-1.png" alt="Stratified simple random sample of size 40 from Voorst. Strata are combinations of soil class and land use." width="100%" />
<p class="caption">
Figure 4.1: Stratified simple random sample of size 40 from Voorst. Strata are combinations of soil class and land use.
</p>
</div>
<div id="EstimatorsSTSI" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Estimation of population parameters</h2>
<p>With simple random sampling within strata, the estimator of the mean for simple random sampling (Equation <a href="SI.html#eq:HTMeanSI">(3.2)</a>) is applied at the level of the strata. The estimated stratum means are then averaged, using the relative sizes (relative areas) of the strata as weights:</p>
<p><span class="math display" id="eq:HTMeanSTSI">\[\begin{equation}
\hat{\bar{z}}= \sum\limits_{h=1}^{H} w_{h}\,\hat{\bar{z}}_{h} \;,
\tag{4.1}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(H\)</span> is the number of strata, <span class="math inline">\(w_{h}\)</span> are the relative sizes (areas) of the strata (stratum weights): <span class="math inline">\(w_h = N_h/N\)</span>, and <span class="math inline">\(\hat{\bar{z}}_{h}\)</span> is the estimated mean of stratum <span class="math inline">\(h\)</span> estimated by the sample mean for stratum <span class="math inline">\(h\)</span>:</p>
<p><span class="math display" id="eq:HTStratumMeanSI">\[\begin{equation}
\hat{\bar{z}}_{h}=\frac{1}{n_h}\sum_{k \in \mathcal{S}_h} z_k\;,
\tag{4.2}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(\mathcal{S}_h\)</span> the sample selected from stratum <span class="math inline">\(h\)</span>.</p>
<p>The same estimator is found when the <span class="math inline">\(\pi\)</span> estimator is worked out for stratified simple random sampling. With stratified simple random sampling without replacement and different sampling fractions for the strata<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a> the inclusion probabilities differ among the strata and equal <span class="math inline">\(\pi_{hk} = n_h/N_h\)</span> for all <span class="math inline">\(k\)</span> in stratum <span class="math inline">\(h\)</span>, with <span class="math inline">\(n_h\)</span> the sample size of stratum <span class="math inline">\(h\)</span> and <span class="math inline">\(N_h\)</span> the size of stratum <span class="math inline">\(h\)</span>. Inserting this in the <span class="math inline">\(\pi\)</span> estimator of the population mean (Equation <a href="IntroProbabilitySampling.html#eq:HTMean">(2.4)</a>) gives</p>
<p><span class="math display" id="eq:HTMeanSTSI2">\[\begin{equation}
\hat{\bar{z}}= \frac{1}{N}\sum\limits_{h=1}^{H}\sum\limits_{k \in \mathcal{S}_h} \frac{z_{hk}}{\pi_{hk}} = \frac{1}{N}\sum\limits_{h=1}^{H} \frac{N_h}{n_h}\sum\limits_{k \in \mathcal{S}_h} z_{hk} = \sum\limits_{h=1}^{H} w_{h}\,\hat{\bar{z}}_{h} \;.
\tag{4.3}
\end{equation}\]</span></p>
<p>The sampling variance of the estimator of the population mean is estimated by first estimating the sampling variances of the estimated stratum means, and then pooling. Note that for the sampling variance we must square the stratum weights:</p>
<p><span class="math display" id="eq:EstVarMeanSTSI">\[\begin{equation}
\widehat{V}\!\left(\hat{\bar{z}}\right)=\sum\limits_{h=1}^{H}w_{h}^{2}\,\widehat{V}\!\left(\hat{\bar{z}}_{h}\right)\;,
\tag{4.4}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\widehat{V}\!\left(\hat{\bar{z}}_{h}\right)\)</span> is the estimated sampling variance of <span class="math inline">\(\hat{\bar{z}}_{h}\)</span>:</p>
<p><span class="math display" id="eq:EstVarstratummean">\[\begin{equation}
\widehat{V}\!\left(\hat{\bar{z}}_{h}\right)= (1-\frac{n_h}{N_h}) \frac{\widehat{S^2}_h(z)}{n_h}\;,
\tag{4.5}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(\widehat{S^2}_h(z)\)</span> the estimated variance of <span class="math inline">\(z\)</span> within stratum <span class="math inline">\(h\)</span>:</p>
<p><span class="math display" id="eq:EstStratumVar">\[\begin{equation}
\widehat{S^2}_h(z)=\frac{1}{n_h-1}\sum\limits_{k \in \mathcal{S}_h}\left(z_{hk}-\hat{\bar{z}}_{h}\right)^{2}\;.
\tag{4.6}
\end{equation}\]</span></p>
<p>For stratified simple random sampling with replacement of finite populations and stratified simple random sampling of infinite populations the <span class="math inline">\(1-(n_h/N_h)\)</span> can be dropped.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="STSI.html#cb35-1" aria-hidden="true" tabindex="-1"></a>mz_h <span class="ot">&lt;-</span> <span class="fu">tapply</span>(mysample<span class="sc">$</span>z, <span class="at">INDEX=</span>mysample<span class="sc">$</span>stratum, <span class="at">FUN=</span>mean)</span>
<span id="cb35-2"><a href="STSI.html#cb35-2" aria-hidden="true" tabindex="-1"></a>mz <span class="ot">&lt;-</span> <span class="fu">sum</span>(w_h<span class="sc">*</span>mz_h)</span>
<span id="cb35-3"><a href="STSI.html#cb35-3" aria-hidden="true" tabindex="-1"></a>S2z_h <span class="ot">&lt;-</span> <span class="fu">tapply</span>(mysample<span class="sc">$</span>z, <span class="at">INDEX=</span>mysample<span class="sc">$</span>stratum, <span class="at">FUN=</span>var)</span>
<span id="cb35-4"><a href="STSI.html#cb35-4" aria-hidden="true" tabindex="-1"></a>v_mz_h <span class="ot">&lt;-</span> S2z_h<span class="sc">/</span>n_h</span>
<span id="cb35-5"><a href="STSI.html#cb35-5" aria-hidden="true" tabindex="-1"></a>se_mz <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(w_h<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>v_mz_h))</span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:stratummeans">Table 4.1: </span>Stratum size (Nh), stratum sample size (nh), estimated stratum mean (Mean), estimated variance (Variance) and estimated variance of estimated stratum mean (Variance of mean).
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Nh
</th>
<th style="text-align:right;">
nh
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
Variance
</th>
<th style="text-align:right;">
Variance of mean
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
BA
</td>
<td style="text-align:right;">
2371
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
8.22
</td>
<td style="text-align:right;">
10.20
</td>
<td style="text-align:right;">
0.850
</td>
</tr>
<tr>
<td style="text-align:left;">
EA
</td>
<td style="text-align:right;">
1442
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
5.55
</td>
<td style="text-align:right;">
4.35
</td>
<td style="text-align:right;">
0.544
</td>
</tr>
<tr>
<td style="text-align:left;">
PA
</td>
<td style="text-align:right;">
1710
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
5.97
</td>
<td style="text-align:right;">
14.42
</td>
<td style="text-align:right;">
1.603
</td>
</tr>
<tr>
<td style="text-align:left;">
RA
</td>
<td style="text-align:right;">
659
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7.64
</td>
<td style="text-align:right;">
9.24
</td>
<td style="text-align:right;">
2.310
</td>
</tr>
<tr>
<td style="text-align:left;">
XF
</td>
<td style="text-align:right;">
1346
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
8.73
</td>
<td style="text-align:right;">
11.48
</td>
<td style="text-align:right;">
1.640
</td>
</tr>
</tbody>
</table>
<p>Table <a href="STSI.html#tab:stratummeans">4.1</a> shows per stratum the estimated means, estimated variances and estimated sampling variances of the estimated means. We can see large differences in the within-stratum variances. For the stratified sample of Figure <a href="STSI.html#fig:SampleSTSI">4.1</a> the estimated population mean equals 7.238 and the estimated standard error of this estimator equals 0.507.</p>
<p>The population mean can also be estimated directly using the basic <span class="math inline">\(\pi\)</span> estimator (Equation <a href="SI.html#eq:HTMeanSI">(3.2)</a>). The inclusion probabilities are included in the data frame , in the column <code>Prob</code>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="STSI.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mysample)</span></code></pre></div>
<pre><code>           s1       s2         z stratum ID_unit        Prob Stratum
1962 202554.8 464556.7  6.460569      XF    1135 0.005189017       1
3712 204305.5 464738.9  6.217245      XF    2159 0.005189017       1
6781 203038.3 465057.0 15.140350      XF    4205 0.005189017       1
7235 202381.1 465096.7  5.766409      XF    4503 0.005189017       1
8484 203610.4 465237.8  9.363492      XF    5336 0.005189017       1
9265 205147.1 465315.5 10.928986      XF    5853 0.005189017       1</code></pre>
<p>The population total is estimated first, and by dividing this estimated total by the total number of population units <span class="math inline">\(N\)</span> an estimate of the population mean is obtained.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="STSI.html#cb38-1" aria-hidden="true" tabindex="-1"></a>tz <span class="ot">&lt;-</span> <span class="fu">sum</span>(mysample<span class="sc">$</span>z<span class="sc">/</span>mysample<span class="sc">$</span>Prob)</span>
<span id="cb38-2"><a href="STSI.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mz <span class="ot">&lt;-</span> tz<span class="sc">/</span><span class="fu">sum</span>(N_h))</span></code></pre></div>
<pre><code>[1] 7.254982</code></pre>
<p>The two estimates of the population mean are not exactly equal. This is due to rounding errors in the inclusion probabilities. This can be shown by computing the sum of the inclusion probabilities over all population units. This sum should be equal to the sample size <span class="math inline">\(n=40\)</span>, but as we can see below, this sum is slightly smaller.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="STSI.html#cb40-1" aria-hidden="true" tabindex="-1"></a>pi_h <span class="ot">&lt;-</span> <span class="fu">tapply</span>(mysample<span class="sc">$</span>Prob, <span class="at">INDEX=</span>mysample<span class="sc">$</span>stratum, <span class="at">FUN=</span>unique)</span>
<span id="cb40-2"><a href="STSI.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sum</span>(pi_h<span class="sc">*</span>N_h))</span></code></pre></div>
<pre><code>[1] 39.90711</code></pre>
<p>Now suppose that we ignore that the sample data come from a stratified sampling design, and we use the (unweighted) sample mean as an estimate of the population mean.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="STSI.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(mysample<span class="sc">$</span>z))</span></code></pre></div>
<pre><code>[1] 7.211431</code></pre>
<p>The sample mean slightly differs from the proper estimate of the population mean. The sample mean is a <em>biased</em> estimator, but the bias is only small. The reason for the small bias is that the stratum sample sizes are about proportional to the sizes of the strata, so that the inclusion probabilities (sampling intensities) are about equal for all strata: 0.0050494, 0.0055344, 0.0052509, 0.006056, 0.005189. The probabilities are not exactly equal because the stratum sample sizes are necessarily rounded to integers and because we reduced the largest sample size by one unit. The bias would have been substantially larger if an equal number of units would have been selected from each stratum, leading to much larger differences in the inclusion probabilities among the strata. Sampling intensity in stratum BA, for instance, then would be much smaller compared to the other strata, and so are the inclusion probabilities of the units in this stratum as compared to the other strata. Stratum is underrepresented in the sample. This is not a problem as long as we account for the difference in inclusion probabilities of the units in estimation of the population mean. If we do not account for these differences in inclusion probabilities, the estimator of the mean will be seriously biased.</p>
<p>The next code chunk shows how the population mean and its standard error can be estimated with package <strong>survey</strong> <span class="citation">(<a href="#ref-Lumley2020" role="doc-biblioref">Lumley 2020</a>)</span>. Note that the stratum weights <span class="math inline">\(N_h/n_h\)</span> must be given to function <code>svydesign</code> in argument <code>weight</code>. These are first attached to the data frame <code>mysample</code> by creating a look-up table <code>lut</code>, which is then merged with function <code>merge</code> to the data frame <code>mysample</code>.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="STSI.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb44-2"><a href="STSI.html#cb44-2" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(mysample<span class="sc">$</span>stratum))</span>
<span id="cb44-3"><a href="STSI.html#cb44-3" aria-hidden="true" tabindex="-1"></a>lut <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">stratum=</span>labels, <span class="at">weight=</span>N_h<span class="sc">/</span>n_h)</span>
<span id="cb44-4"><a href="STSI.html#cb44-4" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x=</span>mysample, <span class="at">y=</span>lut)</span>
<span id="cb44-5"><a href="STSI.html#cb44-5" aria-hidden="true" tabindex="-1"></a>design_stsi <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb44-6"><a href="STSI.html#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">id=</span><span class="sc">~</span><span class="dv">1</span>, <span class="at">strata=</span><span class="sc">~</span>stratum, <span class="at">weight=</span><span class="sc">~</span>weight, <span class="at">data=</span>mysample)</span>
<span id="cb44-7"><a href="STSI.html#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="fu">svymean</span>(<span class="sc">~</span>z, design_stsi)</span></code></pre></div>
<pre><code>    mean     SE
z 7.2382 0.5071</code></pre>
<div id="estimation-of-population-proportion-cumulative-distribution-function-and-quantiles" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Estimation of population proportion, cumulative distribution function and quantiles</h3>
<p>The proportion of a population satisfying some condition can be estimated by Equations <a href="STSI.html#eq:HTMeanSTSI">(4.1)</a> and <a href="STSI.html#eq:HTStratumMeanSI">(4.2)</a>, substituting for the study variable <span class="math inline">\(z_k\)</span> an indicator <span class="math inline">\(y_k\)</span> with value 1 if for unit <span class="math inline">\(k\)</span> the condition is satisfied, and 0 otherwise (Section <a href="SI.html#PopProportion">3.1.1</a>). In general with stratified simple random sampling the inclusion probabilities are not exactly equal, so that the estimated population proportion is not equal to the sample proportion.</p>
<p>These unequal inclusion probabilities must also be accounted for when estimating the cumulative distribution function (CDF) and quantiles (Section <a href="SI.html#CDF">3.1.2</a>), as shown in the next code chunk for the CDF.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="STSI.html#cb46-1" aria-hidden="true" tabindex="-1"></a>thresholds <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(mysample<span class="sc">$</span>z))</span>
<span id="cb46-2"><a href="STSI.html#cb46-2" aria-hidden="true" tabindex="-1"></a>cumfreq <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="at">length=</span><span class="fu">length</span>(thresholds))</span>
<span id="cb46-3"><a href="STSI.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(thresholds)) {</span>
<span id="cb46-4"><a href="STSI.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> mysample<span class="sc">$</span>z <span class="sc">&lt;=</span> thresholds[i]</span>
<span id="cb46-5"><a href="STSI.html#cb46-5" aria-hidden="true" tabindex="-1"></a>  mh_ind <span class="ot">&lt;-</span> <span class="fu">tapply</span>(ind, <span class="at">INDEX=</span>mysample<span class="sc">$</span>stratum, <span class="at">FUN=</span>mean)</span>
<span id="cb46-6"><a href="STSI.html#cb46-6" aria-hidden="true" tabindex="-1"></a>  cumfreq[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(w_h<span class="sc">*</span>mh_ind)</span>
<span id="cb46-7"><a href="STSI.html#cb46-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-8"><a href="STSI.html#cb46-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>thresholds, <span class="at">y=</span>cumfreq)</span></code></pre></div>
<p>Figure <a href="STSI.html#fig:EstimatedCDFVoorstSTSI">4.2</a> shows the estimated CDF, estimated from the stratified simple random sample of 40 units from Voorst (Figure <a href="STSI.html#fig:SampleSTSI">4.1</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:EstimatedCDFVoorstSTSI"></span>
<img src="SpatialSampling_files/figure-html/EstimatedCDFVoorstSTSI-1.png" alt="Cumulative distribution function estimated from the stratified simple random sample of 40 units from Voorst." width="80%" />
<p class="caption">
Figure 4.2: Cumulative distribution function estimated from the stratified simple random sample of 40 units from Voorst.
</p>
</div>
<p>The estimated proportions (cumulative frequencies) are used to estimate a quantile. These estimates are easily obtained with function <code>svyquantile</code> of package <strong>survey</strong>.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="STSI.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">svyquantile</span>(<span class="sc">~</span>z, design_stsi, <span class="at">quantile=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.9</span>))</span></code></pre></div>
<pre><code>$z
     quantile    ci.2.5  ci.97.5        se
0.5  6.460569  5.524261 8.625079 0.7637077
0.9 12.064708 10.928986      NaN       NaN

attr(,&quot;hasci&quot;)
[1] TRUE
attr(,&quot;class&quot;)
[1] &quot;newsvyquantile&quot;</code></pre>
</div>
<div id="WhyStratify" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Why should we stratify?</h3>
<p>There can be two reasons for stratifying the population:</p>
<ol style="list-style-type: decimal">
<li>We are interested in the means (totals) per stratum.<br />
</li>
<li>We want to increase the precision of the estimated mean (total) for the entire population.</li>
</ol>
<p>Figure <a href="STSI.html#fig:SamplingDistributionSTSI">4.3</a> shows the sampling distributions of the estimator of the population mean for stratified simple random sampling and simple random sampling, both of size 40, obtained by repeating the random sampling with each design and estimation 10,000 times.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:SamplingDistributionSTSI"></span>
<img src="SpatialSampling_files/figure-html/SamplingDistributionSTSI-1.png" alt="Sampling distribution of the estimator of the mean of SOM (g/kg) in Voorst for stratified simple random sampling and simple random sampling of size 40." width="80%" />
<p class="caption">
Figure 4.3: Sampling distribution of the estimator of the mean of SOM (g/kg) in Voorst for stratified simple random sampling and simple random sampling of size 40.
</p>
</div>
<p>The sampling distributions of the estimators of the population mean with the two designs are not very different. With stratified random sampling the spread of the estimated means is somewhat smaller. The horizontal red line is the population mean. The gain in precision due to the stratification, referred to as the stratification effect, can be quantified by ratio of the variance with simple random sampling and the variance with stratified simple random sampling. So when this variance ratio is larger than 1, stratified simple random sampling is more precise than simple random sampling. For Voorst the stratification effect with proportional allocation (Section <a href="STSI.html#STSIallocation">4.3</a>) equals 1.263. This means that with simple random sampling we need 1.263 more sampling units than stratified simple random sampling to obtain an estimate of the same precision.</p>
<p>The stratification effect is computed from the population variance <span class="math inline">\(S^2(z)\)</span> (Equation <a href="SI.html#eq:VarMean">(3.7)</a>) and the variances within the strata <span class="math inline">\(S^2_h(z)\)</span>. In the sampling experiment these variances are known without error because we know the <span class="math inline">\(z\)</span>-values for all units in the population. In practice we only know the <span class="math inline">\(z\)</span>-values for the sampled units. However, a design-unbiased estimator of the population variance is <span class="citation">(<a href="#ref-gru06" role="doc-biblioref">de Gruijter et al. 2006</a>)</span></p>
<p><span class="math display" id="eq:EstimatorPopulationVariancefromSTSI">\[\begin{equation}
\widehat{S^{2}}(z)= \widehat{\overline{z^{2}}}-\left(\hat{\bar{z}}\right)^{2}+
\widehat{V}\!\left(\hat{\bar{z}}\right) \;,
\tag{4.7}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\widehat{\overline{z^{2}}}\)</span> denotes the estimated population mean of the study variable squared (<span class="math inline">\(z^2\)</span>), obtained in the same way as <span class="math inline">\(\hat{\bar{z}}\)</span> (Equation <a href="STSI.html#eq:HTMeanSTSI">(4.1)</a>, but using squared values, and <span class="math inline">\(\widehat{V}\!\left(\hat{\bar{z}}\right)\)</span> the estimated variance of the estimator of the population mean (Equation <a href="STSI.html#eq:EstVarMeanSTSI">(4.4)</a>).</p>
<p>The estimated population variance is then divided by the sum of the stratum sample sizes to get an estimate of the sampling variance of the estimator of the mean with simple random sampling of an equal number of units:</p>
<p><span class="math display" id="eq:stratificationeffect">\[\begin{equation}
\widehat{V}(\hat{\bar{z}}_{\text{SI}}) = \frac{\widehat{S^2}(z)}{\sum_{h=1}^{H}n_h}\;.
\tag{4.8}
\end{equation}\]</span></p>
<p>The population variance can be estimated with function <code>s2</code> of package <strong>surveyplanning</strong> <span class="citation">(<a href="#ref-surveyplanning" role="doc-biblioref">Breidaks, Liberts, and Jukams 2020</a>)</span>. However, this function is an implementation of an alternative, consistent estimator<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a> of the population variance (<span class="citation"><a href="#ref-sar92" role="doc-biblioref">Särndal, Swensson, and Wretman</a> (<a href="#ref-sar92" role="doc-biblioref">1992</a>)</span>):</p>
<p><span class="math display" id="eq:EstimatorPopulationVariance4AnyDesign">\[\begin{equation}
\widehat{S^2}(z) = \frac{N-1}{N} \frac{n}{n-1} \frac{1}{N-1} \sum_{k \in \mathcal{S}} \frac{(z_k - \hat{\bar{z}}_{\pi})^2}{\pi_k} \;.
\tag{4.9}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="STSI.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(surveyplanning)</span>
<span id="cb49-2"><a href="STSI.html#cb49-2" aria-hidden="true" tabindex="-1"></a>S2z <span class="ot">&lt;-</span> <span class="fu">s2</span>(mysample<span class="sc">$</span>z,<span class="at">w=</span>mysample<span class="sc">$</span>weight)</span></code></pre></div>
<p>The design effect is defined as the ratio of the variance of the sampling design under study and the variance of the estimator of the mean with simple random sampling of an equal number of units (Chapter <a href="RequiredSampleSize.html#DesignEffect">12.4</a>). So the design effect of stratified random sampling is the reciprocal of the stratification effect. For the stratified simple random sample of Figure <a href="STSI.html#fig:SampleSTSI">4.1</a> the design effect can then be estimated as follows. The function <code>SE</code> extracts the standard error of the estimated mean from the output of function <code>svymean</code>. The extracted standard error is then squared to obtain an estimate of the sampling variance of the estimator of the population with stratified simple random sampling. Finally, this variance is divided by the variance with simple random sampling of an equal number of units.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="STSI.html#cb50-1" aria-hidden="true" tabindex="-1"></a>v_mz_SI <span class="ot">&lt;-</span> S2z<span class="sc">/</span>n</span>
<span id="cb50-2"><a href="STSI.html#cb50-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">svymean</span>(<span class="sc">~</span>z, design_stsi)</span>
<span id="cb50-3"><a href="STSI.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">SE</span>(res)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>v_mz_SI</span></code></pre></div>
<pre><code>          z
z 0.9481981</code></pre>
<p>The same value is obtained with argument <code>deff</code> of function <code>svymean</code>.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="STSI.html#cb52-1" aria-hidden="true" tabindex="-1"></a>design_stsi <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb52-2"><a href="STSI.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">id=</span><span class="sc">~</span><span class="dv">1</span>, <span class="at">strata=</span><span class="sc">~</span>stratum, <span class="at">weight=</span><span class="sc">~</span>weight, <span class="at">data=</span>mysample)</span>
<span id="cb52-3"><a href="STSI.html#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">svymean</span>(<span class="sc">~</span>z, design_stsi, <span class="at">deff=</span><span class="st">&quot;replace&quot;</span>)</span></code></pre></div>
<pre><code>     mean      SE   DEff
z 7.23820 0.50707 0.9482</code></pre>
<p>So, when using package <strong>survey</strong> estimation of the population variance is not needed to estimate the design effect. I only added this to make clear how the design effect is computed with functions in package <strong>survey</strong>. In following chapters I will skip the estimation of the population variance.</p>
<p>The estimated design effect as estimated from the stratified sample is a bit smaller than 1, showing that stratified simple random sampling is slightly more efficient than simple random sampling. The reciprocal of the estimated design effect is considerably smaller than the stratification effect as computed in the sampling experiment, but this is an estimate of the design effect from one stratified sample only. The estimated population variance varies among stratified samples, and so does the estimated design effect.</p>
<p>Stratified simple random sampling with proportional allocation (Section <a href="STSI.html#STSIallocation">4.3</a>) is more precise than simple random sampling when the sum of squares of the stratum means is larger than the sum of squares within strata <span class="citation">(<a href="#ref-loh99" role="doc-biblioref">Lohr 1999</a>)</span>:</p>
<p><span class="math display" id="eq:STSImoreprecisewhen">\[\begin{equation}
SSB &gt; \sum_{h=1}^H (1-\frac{N_h}{N})S^2_h \;,
\tag{4.10}
\end{equation}\]</span></p>
<p>with SSB the weighted sum-of-squares between the stratum means:</p>
<p><span class="math display" id="eq:SSB">\[\begin{equation}
SSB= \sum_{h=1}^H N_h (\bar{z}_h-\bar{z})^2 \;.
\tag{4.11}
\end{equation}\]</span></p>
<p>In other words, the smaller the differences in the stratum means and the larger the variances within the strata, the smaller the stratification effect will be. Figure <a href="STSI.html#fig:boxplotsSOMstrata">4.4</a> shows boxplots of SOM per stratum (soil-land use combination). The stratum means are equal to 7.94, 5.26, 6.56, 9.47, 11.12. The stratum variances are 14.5, 3.6, 9.2, 17.4, 27.6. The rather small differences in stratum means, in combination with the large stratum variances explain the modest gain in precision realised by stratified simple random sampling compared to simple random sampling in this case.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:boxplotsSOMstrata"></span>
<img src="SpatialSampling_files/figure-html/boxplotsSOMstrata-1.png" alt="Boxplots of SOM per landuse-soil combination." width="100%" />
<p class="caption">
Figure 4.4: Boxplots of SOM per landuse-soil combination.
</p>
</div>
</div>
</div>
<div id="CISTSI" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Confidence interval estimate</h2>
<p>The <span class="math inline">\(100(1-\alpha )\)</span>% confidence interval for <span class="math inline">\(\bar{z}\)</span> is given by</p>
<p><span class="math display" id="eq:CISTSI">\[\begin{equation}
\hat{\bar{z}} \pm t_{\alpha /2, df}\cdot
\sqrt{\widehat{V}\!\left(\hat{\bar{z}}\right)} \;,
\tag{4.12}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(t_{\alpha /2,df}\)</span> is the value of <span class="math inline">\(t\)</span> of a Student’s <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(df\)</span> degrees of freedom having a tail area of <span class="math inline">\(\alpha/2\)</span> to its right. In other words this is the <span class="math inline">\((1-(\alpha /2))\)</span> quantile of the Student’s <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(df\)</span> degrees of freedom. The degrees of freedom <span class="math inline">\(df\)</span> can be approximated by <span class="math inline">\(n-H\)</span>, as proposed by <span class="citation"><a href="#ref-loh99" role="doc-biblioref">Lohr</a> (<a href="#ref-loh99" role="doc-biblioref">1999</a>)</span>. This is the number of the degrees of freedom if the variances within the strata are equal. With unequal variances within strata <span class="math inline">\(df\)</span> can be approximated by Sattherwaites method <span class="citation">(<a href="#ref-nan04" role="doc-biblioref">Nanthakumar and Selvavel 2004</a>)</span>:</p>
<p><span class="math display" id="eq:dfSattherwaite">\[\begin{equation}
df \approx \frac {\left(\sum_{h=1}^H w_h^2
\frac{\widehat{S^2}_h(z)}{n_h}\right)^2} {\sum_{h=1}^H w_h^4
\left(\frac{\widehat{S^2}_h(z)}{n_h}\right)^2 \frac {1}{n_h-1}} \;.
\tag{4.13}
\end{equation}\]</span></p>
<p>A confidence interval estimate of the population mean can be extracted with method <code>confint</code> of package <strong>survey</strong>. It uses <span class="math inline">\(n-H\)</span> degrees of freedom.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="STSI.html#cb54-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">svymean</span>(<span class="sc">~</span>z, design_stsi)</span>
<span id="cb54-2"><a href="STSI.html#cb54-2" aria-hidden="true" tabindex="-1"></a>df_stsi <span class="ot">&lt;-</span> <span class="fu">degf</span>(design_stsi)</span>
<span id="cb54-3"><a href="STSI.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(res, <span class="at">df=</span>df_stsi, <span class="at">level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>     2.5 %   97.5 %
z 6.208797 8.267613</code></pre>
</div>
<div id="STSIallocation" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Allocation of sample size to strata</h2>
<p>After we have decided on the total sample size <span class="math inline">\(n\)</span>, we must decide how to apportion the units to the strata. It is reasonable to allocate more sampling units to large strata, and fewer to small strata. The simplest way to achieve this is proportional allocation:</p>
<p><span class="math display" id="eq:propallocation">\[\begin{equation}
n_{h}=n \cdot \frac{N_{h}}{\sum N_{h}}\;,
\tag{4.14}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(N_h\)</span> the total number of population units (size) of stratum <span class="math inline">\(h\)</span>. With infinite populations <span class="math inline">\(N_h\)</span> is replaced by the area <span class="math inline">\(A_h\)</span>. The sample sizes computed with this equation are rounded to the nearest integers.</p>
<p>If we have prior information on the variance of the study variable within the strata, then it makes sense to account for differences in variance. Heterogeneous strata should receive more sampling units than homogeneous strata, leading to Neyman allocation:</p>
<p><span class="math display" id="eq:Neymanallocation">\[\begin{equation}
n_{h}= n \cdot \frac{N_{h}\,S_{h}(z)}{\sum\limits_{h=1}^{H} N_{h}\,S_{h}(z)} \;.
\tag{4.15}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(S_h(z)\)</span> the standard deviation (square root of variance) of the study variable <span class="math inline">\(z\)</span> in stratum <span class="math inline">\(h\)</span>.</p>
<p>Finally, costs of sampling may differ between strata. It can be relatively expensive to sample nearly inaccessible strata, and we do not want to sample many units there. This leads to optimal allocation:</p>
<p><span class="math display" id="eq:optallocation">\[\begin{equation}
n_{h}= n \cdot \frac{\frac{N_{h}\,S_{h}(z)}{\sqrt{c_{h}}}}{\sum\limits_{h=1}^{H} \frac{N_{h}\,S_{h}(z)}{\sqrt{c_{h}}}} \;,
\tag{4.16}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(c_h\)</span> the costs per sampling unit in stratum <span class="math inline">\(h\)</span>. Optimal means that given the total costs this allocation type leads to minimum sampling variance, assuming a linear costs model:</p>
<p><span class="math display" id="eq:linearcostmodel">\[\begin{equation}
C = c_0 + \sum_{h=1}^H n_h c_h \;.
\tag{4.17}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(c_0\)</span> overhead costs. So the more variable a stratum and the lower the costs, the more units will be selected from this stratum.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="STSI.html#cb56-1" aria-hidden="true" tabindex="-1"></a>S2z_h <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="at">X=</span>grdVoorst<span class="sc">$</span>z, <span class="at">INDEX=</span>grdVoorst<span class="sc">$</span>stratum, <span class="at">FUN=</span>var)</span>
<span id="cb56-2"><a href="STSI.html#cb56-2" aria-hidden="true" tabindex="-1"></a>n_h_Neyman <span class="ot">&lt;-</span> <span class="fu">round</span>(n<span class="sc">*</span>N_h<span class="sc">*</span><span class="fu">sqrt</span>(S2z_h)<span class="sc">/</span><span class="fu">sum</span>(N_h<span class="sc">*</span><span class="fu">sqrt</span>(S2z_h)))</span></code></pre></div>
<p>These optimal sample sizes can be computed with function <code>optsize</code> of package <strong>surveyplanning</strong>.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="STSI.html#cb57-1" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(mysample<span class="sc">$</span>stratum))</span>
<span id="cb57-2"><a href="STSI.html#cb57-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">optsize</span>(labels,n,N_h,S2z_h)</span>
<span id="cb57-3"><a href="STSI.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(res<span class="sc">$</span>nh,<span class="dv">0</span>)</span></code></pre></div>
<pre><code>[1] 13  4  8  4 11</code></pre>
<p>Table <a href="STSI.html#tab:tableallocation">4.2</a> shows the proportional and optimal sample sizes for the five strata of the study area Voorst, for a total sample size of 40. Stratum XF is the one-but-smallest stratum and therefore receives only seven sampling units. However, the standard deviation in this stratum is the largest, and as a consequence with optimal allocation the sample size in this stratum is increased by four points, at the cost of stratum EA which is relatively homogeneous.</p>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:tableallocation">Table 4.2: </span>Proportional and Neyman sample sizes in stratified simple random sampling of Voorst with a total sample size of 40. Nh: stratum size; Sh: stratum standard deviation
</caption>
<thead>
<tr>
<th style="text-align:left;">
Stratum
</th>
<th style="text-align:right;">
Nh
</th>
<th style="text-align:right;">
Sh
</th>
<th style="text-align:right;">
nhprop
</th>
<th style="text-align:right;">
nhNeyman
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
BA
</td>
<td style="text-align:right;">
2371
</td>
<td style="text-align:right;">
3.81
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
13
</td>
</tr>
<tr>
<td style="text-align:left;">
EA
</td>
<td style="text-align:right;">
1442
</td>
<td style="text-align:right;">
1.89
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
PA
</td>
<td style="text-align:right;">
1710
</td>
<td style="text-align:right;">
3.04
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
RA
</td>
<td style="text-align:right;">
659
</td>
<td style="text-align:right;">
4.18
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
XF
</td>
<td style="text-align:right;">
1346
</td>
<td style="text-align:right;">
5.25
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
11
</td>
</tr>
</tbody>
</table>
<p>Figure <a href="STSI.html#fig:plotsdmeanallocation">4.5</a> shows the standard error of the estimated population mean as a function of the total sample size for simple random sampling, and stratified simple random sampling with proportional and Neyman allocation for study area Voorst. A small extra gain in precision can be achieved using Neyman allocation instead of proportional allocation. However, in practice often Neyman allocation is not achievable because we do not know the standard deviations of the study variable within the strata. If a quantitative covariate <span class="math inline">\(x\)</span> is used for stratification (see Sections <a href="STSI.html#cumrootf">4.4</a> and <a href="MBpredictionofDesignVariance.html#Ospats">13.2</a>, hereafter), the standard deviations <span class="math inline">\(S_h(z)\)</span> are approximated by <span class="math inline">\(S_h(x)\)</span>, resulting in approximately optimal stratum sample sizes. The gain in precision compared to proportional allocation is then partly or entirely lost.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:plotsdmeanallocation"></span>
<img src="SpatialSampling_files/figure-html/plotsdmeanallocation-1.png" alt="Standard error of estimated population mean as a function of the total sample size, for simple random sampling and stratified simple random sampling with proportional and Neyman allocation." width="100%" />
<p class="caption">
Figure 4.5: Standard error of estimated population mean as a function of the total sample size, for simple random sampling and stratified simple random sampling with proportional and Neyman allocation.
</p>
</div>
<p>Optimal allocation and Neyman allocation assume univariate stratification, i.e. the stratified simple random sample is used to estimate the mean of a single study variable. If we have multiple study variables, optimal allocation becomes more complicated. In Bethel allocation the total sampling costs, assuming a linear costs model (Equation <a href="STSI.html#eq:linearcostmodel">(4.17)</a>), are minimised given a constraint on the precision of the estimated mean for each study variable <span class="citation">(<a href="#ref-Bethel1989" role="doc-biblioref">Bethel 1989</a>)</span>, see Section <a href="STSI.html#MultivariateStratification">4.8</a>. Bethel allocation can be computed with function <code>bethel</code> of package <strong>SamplingStrata</strong> <span class="citation">(<a href="#ref-Barcaroli2020" role="doc-biblioref">G. Barcaroli et al. 2020</a>)</span>.</p>
<div id="exercises-4" class="section level4 unnumbered">
<h4>Exercises</h4>
<ol style="list-style-type: decimal">
<li>Looking at Figure <a href="STSI.html#fig:boxplotsSOMstrata">4.4</a>, which strata do you expect can be merged without losing much precision of the estimated population mean?<br />
</li>
<li>Load the data of Voorst, and use function <code>fct_collapse</code> of package <strong>forcats</strong> <span class="citation">(<a href="#ref-forcats" role="doc-biblioref">Wickham 2020</a>)</span> to merge the strata EA and PA.
<ul>
<li>Compute the true sampling variance of the estimator of the mean for this new stratification, a total sample size of 40 and proportional allocation. Check that the sum of stratum sample sizes is 40. (Hint: compute the population variances of SOM per stratum, and divide these by the stratum sample sizes).<br />
</li>
<li>Compare this true sampling variance with the true sampling variance using the original five strata (same sample size, proportional allocation). What is your conclusion about the new stratification?<br />
</li>
</ul></li>
<li>Proof that the sum of the inclusion probabilities over all populations units with stratified simple random sampling equals the sample size <span class="math inline">\(n\)</span>.</li>
</ol>
</div>
</div>
<div id="cumrootf" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> <em>Cum-root-f</em> stratification</h2>
<p>When we have a quantitative covariate <span class="math inline">\(x\)</span> related to the study variable <span class="math inline">\(z\)</span> and that is known for all units in the population, strata can be constructed with the <em>cum-root-f</em> method using this covariate as a stratification variable, see <span class="citation"><a href="#ref-Dalenius1959" role="doc-biblioref">Dalenius and Hodges</a> (<a href="#ref-Dalenius1959" role="doc-biblioref">1959</a>)</span> and <span class="citation"><a href="#ref-coc77" role="doc-biblioref">Cochran</a> (<a href="#ref-coc77" role="doc-biblioref">1977</a>)</span>. Population units with similar values for the covariate (stratification variable) are grouped into a stratum. Strata are computed as follows:</p>
<ol style="list-style-type: decimal">
<li>Compute a histogram of the stratification variable using a large number of bins.<br />
</li>
<li>Compute the square root of the histogram frequencies.<br />
</li>
<li>Cumulate the square root of the frequencies, i.e. compute <span class="math inline">\(\sqrt{f_1}\)</span>, <span class="math inline">\(\sqrt{f_1} + \sqrt{f_2}\)</span>, <span class="math inline">\(\sqrt{f_1} + \sqrt{f_2} + \sqrt{f_3}\)</span>, etc.<br />
</li>
<li>Divide the cumulative sum of the last bin by the number of strata, multiply this value by 1, 2, <span class="math inline">\(\dots\)</span>, <em>H</em>-1, with <em>H</em> the number of strata, and select the boundaries of the histogram bins closest to these values.</li>
</ol>
<p>In <em>cum-root-f</em> stratification it is assumed that (after linear transformation) the covariate values are nearly perfect predictions of the study variable, so that the prediction errors do not affect the stratification. Under this assumption the stratification is optimal.</p>
<p><em>Cum-root-f</em> stratification is illustrated with the data of Xuancheng (Anhui province, China). We wish to estimate the mean organic matter concentration in the topsoil (SOM, g/kg) of this area. Various covariates are available that are correlated with SOM, such as elevation, yearly average temperature, slope and various other terrain attributes. Elevation (the name of this variable in the data frame is dem) is used as as a single stratification variable, see Figure <a href="STSI.html#fig:DEMXuancheng">4.6</a>. The correlation coefficient of SOM and elevation in a sample of 183 observations is 0.59. The positive correlation can be explained as follows. Temperature is decreasing with elevation, leading to smaller a decomposition rate of organic matter in the soil.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:DEMXuancheng"></span>
<img src="SpatialSampling_files/figure-html/DEMXuancheng-1.png" alt="Elevation used as a stratification variable in cum-root-f stratification." width="80%" />
<p class="caption">
Figure 4.6: Elevation used as a stratification variable in cum-root-f stratification.
</p>
</div>
<p>The strata can be constructed with the package <strong>stratification</strong> <span class="citation">(<a href="#ref-Baillargeon2011" role="doc-biblioref">Baillargeon and Rivest 2011</a>)</span>. Care should be taken that the data are sorted in ascending order by the columns used for stratification, see help of function <code>strata.cumrootf</code>. The argument <code>n</code> of this function is the total sample size, but this value has no effect on the stratification. The argument <code>Ls</code> is the number of strata. I arbitrarily chose to construct five strata. The argument <code>nclass</code> is the number of bins of the histogram. The output object of the function <code>strata.cumrootf</code> is a list containing amongst others a numeric vector with the stratum breaks (<code>bh</code>) and a factor with the stratum levels of the grid cells (<code>stratumID</code>). Finally, note that the values of the stratification variable must be positive. The minimum elevation is -5 m, so we added the absolute value of this minimum to elevation.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="STSI.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stratification)</span>
<span id="cb59-2"><a href="STSI.html#cb59-2" aria-hidden="true" tabindex="-1"></a>grd <span class="ot">&lt;-</span> grd[<span class="fu">order</span>(grd<span class="sc">$</span>dem),]</span>
<span id="cb59-3"><a href="STSI.html#cb59-3" aria-hidden="true" tabindex="-1"></a>dem_new <span class="ot">&lt;-</span> grd<span class="sc">$</span>dem<span class="sc">+</span><span class="fu">abs</span>(<span class="fu">min</span>(grd<span class="sc">$</span>dem))</span>
<span id="cb59-4"><a href="STSI.html#cb59-4" aria-hidden="true" tabindex="-1"></a>crfstrata <span class="ot">&lt;-</span> <span class="fu">strata.cumrootf</span>(<span class="at">x=</span>dem_new, <span class="at">n=</span><span class="dv">100</span>, <span class="at">Ls=</span><span class="dv">5</span>, <span class="at">nclass=</span><span class="dv">500</span>)</span>
<span id="cb59-5"><a href="STSI.html#cb59-5" aria-hidden="true" tabindex="-1"></a>bh <span class="ot">&lt;-</span> crfstrata<span class="sc">$</span>bh</span>
<span id="cb59-6"><a href="STSI.html#cb59-6" aria-hidden="true" tabindex="-1"></a>grd<span class="sc">$</span>crfstrata <span class="ot">&lt;-</span> crfstrata<span class="sc">$</span>stratumID</span></code></pre></div>
<p>Stratum breaks are threshold values of the stratification variable elevation; these stratum breaks are equal to 46.8, 108.4, 216.9, 386.9. Note that the number of stratum breaks is one less than the number of strata. The resulting stratification is shown in Figure <a href="STSI.html#fig:optstrata">4.7</a>. Note that most strata are not single polygons, but are made up of many smaller ones. This may be even more so if the stratification variable shows a noisy spatial pattern. This is not a problem at all, a stratum is just a collection of population units (raster cells), and need not be spatially contiguous.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:optstrata"></span>
<img src="SpatialSampling_files/figure-html/optstrata-1.png" alt="Strata obtained with cum-root-f method, using elevation as stratification variable." width="80%" />
<p class="caption">
Figure 4.7: Strata obtained with cum-root-f method, using elevation as stratification variable.
</p>
</div>
<div id="exercises-5" class="section level4 unnumbered">
<h4>Exercises</h4>
<ol start="4" style="list-style-type: decimal">
<li>Write an <strong>R</strong> script to compute five <em>cum-root-f</em> strata for Eastern Amazonia to estimate the population mean of aboveground biomass (AGB), using log-transformed short-wave infrared (SWIR2) as stratification variable. To speed up the computations use the 5 km <span class="math inline">\(\times\)</span> 5 km subgrid subsampled from the original 1 km <span class="math inline">\(\times\)</span> 1 km grid. This subgrid is in file <code>data/Amazonia_5km.RData</code>.
<ul>
<li>Compute ten <em>cum-root-f</em> strata, using function <code>strata</code> of package <strong>sampling</strong>. Sort the units first in ascending order on lnSWIR2. Use the stratum sample sizes as computed by the function <code>strata.cumrootf</code>. What allocation is used for computing the stratum sample sizes?<br />
</li>
<li>Select a stratified simple random sample of 100 units. First compute the stratum sample sizes for proportional allocation.<br />
</li>
<li>Estimate the population mean of AGB and its sampling variance.<br />
</li>
<li>Compute the true sampling variance of the estimator of the mean for this sampling design (see Exercise 2 for a hint).<br />
</li>
<li>Compute the stratification effect (gain in precision) (Hint: compute the sampling variance for simple random sampling by computing the population variance of AGB, and divide this by the total sample size).</li>
</ul></li>
</ol>
</div>
</div>
<div id="kmeansstratification" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Stratification with multiple covariates</h2>
<p>If we have multiple variables that are possibly related to the study variable, we may want to use them all or a subset of them as stratification variables. Using the quantitative variables one-by-one in <em>cum-root-f</em> stratification, followed by overlaying the maps with univariate strata, may lead to numerous cross-classification strata.</p>
<p>A simple solution is to construct homogeneous groups, referred to as clusters, of population units (raster cells). The units within a cluster are more similar to each other than to the units in other clusters. Various clustering techniques are available. Here I use hard <span class="math inline">\(k\)</span>-means.</p>
<p>This is illustrated again with the Xuancheng case study. Five quantitative covariates are used for constructing the strata. Besides elevation which was used as a single stratification variable in the previous section, now also temperature, slope, topographic wetness index (twi) and profile curvature are used to construct clusters that are used as strata in stratified simple random sampling. To speed up the computations a subgrid with a spacing of 400 m is selected, using function <code>spsample</code> of package <strong>sp</strong>, see Chapter <a href="SY.html#SY">5</a> <span class="citation">(<a href="#ref-Bivand2013" role="doc-biblioref">R. S. Bivand, Pebesma, and Gomez-Rubio 2013</a>)</span>.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="STSI.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb60-2"><a href="STSI.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gridded</span>(grd) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>,<span class="st">&quot;x2&quot;</span>)</span>
<span id="cb60-3"><a href="STSI.html#cb60-3" aria-hidden="true" tabindex="-1"></a>subgrd <span class="ot">&lt;-</span> <span class="fu">spsample</span>(</span>
<span id="cb60-4"><a href="STSI.html#cb60-4" aria-hidden="true" tabindex="-1"></a>  grd, <span class="at">type=</span><span class="st">&quot;regular&quot;</span>, <span class="at">cellsize=</span><span class="fl">0.4</span>, <span class="at">offset=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb60-5"><a href="STSI.html#cb60-5" aria-hidden="true" tabindex="-1"></a>subgrd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">coordinates</span>(subgrd), <span class="fu">over</span>(subgrd,grd))</span></code></pre></div>
<p>Five clusters are computed with <span class="math inline">\(k\)</span>-means using as clustering variables elevation (dem), temperature, slope, profile curvature and topographic wetness index (twi). The scale of the five covariates is largely different, and for that reason they must be scaled before being used in clustering. The <span class="math inline">\(k\)</span>-means algorithm is a deterministic algorithm, i.e. the same initial clustering will end in the same final, optimised clustering. This final clustering can be suboptimal, and therefore it is recommended to repeat the clustering as many times as feasible, with different initial clusterings. Argument <code>nstart</code> is the number of initial clusterings. The best clustering, i.e. the one with the smallest within-cluster sum-of-squares, is kept.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="STSI.html#cb61-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;dem&quot;</span>,<span class="st">&quot;temperature&quot;</span>,<span class="st">&quot;slope&quot;</span>,<span class="st">&quot;profile.curvature&quot;</span>,<span class="st">&quot;twi&quot;</span>)</span>
<span id="cb61-2"><a href="STSI.html#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb61-3"><a href="STSI.html#cb61-3" aria-hidden="true" tabindex="-1"></a>myClusters <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(</span>
<span id="cb61-4"><a href="STSI.html#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>(subgrd[,x]), <span class="at">centers=</span><span class="dv">5</span>, <span class="at">iter.max=</span><span class="dv">1000</span>, <span class="at">nstart=</span><span class="dv">100</span>)</span>
<span id="cb61-5"><a href="STSI.html#cb61-5" aria-hidden="true" tabindex="-1"></a>subgrd<span class="sc">$</span>cluster <span class="ot">&lt;-</span> myClusters<span class="sc">$</span>cluster</span></code></pre></div>
<p>Figure <a href="STSI.html#fig:kmeansstrataXuancheng">4.8</a> shows the five strata obtained by the <span class="math inline">\(k\)</span>-means clustering of the raster cells.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:kmeansstrataXuancheng"></span>
<img src="SpatialSampling_files/figure-html/kmeansstrataXuancheng-1.png" alt="Five $k$-means clusters using five scaled covariates in clustering, to be used as strata in random sampling from study area Xuancheng." width="80%" />
<p class="caption">
Figure 4.8: Five <span class="math inline">\(k\)</span>-means clusters using five scaled covariates in clustering, to be used as strata in random sampling from study area Xuancheng.
</p>
</div>
<p>The size of the clusters (strata) is largely different among the strata (Table <a href="STSI.html#tab:tablekmeansstrata">4.3</a>). This table also shows means of the unscaled covariates used in clustering.</p>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:tablekmeansstrata">Table 4.3: </span>Total number of raster cells (Nh) and means of clustering variables of the five strata in Xuancheng obtained with k-means clustering of raster cells.
</caption>
<thead>
<tr>
<th style="text-align:right;">
Stratum
</th>
<th style="text-align:right;">
Nh
</th>
<th style="text-align:right;">
Elevation
</th>
<th style="text-align:right;">
Temperature
</th>
<th style="text-align:right;">
Slope
</th>
<th style="text-align:right;">
Profilecurv
</th>
<th style="text-align:right;">
Twi
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
16032
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
15.44
</td>
<td style="text-align:right;">
2.09
</td>
<td style="text-align:right;">
0.00001
</td>
<td style="text-align:right;">
9.25
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5312
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
15.60
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.00006
</td>
<td style="text-align:right;">
17.16
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1650
</td>
<td style="text-align:right;">
308
</td>
<td style="text-align:right;">
14.43
</td>
<td style="text-align:right;">
12.78
</td>
<td style="text-align:right;">
-0.00143
</td>
<td style="text-align:right;">
6.29
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4184
</td>
<td style="text-align:right;">
176
</td>
<td style="text-align:right;">
14.66
</td>
<td style="text-align:right;">
10.67
</td>
<td style="text-align:right;">
0.00066
</td>
<td style="text-align:right;">
7.78
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1710
</td>
<td style="text-align:right;">
401
</td>
<td style="text-align:right;">
13.74
</td>
<td style="text-align:right;">
20.90
</td>
<td style="text-align:right;">
0.00019
</td>
<td style="text-align:right;">
6.54
</td>
</tr>
</tbody>
</table>
<p>In the situation that we already have some data of the study variable, an alternative solution is to calibrate a model for the study variable, for instance a multiple linear regression model, using the covariates as predictors, and to use the predictions of the study variable as a single stratification variable in <em>cum-root-f</em> stratification or in optimal spatial stratification, see Section <a href="MBpredictionofDesignVariance.html#Ospats">13.2</a>.</p>
</div>
<div id="geostrata" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Geographical stratification</h2>
<p>When no covariate is available, we may still decide to apply a <em>geographical stratification</em>. For instance, a square study area can be divided into <span class="math inline">\(4 \times 4\)</span> equally sized subsquares that are used as strata. When we select one or two points per subsquare, we avoid strong spatial clustering of the sampling points. Geographical stratification improves the <em>spatial coverage</em>. When the study variable is spatially structured, think for instance of a spatial trend, then geographical stratification will lead to more precisely estimated means (smaller sampling variances).</p>
<p>A simple method for constructing geographical strata is <span class="math inline">\(k\)</span>-means clustering <span class="citation">(<a href="#ref-bru99" role="doc-biblioref">Brus, Spätjens, and de Gruijter 1999</a>)</span>. See Chapter <a href="SpatialCoverage.html#SpatialCoverage">18</a> for a simple illustrative example of how geographical strata are computed with <span class="math inline">\(k\)</span>-means clustering. In this approach the study area is discretised by a large number of pixels (raster cells). These pixels are the objects that are clustered. The clustering variables are simply the s1-coordinate (Easting) and s2-coordinate (Northing) of the centers of the pixels. This method leads to compact geographical strata, shortly referred to as geostrata. Geostrata can be computed, as in Section <a href="STSI.html#kmeansstratification">4.5</a>, with function <code>kmeans</code>. The two clustering variables have the same scale, so they should not be scaled because this would lead to an arbitrary distortion of geographical distances. The geostrata generally will not have the same area (number of pixels). Geostrata of equal area can be attractive, as then the sample becomes selfweighting, i.e. the sample mean is an unbiased estimator of the population mean.</p>
<p>Geostrata of the same area can be computed with function <code>stratify</code> of the package <strong>spcosa</strong> <span class="citation">(<a href="#ref-walvoort2010" role="doc-biblioref">Walvoort, Brus, and Gruijter 2010</a>)</span>, with argument <code>equalArea=TRUE</code><a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a>.
<span class="citation"><a href="#ref-walvoort2010" role="doc-biblioref">Walvoort, Brus, and Gruijter</a> (<a href="#ref-walvoort2010" role="doc-biblioref">2010</a>)</span> describe the <span class="math inline">\(k\)</span>-means algorithms implemented in this package in detail. The argument <code>object</code> of function <code>stratify</code> specifies a spatial object of the population units. In the <strong>R</strong> code below the data frame <code>grdVoorst</code> is changed into a <code>SpatialPixelsDataFrame</code> with function <code>gridded</code> of the package <strong>sp</strong>. The spatial object can also be of class <code>SpatialPolygons</code>. In that case either argument <code>nGridCells</code> or argument <code>cellSize</code> must be set, so that the vector map in <code>object</code> can be discretised by a finite number of grid cells. Argument <code>nTry</code> specifies the number of initial stratifications in <span class="math inline">\(k\)</span>-means clustering, and so is comparable with argument <code>nstart</code> of function <code>kmeans</code>. For more details on spatial stratification using <span class="math inline">\(k\)</span>-means clustering, see Chapter <a href="SpatialCoverage.html#SpatialCoverage">18</a>. The <span class="math inline">\(k\)</span>-means algorithm used with <code>equalArea=TRUE</code> takes much more computing time than the one used with <code>equalArea=FALSE</code>.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="STSI.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spcosa)</span>
<span id="cb62-2"><a href="STSI.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb62-3"><a href="STSI.html#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb62-4"><a href="STSI.html#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gridded</span>(subgrd) <span class="ot">&lt;-</span> <span class="er">~</span>x1<span class="sc">+</span>x2</span>
<span id="cb62-5"><a href="STSI.html#cb62-5" aria-hidden="true" tabindex="-1"></a>mygeostrata <span class="ot">&lt;-</span> <span class="fu">stratify</span>(</span>
<span id="cb62-6"><a href="STSI.html#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">object=</span>subgrd, <span class="at">nStrata=</span><span class="dv">50</span>, <span class="at">nTry=</span><span class="dv">1</span>, <span class="at">equalArea=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Function <code>spsample</code> of package <strong>spcosa</strong> is used to select from each geostratum a simple random sample of two points.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="STSI.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb63-2"><a href="STSI.html#cb63-2" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> spcosa<span class="sc">::</span><span class="fu">spsample</span>(mygeostrata, <span class="at">n=</span><span class="dv">2</span>)</span>
<span id="cb63-3"><a href="STSI.html#cb63-3" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> <span class="fu">as</span>(mysample, <span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb63-4"><a href="STSI.html#cb63-4" aria-hidden="true" tabindex="-1"></a>mygeostrata <span class="ot">&lt;-</span> <span class="fu">as</span>(mygeostrata,  <span class="st">&quot;data.frame&quot;</span>)</span></code></pre></div>
<p>The operator <code>%&gt;%</code> of package <strong>magrittr</strong> <span class="citation">(<a href="#ref-magrittr" role="doc-biblioref">Bache and Wickham 2014</a>)</span> can be used to merge the two lines in the code chunk above. In this way we can save memory, as we do not need an object of the class <code>SamplingPatternRandomSamplingUnits</code> obtained with function <code>spsample</code>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="STSI.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb64-2"><a href="STSI.html#cb64-2" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> spcosa<span class="sc">::</span><span class="fu">spsample</span>(mygeostrata, <span class="at">n=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">as</span>(.,<span class="st">&quot;data.frame&quot;</span>)</span></code></pre></div>
<p>Figure <a href="STSI.html#fig:GeoStrata">4.9</a> shows 20 compact geostrata of equal area of Voorst with the selected sampling points. Note that the sampling points are reasonably well spread throughout the study area.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:GeoStrata"></span>
<img src="SpatialSampling_files/figure-html/GeoStrata-1.png" alt="Compact geostrata of equal size in Xuancheng, and stratified simple random sample of two points per stratum." width="80%" />
<p class="caption">
Figure 4.9: Compact geostrata of equal size in Xuancheng, and stratified simple random sample of two points per stratum.
</p>
</div>
<p>Once the observations are done, the population mean can be estimated with function <code>estimate</code>. For Xuancheng I simulated data from a normal distribution, to illustrate estimation with function <code>estimate</code>. Various statistics can be estimated, among which the population mean (spatial mean), the standard error, and the cumulative distribution function (CDF). The CDF is estimated by transforming the data to indicators (Section <a href="SI.html#CDF">3.1.2</a>).</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="STSI.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spcosa)</span>
<span id="cb65-2"><a href="STSI.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file=</span><span class="st">&quot;results/geostrata_Xuancheng.RData&quot;</span>)</span>
<span id="cb65-3"><a href="STSI.html#cb65-3" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> spcosa<span class="sc">::</span><span class="fu">spsample</span>(mygeostrata, <span class="at">n=</span><span class="dv">2</span>)</span>
<span id="cb65-4"><a href="STSI.html#cb65-4" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">z=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean=</span><span class="dv">10</span>, <span class="at">sd=</span><span class="dv">2</span>))</span>
<span id="cb65-5"><a href="STSI.html#cb65-5" aria-hidden="true" tabindex="-1"></a>mean <span class="ot">&lt;-</span> <span class="fu">estimate</span>(</span>
<span id="cb65-6"><a href="STSI.html#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;spatial mean&quot;</span>, mygeostrata, mysample, <span class="at">data=</span>mydata)</span>
<span id="cb65-7"><a href="STSI.html#cb65-7" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">estimate</span>(</span>
<span id="cb65-8"><a href="STSI.html#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;standard error&quot;</span>, mygeostrata, mysample, <span class="at">data=</span>mydata)</span>
<span id="cb65-9"><a href="STSI.html#cb65-9" aria-hidden="true" tabindex="-1"></a>cdf <span class="ot">&lt;-</span> <span class="fu">estimate</span>(</span>
<span id="cb65-10"><a href="STSI.html#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;scdf&quot;</span>, mygeostrata, mysample, <span class="at">data=</span>mydata)</span></code></pre></div>
<p>The estimated population mean equals 9.82, with an estimated standard error of 0.192.</p>
<div id="exercises-6" class="section level4 unnumbered">
<h4>Exercises</h4>
<ol start="5" style="list-style-type: decimal">
<li>Why is it attractive to select at least two points per geostratum?<br />
</li>
<li>The alternative to 20 geostrata and two points per geostratum is 40 geostrata and one point per geostratum. Which sampling strategy will be more precise?<br />
</li>
<li>The geostrata in the figure above have equal area, which can be enforced by argument <code>equalArea=TRUE</code>. Why are equal areas attractive? Work out the estimator of the population mean for strata of equal size.<br />
</li>
<li>Write an <strong>R</strong> script to construct 20 compact geographical strata of equal area for agricultural field Leest. Read the shapefile <code>Leest5</code> using function <code>readOGR</code> of the package <strong>rgdal</strong>. Remove the projection attributes with <code>proj4string(shpField) &lt;- NA_character_</code>. Select two points per geostratum, using function <code>spsample</code> of package <strong>spcosa</strong>. Repeat this with 40 strata of equal area, and randomly select one point per stratum.
<ul>
<li>If only one point per stratum is selected, the sampling variance can be approximated by the collapsed strata estimator. In this method pairs of strata are formed, and the two strata of a pair are joined. In each new stratum we now have two points. With an odd number of strata there will be one group of three strata and three points. The sample is then analyzed as if it were a random sample from the new collapsed strata. Suppose we group the strata on the basis of the measurements of the study variable. Do you think this is a proper way of grouping?<br />
</li>
<li>In case you think this is not a proper way of grouping the strata, how would you group the strata?<br />
</li>
<li>Will the estimated sampling variance estimator be unbiased? If not, will it be overestimated or underestimated?<br />
</li>
</ul></li>
<li>Laboratory costs for measuring the study variable can be saved by bulking the soil aliquots (composite sampling). There are two options: bulking all soil aliquots from the same stratum (bulking within strata) or bulking by selecting one aliquot from each stratum (bulking across strata). In <strong>spcosa</strong> bulking across strata is implemented. Write an <strong>R</strong> script to construct 20 compact geographical strata for study area Voorst. Use the argument <code>equalArea = TRUE</code>. Select four points per stratum using argument <code>type="composite"</code>, and change class of resulting object in <code>SpatialPoints</code>. Extract the z-values in grdVoorst at the selected sampling points using function <code>over</code>. Add a column to the resulting data frame indicating the composite (points 1 to 4 are from the first stratum, points 5 to 8 from the second stratum, etc.), and estimate the means for the four composites using function <code>tapply</code>. Estimate the population mean and its standard error.
<ul>
<li>Can the sampling variance of the estimator of the mean be estimated for bulking within the strata?<br />
</li>
<li>The alternative to analyzing the concentration of four composite samples obtained by bulking across strata is to analyze all <span class="math inline">\(20 \times 4\)</span> aliquots separately. The strata have equal area, so the inclusion probabilities are equal. As a consequence the sample mean is an unbiased estimator of the population mean. Is the precision of this estimated population mean equal to the estimated population mean with composite sampling? If not, is it smaller or larger, and why?<br />
</li>
<li>If you use argument <code>equalArea = FALSE</code> in combination with argument <code>type="composite"</code>, you get an error message. Why does this not work?</li>
</ul></li>
</ol>
</div>
</div>
<div id="multi-way-stratification" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Multi-way stratification</h2>
<p>In Section <a href="STSI.html#kmeansstratification">4.5</a> multiple continuous covariates are used to construct clusters of raster cells using k-means. These clusters are then used as strata. This section considers the case where we have multiple categorical and/or continuous variables that we would like to use as stratification variables. The continuous stratification variables are first used to compute strata based on that stratification variable, e.g. using the <em>cumroot-f</em> method. What could be done then is to compute the cross-classification of each unit, and use these cross-classifications as strata in random sampling. However, this may lead to numerous strata, maybe even more than the intended sample size. To reduce the total number of strata, we may aggregate cross-classification strata with similar means of the study variable, based on our prior knowledge.</p>
<p>An alternative to aggregation of cross-classification strata is to use the separate strata, i.e. the strata based on an individual stratification variable, as <em>marginal</em> strata in random sampling, instead of using the cross-classifications as strata. How this works is explained in Section <a href="BalancedSpreaded.html#Multiwaystratification">9.1.4</a>.</p>
</div>
<div id="MultivariateStratification" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Multivariate stratification</h2>
<p>Another situation is where we have multiple study variables, and we would like to optimise the stratification and allocation for estimating the population means of all study variables. Optimal stratification for multiple study variables is only relevant if we would like to use different stratification variables for the study variables. In many cases we do not have reliable prior information about the different study variables justifying the use of multiple stratification variables. We are already happy to have one stratification variable that may serve to increase the precision of the estimated means of all study variables.</p>
<p>However in case we do have multiple stratification variables, tailored at different study variables, the aim is to partition the population in strata, so that for a given allocation, the total sampling costs, assuming a linear costs model (Equation <a href="STSI.html#eq:linearcostmodel">(4.17)</a>), is minimised given a constraint on the precision of the estimated mean for each study variable.</p>
<p>Package <strong>SamplingStrata</strong> <span class="citation">(<a href="#ref-Barcaroli2020" role="doc-biblioref">G. Barcaroli et al. 2020</a>)</span> can be used to optimise multivariate strata. <span class="citation"><a href="#ref-Barcaroli2014" role="doc-biblioref">Giulio Barcaroli</a> (<a href="#ref-Barcaroli2014" role="doc-biblioref">2014</a>)</span> gives details about the objective function and the algorithm used for optimising the strata. Sampling units are allocated to the strata by Bethel allocation <span class="citation">(<a href="#ref-Bethel1989" role="doc-biblioref">Bethel 1989</a>)</span>. The required precision is specified in terms of a coefficient of variation, one per per study variable.</p>
<p>Multivariate stratification is illustrated with the Meuse data set of package <strong>gstat</strong> <span class="citation">(<a href="#ref-peb04" role="doc-biblioref">Pebesma 2004</a>)</span>. The prior data of heavy metal concentrations of Cd and Zn, are used in spatial prediction, to create maps of these two study variables. These predictions of the study variables are used as stratification variables in designing a new sample for design-based estimation of the population means of Cd and Zn.</p>
<p>The maps of natural logarithms of the two metal concentrations are created by kriging with an external drift, using the square root of the distance to the Meuse river as a predictor for the mean, see Section <a href="Introkriging.html#IntroKED">22.2</a> for how this spatial prediction method works.</p>
<p>Figure <a href="STSI.html#fig:PredictedCd">4.10</a> shows the map with the predicted log Cd and log Zn concentration.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:PredictedCd"></span>
<img src="SpatialSampling_files/figure-html/PredictedCd-1.png" alt="Kriging predictions of natural logarithms of Cd and Zn concentration in study area Meuse (Netherlands), used as stratification variable in bivariate stratification." width="100%" />
<p class="caption">
Figure 4.10: Kriging predictions of natural logarithms of Cd and Zn concentration in study area Meuse (Netherlands), used as stratification variable in bivariate stratification.
</p>
</div>
<p>The predicted log concentrations of the two heavy metal concentrations are used as stratification variables. For the log of Cd there are negative predicted concentrations (Figure <a href="STSI.html#fig:PredictedCd">4.10</a>). This leads to an error when running function <code>optimStrata</code>. The minimum predicted log Cd concentration is -1.7, so I added 2 to the predictions. A variable indicating the domains of interest is added to the data frame. The value of this variable is 1 for all grid cells, so that a sample is designed for estimating the mean of the entire population. As a first step function <code>buildFrameDF</code> is used to create a data frame that can be handled by function <code>optimStrata</code>. Argument <code>X</code> specifies the stratification variables, and argument <code>Y</code> the study variables. In our case the stratification variables and the study variables are the same. This is typical for the situation where the stratification variables are obtained by mapping the study variables.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="STSI.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SamplingStrata)</span>
<span id="cb66-2"><a href="STSI.html#cb66-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cd=</span>lcd_kriged<span class="sc">$</span>var1.pred,</span>
<span id="cb66-3"><a href="STSI.html#cb66-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">zn=</span>lzn_kriged<span class="sc">$</span>var1.pred)</span>
<span id="cb66-4"><a href="STSI.html#cb66-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>cd <span class="ot">&lt;-</span> df<span class="sc">$</span>cd<span class="sc">+</span><span class="dv">2</span></span>
<span id="cb66-5"><a href="STSI.html#cb66-5" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>dom <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(df))</span>
<span id="cb66-6"><a href="STSI.html#cb66-6" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df))</span>
<span id="cb66-7"><a href="STSI.html#cb66-7" aria-hidden="true" tabindex="-1"></a>frame <span class="ot">&lt;-</span> <span class="fu">buildFrameDF</span>(</span>
<span id="cb66-8"><a href="STSI.html#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">df=</span>df, <span class="at">id=</span><span class="st">&quot;id&quot;</span>,</span>
<span id="cb66-9"><a href="STSI.html#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">X=</span><span class="fu">c</span>(<span class="st">&quot;cd&quot;</span>,<span class="st">&quot;zn&quot;</span>), <span class="at">Y=</span><span class="fu">c</span>(<span class="st">&quot;cd&quot;</span>,<span class="st">&quot;zn&quot;</span>),</span>
<span id="cb66-10"><a href="STSI.html#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">domainvalue=</span><span class="st">&quot;dom&quot;</span>)</span></code></pre></div>
<p>Next, a data frame with the precision requirements for the estimated means is created. The precision requirement is given as a coefficient of variation, i.e. the standard error of the estimated population mean, divided by the estimated mean. The study variables as specified in <code>Y</code> are used to compute estimated means and the standard errors for a given stratification and allocation.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="STSI.html#cb67-1" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb67-2"><a href="STSI.html#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">DOM=</span><span class="st">&quot;DOM1&quot;</span>, <span class="at">CV1=</span><span class="fl">0.02</span>, <span class="at">CV2=</span><span class="fl">0.02</span>, <span class="at">domainvalue=</span><span class="dv">1</span>))</span></code></pre></div>
<p>Finally, the multivariate stratification is optimised, by optimising the stratum bounds, using a genetic algorithm <span class="citation">(<a href="#ref-ger99" role="doc-biblioref">Gershenfeld 1999</a>)</span>.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="STSI.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb68-2"><a href="STSI.html#cb68-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">optimStrata</span>(</span>
<span id="cb68-3"><a href="STSI.html#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">method=</span><span class="st">&quot;continuous&quot;</span>,  <span class="at">errors=</span>cv, <span class="at">framesamp=</span>frame, <span class="at">nStrata=</span><span class="dv">5</span>, </span>
<span id="cb68-4"><a href="STSI.html#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter=</span><span class="dv">50</span>, <span class="at">pops=</span><span class="dv">20</span>, <span class="at">showPlot=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>A summary of the strata can be obtained with function <code>summaryStrata</code>.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="STSI.html#cb69-1" aria-hidden="true" tabindex="-1"></a>smrstrata <span class="ot">&lt;-</span> <span class="fu">summaryStrata</span>(</span>
<span id="cb69-2"><a href="STSI.html#cb69-2" aria-hidden="true" tabindex="-1"></a>  res<span class="sc">$</span>framenew, res<span class="sc">$</span>aggr_strata, <span class="at">progress=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>  Stratum Population Allocation Lower_X1 Upper_X1 Lower_X2 Upper_X2
1       1        717          7    0.266    1.421    4.502    5.576
2       2        694          5    1.421    2.090    4.950    6.010
3       3        597          3    2.091    2.630    5.163    6.358
4       4        704          6    2.630    3.476    5.472    6.802
5       5        391          5    3.480    4.781    6.234    7.527</code></pre>
<p>The column <code>Population</code> is the size of the strata (number of pixels). The total sample size equals 26. The sample sizes per stratum are computed with Bethel allocation, see Section <a href="STSI.html#STSIallocation">4.3</a>. The last four columns contain the lower and upper bounds of the orthogonal intervals.</p>
<p>Figure <a href="STSI.html#fig:2dplotbivariatestrata">4.11</a> shows a 2D-plot of the bivariate strata. The strata can be plotted as a series of nested rectangles. All population units in the smallest rectangle belong to stratum 1; all units in the one-but-smallest rectangle that are not in the smallest rectangle belong to stratum 2, etc. If we have more than two stratification variables the strata form a series of nested hyperrectangles or boxes. The strata are obtained as the Cartesian product of orthogonal intervals.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="STSI.html#cb71-1" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> <span class="fu">plotStrata2d</span>(</span>
<span id="cb71-2"><a href="STSI.html#cb71-2" aria-hidden="true" tabindex="-1"></a>  res<span class="sc">$</span>framenew, res<span class="sc">$</span>aggr_strata, <span class="at">domain=</span><span class="dv">1</span>, </span>
<span id="cb71-3"><a href="STSI.html#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars=</span><span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;X2&quot;</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Cd&quot;</span>,<span class="st">&quot;Zn&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:2dplotbivariatestrata"></span>
<img src="SpatialSampling_files/figure-html/2dplotbivariatestrata-1.png" alt="Optimised bivariate strata for study area Meuse." width="80%" />
<p class="caption">
Figure 4.11: Optimised bivariate strata for study area Meuse.
</p>
</div>
<p>It may happen that during the optimisation of the stratum bounds in some resulting strata no units are contained. If the solution with a smaller number of strata requires fewer sampling units, then this is retained as the optimal stratification (personal communication Giulio Barcaroli).</p>
<p>Figure <a href="STSI.html#fig:OptimisedstrataMeuse">4.12</a> shows a map of the optimised strata.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:OptimisedstrataMeuse"></span>
<img src="SpatialSampling_files/figure-html/OptimisedstrataMeuse-1.png" alt="Optimised bivariate strata for study area Meuse." width="70%" />
<p class="caption">
Figure 4.12: Optimised bivariate strata for study area Meuse.
</p>
</div>
<p>The expected coefficient of variation can be extracted with function <code>expected_CV</code>.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="STSI.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">expected_CV</span>(res<span class="sc">$</span>aggr_strata)</span></code></pre></div>
<pre><code>     cv(Y1) cv(Y2)
DOM1   0.02  0.009</code></pre>
<p>The coefficient of variation of Cd is indeed equal to the desired level of 0.02, for Zn it is smaller. So in this case Cd is the study variable that determines the total sample size of 26 units.</p>
<p>Note that these coefficients of variation are computed from the stratification variables, which are predictions of the study variable. Errors in these predictions are not accounted for. It is well-known that kriging is a smoother, so that the variance of the predicted values within a stratum is smaller than the variance of the true values. As a consequence the coefficient of variation underestimates the coefficient of variation of the study variable. See Section <a href="MBpredictionofDesignVariance.html#Ospats">13.2</a> for how prediction errors and spatial correlation of prediction errors can be accounted for in optimal stratification. An additional problem is that I added a value of 2 to the log Cd concentrations. This does not affect the standard error of the estimated mean, but does effect the estimated mean, so that also for this reason the coefficient of variation is underestimated.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-magrittr" class="csl-entry">
Bache, Stefan Milton, and Hadley Wickham. 2014. <em><span class="nocase">magrittr: A Forward-Pipe Operator for R</span></em>. <a href="https://CRAN.R-project.org/package=magrittr">https://CRAN.R-project.org/package=magrittr</a>.
</div>
<div id="ref-Baillargeon2011" class="csl-entry">
Baillargeon, S., and L.-P. Rivest. 2011. <span>“<span class="nocase">The construction of stratified designs in R with the package stratification</span>.”</span> <em>Survey Methodology</em> 37: 53–65.
</div>
<div id="ref-Barcaroli2020" class="csl-entry">
Barcaroli, G., M. Ballin, H. Odendaal, D. Pagliuca, E. Willighagen, and D. Zardetto. 2020. <em><span class="nocase">SamplingStrata: Optimal Stratification of Sampling Frames for Multipurpose Sampling Surveys</span></em>. <a href="{https://cran.r-project.org/package=SamplingStrata}">{https://cran.r-project.org/package=SamplingStrata}</a>.
</div>
<div id="ref-Barcaroli2014" class="csl-entry">
Barcaroli, Giulio. 2014. <span>“<span class="nocase">SamplingStrata: An R Package for the optimisation of Stratified Sampling</span>.”</span> <em>Journal of Statistical Software</em> 61 (4). <a href="https://doi.org/10.18637/jss.v061.i04">https://doi.org/10.18637/jss.v061.i04</a>.
</div>
<div id="ref-Bethel1989" class="csl-entry">
Bethel, J. 1989. <span>“<span class="nocase">Sample allocation in multiple surveys</span>.”</span> <em>Survey Methodology</em> 15 (1): 47–57.
</div>
<div id="ref-Bivand2013" class="csl-entry">
Bivand, Roger S., Edzer Pebesma, and Virgilio Gomez-Rubio. 2013. <em>Applied Spatial Data Analysis with <span>R</span>, Second Edition</em>. Springer, NY. <a href="https://asdar-book.org/">https://asdar-book.org/</a>.
</div>
<div id="ref-surveyplanning" class="csl-entry">
Breidaks, Juris, Martins Liberts, and Janis Jukams. 2020. <em><span class="nocase">surveyplanning</span>: Survey Planning Tools</em>. Riga, Latvia: Central Statistical Bureau of Latvia. <a href="https://csblatvia.github.io/surveyplanning/">https://csblatvia.github.io/surveyplanning/</a>.
</div>
<div id="ref-bru99" class="csl-entry">
Brus, D. J., L. E. E. M. Spätjens, and J. J. de Gruijter. 1999. <span>“A Sampling Scheme for Estimating the Mean Extractable Phosphorus Concentration of Fields for Environmental Regulation.”</span> <em>Geoderma</em> 89: 129–48.
</div>
<div id="ref-coc77" class="csl-entry">
Cochran, W. G. 1977. <em>Sampling Techniques</em>. New York: Wiley.
</div>
<div id="ref-Dalenius1959" class="csl-entry">
Dalenius, T., and J. L. Hodges. 1959. <span>“Minimum Variance Stratification.”</span> <em>Journal of the American Statistical Association</em> 54 (285): 88–101. <a href="https://doi.org/10.2307/2282141">https://doi.org/10.2307/2282141</a>.
</div>
<div id="ref-gru06" class="csl-entry">
de Gruijter, J. J., D. J. Brus, M. F. P. Bierkens, and M. Knotters. 2006. <em>Sampling for Natural Resource Monitoring</em>. Berlin: Springer.
</div>
<div id="ref-ger99" class="csl-entry">
Gershenfeld, N. 1999. <em>The Nature of Mathematical Modeling</em>. Cambridge: Cambridge University Press.
</div>
<div id="ref-loh99" class="csl-entry">
Lohr, S. L. 1999. <em>Sampling: Design and Analysis</em>. Pacific Grove, USA: Duxbury Press.
</div>
<div id="ref-Lumley2020" class="csl-entry">
Lumley, T. 2020. <em><span class="nocase">survey: analysis of complex survey samples</span></em>.
</div>
<div id="ref-nan04" class="csl-entry">
Nanthakumar, A., and K. Selvavel. 2004. <span>“Estimation of Proportion of Success from a Stratified Population: A Comparative Study.”</span> <em>Communications in Statistics</em> 33: 2245–57.
</div>
<div id="ref-peb04" class="csl-entry">
Pebesma, E. J. 2004. <span>“Multivariable Geostatistics in <span>S</span>: The Gstat Package.”</span> <em>Computers &amp; Geosciences</em> 30: 683–91.
</div>
<div id="ref-sar92" class="csl-entry">
Särndal, C. E., B. Swensson, and J. Wretman. 1992. <em>Model Assisted Survey Sampling</em>. New York: Springer.
</div>
<div id="ref-Tille2016" class="csl-entry">
Tillé, Y., and A. Matei. 2016. <em><span class="nocase">sampling: Survey Sampling</span></em>. <a href="https://CRAN.R-project.org/package=sampling">https://CRAN.R-project.org/package=sampling</a>.
</div>
<div id="ref-walvoort2010" class="csl-entry">
Walvoort, D. J. J., D. J. Brus, and J. J. de Gruijter. 2010. <span>“An <span>R</span> Package for Spatial Coverage Sampling and Random Sampling from Compact Geographical Strata by k-Means.”</span> <em>Computers and Geosciences</em> 36: 1261–67. <a href="https://doi.org/10.1016/j.cageo.2010.04.005">https://doi.org/10.1016/j.cageo.2010.04.005</a>.
</div>
<div id="ref-forcats" class="csl-entry">
Wickham, Hadley. 2020. <em><span class="nocase">forcats: Tools for Working with Categorical Variables (Factors)</span></em>. <a href="https://CRAN.R-project.org/package=forcats">https://CRAN.R-project.org/package=forcats</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="7">
<li id="fn7"><p>The sampling fractions are usually slightly different, even with proportional allocation (Section <a href="STSI.html#STSIallocation">4.3</a>) because <span class="math inline">\(n_h/N_h\)</span> cannot be made exactly equal for all strata.<a href="STSI.html#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>An estimator is consistent if the estimate becomes exactly equal to the population value when <span class="math inline">\(n=N\)</span> <span class="citation">(<a href="#ref-coc77" role="doc-biblioref">Cochran 1977</a>)</span>.<a href="STSI.html#fnref8" class="footnote-back">↩︎</a></p></li>
<li id="fn9"><p>If the total number of pixels divided by the number of strata is an integer, the stratum sizes are exactly equal, otherwise the difference is 1 pixel.<a href="STSI.html#fnref9" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="SI.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="SY.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-STSI.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SpatialSampling.pdf", "SpatialSampling.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
