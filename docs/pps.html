<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Sampling with probabilities proportional to size | Spatial sampling with R</title>
  <meta name="description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Sampling with probabilities proportional to size | Spatial sampling with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.pdf" />
  <meta property="og:description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="github-repo" content="DickBrus/SpatialSamplingwithR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Sampling with probabilities proportional to size | Spatial sampling with R" />
  
  <meta name="twitter:description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="twitter:image" content="/images/cover.pdf" />

<meta name="author" content="Dick J. Brus" />


<meta name="date" content="2022-03-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Twostage.html"/>
<link rel="next" href="BalancedSpreaded.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial sampling with R</a></li>

<li class="divider"></li>
<li><a href="index.html#preface">Preface<span></span></a>
<ul>
<li><a href="index.html#acknowledgments">Acknowledgments<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="GeneralIntro.html"><a href="GeneralIntro.html"><i class="fa fa-check"></i><b>1</b> Introduction<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="GeneralIntro.html"><a href="GeneralIntro.html#BasicConcepts"><i class="fa fa-check"></i><b>1.1</b> Basic sampling concepts<span></span></a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="GeneralIntro.html"><a href="GeneralIntro.html#PopulationParameters"><i class="fa fa-check"></i><b>1.1.1</b> Population parameters<span></span></a></li>
<li class="chapter" data-level="1.1.2" data-path="GeneralIntro.html"><a href="GeneralIntro.html#descriptive-statistics-vs.-inference-about-a-population"><i class="fa fa-check"></i><b>1.1.2</b> Descriptive statistics vs. inference about a population<span></span></a></li>
<li class="chapter" data-level="1.1.3" data-path="GeneralIntro.html"><a href="GeneralIntro.html#random-sampling-vs.-probability-sampling"><i class="fa fa-check"></i><b>1.1.3</b> Random sampling vs. probability sampling<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="GeneralIntro.html"><a href="GeneralIntro.html#DBvsMB"><i class="fa fa-check"></i><b>1.2</b> Design-based vs. model-based approach<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="GeneralIntro.html"><a href="GeneralIntro.html#Datasets"><i class="fa fa-check"></i><b>1.3</b> Populations used in sampling experiments<span></span></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="GeneralIntro.html"><a href="GeneralIntro.html#Voorst"><i class="fa fa-check"></i><b>1.3.1</b> Soil organic matter in Voorst, the Netherlands<span></span></a></li>
<li class="chapter" data-level="1.3.2" data-path="GeneralIntro.html"><a href="GeneralIntro.html#Poppy"><i class="fa fa-check"></i><b>1.3.2</b> Poppy fields in Kandahar, Afghanistan<span></span></a></li>
<li class="chapter" data-level="1.3.3" data-path="GeneralIntro.html"><a href="GeneralIntro.html#Amazonia"><i class="fa fa-check"></i><b>1.3.3</b> Aboveground biomass in Eastern Amazonia, Brazil<span></span></a></li>
<li class="chapter" data-level="1.3.4" data-path="GeneralIntro.html"><a href="GeneralIntro.html#TASIberia"><i class="fa fa-check"></i><b>1.3.4</b> Annual mean air temperature in Iberia<span></span></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Probability sampling for estimating population parameters<span></span></b></span></li>
<li class="chapter" data-level="2" data-path="IntroProbabilitySampling.html"><a href="IntroProbabilitySampling.html"><i class="fa fa-check"></i><b>2</b> Introduction to probability sampling<span></span></a>
<ul>
<li><a href="IntroProbabilitySampling.html#arbitrary-haphazard-sampling-vs.-probability-sampling">Arbitrary (haphazard) sampling vs. probability sampling<span></span></a></li>
<li class="chapter" data-level="2.1" data-path="IntroProbabilitySampling.html"><a href="IntroProbabilitySampling.html#HTestimator"><i class="fa fa-check"></i><b>2.1</b> Horvitz-Thompson estimator<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="IntroProbabilitySampling.html"><a href="IntroProbabilitySampling.html#hansen-hurwitz-estimator"><i class="fa fa-check"></i><b>2.2</b> Hansen-Hurwitz estimator<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="IntroProbabilitySampling.html"><a href="IntroProbabilitySampling.html#using-models-in-design-based-approach"><i class="fa fa-check"></i><b>2.3</b> Using models in design-based approach<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="SI.html"><a href="SI.html"><i class="fa fa-check"></i><b>3</b> Simple random sampling<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="SI.html"><a href="SI.html#HTestimatorSI"><i class="fa fa-check"></i><b>3.1</b> Estimation of population parameters<span></span></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="SI.html"><a href="SI.html#PopProportion"><i class="fa fa-check"></i><b>3.1.1</b> Population proportion<span></span></a></li>
<li class="chapter" data-level="3.1.2" data-path="SI.html"><a href="SI.html#CDF"><i class="fa fa-check"></i><b>3.1.2</b> Cumulative distribution function and quantiles<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="SI.html"><a href="SI.html#VarMeanSI"><i class="fa fa-check"></i><b>3.2</b> Sampling variance of estimator of population parameters<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="SI.html"><a href="SI.html#ConfidenceInterval"><i class="fa fa-check"></i><b>3.3</b> Confidence interval estimate<span></span></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="SI.html"><a href="SI.html#ConfidenceIntervalProportion"><i class="fa fa-check"></i><b>3.3.1</b> Confidence interval for a proportion<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="SI.html"><a href="SI.html#SIcircularplots"><i class="fa fa-check"></i><b>3.4</b> Simple random sampling of circular plots<span></span></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="SI.html"><a href="SI.html#sampling-from-a-finite-set-of-fixed-circles"><i class="fa fa-check"></i><b>3.4.1</b> Sampling from a finite set of fixed circles<span></span></a></li>
<li class="chapter" data-level="3.4.2" data-path="SI.html"><a href="SI.html#sampling-from-an-infinite-set-of-floating-circles"><i class="fa fa-check"></i><b>3.4.2</b> Sampling from an infinite set of floating circles<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="STSI.html"><a href="STSI.html"><i class="fa fa-check"></i><b>4</b> Stratified simple random sampling<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="STSI.html"><a href="STSI.html#EstimatorsSTSI"><i class="fa fa-check"></i><b>4.1</b> Estimation of population parameters<span></span></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="STSI.html"><a href="STSI.html#population-proportion-cumulative-distribution-function-and-quantiles"><i class="fa fa-check"></i><b>4.1.1</b> Population proportion, cumulative distribution function, and quantiles<span></span></a></li>
<li class="chapter" data-level="4.1.2" data-path="STSI.html"><a href="STSI.html#WhyStratify"><i class="fa fa-check"></i><b>4.1.2</b> Why should we stratify?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="STSI.html"><a href="STSI.html#CISTSI"><i class="fa fa-check"></i><b>4.2</b> Confidence interval estimate<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="STSI.html"><a href="STSI.html#STSIallocation"><i class="fa fa-check"></i><b>4.3</b> Allocation of sample size to strata<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="STSI.html"><a href="STSI.html#cumrootf"><i class="fa fa-check"></i><b>4.4</b> <em>Cum-root-f</em> stratification<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="STSI.html"><a href="STSI.html#kmeansstratification"><i class="fa fa-check"></i><b>4.5</b> Stratification with multiple covariates<span></span></a></li>
<li class="chapter" data-level="4.6" data-path="STSI.html"><a href="STSI.html#geostrata"><i class="fa fa-check"></i><b>4.6</b> Geographical stratification<span></span></a></li>
<li class="chapter" data-level="4.7" data-path="STSI.html"><a href="STSI.html#multiway-stratification"><i class="fa fa-check"></i><b>4.7</b> Multiway stratification<span></span></a></li>
<li class="chapter" data-level="4.8" data-path="STSI.html"><a href="STSI.html#MultivariateStratification"><i class="fa fa-check"></i><b>4.8</b> Multivariate stratification<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="SY.html"><a href="SY.html"><i class="fa fa-check"></i><b>5</b> Systematic random sampling<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="SY.html"><a href="SY.html#EstVarSY"><i class="fa fa-check"></i><b>5.1</b> Estimation of population parameters<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="SY.html"><a href="SY.html#approximating-the-sampling-variance-of-the-estimator-of-the-mean"><i class="fa fa-check"></i><b>5.2</b> Approximating the sampling variance of the estimator of the mean<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Cl.html"><a href="Cl.html"><i class="fa fa-check"></i><b>6</b> Cluster random sampling<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="Cl.html"><a href="Cl.html#clustersamplingestimators"><i class="fa fa-check"></i><b>6.1</b> Estimation of population parameters<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="Cl.html"><a href="Cl.html#clusters-selected-with-probabilities-proportional-to-size-without-replacement"><i class="fa fa-check"></i><b>6.2</b> Clusters selected with probabilities proportional to size, without replacement<span></span></a></li>
<li class="chapter" data-level="6.3" data-path="Cl.html"><a href="Cl.html#SIC"><i class="fa fa-check"></i><b>6.3</b> Simple random sampling of clusters<span></span></a></li>
<li class="chapter" data-level="6.4" data-path="Cl.html"><a href="Cl.html#StratifiedCl"><i class="fa fa-check"></i><b>6.4</b> Stratified cluster random sampling<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Twostage.html"><a href="Twostage.html"><i class="fa fa-check"></i><b>7</b> Two-stage cluster random sampling<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="Twostage.html"><a href="Twostage.html#twostagesamplingestimators"><i class="fa fa-check"></i><b>7.1</b> Estimation of population parameters<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="Twostage.html"><a href="Twostage.html#primary-sampling-units-selected-without-replacement"><i class="fa fa-check"></i><b>7.2</b> Primary sampling units selected without replacement<span></span></a></li>
<li class="chapter" data-level="7.3" data-path="Twostage.html"><a href="Twostage.html#TwostageSISI"><i class="fa fa-check"></i><b>7.3</b> Simple random sampling of primary sampling units<span></span></a></li>
<li class="chapter" data-level="7.4" data-path="Twostage.html"><a href="Twostage.html#StratifiedTwostage"><i class="fa fa-check"></i><b>7.4</b> Stratified two-stage cluster random sampling<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="pps.html"><a href="pps.html"><i class="fa fa-check"></i><b>8</b> Sampling with probabilities proportional to size<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="pps.html"><a href="pps.html#ppswr"><i class="fa fa-check"></i><b>8.1</b> Probability-proportional-to-size sampling with replacement<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="pps.html"><a href="pps.html#ppswor"><i class="fa fa-check"></i><b>8.2</b> Probability-proportional-to-size sampling without replacement<span></span></a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="pps.html"><a href="pps.html#Systematicpps"><i class="fa fa-check"></i><b>8.2.1</b> Systematic pps sampling without replacement<span></span></a></li>
<li class="chapter" data-level="8.2.2" data-path="pps.html"><a href="pps.html#pivotalmethod"><i class="fa fa-check"></i><b>8.2.2</b> The pivotal method<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html"><i class="fa fa-check"></i><b>9</b> Balanced and well-spread sampling<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#Balanced"><i class="fa fa-check"></i><b>9.1</b> Balanced sampling<span></span></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#balanced-sample-vs.-balanced-sampling-design"><i class="fa fa-check"></i><b>9.1.1</b> Balanced sample vs. balanced sampling design<span></span></a></li>
<li class="chapter" data-level="9.1.2" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#unequal-inclusion-probabilities"><i class="fa fa-check"></i><b>9.1.2</b> Unequal inclusion probabilities<span></span></a></li>
<li class="chapter" data-level="9.1.3" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#StratifiedsamplingasBalancedsampling"><i class="fa fa-check"></i><b>9.1.3</b> Stratified random sampling<span></span></a></li>
<li class="chapter" data-level="9.1.4" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#Multiwaystratification"><i class="fa fa-check"></i><b>9.1.4</b> Multiway stratification<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#Spreaded"><i class="fa fa-check"></i><b>9.2</b> Well-spread sampling<span></span></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#LPM"><i class="fa fa-check"></i><b>9.2.1</b> Local pivotal method<span></span></a></li>
<li class="chapter" data-level="9.2.2" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#GRTS"><i class="fa fa-check"></i><b>9.2.2</b> Generalised random-tessellation stratified sampling<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="BalancedSpreaded.html"><a href="BalancedSpreaded.html#BalancedandSpreaded"><i class="fa fa-check"></i><b>9.3</b> Balanced sampling with spreading<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Modelassisted.html"><a href="Modelassisted.html"><i class="fa fa-check"></i><b>10</b> Model-assisted estimation<span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="Modelassisted.html"><a href="Modelassisted.html#GREG"><i class="fa fa-check"></i><b>10.1</b> Generalised regression estimator<span></span></a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="Modelassisted.html"><a href="Modelassisted.html#RegressionEstimator"><i class="fa fa-check"></i><b>10.1.1</b> Simple and multiple regression estimators<span></span></a></li>
<li class="chapter" data-level="10.1.2" data-path="Modelassisted.html"><a href="Modelassisted.html#penalised-least-squares-estimation"><i class="fa fa-check"></i><b>10.1.2</b> Penalised least squares estimation<span></span></a></li>
<li class="chapter" data-level="10.1.3" data-path="Modelassisted.html"><a href="Modelassisted.html#RegressionEstimatorSTSI"><i class="fa fa-check"></i><b>10.1.3</b> Regression estimator with stratified simple random sampling<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="Modelassisted.html"><a href="Modelassisted.html#RatioEstimator"><i class="fa fa-check"></i><b>10.2</b> Ratio estimator<span></span></a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="Modelassisted.html"><a href="Modelassisted.html#RatioEstimatorSTSI"><i class="fa fa-check"></i><b>10.2.1</b> Ratio estimators with stratified simple random sampling<span></span></a></li>
<li class="chapter" data-level="10.2.2" data-path="Modelassisted.html"><a href="Modelassisted.html#PoststratifiedEstimator"><i class="fa fa-check"></i><b>10.2.2</b> Poststratified estimator<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="Modelassisted.html"><a href="Modelassisted.html#RandomForest"><i class="fa fa-check"></i><b>10.3</b> Model-assisted estimation using machine learning techniques<span></span></a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="Modelassisted.html"><a href="Modelassisted.html#predicting-with-a-regression-tree"><i class="fa fa-check"></i><b>10.3.1</b> Predicting with a regression tree<span></span></a></li>
<li class="chapter" data-level="10.3.2" data-path="Modelassisted.html"><a href="Modelassisted.html#predicting-with-a-random-forest"><i class="fa fa-check"></i><b>10.3.2</b> Predicting with a random forest<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="Modelassisted.html"><a href="Modelassisted.html#big-data-and-volunteer-data"><i class="fa fa-check"></i><b>10.4</b> Big data and volunteer data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Twophase.html"><a href="Twophase.html"><i class="fa fa-check"></i><b>11</b> Two-phase random sampling<span></span></a>
<ul>
<li class="chapter" data-level="11.1" data-path="Twophase.html"><a href="Twophase.html#TwophaseStratification"><i class="fa fa-check"></i><b>11.1</b> Two-phase random sampling for stratification<span></span></a></li>
<li class="chapter" data-level="11.2" data-path="Twophase.html"><a href="Twophase.html#TwophaseRegression"><i class="fa fa-check"></i><b>11.2</b> Two-phase random sampling for regression<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html"><i class="fa fa-check"></i><b>12</b> Computing the required sample size<span></span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#standard-error"><i class="fa fa-check"></i><b>12.1</b> Standard error<span></span></a></li>
<li class="chapter" data-level="12.2" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#ReqSampleSizeLengthCI"><i class="fa fa-check"></i><b>12.2</b> Length of confidence interval<span></span></a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#length-of-confidence-interval-for-a-proportion"><i class="fa fa-check"></i><b>12.2.1</b> Length of confidence interval for a proportion<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#statistical-testing-of-hypothesis"><i class="fa fa-check"></i><b>12.3</b> Statistical testing of hypothesis<span></span></a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#sample-size-for-testing-a-proportion"><i class="fa fa-check"></i><b>12.3.1</b> Sample size for testing a proportion<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#DesignEffect"><i class="fa fa-check"></i><b>12.4</b> Accounting for design effect<span></span></a></li>
<li class="chapter" data-level="12.5" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#BayesianSampleSize"><i class="fa fa-check"></i><b>12.5</b> Bayesian sample size determination<span></span></a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#bayesian-criteria-for-sample-size-computation"><i class="fa fa-check"></i><b>12.5.1</b> Bayesian criteria for sample size computation<span></span></a></li>
<li class="chapter" data-level="12.5.2" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#mixed-bayesian-likelihood-approach"><i class="fa fa-check"></i><b>12.5.2</b> Mixed Bayesian-likelihood approach<span></span></a></li>
<li class="chapter" data-level="12.5.3" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#estimation-of-population-mean"><i class="fa fa-check"></i><b>12.5.3</b> Estimation of population mean<span></span></a></li>
<li class="chapter" data-level="12.5.4" data-path="RequiredSampleSize.html"><a href="RequiredSampleSize.html#estimation-of-a-population-proportion"><i class="fa fa-check"></i><b>12.5.4</b> Estimation of a population proportion<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html"><i class="fa fa-check"></i><b>13</b> Model-based optimisation of probability sampling designs<span></span></a>
<ul>
<li class="chapter" data-level="13.1" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#model-based-optimisation-of-sampling-design-type-and-sample-size"><i class="fa fa-check"></i><b>13.1</b> Model-based optimisation of sampling design type and sample size<span></span></a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#AnalyticalApproach"><i class="fa fa-check"></i><b>13.1.1</b> Analytical approach<span></span></a></li>
<li class="chapter" data-level="13.1.2" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#GeostatisticalSimulationApproach"><i class="fa fa-check"></i><b>13.1.2</b> Geostatistical simulation approach<span></span></a></li>
<li class="chapter" data-level="13.1.3" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#MBpredSamplingVarBayes"><i class="fa fa-check"></i><b>13.1.3</b> Bayesian approach<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="MBpredictionofDesignVariance.html"><a href="MBpredictionofDesignVariance.html#Ospats"><i class="fa fa-check"></i><b>13.2</b> Model-based optimisation of spatial strata<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html"><i class="fa fa-check"></i><b>14</b> Sampling for estimating parameters of domains<span></span></a>
<ul>
<li class="chapter" data-level="14.1" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#LargeDomainsDirectEstimator"><i class="fa fa-check"></i><b>14.1</b> Direct estimator for large domains<span></span></a></li>
<li class="chapter" data-level="14.2" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#SmallDomainsModelAssisted"><i class="fa fa-check"></i><b>14.2</b> Model-assisted estimators for small domains<span></span></a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#RegressionestimatorSmallDomain"><i class="fa fa-check"></i><b>14.2.1</b> Regression estimator<span></span></a></li>
<li class="chapter" data-level="14.2.2" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#SyntheticestimatorSmallDomain"><i class="fa fa-check"></i><b>14.2.2</b> Synthetic estimator<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#SmallAreaModelBased"><i class="fa fa-check"></i><b>14.3</b> Model-based prediction<span></span></a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#random-intercept-model"><i class="fa fa-check"></i><b>14.3.1</b> Random intercept model<span></span></a></li>
<li class="chapter" data-level="14.3.2" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#geostatistical-model"><i class="fa fa-check"></i><b>14.3.2</b> Geostatistical model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="SmallAreaEstimation.html"><a href="SmallAreaEstimation.html#supplemental-probability-sampling-of-small-domains"><i class="fa fa-check"></i><b>14.4</b> Supplemental probability sampling of small domains<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html"><i class="fa fa-check"></i><b>15</b> Repeated sample surveys for monitoring population parameters<span></span></a>
<ul>
<li class="chapter" data-level="15.1" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#space-time-designs"><i class="fa fa-check"></i><b>15.1</b> Space-time designs<span></span></a></li>
<li class="chapter" data-level="15.2" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#SpaceTimeparameters"><i class="fa fa-check"></i><b>15.2</b> Space-time population parameters<span></span></a></li>
<li class="chapter" data-level="15.3" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#design-based-generalised-least-squares-estimation-of-spatial-means"><i class="fa fa-check"></i><b>15.3</b> Design-based generalised least squares estimation of spatial means<span></span></a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#current-mean"><i class="fa fa-check"></i><b>15.3.1</b> Current mean<span></span></a></li>
<li class="chapter" data-level="15.3.2" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#change-of-the-spatial-mean"><i class="fa fa-check"></i><b>15.3.2</b> Change of the spatial mean<span></span></a></li>
<li class="chapter" data-level="15.3.3" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#temporal-trend-of-the-spatial-mean"><i class="fa fa-check"></i><b>15.3.3</b> Temporal trend of the spatial mean<span></span></a></li>
<li class="chapter" data-level="15.3.4" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#space-time-mean"><i class="fa fa-check"></i><b>15.3.4</b> Space-time mean<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#case-study-annual-mean-daily-temperature-in-iberia"><i class="fa fa-check"></i><b>15.4</b> Case study: annual mean daily temperature in Iberia<span></span></a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#static-synchronous-design"><i class="fa fa-check"></i><b>15.4.1</b> Static-synchronous design<span></span></a></li>
<li class="chapter" data-level="15.4.2" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#independent-synchronous-design"><i class="fa fa-check"></i><b>15.4.2</b> Independent synchronous design<span></span></a></li>
<li class="chapter" data-level="15.4.3" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#serially-alternating-design"><i class="fa fa-check"></i><b>15.4.3</b> Serially alternating design<span></span></a></li>
<li class="chapter" data-level="15.4.4" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#supplemented-panel-design"><i class="fa fa-check"></i><b>15.4.4</b> Supplemented panel design<span></span></a></li>
<li class="chapter" data-level="15.4.5" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#rotating-panel-design"><i class="fa fa-check"></i><b>15.4.5</b> Rotating panel design<span></span></a></li>
<li class="chapter" data-level="15.4.6" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#sampling-experiment"><i class="fa fa-check"></i><b>15.4.6</b> Sampling experiment<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="RepeatedSurveys.html"><a href="RepeatedSurveys.html#space-time-sampling-with-stratified-random-sampling-in-space"><i class="fa fa-check"></i><b>15.5</b> Space-time sampling with stratified random sampling in space<span></span></a></li>
</ul></li>
<li class="part"><span><b>II Sampling for mapping<span></span></b></span></li>
<li class="chapter" data-level="16" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html"><i class="fa fa-check"></i><b>16</b> Introduction to sampling for mapping<span></span></a>
<ul>
<li class="chapter" data-level="16.1" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html#when-is-probability-sampling-not-required"><i class="fa fa-check"></i><b>16.1</b> When is probability sampling not required?<span></span></a></li>
<li class="chapter" data-level="16.2" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html#sampling-for-simultaneously-mapping-and-estimating-means"><i class="fa fa-check"></i><b>16.2</b> Sampling for simultaneously mapping and estimating means<span></span></a></li>
<li class="chapter" data-level="16.3" data-path="IntroSamplingforMapping.html"><a href="IntroSamplingforMapping.html#broad-overview-of-sampling-designs-for-mapping"><i class="fa fa-check"></i><b>16.3</b> Broad overview of sampling designs for mapping<span></span></a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="RegularGridSpatialCoverage.html"><a href="RegularGridSpatialCoverage.html"><i class="fa fa-check"></i><b>17</b> Regular grid and spatial coverage sampling<span></span></a>
<ul>
<li class="chapter" data-level="17.1" data-path="RegularGridSpatialCoverage.html"><a href="RegularGridSpatialCoverage.html#Regulargrid"><i class="fa fa-check"></i><b>17.1</b> Regular grid sampling<span></span></a></li>
<li class="chapter" data-level="17.2" data-path="RegularGridSpatialCoverage.html"><a href="RegularGridSpatialCoverage.html#SpatialCoverage"><i class="fa fa-check"></i><b>17.2</b> Spatial coverage sampling<span></span></a></li>
<li class="chapter" data-level="17.3" data-path="RegularGridSpatialCoverage.html"><a href="RegularGridSpatialCoverage.html#SpatialInfill"><i class="fa fa-check"></i><b>17.3</b> Spatial infill sampling<span></span></a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="kmeans.html"><a href="kmeans.html"><i class="fa fa-check"></i><b>18</b> Covariate space coverage sampling<span></span></a>
<ul>
<li class="chapter" data-level="18.1" data-path="kmeans.html"><a href="kmeans.html#covariate-space-infill-sampling"><i class="fa fa-check"></i><b>18.1</b> Covariate space infill sampling<span></span></a></li>
<li class="chapter" data-level="18.2" data-path="kmeans.html"><a href="kmeans.html#PerformanceCSC"><i class="fa fa-check"></i><b>18.2</b> Performance of covariate space coverage sampling in random forest prediction<span></span></a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="cLHS.html"><a href="cLHS.html"><i class="fa fa-check"></i><b>19</b> Conditioned Latin hypercube sampling<span></span></a>
<ul>
<li class="chapter" data-level="19.1" data-path="cLHS.html"><a href="cLHS.html#cLHIS"><i class="fa fa-check"></i><b>19.1</b> Conditioned Latin hypercube infill sampling<span></span></a></li>
<li class="chapter" data-level="19.2" data-path="cLHS.html"><a href="cLHS.html#performance-of-conditioned-latin-hypercube-sampling-in-random-forest-prediction"><i class="fa fa-check"></i><b>19.2</b> Performance of conditioned Latin hypercube sampling in random forest prediction<span></span></a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="SpatialResponseSurface.html"><a href="SpatialResponseSurface.html"><i class="fa fa-check"></i><b>20</b> Spatial response surface sampling<span></span></a>
<ul>
<li class="chapter" data-level="20.1" data-path="SpatialResponseSurface.html"><a href="SpatialResponseSurface.html#IncreaseSampleSize"><i class="fa fa-check"></i><b>20.1</b> Increasing the sample size<span></span></a></li>
<li class="chapter" data-level="20.2" data-path="SpatialResponseSurface.html"><a href="SpatialResponseSurface.html#stratified-spatial-response-surface-sampling"><i class="fa fa-check"></i><b>20.2</b> Stratified spatial response surface sampling<span></span></a></li>
<li class="chapter" data-level="20.3" data-path="SpatialResponseSurface.html"><a href="SpatialResponseSurface.html#mapping"><i class="fa fa-check"></i><b>20.3</b> Mapping<span></span></a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="Introkriging.html"><a href="Introkriging.html"><i class="fa fa-check"></i><b>21</b> Introduction to kriging<span></span></a>
<ul>
<li class="chapter" data-level="21.1" data-path="Introkriging.html"><a href="Introkriging.html#OrdinaryKriging"><i class="fa fa-check"></i><b>21.1</b> Ordinary kriging<span></span></a></li>
<li class="chapter" data-level="21.2" data-path="Introkriging.html"><a href="Introkriging.html#BlockKriging"><i class="fa fa-check"></i><b>21.2</b> Block-kriging<span></span></a></li>
<li class="chapter" data-level="21.3" data-path="Introkriging.html"><a href="Introkriging.html#IntroKED"><i class="fa fa-check"></i><b>21.3</b> Kriging with an external drift<span></span></a></li>
<li class="chapter" data-level="21.4" data-path="Introkriging.html"><a href="Introkriging.html#VariogramEstimation"><i class="fa fa-check"></i><b>21.4</b> Estimating the semivariogram<span></span></a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="Introkriging.html"><a href="Introkriging.html#MoM"><i class="fa fa-check"></i><b>21.4.1</b> Method-of-moments<span></span></a></li>
<li class="chapter" data-level="21.4.2" data-path="Introkriging.html"><a href="Introkriging.html#MLestimationVariogram"><i class="fa fa-check"></i><b>21.4.2</b> Maximum likelihood<span></span></a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="Introkriging.html"><a href="Introkriging.html#ResidualVariogram"><i class="fa fa-check"></i><b>21.5</b> Estimating the residual semivariogram<span></span></a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="Introkriging.html"><a href="Introkriging.html#IterativeMoM"><i class="fa fa-check"></i><b>21.5.1</b> Iterative method-of-moments<span></span></a></li>
<li class="chapter" data-level="21.5.2" data-path="Introkriging.html"><a href="Introkriging.html#REML"><i class="fa fa-check"></i><b>21.5.2</b> Restricted maximum likelihood<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="MBgridspacing.html"><a href="MBgridspacing.html"><i class="fa fa-check"></i><b>22</b> Model-based optimisation of the grid spacing<span></span></a>
<ul>
<li class="chapter" data-level="22.1" data-path="MBgridspacing.html"><a href="MBgridspacing.html#GridspacingOK"><i class="fa fa-check"></i><b>22.1</b> Optimal grid spacing for ordinary kriging<span></span></a></li>
<li class="chapter" data-level="22.2" data-path="MBgridspacing.html"><a href="MBgridspacing.html#controlling-the-mean-or-a-quantile-of-the-ordinary-kriging-variance"><i class="fa fa-check"></i><b>22.2</b> Controlling the mean or a quantile of the ordinary kriging variance<span></span></a></li>
<li class="chapter" data-level="22.3" data-path="MBgridspacing.html"><a href="MBgridspacing.html#optimal-grid-spacing-for-block-kriging"><i class="fa fa-check"></i><b>22.3</b> Optimal grid spacing for block-kriging<span></span></a></li>
<li class="chapter" data-level="22.4" data-path="MBgridspacing.html"><a href="MBgridspacing.html#MBgridspacingKED"><i class="fa fa-check"></i><b>22.4</b> Optimal grid spacing for kriging with an external drift<span></span></a></li>
<li class="chapter" data-level="22.5" data-path="MBgridspacing.html"><a href="MBgridspacing.html#BayesianGridSpacing"><i class="fa fa-check"></i><b>22.5</b> Bayesian approach<span></span></a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html"><i class="fa fa-check"></i><b>23</b> Model-based optimisation of the sampling pattern<span></span></a>
<ul>
<li class="chapter" data-level="23.1" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#SSA"><i class="fa fa-check"></i><b>23.1</b> Spatial simulated annealing<span></span></a></li>
<li class="chapter" data-level="23.2" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#SamplePatternOK"><i class="fa fa-check"></i><b>23.2</b> Optimising the sampling pattern for ordinary kriging<span></span></a></li>
<li class="chapter" data-level="23.3" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#SamplePatternKED"><i class="fa fa-check"></i><b>23.3</b> Optimising the sampling pattern for kriging with an external drift<span></span></a></li>
<li class="chapter" data-level="23.4" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#model-based-infill-sampling-for-ordinary-kriging"><i class="fa fa-check"></i><b>23.4</b> Model-based infill sampling for ordinary kriging<span></span></a></li>
<li class="chapter" data-level="23.5" data-path="MBSamplePattern.html"><a href="MBSamplePattern.html#model-based-infill-sampling-for-kriging-with-an-external-drift"><i class="fa fa-check"></i><b>23.5</b> Model-based infill sampling for kriging with an external drift<span></span></a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html"><i class="fa fa-check"></i><b>24</b> Sampling for estimating the semivariogram<span></span></a>
<ul>
<li class="chapter" data-level="24.1" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#NestedSampling"><i class="fa fa-check"></i><b>24.1</b> Nested sampling<span></span></a></li>
<li class="chapter" data-level="24.2" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#IndependentSamplingPairs"><i class="fa fa-check"></i><b>24.2</b> Independent sampling of pairs of points<span></span></a></li>
<li class="chapter" data-level="24.3" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#samplingforvariogram"><i class="fa fa-check"></i><b>24.3</b> Optimisation of sampling pattern for semivariogram estimation<span></span></a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#UncertainSemivariogramParameters"><i class="fa fa-check"></i><b>24.3.1</b> Uncertainty about semivariogram parameters<span></span></a></li>
<li class="chapter" data-level="24.3.2" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#UncertainKrigingVariance"><i class="fa fa-check"></i><b>24.3.2</b> Uncertainty about the kriging variance<span></span></a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#SamplingEstimationandPrediction"><i class="fa fa-check"></i><b>24.4</b> Optimisation of sampling pattern for semivariogram estimation and mapping<span></span></a></li>
<li class="chapter" data-level="24.5" data-path="SamplingVariogram.html"><a href="SamplingVariogram.html#a-practical-solution"><i class="fa fa-check"></i><b>24.5</b> A practical solution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="Validation.html"><a href="Validation.html"><i class="fa fa-check"></i><b>25</b> Sampling for validation of maps<span></span></a>
<ul>
<li class="chapter" data-level="25.1" data-path="Validation.html"><a href="Validation.html#map-quality-indices"><i class="fa fa-check"></i><b>25.1</b> Map quality indices<span></span></a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="Validation.html"><a href="Validation.html#estimation-of-map-quality-indices"><i class="fa fa-check"></i><b>25.1.1</b> Estimation of map quality indices<span></span></a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="Validation.html"><a href="Validation.html#real-world-case-study"><i class="fa fa-check"></i><b>25.2</b> Real-world case study<span></span></a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="Validation.html"><a href="Validation.html#estimation-of-the-population-mean-error-and-mean-squared-error"><i class="fa fa-check"></i><b>25.2.1</b> Estimation of the population mean error and mean squared error<span></span></a></li>
<li class="chapter" data-level="25.2.2" data-path="Validation.html"><a href="Validation.html#estimation-of-the-standard-error-of-the-estimator-of-the-population-mean-error-and-mean-squared-error"><i class="fa fa-check"></i><b>25.2.2</b> Estimation of the standard error of the estimator of the population mean error and mean squared error<span></span></a></li>
<li class="chapter" data-level="25.2.3" data-path="Validation.html"><a href="Validation.html#estimation-of-model-efficiency-coefficient"><i class="fa fa-check"></i><b>25.2.3</b> Estimation of model efficiency coefficient<span></span></a></li>
<li class="chapter" data-level="25.2.4" data-path="Validation.html"><a href="Validation.html#statistical-testing-of-hypothesis-about-population-me-and-mse"><i class="fa fa-check"></i><b>25.2.4</b> Statistical testing of hypothesis about population ME and MSE<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="Approaches.html"><a href="Approaches.html"><i class="fa fa-check"></i><b>26</b> Design-based, model-based, and model-assisted approach for sampling and inference<span></span></a>
<ul>
<li class="chapter" data-level="26.1" data-path="Approaches.html"><a href="Approaches.html#two-sources-of-randomness"><i class="fa fa-check"></i><b>26.1</b> Two sources of randomness<span></span></a></li>
<li class="chapter" data-level="26.2" data-path="Approaches.html"><a href="Approaches.html#iid"><i class="fa fa-check"></i><b>26.2</b> Identically and independently distributed<span></span></a></li>
<li class="chapter" data-level="26.3" data-path="Approaches.html"><a href="Approaches.html#BiasandVariance"><i class="fa fa-check"></i><b>26.3</b> Bias and variance<span></span></a></li>
<li class="chapter" data-level="26.4" data-path="Approaches.html"><a href="Approaches.html#effectivesamplesize"><i class="fa fa-check"></i><b>26.4</b> Effective sample size<span></span></a></li>
<li class="chapter" data-level="26.5" data-path="Approaches.html"><a href="Approaches.html#ExploitSpatialStructure"><i class="fa fa-check"></i><b>26.5</b> Exploiting spatial structure in design-based approach<span></span></a></li>
<li class="chapter" data-level="26.6" data-path="Approaches.html"><a href="Approaches.html#ModelassistedvsModeldependent"><i class="fa fa-check"></i><b>26.6</b> Model-assisted vs. model-dependent<span></span></a></li>
</ul></li>
<li class="appendix"><span><b>Appendices<span></span></b></span></li>
<li class="chapter" data-level="A" data-path="Answers.html"><a href="Answers.html"><i class="fa fa-check"></i><b>A</b> Answers to exercises<span></span></a>
<ul>
<li><a href="Answers.html#introduction-to-probability-sampling">Introduction to probability sampling<span></span></a></li>
<li><a href="Answers.html#simple-random-sampling-1">Simple random sampling<span></span></a></li>
<li><a href="Answers.html#stratified-simple-random-sampling-1">Stratified simple random sampling<span></span></a></li>
<li><a href="Answers.html#systematic-random-sampling-2">Systematic random sampling<span></span></a></li>
<li><a href="Answers.html#cluster-random-sampling">Cluster random sampling<span></span></a></li>
<li><a href="Answers.html#two-stage-cluster-random-sampling-1">Two-stage cluster random sampling<span></span></a></li>
<li><a href="Answers.html#sampling-with-probabilities-proportional-to-size">Sampling with probabilities proportional to size<span></span></a></li>
<li><a href="Answers.html#balanced-and-well-spread-sampling">Balanced and well-spread sampling<span></span></a></li>
<li><a href="Answers.html#model-assisted-estimation">Model-assisted estimation<span></span></a></li>
<li><a href="Answers.html#two-phase-random-sampling">Two-phase random sampling<span></span></a></li>
<li><a href="Answers.html#computing-the-required-sample-size">Computing the required sample size<span></span></a></li>
<li><a href="Answers.html#model-based-optimisation-of-probability-sampling-designs">Model-based optimisation of probability sampling designs<span></span></a></li>
<li><a href="Answers.html#repeated-sample-surveys-for-monitoring-population-parameters">Repeated sample surveys for monitoring population parameters<span></span></a></li>
<li><a href="Answers.html#regular-grid-and-spatial-coverage-sampling">Regular grid and spatial coverage sampling<span></span></a></li>
<li><a href="Answers.html#covariate-space-coverage-sampling">Covariate space coverage sampling<span></span></a></li>
<li><a href="Answers.html#conditioned-latin-hypercube-sampling">Conditioned Latin hypercube sampling<span></span></a></li>
<li><a href="Answers.html#model-based-optimisation-of-the-grid-spacing">Model-based optimisation of the grid spacing<span></span></a></li>
<li><a href="Answers.html#model-based-optimisation-of-the-sampling-pattern">Model-based optimisation of the sampling pattern<span></span></a></li>
<li><a href="Answers.html#sampling-for-estimating-the-semivariogram">Sampling for estimating the semivariogram<span></span></a></li>
<li><a href="Answers.html#sampling-for-validation-of-maps">Sampling for validation of maps<span></span></a></li>
</ul></li>
<li><a href="references.html#references">References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/DickBrus/">Dick Brus</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial sampling with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pps" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Sampling with probabilities proportional to size<a href="pps.html#pps" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In simple random sampling, the inclusion probabilities are equal for all population units. The advantage of this is simple and straightforward statistical inference. With equal inclusion probabilities the unweighted sample mean is an unbiased estimator of the spatial mean, i.e., the sampling design is <em>self-weighting</em>. However, in some situations equal probability sampling is not very efficient, i.e., given the sample size the precision of the estimated mean or total will be relatively low. An example is the following. In order to estimate the total area of a given crop in a country, a raster of square cells of, for instance, 1 km <span class="math inline">\(\times\)</span> 1 km is constructed and projected on the country. The square cells are the population units, and these units serve as the sampling units. Note that near the country border cells cross the border. Some of them may contain only a few hectares of the target population, the country under study. We do not want to select many of these squares with only a few hectares of the study area, as intuitively it is clear that this will result in a low precision of the estimated crop area. In such situation it can be more efficient to select units with probabilities proportional to the area of the target population within the squares, so that small units near the border have a smaller probability of being selected than interior units. Actually, the sampling units are not the square cells, but the pieces of land obtained by overlaying the cells and the GIS map of the country under study. As a consequence, the sampling units have unequal size. The sampling units of unequal size are selected by probabilities proportional to their size (pps).</p>

<div class="rmdnote">
In Chapters <a href="Cl.html#Cl">6</a> and <a href="Twostage.html#Twostage">7</a> pps sampling was already used to select clusters (primary sampling units) of population units. In this chapter the <em>individual</em> population units (elementary sampling units) are selected with probabilities proportional to size.
</div>
<p>If we have a GIS map of land use categories such as agriculture, built-up areas, water bodies, forests, etc., we may use this file to further adapt the selection probabilities. The crop will be grown in agricultural areas only, so we expect small crop areas in cells largely covered by non-agricultural land. As a size measure in computing the selection probabilities, we may use the agricultural area, as represented in the GIS map, in the country under study within the cells. Note that size now has a different meaning. It does not refer to the area of the sampling units anymore, but to an ancillary variable that we expect to be related to the study variable, i.e., the crop area. When the crop area per cell is proportional to the agricultural area per cell, then the precision of the estimated total area of the crop can be increased by selecting the cells with probabilities proportional to the agricultural area.</p>
<p>In this example the sampling units have an area. However, sampling with probabilities proportional to size is not restricted to areal sampling units, but can also be used for selecting points. If we have a map of an ancillary variable that is expected to be positively related to the study variable, this ancillary variable can be used as a size measure. For instance, in areas where soil organic matter shows a positive relation with elevation, it can be efficient to select sampling points with a selection probability proportional to this environmental variable. The ancillary variable must be strictly positive for all points.</p>
<p>Sampling units can be selected with probabilities proportional to their size (pps) <em>with</em> or <em>without</em> replacement. This distinction is immaterial for infinite populations, as in sampling points from an area. pps sampling with replacement (ppswr) is much easier to implement than pps sampling without replacement (ppswor). The problem with ppswor is that after each draw the selected unit is removed from the sampling frame, so that the sum of the size variable over all remaining units changes and as a result the draw-by-draw selection probabilities of the units.</p>
<p>pps sampling is illustrated with the simulated map of poppy area per 5 km square in the province of Kandahar (Figure <a href="GeneralIntro.html#fig:mapsKandahar">1.6</a>). The first six rows of the data frame are shown below. Variable <code>poppy</code> is the study variable, variable <code>agri</code> is the agricultural area within the 5 km squares, used as a size variable.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="pps.html#cb149-1" aria-hidden="true" tabindex="-1"></a>grdKandahar</span></code></pre></div>
<pre><code># A tibble: 965 x 4
        s1       s2    poppy   agri
     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
 1 809232. 3407627.  0.905    65.7 
 2 814232. 3412627.  0.00453  15.6 
 3 794232. 3417627. 11.3      17.6 
 4 809232. 3417627.  0.110    14.0 
 5 814232. 3417627.  0.0344   22.2 
 6 819232. 3417627.  0.143    13.3 
 7 794232. 3422627.  3.66     34.1 
 8 799232. 3422627.  3.66      6.12
 9 809232. 3422627.  0.688    10.6 
10 814232. 3422627.  4.79    130.  
# ... with 955 more rows</code></pre>
<div id="ppswr" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Probability-proportional-to-size sampling with replacement<a href="pps.html#ppswr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the first draw, a sampling unit is selected with probability <span class="math inline">\(p_k = x_k/t(x)\)</span>, with <span class="math inline">\(x_k\)</span> the size variable for unit <span class="math inline">\(k\)</span> and <span class="math inline">\(t(x) = \sum_{k=1}^N x_k\)</span> the population total of the size variable. The selected unit is then replaced, and these two steps are repeated <span class="math inline">\(n\)</span> times. Note that with this sampling design population units can be selected more than once, especially with large sampling fractions <span class="math inline">\(n/N\)</span>.</p>
<p>The population total can be estimated by the pwr estimator:</p>
<p><span class="math display" id="eq:HHTotalppswr">\[\begin{equation}
\hat{t}(z)=\frac{1}{n}\sum_{k \in \mathcal{S}}\frac{z_{k}}{p_{k}} \;,
\tag{8.1}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the sample size (number of draws). The population mean can be estimated by the estimated population total divided by the population size <span class="math inline">\(N\)</span>. With independent draws, the sampling variance of the estimator of the population total can be estimated by</p>
<p><span class="math display" id="eq:VarHHTotalppswr">\[\begin{equation}
\widehat{V}\!\left(\hat{t}(z)\right)=
\frac{1}{\,n\,(n-1)}\sum_{k \in \mathcal{S}}\left( \frac{z_{k}}{p_{k}}-\hat{t}(z)\right)^{2} \;.
\tag{8.2}
\end{equation}\]</span></p>
<p>The sampling variance of the estimator of the mean can be estimated by the variance of the estimator of the total divided by <span class="math inline">\(N^2\)</span>.</p>
<p>As a first step, I check whether the size variable is strictly positive in our case study of Kandahar. The minimum equals 0.307 m<sup>2</sup>, so this is the case. If there are values equal to or smaller than 0, these values must be replaced by a small number, so that all units have a positive probability of being selected. Then the draw-by-draw selection probabilities are computed, and the sample is selected using function <code>sample</code>.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="pps.html#cb151-1" aria-hidden="true" tabindex="-1"></a>grdKandahar<span class="sc">$</span>p <span class="ot">&lt;-</span> grdKandahar<span class="sc">$</span>agri <span class="sc">/</span>  <span class="fu">sum</span>(grdKandahar<span class="sc">$</span>agri)</span>
<span id="cb151-2"><a href="pps.html#cb151-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(grdKandahar)</span>
<span id="cb151-3"><a href="pps.html#cb151-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb151-4"><a href="pps.html#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb151-5"><a href="pps.html#cb151-5" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">sample</span>(N, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> grdKandahar<span class="sc">$</span>p)</span>
<span id="cb151-6"><a href="pps.html#cb151-6" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> grdKandahar[units, ]</span></code></pre></div>

<div class="rmdnote">
To select the units, computing the selection probabilities is not strictly needed. Exactly the same units are selected when the agricultural area within the units (variable <code>agri</code> in the data frame) is used in argument <code>prob</code> of <code>sample</code>.
</div>
<p>Four units are selected twice.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="pps.html#cb152-1" aria-hidden="true" tabindex="-1"></a>table_frq <span class="ot">&lt;-</span> <span class="fu">table</span>(units) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb152-2"><a href="pps.html#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(table_frq[table_frq<span class="sc">$</span>Freq <span class="sc">&gt;</span> <span class="dv">1</span>, ])</span></code></pre></div>
<pre><code>   units Freq
9    278    2
13   334    2
14   336    2
24   439    2</code></pre>
<p>Figure <a href="pps.html#fig:ppswrKandahar">8.1</a> shows the selected sampling units, plotted on a map of the agricultural area within the units which is used as a size variable.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ppswrKandahar"></span>
<img src="SpatialSampling_files/figure-html/ppswrKandahar-1.png" alt="Sample of size 40 from Kandahar, selected with probabilities proportional to agricultural area with replacement. Four units are selected twice, so that the number of distinct units is 36." width="100%" />
<p class="caption">
Figure 8.1: Sample of size 40 from Kandahar, selected with probabilities proportional to agricultural area with replacement. Four units are selected twice, so that the number of distinct units is 36.
</p>
</div>
<p>The next code chunk shows how the population total of the poppy area can be estimated, using Equation <a href="pps.html#eq:HHTotalppswr">(8.1)</a>, as well as the standard error of the estimator of the population total (square root of estimator of Equation <a href="pps.html#eq:VarHHTotalppswr">(8.2)</a>). As a first step, the observations are inflated, or expanded, through division of the observations by the selection probabilities of the corresponding units.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="pps.html#cb154-1" aria-hidden="true" tabindex="-1"></a>z_pexpanded <span class="ot">&lt;-</span> mysample<span class="sc">$</span>poppy <span class="sc">/</span> mysample<span class="sc">$</span>p</span>
<span id="cb154-2"><a href="pps.html#cb154-2" aria-hidden="true" tabindex="-1"></a>tz <span class="ot">&lt;-</span> <span class="fu">mean</span>(z_pexpanded)</span>
<span id="cb154-3"><a href="pps.html#cb154-3" aria-hidden="true" tabindex="-1"></a>se_tz <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(z_pexpanded) <span class="sc">/</span> n)</span></code></pre></div>
<p>The estimated total equals 65,735 ha, with a standard error of 12,944 ha. The same estimates are obtained with package <strong>survey</strong> <span class="citation">(<a href="#ref-Lumley2020" role="doc-biblioref">Lumley 2021</a>)</span>.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="pps.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb155-2"><a href="pps.html#cb155-2" aria-hidden="true" tabindex="-1"></a>mysample<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (mysample<span class="sc">$</span>p <span class="sc">*</span> n)</span>
<span id="cb155-3"><a href="pps.html#cb155-3" aria-hidden="true" tabindex="-1"></a>design_ppswr <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">id =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> mysample, <span class="at">weights =</span> <span class="sc">~</span> weight)</span>
<span id="cb155-4"><a href="pps.html#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="fu">svytotal</span>(<span class="sc">~</span> poppy, design_ppswr)</span></code></pre></div>
<pre><code>      total    SE
poppy 65735 12944</code></pre>
<p>In ppswr sampling, a sampling unit can be selected more than once, especially with large sampling fractions <span class="math inline">\(n/N\)</span>. This may decrease the sampling efficiency. With large sampling fractions, the alternative is pps sampling without replacement (ppswor), see next section.</p>
<p>The estimators of Equations <a href="pps.html#eq:HHTotalppswr">(8.1)</a> and <a href="pps.html#eq:VarHHTotalppswr">(8.2)</a> can also be used for infinite populations. For infinite populations, the probability that a unit is selected more than once is zero.</p>
<div id="exercises-12" class="section level4 unnumbered hasAnchor">
<h4>Exercises<a href="pps.html#exercises-12" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>Write an <strong>R</strong> script to select a pps with replacement sample from Eastern Amazonia (<code>grdAmazonia</code> in package <strong>sswr</strong>) to estimate the population mean of aboveground biomass (AGB), using log-transformed short-wave infrared radiation (SWIR2) as a size variable.
<ul>
<li>The correlation of AGB and lnSWIR2 is negative. The first step is to compute an appropriate size variable, so that the larger the size variable, the larger the selection probability. Multiply the lnSWIR2 values by -1. Then add a small value, so that the size variable becomes strictly positive.</li>
<li>Select in a for-loop 1,000 times a ppswr sample of size 100 (<span class="math inline">\(n=100\)</span>), and estimate from each sample the population mean of AGB with the pwr estimator (Hansen-Hurwitz estimator) and its sampling variance. Compute the variance of the 1,000 estimated population means and the mean of the 1,000 estimated variances. Make a histogram of the 1,000 estimated means.</li>
<li>Compute the true sampling variance of the <span class="math inline">\(\pi\)</span> estimator with simple random sampling with replacement and the same sample size.</li>
<li>Compute the gain in precision by the ratio of the variance of the estimator of the mean with simple random sampling to the variance with ppswr.</li>
</ul></li>
</ol>
</div>
</div>
<div id="ppswor" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Probability-proportional-to-size sampling without replacement<a href="pps.html#ppswor" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The alternative to pps sampling with replacement (ppswr) is pps sampling without replacement (ppswor). In ppswor sampling the <em>inclusion</em> probabilities are proportional to a size variable, not the draw-by-draw selection probabilities as in ppswr. For this reason, ppswor sampling is referred to as <span class="math inline">\(\pi\)</span>ps sampling by <span class="citation"><a href="#ref-sar92" role="doc-biblioref">Särndal, Swensson, and Wretman</a> (<a href="#ref-sar92" role="doc-biblioref">1992</a>)</span>. ppswor sampling starts with assigning target inclusion probabilities to all units in the population. With inclusion probabilities proportional to a size variable <span class="math inline">\(x\)</span> the target inclusion probabilities are computed by <span class="math inline">\(\pi_k= n\;x_k/\sum_{j=1}^Nx_j,\; k = 1, \dots , N\)</span>.</p>
<div id="Systematicpps" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Systematic pps sampling without replacement<a href="pps.html#Systematicpps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Many algorithms are available for ppswor sampling, see <span class="citation"><a href="#ref-Tille2006" role="doc-biblioref">Tillé</a> (<a href="#ref-Tille2006" role="doc-biblioref">2006</a>)</span> for an overview. A simple, straightforward method is systematic ppswor sampling. Two subtypes can be distinguished, systematic ppswor sampling with fixed frame order and systematic ppswor sampling with random frame order <span class="citation">(<a href="#ref-Rosen1997b" role="doc-biblioref">Rosén 1997</a>)</span>. Given some order of the units, the cumulative sum of the inclusion probabilities is computed. Each population unit is then associated with an interval of cumulative inclusion probabilities. The larger the inclusion probability of a unit, the wider the interval. Then a random number from the uniform distribution is drawn, which serves as the start of a one-dimensional systematic sample of size <span class="math inline">\(n\)</span> with an interval of 1. Finally, the units are determined for which the systematic random values are in the interval of cumulative inclusion probabilities, see Figure <a href="pps.html#fig:sysppswor">8.2</a> for ten population units and a sample size of four. The units selected are 2, 5, 7, and 9. Note that the sum of the interval lengths equals the sample size. Further note that a unit cannot be selected more than once because the inclusion probabilities are <span class="math inline">\(&lt;1\)</span> and the sampling interval equals 1.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="pps.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sampling)</span>
<span id="cb157-2"><a href="pps.html#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb157-3"><a href="pps.html#cb157-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb157-4"><a href="pps.html#cb157-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb157-5"><a href="pps.html#cb157-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb157-6"><a href="pps.html#cb157-6" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">inclusionprobabilities</span>(x, n)</span>
<span id="cb157-7"><a href="pps.html#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">seq_len</span>(N), x, pi))</span></code></pre></div>
<pre><code>   id        x        pi
1   1 13.55882 0.3027383
2   2 23.63731 0.5277684
3   3 15.83538 0.3535687
4   4 16.48162 0.3679978
5   5 20.63624 0.4607613
6   6 18.32529 0.4091630
7   7 16.50655 0.3685545
8   8 20.06336 0.4479702
9   9 22.94495 0.5123095
10 10 11.15957 0.2491684</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="pps.html#cb159-1" aria-hidden="true" tabindex="-1"></a>cumsumpi <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">cumsum</span>(pi))</span>
<span id="cb159-2"><a href="pps.html#cb159-2" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb159-3"><a href="pps.html#cb159-3" aria-hidden="true" tabindex="-1"></a>sys <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span>  start</span>
<span id="cb159-4"><a href="pps.html#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(units <span class="ot">&lt;-</span> <span class="fu">findInterval</span>(sys, cumsumpi))</span></code></pre></div>
<pre><code>[1] 2 5 7 9</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sysppswor"></span>
<img src="SpatialSampling_files/figure-html/sysppswor-1.png" alt="Systematic random sample along a line with unequal inclusion probabilities." width="100%" />
<p class="caption">
Figure 8.2: Systematic random sample along a line with unequal inclusion probabilities.
</p>
</div>
<p>Sampling efficiency can be increased by ordering the units by the size variable (Figure <a href="pps.html#fig:sysppsworsort">8.3</a>). With this design, the third, fourth, fifth, and second units in the original frame are selected, with sizes 15.8, 16.5, 20.6, and 23.6, respectively. Ordering the units by size leads to a large within-sample and a small between-sample variance of the size variable <span class="math inline">\(x\)</span>. If the study variable is proportional to the size variable, this results in a smaller sampling variance of the estimator of the mean of the study variable. A drawback of systematic ppswor sampling with fixed order is that no unbiased estimator of the sampling variance exists.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sysppsworsort"></span>
<img src="SpatialSampling_files/figure-html/sysppsworsort-1.png" alt="Systematic random sample along a line with unequal inclusion probabilities. Units are ordered by size." width="100%" />
<p class="caption">
Figure 8.3: Systematic random sample along a line with unequal inclusion probabilities. Units are ordered by size.
</p>
</div>
<p>A small simulation study is done next to see how much gain in precision can be achieved by ordering the units by size. A size variable <span class="math inline">\(x\)</span> and a study variable <span class="math inline">\(z\)</span> are simulated by drawing 1,000 values from a bivariate normal distribution with a correlation coefficient of 0.8. Function <code>mvrnorm</code> of package <strong>MASS</strong> <span class="citation">(<a href="#ref-VenablesRipley2002" role="doc-biblioref">Venables and Ripley 2002</a>)</span> is used for the simulation.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="pps.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb161-2"><a href="pps.html#cb161-2" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb161-3"><a href="pps.html#cb161-3" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">10</span>; sd1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb161-4"><a href="pps.html#cb161-4" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">15</span>; sd2 <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb161-5"><a href="pps.html#cb161-5" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2)</span>
<span id="cb161-6"><a href="pps.html#cb161-6" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb161-7"><a href="pps.html#cb161-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">c</span>(sd1<span class="sc">^</span><span class="dv">2</span>, <span class="fu">rep</span>(sd1 <span class="sc">*</span>  sd2 <span class="sc">*</span>  rho, <span class="dv">2</span>), sd2<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb161-8"><a href="pps.html#cb161-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb161-9"><a href="pps.html#cb161-9" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb161-10"><a href="pps.html#cb161-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb161-11"><a href="pps.html#cb161-11" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">mvrnorm</span>(N, <span class="at">mu =</span> mu, <span class="at">Sigma =</span> sigma))</span>
<span id="cb161-12"><a href="pps.html#cb161-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;z&quot;</span>, <span class="st">&quot;x&quot;</span>)</span>
<span id="cb161-13"><a href="pps.html#cb161-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div>
<pre><code>          z         x
1  9.462930  9.149784
2 12.605847 17.306046
3  7.892686 11.979986
4  7.945021 12.567608
5 11.004325 15.165744
6 10.369943 13.258177</code></pre>
<p>Twenty units are selected by systematic ppswor sampling with random order and ordered by size. This is repeated 10,000 times.</p>
<p>The standard deviation of the 10,000 estimated means with systematic ppswor sampling with random order is 0.336, and when ordered by size 0.321. So, a small gain in precision is achieved through ordering the units by size. For comparison, I also computed the standard error for simple random sampling without replacement (SI) of the same size. The standard error with this basic sampling design is 0.424.</p>
</div>
<div id="pivotalmethod" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> The pivotal method<a href="pps.html#pivotalmethod" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another interesting algorithm for ppswor sampling is the pivotal method <span class="citation">(<a href="#ref-Deville1998" role="doc-biblioref">Deville and Tillé 1998</a>)</span>. A nice adaptation of this algorithm, the local pivotal method, leading to samples with improved (geographical) spreading, is described in Section <a href="BalancedSpreaded.html#Spreaded">9.2</a>. In the pivotal method, the <span class="math inline">\(N\)</span>-vector with inclusion probabilities is successively updated to a vector with indicators. If the indicator value for sampling unit <span class="math inline">\(k\)</span> becomes 1, then this sampling unit is selected, if it becomes 0, then it is not selected. The updating algorithm can be described as follows:</p>
<ol style="list-style-type: decimal">
<li>Select randomly two units <span class="math inline">\(k\)</span> and <span class="math inline">\(l\)</span> with <span class="math inline">\(0&lt;\pi_k&lt;1\)</span> and <span class="math inline">\(0&lt;\pi_l&lt;1\)</span>.<br />
</li>
<li>If <span class="math inline">\(\pi_k + \pi_l &lt; 1\)</span>, then update the probabilities by</li>
</ol>
<p><span class="math display" id="eq:algppswor1">\[\begin{equation}
(\pi^{\prime}_k,\pi^{\prime}_l)=\left\{
\begin{array}{cc}
(0,\pi_k+\pi_l) &amp; \;\;\;\text{with probability}\frac{\pi_l}{\pi_k+\pi_l} \\
(\pi_k+\pi_l,0) &amp; \;\;\;\text{with probability}\frac{\pi_k}{\pi_k+\pi_l}
\end{array}
\right. \;,
\tag{8.3}
\end{equation}\]</span></p>
<p>and if <span class="math inline">\(\pi_k + \pi_l \geq 1\)</span>, update the probabilities by</p>
<p><span class="math display" id="eq:algppswor2">\[\begin{equation}
(\pi^{\prime}_k,\pi^{\prime}_l)=\left\{
\begin{array}{cc}
(1,\pi_k+\pi_l-1) &amp; \;\;\;\text{with probability}\frac{1-\pi_l}{2-(\pi_k+\pi_l)} \\
(\pi_k+\pi_l-1,1) &amp; \;\;\;\text{with probability}\frac{1-\pi_k}{2-(\pi_k+\pi_l)}
\end{array}
\right.\;.
\tag{8.4}
\end{equation}\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Replace (<span class="math inline">\(\pi_k,\pi_l\)</span>) by (<span class="math inline">\(\pi^{\prime}_k,\pi^{\prime}_l\)</span>), and repeat the first two steps until each population unit is either selected (inclusion probability equals 1) or not selected (inclusion probability equals 0).</li>
</ol>
<p>In words, when the sum of the inclusion probabilities is smaller than 1, the updated inclusion probability of one of the units will become 0, which means that this unit will not be sampled. The inclusion probability of the other unit will become the sum of the two inclusion probabilities, which means that the probability increases that this unit will be selected in one of the subsequent iterations. The probability of a unit of being excluded from the sample is proportional to the inclusion probability of the other unit, so that the larger the inclusion probability of the other unit, the larger the probability that it will not be selected.</p>
<p>When the sum of the inclusion probabilities of the two units is larger than or equal to 1, then one of the units is selected (updated inclusion probability is one), while the inclusion probability of the other unit is lowered by 1 minus the inclusion probability of the selected unit. The probability of being selected is proportional to the complement of the inclusion probability of the other unit. After the inclusion probability of a unit has been updated to either 0 or 1, this unit cannot be selected anymore in the next iteration.</p>
<p>With this ppswor design, the population total can be estimated by the <span class="math inline">\(\pi\)</span> estimator, Equation <a href="IntroProbabilitySampling.html#eq:HTTotal">(2.2)</a>. The <span class="math inline">\(\pi\)</span> estimator of the mean is simply obtained by dividing the estimator for the total by the population size <span class="math inline">\(N\)</span>.</p>

<div class="rmdnote">
The inclusion probabilities <span class="math inline">\(\pi_k\)</span> used in the <span class="math inline">\(\pi\)</span> estimator are not the final probabilities obtained with the local pivotal method, which are either 0 or 1, but the initial inclusion probabilities.
</div>
<p>An alternative estimator of the population mean is the ratio estimator, also known as the Hájek estimator:</p>
<p><span class="math display" id="eq:HTTotalppsworHajek">\[\begin{equation}
\hat{\bar{z}}_{\text{Hajek}}=\frac{\sum_{k \in \mathcal{S}} w_k z_k}{\sum_{k \in \mathcal{S}} w_k} \;,
\tag{8.5}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(w_k = 1/\pi_k\)</span>. The denominator is an estimator of the population size <span class="math inline">\(N\)</span>. The Hájek estimator of the population total is obtained by multiplying the Hájek estimator of the mean with the population size <span class="math inline">\(N\)</span>. Recall that the ratio estimator of the population mean was presented before in the chapters on systematic random sampling (Equation <a href="SY.html#eq:RatioMeanSY">(5.4)</a>), cluster random sampling with simple random sampling of clusters (Equation <a href="Cl.html#eq:EstMeanRatioClEqual">(6.12)</a>), and two-stage cluster random sampling with simple random sampling of PSUs. These sampling designs have in common that the sample size (for cluster random sampling, the number of SSUs) is random.</p>
<p>Various functions in package <strong>sampling</strong> <span class="citation">(<a href="#ref-Tille2016" role="doc-biblioref">Tillé and Matei 2021</a>)</span> can be used to select a ppswor sample. In the code chunk below, I use function <code>UPrandompivotal</code>. With this function, the order of the population units is randomised before function <code>UPpivotal</code> is used. Argument <code>pi</code> is a numeric with the inclusion probabilities. These are computed with function <code>inclusionprobabilities</code>. Recall that <span class="math inline">\(\pi_k= n\;x_k/t(x)\)</span>. The sum of the inclusion probabilities should be equal to the sample size <span class="math inline">\(n\)</span>. Function <code>UPpivotal</code> returns a numeric of length <span class="math inline">\(N\)</span> with elements 1 and 0, 1 if the unit is selected, 0 if it is not selected.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="pps.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sampling)</span>
<span id="cb163-2"><a href="pps.html#cb163-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb163-3"><a href="pps.html#cb163-3" aria-hidden="true" tabindex="-1"></a>size <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(grdKandahar<span class="sc">$</span>agri <span class="sc">&lt;</span> <span class="fl">1E-12</span>, <span class="fl">0.1</span>, grdKandahar<span class="sc">$</span>agri)</span>
<span id="cb163-4"><a href="pps.html#cb163-4" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">inclusionprobabilities</span>(size, n)</span>
<span id="cb163-5"><a href="pps.html#cb163-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb163-6"><a href="pps.html#cb163-6" aria-hidden="true" tabindex="-1"></a>sampleind <span class="ot">&lt;-</span> <span class="fu">UPrandompivotal</span>(<span class="at">pik =</span> pi)</span>
<span id="cb163-7"><a href="pps.html#cb163-7" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(grdKandahar[sampleind <span class="sc">==</span> <span class="dv">1</span>, ], <span class="at">pi =</span> pi[sampleind <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb163-8"><a href="pps.html#cb163-8" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mysample)</span></code></pre></div>
<pre><code>[1] 39</code></pre>
<p>As can be seen, not 40 but only 39 units are selected. The reason is that function <code>UPrandompivotal</code> uses a very small number that can be set with argument <code>eps</code>. If the updated inclusion probability of a unit is larger than the complement of this small number <code>eps</code>, the unit is treated as being selected. The default value of <code>eps</code> is <span class="math inline">\(10^{-6}\)</span>. If we replace <code>sampleind == 1</code> by <code>sampleind &gt; 1 - eps</code>, 40 units are selected.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="pps.html#cb165-1" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb165-2"><a href="pps.html#cb165-2" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb165-3"><a href="pps.html#cb165-3" aria-hidden="true" tabindex="-1"></a>  grdKandahar[sampleind <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">-</span> eps, ], <span class="at">pi =</span> pi[sampleind <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">-</span> eps])</span>
<span id="cb165-4"><a href="pps.html#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mysample)</span></code></pre></div>
<pre><code>[1] 40</code></pre>
<p>The total poppy area can be estimated from the ppswor sample by</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="pps.html#cb167-1" aria-hidden="true" tabindex="-1"></a>tz_HT <span class="ot">&lt;-</span> <span class="fu">sum</span>(mysample<span class="sc">$</span>poppy <span class="sc">/</span> mysample<span class="sc">$</span>pi)</span>
<span id="cb167-2"><a href="pps.html#cb167-2" aria-hidden="true" tabindex="-1"></a>tz_Hajek <span class="ot">&lt;-</span> N <span class="sc">*</span> <span class="fu">sum</span>(mysample<span class="sc">$</span>poppy <span class="sc">/</span> mysample<span class="sc">$</span>pi) <span class="sc">/</span> <span class="fu">sum</span>(<span class="dv">1</span> <span class="sc">/</span> mysample<span class="sc">$</span>pi)</span></code></pre></div>
<p>The total poppy area as estimated with the <span class="math inline">\(\pi\)</span> estimator equals 88,501 ha. The Hájek estimator results in a much smaller estimated total: 62,169 ha.</p>
<p>The <span class="math inline">\(\pi\)</span> estimate can also be computed with function <code>svytotal</code> of package <strong>survey</strong>, which also provides an approximate estimate of the standard error. Various methods are implemented in function <code>svydesign</code> for approximating the standard error. These methods differ in the way the pairwise inclusion probabilities are approximated from the unitwise inclusion probabilities. These approximated pairwise inclusion probabilities are then used in the <span class="math inline">\(\pi\)</span> variance estimator or the Yates-Grundy variance estimator. In the next code chunks, Brewer’s method is used, see option 2 of Brewer’s method in <span class="citation"><a href="#ref-Berger2004" role="doc-biblioref">Berger</a> (<a href="#ref-Berger2004" role="doc-biblioref">2004</a>)</span>, as well as Hartley-Rao’s method for approximating the variance.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="pps.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb168-2"><a href="pps.html#cb168-2" aria-hidden="true" tabindex="-1"></a>design_ppsworbrewer <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb168-3"><a href="pps.html#cb168-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> mysample, <span class="at">pps =</span> <span class="st">&quot;brewer&quot;</span>, <span class="at">fpc =</span> <span class="sc">~</span> pi)</span>
<span id="cb168-4"><a href="pps.html#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="fu">svytotal</span>(<span class="sc">~</span> poppy, design_ppsworbrewer)</span></code></pre></div>
<pre><code>      total    SE
poppy 88501 14046</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="pps.html#cb170-1" aria-hidden="true" tabindex="-1"></a>p2sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(mysample<span class="sc">$</span>pi<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> n</span>
<span id="cb170-2"><a href="pps.html#cb170-2" aria-hidden="true" tabindex="-1"></a>design_ppsworhr <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb170-3"><a href="pps.html#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> mysample, <span class="at">pps =</span> <span class="fu">HR</span>(p2sum), <span class="at">fpc =</span> <span class="sc">~</span> pi)</span>
<span id="cb170-4"><a href="pps.html#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="fu">svytotal</span>(<span class="sc">~</span> poppy, design_ppsworhr)</span></code></pre></div>
<pre><code>      total    SE
poppy 88501 14900</code></pre>
<p>In package <strong>samplingVarEst</strong> <span class="citation">(<a href="#ref-samplingVarEst" role="doc-biblioref">Escobar, Zamudio, and Munoz Rosas 2019</a>)</span>, also various functions are available for approximating the variance: <code>VE.Hajek.Total.NHT</code>, <code>VE.HT.Total.NHT</code>, and <code>VE.SYG.Total.NHT</code>. The first variance approximation is the Hájek-Rosén variance estimator, see equation (4.3) in <span class="citation"><a href="#ref-Rosen1997b" role="doc-biblioref">Rosén</a> (<a href="#ref-Rosen1997b" role="doc-biblioref">1997</a>)</span>. The latter two functions require the pairwise inclusion probabilities, which can be estimated by function <code>Pkl.Hajek.s</code>.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="pps.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(samplingVarEst)</span>
<span id="cb172-2"><a href="pps.html#cb172-2" aria-hidden="true" tabindex="-1"></a>se_tz_Hajek <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">VE.Hajek.Total.NHT</span>(mysample<span class="sc">$</span>poppy, mysample<span class="sc">$</span>pi))</span>
<span id="cb172-3"><a href="pps.html#cb172-3" aria-hidden="true" tabindex="-1"></a>pikl <span class="ot">&lt;-</span> <span class="fu">Pkl.Hajek.s</span>(mysample<span class="sc">$</span>pi)</span>
<span id="cb172-4"><a href="pps.html#cb172-4" aria-hidden="true" tabindex="-1"></a>se_tz_HT <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">VE.HT.Total.NHT</span>(mysample<span class="sc">$</span>poppy, mysample<span class="sc">$</span>pi, pikl))</span>
<span id="cb172-5"><a href="pps.html#cb172-5" aria-hidden="true" tabindex="-1"></a>se_tz_SYG <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">VE.SYG.Total.NHT</span>(mysample<span class="sc">$</span>poppy, mysample<span class="sc">$</span>pi, pikl))</span></code></pre></div>
<p>The three approximated standard errors are 14,045, 14,068, and 14,017 ha. The differences are small when related to the estimated total.</p>
<p>Figure <a href="pps.html#fig:SamplingDistributionPps">8.4</a> shows the approximated sampling distribution of estimators of the total poppy area with ppswor sampling and simple random sampling without replacement of size 40, obtained by repeating the random sampling with each design and estimation 10,000 times. With the ppswor samples, the total poppy area is estimated by the <span class="math inline">\(\pi\)</span> estimator and the Hájek estimator. For each ppswor sample, the variance of the <span class="math inline">\(\pi\)</span> estimator is approximated by the Hájek-Rosén variance estimator (using function <code>VE.Hajek.Total.NHT</code> of package <strong>samplingVarEst</strong>).</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:SamplingDistributionPps"></span>
<img src="SpatialSampling_files/figure-html/SamplingDistributionPps-1.png" alt="Approximated sampling distribution of the \(\pi\) estimator (ppswor.HT) and the Hájek estimator (ppswor.Hajek) of the total poppy area (ha) in Kandahar with ppswor sampling of size 40, and of the \(\pi\) estimator with simple random sampling without replacement (SI) of size 40." width="80%" />
<p class="caption">
Figure 8.4: Approximated sampling distribution of the <span class="math inline">\(\pi\)</span> estimator (ppswor.HT) and the Hájek estimator (ppswor.Hajek) of the total poppy area (ha) in Kandahar with ppswor sampling of size 40, and of the <span class="math inline">\(\pi\)</span> estimator with simple random sampling without replacement (SI) of size 40.
</p>
</div>
<p>Sampling design ppswor in combination with the <span class="math inline">\(\pi\)</span> estimator is clearly much more precise than simple random sampling. The standard deviation of the 10,000 <span class="math inline">\(\pi\)</span> estimates of the total poppy area with ppswor equals 11,684 ha. The average of the square root of the Hájek-Rosén approximated variances equals 12,332 ha.</p>
<p>Interestingly, with ppswor sampling the variance of the 10,000 Hájek estimates is much larger than that of the <span class="math inline">\(\pi\)</span> estimates. The standard deviation of the 10,000 Hájek estimates with ppswor sampling is about equal to that of the <span class="math inline">\(\pi\)</span> estimates with simple random sampling: 31,234 ha and 33,178 ha, respectively.</p>
<div id="exercises-13" class="section level4 unnumbered hasAnchor">
<h4>Exercises<a href="pps.html#exercises-13" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol start="2" style="list-style-type: decimal">
<li>A field with poppy was found outside Kandahar in a selected sampling unit crossing the boundary. Should this field be included in the sum of the poppy area of that sampling unit?<br />
</li>
<li>In another sampling unit, a poppy field was encountered in Kandahar but in the area represented as non-agricultural in the GIS map. Should this field be included in the sum of that sampling unit?</li>
</ol>

</div>
</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Berger2004" class="csl-entry">
Berger, Y. G. 2004. <span>“A Simple Variance Estimator for Unequal Probability Sampling Without Replacement.”</span> <em>Canadian Journal of Applied Statistics</em> 31 (3): 305–15. <a href="https://doi.org/10.1080/0266476042000184046">https://doi.org/10.1080/0266476042000184046</a>.
</div>
<div id="ref-Deville1998" class="csl-entry">
Deville, J. C., and Y. Tillé. 1998. <span>“Unequal Probability Sampling Without Replacement Through a Splitting Method.”</span> <em>Biometrika</em> 85 (1): 89–101. <a href="https://doi.org/10.1093/biomet/85.1.89">https://doi.org/10.1093/biomet/85.1.89</a>.
</div>
<div id="ref-samplingVarEst" class="csl-entry">
Escobar, E. L., E. B. Zamudio, and J. F. Munoz Rosas. 2019. <em><span class="nocase">samplingVarEst: Sampling Variance Estimation</span></em>.
</div>
<div id="ref-Lumley2020" class="csl-entry">
———. 2021. <em><span class="nocase">survey: Analysis of Complex Survey Samples</span></em>.
</div>
<div id="ref-Rosen1997b" class="csl-entry">
Rosén, B. 1997. <span>“On Sampling with Probability Proportional to Size.”</span> <em>Journal of Statistical Planning and Inference</em> 62 (2): 159–91.
</div>
<div id="ref-sar92" class="csl-entry">
Särndal, C. E., B. Swensson, and J. Wretman. 1992. <em>Model Assisted Survey Sampling</em>. New York: Springer.
</div>
<div id="ref-Tille2006" class="csl-entry">
Tillé, Y. 2006. <em>Sampling Algorithms</em>. New York: Springer.
</div>
<div id="ref-Tille2016" class="csl-entry">
Tillé, Y., and A. Matei. 2021. <em><span class="nocase">sampling: Survey Sampling</span></em>. <a href="https://CRAN.R-project.org/package=sampling">https://CRAN.R-project.org/package=sampling</a>.
</div>
<div id="ref-VenablesRipley2002" class="csl-entry">
Venables, W. N., and B. D. Ripley. 2002. <em>Modern Applied Statistics with s</em>. Fourth. New York: Springer. <a href="http://www.stats.ox.ac.uk/pub/MASS4/">http://www.stats.ox.ac.uk/pub/MASS4/</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Twostage.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="BalancedSpreaded.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/DickBrus/SpatialSamplingwithR/edit/master/08-pps.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SpatialSampling.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
