<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 20 Spatial response surface sampling | Spatial sampling with R</title>
  <meta name="description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 20 Spatial response surface sampling | Spatial sampling with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.pdf" />
  <meta property="og:description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="github-repo" content="DickBrus/SpatialSamplingwithR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 20 Spatial response surface sampling | Spatial sampling with R" />
  
  <meta name="twitter:description" content="This book is for researchers, consultants and students who would like to know how to collect spatial data, either for estimating parameters for the population or several subpopulations, or for mapping. How many data do we need, and how to select the population units? The book presents a wide overview of spatial sampling designs. Besides there is a chapter on designs for sampling in space and time for monitoring. The emphasis is not on the theory, but on how to implement sampling designs in R and on how the (sub)population parameters can be estimated from the sample." />
  <meta name="twitter:image" content="/images/cover.pdf" />

<meta name="author" content="Dick J. Brus" />


<meta name="date" content="2023-01-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cLHS.html"/>
<link rel="next" href="Introkriging.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial sampling with R</a></li>

<li class="divider"></li>
<li><a href="index.html#preface" id="toc-preface">Preface</a>
<ul>
<li><a href="index.html#acknowledgments" id="toc-acknowledgments">Acknowledgments</a></li>
</ul></li>
<li><a href="GeneralIntro.html#GeneralIntro" id="toc-GeneralIntro"><span class="toc-section-number">1</span> Introduction</a>
<ul>
<li><a href="GeneralIntro.html#BasicConcepts" id="toc-BasicConcepts"><span class="toc-section-number">1.1</span> Basic sampling concepts</a>
<ul>
<li><a href="GeneralIntro.html#PopulationParameters" id="toc-PopulationParameters"><span class="toc-section-number">1.1.1</span> Population parameters</a></li>
<li><a href="GeneralIntro.html#descriptive-statistics-vs.-inference-about-a-population" id="toc-descriptive-statistics-vs.-inference-about-a-population"><span class="toc-section-number">1.1.2</span> Descriptive statistics vs. inference about a population</a></li>
<li><a href="GeneralIntro.html#random-sampling-vs.-probability-sampling" id="toc-random-sampling-vs.-probability-sampling"><span class="toc-section-number">1.1.3</span> Random sampling vs. probability sampling</a></li>
</ul></li>
<li><a href="GeneralIntro.html#DBvsMB" id="toc-DBvsMB"><span class="toc-section-number">1.2</span> Design-based vs. model-based approach</a></li>
<li><a href="GeneralIntro.html#Datasets" id="toc-Datasets"><span class="toc-section-number">1.3</span> Populations used in sampling experiments</a>
<ul>
<li><a href="GeneralIntro.html#Voorst" id="toc-Voorst"><span class="toc-section-number">1.3.1</span> Soil organic matter in Voorst, the Netherlands</a></li>
<li><a href="GeneralIntro.html#Poppy" id="toc-Poppy"><span class="toc-section-number">1.3.2</span> Poppy fields in Kandahar, Afghanistan</a></li>
<li><a href="GeneralIntro.html#Amazonia" id="toc-Amazonia"><span class="toc-section-number">1.3.3</span> Aboveground biomass in Eastern Amazonia, Brazil</a></li>
<li><a href="GeneralIntro.html#TASIberia" id="toc-TASIberia"><span class="toc-section-number">1.3.4</span> Annual mean air temperature in Iberia</a></li>
</ul></li>
</ul></li>
<li><a href="#part-probability-sampling-for-estimating-population-parameters" id="toc-part-probability-sampling-for-estimating-population-parameters">(PART) Probability sampling for estimating population parameters</a></li>
<li><a href="IntroProbabilitySampling.html#IntroProbabilitySampling" id="toc-IntroProbabilitySampling"><span class="toc-section-number">2</span> Introduction to probability sampling</a>
<ul>
<li><a href="IntroProbabilitySampling.html#arbitrary-haphazard-sampling-vs.-probability-sampling" id="toc-arbitrary-haphazard-sampling-vs.-probability-sampling">Arbitrary (haphazard) sampling vs. probability sampling</a></li>
<li><a href="IntroProbabilitySampling.html#HTestimator" id="toc-HTestimator"><span class="toc-section-number">2.1</span> Horvitz-Thompson estimator</a></li>
<li><a href="IntroProbabilitySampling.html#hansen-hurwitz-estimator" id="toc-hansen-hurwitz-estimator"><span class="toc-section-number">2.2</span> Hansen-Hurwitz estimator</a></li>
<li><a href="IntroProbabilitySampling.html#using-models-in-design-based-approach" id="toc-using-models-in-design-based-approach"><span class="toc-section-number">2.3</span> Using models in design-based approach</a></li>
</ul></li>
<li><a href="SI.html#SI" id="toc-SI"><span class="toc-section-number">3</span> Simple random sampling</a>
<ul>
<li><a href="SI.html#HTestimatorSI" id="toc-HTestimatorSI"><span class="toc-section-number">3.1</span> Estimation of population parameters</a>
<ul>
<li><a href="SI.html#PopProportion" id="toc-PopProportion"><span class="toc-section-number">3.1.1</span> Population proportion</a></li>
<li><a href="SI.html#CDF" id="toc-CDF"><span class="toc-section-number">3.1.2</span> Cumulative distribution function and quantiles</a></li>
</ul></li>
<li><a href="SI.html#VarMeanSI" id="toc-VarMeanSI"><span class="toc-section-number">3.2</span> Sampling variance of estimator of population parameters</a></li>
<li><a href="SI.html#ConfidenceInterval" id="toc-ConfidenceInterval"><span class="toc-section-number">3.3</span> Confidence interval estimate</a>
<ul>
<li><a href="SI.html#ConfidenceIntervalProportion" id="toc-ConfidenceIntervalProportion"><span class="toc-section-number">3.3.1</span> Confidence interval for a proportion</a></li>
</ul></li>
<li><a href="SI.html#SIcircularplots" id="toc-SIcircularplots"><span class="toc-section-number">3.4</span> Simple random sampling of circular plots</a>
<ul>
<li><a href="SI.html#sampling-from-a-finite-set-of-fixed-circles" id="toc-sampling-from-a-finite-set-of-fixed-circles"><span class="toc-section-number">3.4.1</span> Sampling from a finite set of fixed circles</a></li>
<li><a href="SI.html#sampling-from-an-infinite-set-of-floating-circles" id="toc-sampling-from-an-infinite-set-of-floating-circles"><span class="toc-section-number">3.4.2</span> Sampling from an infinite set of floating circles</a></li>
</ul></li>
</ul></li>
<li><a href="STSI.html#STSI" id="toc-STSI"><span class="toc-section-number">4</span> Stratified simple random sampling</a>
<ul>
<li><a href="STSI.html#EstimatorsSTSI" id="toc-EstimatorsSTSI"><span class="toc-section-number">4.1</span> Estimation of population parameters</a>
<ul>
<li><a href="STSI.html#population-proportion-cumulative-distribution-function-and-quantiles" id="toc-population-proportion-cumulative-distribution-function-and-quantiles"><span class="toc-section-number">4.1.1</span> Population proportion, cumulative distribution function, and quantiles</a></li>
<li><a href="STSI.html#WhyStratify" id="toc-WhyStratify"><span class="toc-section-number">4.1.2</span> Why should we stratify?</a></li>
</ul></li>
<li><a href="STSI.html#CISTSI" id="toc-CISTSI"><span class="toc-section-number">4.2</span> Confidence interval estimate</a></li>
<li><a href="STSI.html#STSIallocation" id="toc-STSIallocation"><span class="toc-section-number">4.3</span> Allocation of sample size to strata</a></li>
<li><a href="STSI.html#cumrootf" id="toc-cumrootf"><span class="toc-section-number">4.4</span> <em>Cum-root-f</em> stratification</a></li>
<li><a href="STSI.html#kmeansstratification" id="toc-kmeansstratification"><span class="toc-section-number">4.5</span> Stratification with multiple covariates</a></li>
<li><a href="STSI.html#geostrata" id="toc-geostrata"><span class="toc-section-number">4.6</span> Geographical stratification</a></li>
<li><a href="STSI.html#multiway-stratification" id="toc-multiway-stratification"><span class="toc-section-number">4.7</span> Multiway stratification</a></li>
<li><a href="STSI.html#MultivariateStratification" id="toc-MultivariateStratification"><span class="toc-section-number">4.8</span> Multivariate stratification</a></li>
</ul></li>
<li><a href="SY.html#SY" id="toc-SY"><span class="toc-section-number">5</span> Systematic random sampling</a>
<ul>
<li><a href="SY.html#EstVarSY" id="toc-EstVarSY"><span class="toc-section-number">5.1</span> Estimation of population parameters</a></li>
<li><a href="SY.html#approximating-the-sampling-variance-of-the-estimator-of-the-mean" id="toc-approximating-the-sampling-variance-of-the-estimator-of-the-mean"><span class="toc-section-number">5.2</span> Approximating the sampling variance of the estimator of the mean</a></li>
</ul></li>
<li><a href="Cl.html#Cl" id="toc-Cl"><span class="toc-section-number">6</span> Cluster random sampling</a>
<ul>
<li><a href="Cl.html#clustersamplingestimators" id="toc-clustersamplingestimators"><span class="toc-section-number">6.1</span> Estimation of population parameters</a></li>
<li><a href="Cl.html#clusters-selected-with-probabilities-proportional-to-size-without-replacement" id="toc-clusters-selected-with-probabilities-proportional-to-size-without-replacement"><span class="toc-section-number">6.2</span> Clusters selected with probabilities proportional to size, without replacement</a></li>
<li><a href="Cl.html#SIC" id="toc-SIC"><span class="toc-section-number">6.3</span> Simple random sampling of clusters</a></li>
<li><a href="Cl.html#StratifiedCl" id="toc-StratifiedCl"><span class="toc-section-number">6.4</span> Stratified cluster random sampling</a></li>
</ul></li>
<li><a href="Twostage.html#Twostage" id="toc-Twostage"><span class="toc-section-number">7</span> Two-stage cluster random sampling</a>
<ul>
<li><a href="Twostage.html#twostagesamplingestimators" id="toc-twostagesamplingestimators"><span class="toc-section-number">7.1</span> Estimation of population parameters</a></li>
<li><a href="Twostage.html#primary-sampling-units-selected-without-replacement" id="toc-primary-sampling-units-selected-without-replacement"><span class="toc-section-number">7.2</span> Primary sampling units selected without replacement</a></li>
<li><a href="Twostage.html#TwostageSISI" id="toc-TwostageSISI"><span class="toc-section-number">7.3</span> Simple random sampling of primary sampling units</a></li>
<li><a href="Twostage.html#StratifiedTwostage" id="toc-StratifiedTwostage"><span class="toc-section-number">7.4</span> Stratified two-stage cluster random sampling</a></li>
</ul></li>
<li><a href="pps.html#pps" id="toc-pps"><span class="toc-section-number">8</span> Sampling with probabilities proportional to size</a>
<ul>
<li><a href="pps.html#ppswr" id="toc-ppswr"><span class="toc-section-number">8.1</span> Probability-proportional-to-size sampling with replacement</a></li>
<li><a href="pps.html#ppswor" id="toc-ppswor"><span class="toc-section-number">8.2</span> Probability-proportional-to-size sampling without replacement</a>
<ul>
<li><a href="pps.html#Systematicpps" id="toc-Systematicpps"><span class="toc-section-number">8.2.1</span> Systematic pps sampling without replacement</a></li>
<li><a href="pps.html#pivotalmethod" id="toc-pivotalmethod"><span class="toc-section-number">8.2.2</span> The pivotal method</a></li>
</ul></li>
</ul></li>
<li><a href="BalancedSpreaded.html#BalancedSpreaded" id="toc-BalancedSpreaded"><span class="toc-section-number">9</span> Balanced and well-spread sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#Balanced" id="toc-Balanced"><span class="toc-section-number">9.1</span> Balanced sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#balanced-sample-vs.-balanced-sampling-design" id="toc-balanced-sample-vs.-balanced-sampling-design"><span class="toc-section-number">9.1.1</span> Balanced sample vs. balanced sampling design</a></li>
<li><a href="BalancedSpreaded.html#unequal-inclusion-probabilities" id="toc-unequal-inclusion-probabilities"><span class="toc-section-number">9.1.2</span> Unequal inclusion probabilities</a></li>
<li><a href="BalancedSpreaded.html#StratifiedsamplingasBalancedsampling" id="toc-StratifiedsamplingasBalancedsampling"><span class="toc-section-number">9.1.3</span> Stratified random sampling</a></li>
<li><a href="BalancedSpreaded.html#Multiwaystratification" id="toc-Multiwaystratification"><span class="toc-section-number">9.1.4</span> Multiway stratification</a></li>
</ul></li>
<li><a href="BalancedSpreaded.html#Spreaded" id="toc-Spreaded"><span class="toc-section-number">9.2</span> Well-spread sampling</a>
<ul>
<li><a href="BalancedSpreaded.html#LPM" id="toc-LPM"><span class="toc-section-number">9.2.1</span> Local pivotal method</a></li>
<li><a href="BalancedSpreaded.html#GRTS" id="toc-GRTS"><span class="toc-section-number">9.2.2</span> Generalised random-tessellation stratified sampling</a></li>
</ul></li>
<li><a href="BalancedSpreaded.html#BalancedandSpreaded" id="toc-BalancedandSpreaded"><span class="toc-section-number">9.3</span> Balanced sampling with spreading</a></li>
</ul></li>
<li><a href="Modelassisted.html#Modelassisted" id="toc-Modelassisted"><span class="toc-section-number">10</span> Model-assisted estimation</a>
<ul>
<li><a href="Modelassisted.html#GREG" id="toc-GREG"><span class="toc-section-number">10.1</span> Generalised regression estimator</a>
<ul>
<li><a href="Modelassisted.html#RegressionEstimator" id="toc-RegressionEstimator"><span class="toc-section-number">10.1.1</span> Simple and multiple regression estimators</a></li>
<li><a href="Modelassisted.html#penalised-least-squares-estimation" id="toc-penalised-least-squares-estimation"><span class="toc-section-number">10.1.2</span> Penalised least squares estimation</a></li>
<li><a href="Modelassisted.html#RegressionEstimatorSTSI" id="toc-RegressionEstimatorSTSI"><span class="toc-section-number">10.1.3</span> Regression estimator with stratified simple random sampling</a></li>
</ul></li>
<li><a href="Modelassisted.html#RatioEstimator" id="toc-RatioEstimator"><span class="toc-section-number">10.2</span> Ratio estimator</a>
<ul>
<li><a href="Modelassisted.html#RatioEstimatorSTSI" id="toc-RatioEstimatorSTSI"><span class="toc-section-number">10.2.1</span> Ratio estimators with stratified simple random sampling</a></li>
</ul></li>
<li><a href="Modelassisted.html#PoststratifiedEstimator" id="toc-PoststratifiedEstimator"><span class="toc-section-number">10.3</span> Poststratified estimator</a></li>
<li><a href="Modelassisted.html#RandomForest" id="toc-RandomForest"><span class="toc-section-number">10.4</span> Model-assisted estimation using machine learning techniques</a>
<ul>
<li><a href="Modelassisted.html#predicting-with-a-regression-tree" id="toc-predicting-with-a-regression-tree"><span class="toc-section-number">10.4.1</span> Predicting with a regression tree</a></li>
<li><a href="Modelassisted.html#predicting-with-a-random-forest" id="toc-predicting-with-a-random-forest"><span class="toc-section-number">10.4.2</span> Predicting with a random forest</a></li>
</ul></li>
<li><a href="Modelassisted.html#big-data-and-volunteer-data" id="toc-big-data-and-volunteer-data"><span class="toc-section-number">10.5</span> Big data and volunteer data</a></li>
</ul></li>
<li><a href="Twophase.html#Twophase" id="toc-Twophase"><span class="toc-section-number">11</span> Two-phase random sampling</a>
<ul>
<li><a href="Twophase.html#TwophaseStratification" id="toc-TwophaseStratification"><span class="toc-section-number">11.1</span> Two-phase random sampling for stratification</a></li>
<li><a href="Twophase.html#TwophaseRegression" id="toc-TwophaseRegression"><span class="toc-section-number">11.2</span> Two-phase random sampling for regression</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#RequiredSampleSize" id="toc-RequiredSampleSize"><span class="toc-section-number">12</span> Computing the required sample size</a>
<ul>
<li><a href="RequiredSampleSize.html#standard-error" id="toc-standard-error"><span class="toc-section-number">12.1</span> Standard error</a></li>
<li><a href="RequiredSampleSize.html#ReqSampleSizeLengthCI" id="toc-ReqSampleSizeLengthCI"><span class="toc-section-number">12.2</span> Length of confidence interval</a>
<ul>
<li><a href="RequiredSampleSize.html#length-of-confidence-interval-for-a-proportion" id="toc-length-of-confidence-interval-for-a-proportion"><span class="toc-section-number">12.2.1</span> Length of confidence interval for a proportion</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#statistical-testing-of-hypothesis" id="toc-statistical-testing-of-hypothesis"><span class="toc-section-number">12.3</span> Statistical testing of hypothesis</a>
<ul>
<li><a href="RequiredSampleSize.html#sample-size-for-testing-a-proportion" id="toc-sample-size-for-testing-a-proportion"><span class="toc-section-number">12.3.1</span> Sample size for testing a proportion</a></li>
</ul></li>
<li><a href="RequiredSampleSize.html#DesignEffect" id="toc-DesignEffect"><span class="toc-section-number">12.4</span> Accounting for design effect</a></li>
<li><a href="RequiredSampleSize.html#BayesianSampleSize" id="toc-BayesianSampleSize"><span class="toc-section-number">12.5</span> Bayesian sample size determination</a>
<ul>
<li><a href="RequiredSampleSize.html#bayesian-criteria-for-sample-size-computation" id="toc-bayesian-criteria-for-sample-size-computation"><span class="toc-section-number">12.5.1</span> Bayesian criteria for sample size computation</a></li>
<li><a href="RequiredSampleSize.html#mixed-bayesian-likelihood-approach" id="toc-mixed-bayesian-likelihood-approach"><span class="toc-section-number">12.5.2</span> Mixed Bayesian-likelihood approach</a></li>
<li><a href="RequiredSampleSize.html#estimation-of-population-mean" id="toc-estimation-of-population-mean"><span class="toc-section-number">12.5.3</span> Estimation of population mean</a></li>
<li><a href="RequiredSampleSize.html#estimation-of-a-population-proportion" id="toc-estimation-of-a-population-proportion"><span class="toc-section-number">12.5.4</span> Estimation of a population proportion</a></li>
</ul></li>
</ul></li>
<li><a href="MBpredictionofDesignVariance.html#MBpredictionofDesignVariance" id="toc-MBpredictionofDesignVariance"><span class="toc-section-number">13</span> Model-based optimisation of probability sampling designs</a>
<ul>
<li><a href="MBpredictionofDesignVariance.html#model-based-optimisation-of-sampling-design-type-and-sample-size" id="toc-model-based-optimisation-of-sampling-design-type-and-sample-size"><span class="toc-section-number">13.1</span> Model-based optimisation of sampling design type and sample size</a>
<ul>
<li><a href="MBpredictionofDesignVariance.html#AnalyticalApproach" id="toc-AnalyticalApproach"><span class="toc-section-number">13.1.1</span> Analytical approach</a></li>
<li><a href="MBpredictionofDesignVariance.html#GeostatisticalSimulationApproach" id="toc-GeostatisticalSimulationApproach"><span class="toc-section-number">13.1.2</span> Geostatistical simulation approach</a></li>
<li><a href="MBpredictionofDesignVariance.html#MBpredSamplingVarBayes" id="toc-MBpredSamplingVarBayes"><span class="toc-section-number">13.1.3</span> Bayesian approach</a></li>
</ul></li>
<li><a href="MBpredictionofDesignVariance.html#Ospats" id="toc-Ospats"><span class="toc-section-number">13.2</span> Model-based optimisation of spatial strata</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#SmallAreaEstimation" id="toc-SmallAreaEstimation"><span class="toc-section-number">14</span> Sampling for estimating parameters of domains</a>
<ul>
<li><a href="SmallAreaEstimation.html#LargeDomainsDirectEstimator" id="toc-LargeDomainsDirectEstimator"><span class="toc-section-number">14.1</span> Direct estimator for large domains</a></li>
<li><a href="SmallAreaEstimation.html#SmallDomainsModelAssisted" id="toc-SmallDomainsModelAssisted"><span class="toc-section-number">14.2</span> Model-assisted estimators for small domains</a>
<ul>
<li><a href="SmallAreaEstimation.html#RegressionestimatorSmallDomain" id="toc-RegressionestimatorSmallDomain"><span class="toc-section-number">14.2.1</span> Regression estimator</a></li>
<li><a href="SmallAreaEstimation.html#SyntheticestimatorSmallDomain" id="toc-SyntheticestimatorSmallDomain"><span class="toc-section-number">14.2.2</span> Synthetic estimator</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#SmallAreaModelBased" id="toc-SmallAreaModelBased"><span class="toc-section-number">14.3</span> Model-based prediction</a>
<ul>
<li><a href="SmallAreaEstimation.html#random-intercept-model" id="toc-random-intercept-model"><span class="toc-section-number">14.3.1</span> Random intercept model</a></li>
<li><a href="SmallAreaEstimation.html#geostatistical-model" id="toc-geostatistical-model"><span class="toc-section-number">14.3.2</span> Geostatistical model</a></li>
</ul></li>
<li><a href="SmallAreaEstimation.html#supplemental-probability-sampling-of-small-domains" id="toc-supplemental-probability-sampling-of-small-domains"><span class="toc-section-number">14.4</span> Supplemental probability sampling of small domains</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#RepeatedSurveys" id="toc-RepeatedSurveys"><span class="toc-section-number">15</span> Repeated sample surveys for monitoring population parameters</a>
<ul>
<li><a href="RepeatedSurveys.html#space-time-designs" id="toc-space-time-designs"><span class="toc-section-number">15.1</span> Space-time designs</a></li>
<li><a href="RepeatedSurveys.html#SpaceTimeparameters" id="toc-SpaceTimeparameters"><span class="toc-section-number">15.2</span> Space-time population parameters</a></li>
<li><a href="RepeatedSurveys.html#design-based-generalised-least-squares-estimation-of-spatial-means" id="toc-design-based-generalised-least-squares-estimation-of-spatial-means"><span class="toc-section-number">15.3</span> Design-based generalised least squares estimation of spatial means</a>
<ul>
<li><a href="RepeatedSurveys.html#current-mean" id="toc-current-mean"><span class="toc-section-number">15.3.1</span> Current mean</a></li>
<li><a href="RepeatedSurveys.html#change-of-the-spatial-mean" id="toc-change-of-the-spatial-mean"><span class="toc-section-number">15.3.2</span> Change of the spatial mean</a></li>
<li><a href="RepeatedSurveys.html#temporal-trend-of-the-spatial-mean" id="toc-temporal-trend-of-the-spatial-mean"><span class="toc-section-number">15.3.3</span> Temporal trend of the spatial mean</a></li>
<li><a href="RepeatedSurveys.html#space-time-mean" id="toc-space-time-mean"><span class="toc-section-number">15.3.4</span> Space-time mean</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#case-study-annual-mean-daily-temperature-in-iberia" id="toc-case-study-annual-mean-daily-temperature-in-iberia"><span class="toc-section-number">15.4</span> Case study: annual mean daily temperature in Iberia</a>
<ul>
<li><a href="RepeatedSurveys.html#static-synchronous-design" id="toc-static-synchronous-design"><span class="toc-section-number">15.4.1</span> Static-synchronous design</a></li>
<li><a href="RepeatedSurveys.html#independent-synchronous-design" id="toc-independent-synchronous-design"><span class="toc-section-number">15.4.2</span> Independent synchronous design</a></li>
<li><a href="RepeatedSurveys.html#serially-alternating-design" id="toc-serially-alternating-design"><span class="toc-section-number">15.4.3</span> Serially alternating design</a></li>
<li><a href="RepeatedSurveys.html#supplemented-panel-design" id="toc-supplemented-panel-design"><span class="toc-section-number">15.4.4</span> Supplemented panel design</a></li>
<li><a href="RepeatedSurveys.html#rotating-panel-design" id="toc-rotating-panel-design"><span class="toc-section-number">15.4.5</span> Rotating panel design</a></li>
<li><a href="RepeatedSurveys.html#sampling-experiment" id="toc-sampling-experiment"><span class="toc-section-number">15.4.6</span> Sampling experiment</a></li>
</ul></li>
<li><a href="RepeatedSurveys.html#space-time-sampling-with-stratified-random-sampling-in-space" id="toc-space-time-sampling-with-stratified-random-sampling-in-space"><span class="toc-section-number">15.5</span> Space-time sampling with stratified random sampling in space</a></li>
</ul></li>
<li><a href="#part-sampling-for-mapping" id="toc-part-sampling-for-mapping">(PART) Sampling for mapping</a></li>
<li><a href="IntroSamplingforMapping.html#IntroSamplingforMapping" id="toc-IntroSamplingforMapping"><span class="toc-section-number">16</span> Introduction to sampling for mapping</a>
<ul>
<li><a href="IntroSamplingforMapping.html#when-is-probability-sampling-not-required" id="toc-when-is-probability-sampling-not-required"><span class="toc-section-number">16.1</span> When is probability sampling not required?</a></li>
<li><a href="IntroSamplingforMapping.html#sampling-for-simultaneously-mapping-and-estimating-means" id="toc-sampling-for-simultaneously-mapping-and-estimating-means"><span class="toc-section-number">16.2</span> Sampling for simultaneously mapping and estimating means</a></li>
<li><a href="IntroSamplingforMapping.html#broad-overview-of-sampling-designs-for-mapping" id="toc-broad-overview-of-sampling-designs-for-mapping"><span class="toc-section-number">16.3</span> Broad overview of sampling designs for mapping</a></li>
</ul></li>
<li><a href="RegularGridSpatialCoverage.html#RegularGridSpatialCoverage" id="toc-RegularGridSpatialCoverage"><span class="toc-section-number">17</span> Regular grid and spatial coverage sampling</a>
<ul>
<li><a href="RegularGridSpatialCoverage.html#Regulargrid" id="toc-Regulargrid"><span class="toc-section-number">17.1</span> Regular grid sampling</a></li>
<li><a href="RegularGridSpatialCoverage.html#SpatialCoverage" id="toc-SpatialCoverage"><span class="toc-section-number">17.2</span> Spatial coverage sampling</a></li>
<li><a href="RegularGridSpatialCoverage.html#SpatialInfill" id="toc-SpatialInfill"><span class="toc-section-number">17.3</span> Spatial infill sampling</a></li>
</ul></li>
<li><a href="kmeans.html#kmeans" id="toc-kmeans"><span class="toc-section-number">18</span> Covariate space coverage sampling</a>
<ul>
<li><a href="kmeans.html#covariate-space-infill-sampling" id="toc-covariate-space-infill-sampling"><span class="toc-section-number">18.1</span> Covariate space infill sampling</a></li>
<li><a href="kmeans.html#PerformanceCSC" id="toc-PerformanceCSC"><span class="toc-section-number">18.2</span> Performance of covariate space coverage sampling in random forest prediction</a></li>
</ul></li>
<li><a href="cLHS.html#cLHS" id="toc-cLHS"><span class="toc-section-number">19</span> Conditioned Latin hypercube sampling</a>
<ul>
<li><a href="cLHS.html#cLHIS" id="toc-cLHIS"><span class="toc-section-number">19.1</span> Conditioned Latin hypercube infill sampling</a></li>
<li><a href="cLHS.html#performance-of-conditioned-latin-hypercube-sampling-in-random-forest-prediction" id="toc-performance-of-conditioned-latin-hypercube-sampling-in-random-forest-prediction"><span class="toc-section-number">19.2</span> Performance of conditioned Latin hypercube sampling in random forest prediction</a></li>
</ul></li>
<li><a href="SpatialResponseSurface.html#SpatialResponseSurface" id="toc-SpatialResponseSurface"><span class="toc-section-number">20</span> Spatial response surface sampling</a>
<ul>
<li><a href="SpatialResponseSurface.html#IncreaseSampleSize" id="toc-IncreaseSampleSize"><span class="toc-section-number">20.1</span> Increasing the sample size</a></li>
<li><a href="SpatialResponseSurface.html#stratified-spatial-response-surface-sampling" id="toc-stratified-spatial-response-surface-sampling"><span class="toc-section-number">20.2</span> Stratified spatial response surface sampling</a></li>
<li><a href="SpatialResponseSurface.html#mapping" id="toc-mapping"><span class="toc-section-number">20.3</span> Mapping</a></li>
</ul></li>
<li><a href="Introkriging.html#Introkriging" id="toc-Introkriging"><span class="toc-section-number">21</span> Introduction to kriging</a>
<ul>
<li><a href="Introkriging.html#OrdinaryKriging" id="toc-OrdinaryKriging"><span class="toc-section-number">21.1</span> Ordinary kriging</a></li>
<li><a href="Introkriging.html#BlockKriging" id="toc-BlockKriging"><span class="toc-section-number">21.2</span> Block-kriging</a></li>
<li><a href="Introkriging.html#IntroKED" id="toc-IntroKED"><span class="toc-section-number">21.3</span> Kriging with an external drift</a></li>
<li><a href="Introkriging.html#VariogramEstimation" id="toc-VariogramEstimation"><span class="toc-section-number">21.4</span> Estimating the semivariogram</a>
<ul>
<li><a href="Introkriging.html#MoM" id="toc-MoM"><span class="toc-section-number">21.4.1</span> Method-of-moments</a></li>
<li><a href="Introkriging.html#MLestimationVariogram" id="toc-MLestimationVariogram"><span class="toc-section-number">21.4.2</span> Maximum likelihood</a></li>
</ul></li>
<li><a href="Introkriging.html#ResidualVariogram" id="toc-ResidualVariogram"><span class="toc-section-number">21.5</span> Estimating the residual semivariogram</a>
<ul>
<li><a href="Introkriging.html#IterativeMoM" id="toc-IterativeMoM"><span class="toc-section-number">21.5.1</span> Iterative method-of-moments</a></li>
<li><a href="Introkriging.html#REML" id="toc-REML"><span class="toc-section-number">21.5.2</span> Restricted maximum likelihood</a></li>
</ul></li>
</ul></li>
<li><a href="MBgridspacing.html#MBgridspacing" id="toc-MBgridspacing"><span class="toc-section-number">22</span> Model-based optimisation of the grid spacing</a>
<ul>
<li><a href="MBgridspacing.html#GridspacingOK" id="toc-GridspacingOK"><span class="toc-section-number">22.1</span> Optimal grid spacing for ordinary kriging</a></li>
<li><a href="MBgridspacing.html#controlling-the-mean-or-a-quantile-of-the-ordinary-kriging-variance" id="toc-controlling-the-mean-or-a-quantile-of-the-ordinary-kriging-variance"><span class="toc-section-number">22.2</span> Controlling the mean or a quantile of the ordinary kriging variance</a></li>
<li><a href="MBgridspacing.html#optimal-grid-spacing-for-block-kriging" id="toc-optimal-grid-spacing-for-block-kriging"><span class="toc-section-number">22.3</span> Optimal grid spacing for block-kriging</a></li>
<li><a href="MBgridspacing.html#MBgridspacingKED" id="toc-MBgridspacingKED"><span class="toc-section-number">22.4</span> Optimal grid spacing for kriging with an external drift</a></li>
<li><a href="MBgridspacing.html#BayesianGridSpacing" id="toc-BayesianGridSpacing"><span class="toc-section-number">22.5</span> Bayesian approach</a></li>
</ul></li>
<li><a href="MBSamplePattern.html#MBSamplePattern" id="toc-MBSamplePattern"><span class="toc-section-number">23</span> Model-based optimisation of the sampling pattern</a>
<ul>
<li><a href="MBSamplePattern.html#SSA" id="toc-SSA"><span class="toc-section-number">23.1</span> Spatial simulated annealing</a></li>
<li><a href="MBSamplePattern.html#SamplePatternOK" id="toc-SamplePatternOK"><span class="toc-section-number">23.2</span> Optimising the sampling pattern for ordinary kriging</a></li>
<li><a href="MBSamplePattern.html#SamplePatternKED" id="toc-SamplePatternKED"><span class="toc-section-number">23.3</span> Optimising the sampling pattern for kriging with an external drift</a></li>
<li><a href="MBSamplePattern.html#model-based-infill-sampling-for-ordinary-kriging" id="toc-model-based-infill-sampling-for-ordinary-kriging"><span class="toc-section-number">23.4</span> Model-based infill sampling for ordinary kriging</a></li>
<li><a href="MBSamplePattern.html#model-based-infill-sampling-for-kriging-with-an-external-drift" id="toc-model-based-infill-sampling-for-kriging-with-an-external-drift"><span class="toc-section-number">23.5</span> Model-based infill sampling for kriging with an external drift</a></li>
</ul></li>
<li><a href="SamplingVariogram.html#SamplingVariogram" id="toc-SamplingVariogram"><span class="toc-section-number">24</span> Sampling for estimating the semivariogram</a>
<ul>
<li><a href="SamplingVariogram.html#NestedSampling" id="toc-NestedSampling"><span class="toc-section-number">24.1</span> Nested sampling</a></li>
<li><a href="SamplingVariogram.html#IndependentSamplingPairs" id="toc-IndependentSamplingPairs"><span class="toc-section-number">24.2</span> Independent sampling of pairs of points</a></li>
<li><a href="SamplingVariogram.html#samplingforvariogram" id="toc-samplingforvariogram"><span class="toc-section-number">24.3</span> Optimisation of sampling pattern for semivariogram estimation</a>
<ul>
<li><a href="SamplingVariogram.html#UncertainSemivariogramParameters" id="toc-UncertainSemivariogramParameters"><span class="toc-section-number">24.3.1</span> Uncertainty about semivariogram parameters</a></li>
<li><a href="SamplingVariogram.html#UncertainKrigingVariance" id="toc-UncertainKrigingVariance"><span class="toc-section-number">24.3.2</span> Uncertainty about the kriging variance</a></li>
</ul></li>
<li><a href="SamplingVariogram.html#SamplingEstimationandPrediction" id="toc-SamplingEstimationandPrediction"><span class="toc-section-number">24.4</span> Optimisation of sampling pattern for semivariogram estimation and mapping</a></li>
<li><a href="SamplingVariogram.html#a-practical-solution" id="toc-a-practical-solution"><span class="toc-section-number">24.5</span> A practical solution</a></li>
</ul></li>
<li><a href="Validation.html#Validation" id="toc-Validation"><span class="toc-section-number">25</span> Sampling for validation of maps</a>
<ul>
<li><a href="Validation.html#map-quality-indices" id="toc-map-quality-indices"><span class="toc-section-number">25.1</span> Map quality indices</a>
<ul>
<li><a href="Validation.html#estimation-of-map-quality-indices" id="toc-estimation-of-map-quality-indices"><span class="toc-section-number">25.1.1</span> Estimation of map quality indices</a></li>
</ul></li>
<li><a href="Validation.html#real-world-case-study" id="toc-real-world-case-study"><span class="toc-section-number">25.2</span> Real-world case study</a>
<ul>
<li><a href="Validation.html#estimation-of-the-population-mean-error-and-mean-squared-error" id="toc-estimation-of-the-population-mean-error-and-mean-squared-error"><span class="toc-section-number">25.2.1</span> Estimation of the population mean error and mean squared error</a></li>
<li><a href="Validation.html#estimation-of-the-standard-error-of-the-estimator-of-the-population-mean-error-and-mean-squared-error" id="toc-estimation-of-the-standard-error-of-the-estimator-of-the-population-mean-error-and-mean-squared-error"><span class="toc-section-number">25.2.2</span> Estimation of the standard error of the estimator of the population mean error and mean squared error</a></li>
<li><a href="Validation.html#estimation-of-model-efficiency-coefficient" id="toc-estimation-of-model-efficiency-coefficient"><span class="toc-section-number">25.2.3</span> Estimation of model efficiency coefficient</a></li>
<li><a href="Validation.html#statistical-testing-of-hypothesis-about-population-me-and-mse" id="toc-statistical-testing-of-hypothesis-about-population-me-and-mse"><span class="toc-section-number">25.2.4</span> Statistical testing of hypothesis about population ME and MSE</a></li>
</ul></li>
</ul></li>
<li><a href="Approaches.html#Approaches" id="toc-Approaches"><span class="toc-section-number">26</span> Design-based, model-based, and model-assisted approach for sampling and inference</a>
<ul>
<li><a href="Approaches.html#two-sources-of-randomness" id="toc-two-sources-of-randomness"><span class="toc-section-number">26.1</span> Two sources of randomness</a></li>
<li><a href="Approaches.html#iid" id="toc-iid"><span class="toc-section-number">26.2</span> Identically and independently distributed</a></li>
<li><a href="Approaches.html#BiasandVariance" id="toc-BiasandVariance"><span class="toc-section-number">26.3</span> Bias and variance</a></li>
<li><a href="Approaches.html#effectivesamplesize" id="toc-effectivesamplesize"><span class="toc-section-number">26.4</span> Effective sample size</a></li>
<li><a href="Approaches.html#ExploitSpatialStructure" id="toc-ExploitSpatialStructure"><span class="toc-section-number">26.5</span> Exploiting spatial structure in design-based approach</a></li>
<li><a href="Approaches.html#ModelassistedvsModeldependent" id="toc-ModelassistedvsModeldependent"><span class="toc-section-number">26.6</span> Model-assisted vs. model-dependent</a></li>
</ul></li>
<li><a href="#appendix-appendices" id="toc-appendix-appendices">(APPENDIX) Appendices</a></li>
<li><a href="Answers.html#Answers" id="toc-Answers"><span class="toc-section-number">27</span> Answers to exercises</a>
<ul>
<li><a href="Answers.html#introduction-to-probability-sampling" id="toc-introduction-to-probability-sampling">Introduction to probability sampling</a></li>
<li><a href="Answers.html#simple-random-sampling-1" id="toc-simple-random-sampling-1">Simple random sampling</a></li>
<li><a href="Answers.html#stratified-simple-random-sampling-1" id="toc-stratified-simple-random-sampling-1">Stratified simple random sampling</a></li>
<li><a href="Answers.html#systematic-random-sampling-2" id="toc-systematic-random-sampling-2">Systematic random sampling</a></li>
<li><a href="Answers.html#cluster-random-sampling" id="toc-cluster-random-sampling">Cluster random sampling</a></li>
<li><a href="Answers.html#two-stage-cluster-random-sampling-1" id="toc-two-stage-cluster-random-sampling-1">Two-stage cluster random sampling</a></li>
<li><a href="Answers.html#sampling-with-probabilities-proportional-to-size" id="toc-sampling-with-probabilities-proportional-to-size">Sampling with probabilities proportional to size</a></li>
<li><a href="Answers.html#balanced-and-well-spread-sampling" id="toc-balanced-and-well-spread-sampling">Balanced and well-spread sampling</a></li>
<li><a href="Answers.html#model-assisted-estimation" id="toc-model-assisted-estimation">Model-assisted estimation</a></li>
<li><a href="Answers.html#two-phase-random-sampling" id="toc-two-phase-random-sampling">Two-phase random sampling</a></li>
<li><a href="Answers.html#computing-the-required-sample-size" id="toc-computing-the-required-sample-size">Computing the required sample size</a></li>
<li><a href="Answers.html#model-based-optimisation-of-probability-sampling-designs" id="toc-model-based-optimisation-of-probability-sampling-designs">Model-based optimisation of probability sampling designs</a></li>
<li><a href="Answers.html#repeated-sample-surveys-for-monitoring-population-parameters" id="toc-repeated-sample-surveys-for-monitoring-population-parameters">Repeated sample surveys for monitoring population parameters</a></li>
<li><a href="Answers.html#regular-grid-and-spatial-coverage-sampling" id="toc-regular-grid-and-spatial-coverage-sampling">Regular grid and spatial coverage sampling</a></li>
<li><a href="Answers.html#covariate-space-coverage-sampling" id="toc-covariate-space-coverage-sampling">Covariate space coverage sampling</a></li>
<li><a href="Answers.html#conditioned-latin-hypercube-sampling" id="toc-conditioned-latin-hypercube-sampling">Conditioned Latin hypercube sampling</a></li>
<li><a href="Answers.html#model-based-optimisation-of-the-grid-spacing" id="toc-model-based-optimisation-of-the-grid-spacing">Model-based optimisation of the grid spacing</a></li>
<li><a href="Answers.html#model-based-optimisation-of-the-sampling-pattern" id="toc-model-based-optimisation-of-the-sampling-pattern">Model-based optimisation of the sampling pattern</a></li>
<li><a href="Answers.html#sampling-for-estimating-the-semivariogram" id="toc-sampling-for-estimating-the-semivariogram">Sampling for estimating the semivariogram</a></li>
<li><a href="Answers.html#sampling-for-validation-of-maps" id="toc-sampling-for-validation-of-maps">Sampling for validation of maps</a></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/DickBrus/">Dick Brus</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial sampling with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="SpatialResponseSurface" class="section level1 hasAnchor" number="20">
<h1><span class="header-section-number">Chapter 20</span> Spatial response surface sampling<a href="SpatialResponseSurface.html#SpatialResponseSurface" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>As with conditioned Latin hypercube sampling, spatial response surface sampling is an experimental design adapted for spatial surveys. Experimental response surface designs aim at finding an optimum of the response within specified ranges of the factors. There are many types of response surface designs, see <span class="citation">Myers, Montgomery, and Anderson-Cook (<a href="#ref-myers2002" role="doc-biblioref">2009</a>)</span>. With response surface sampling one assumes that some type of low order regression model can be used to accurately approximate the relationship between the study variable and the covariates. A commonly used design is the central composite design. The data obtained with this design are used to fit a multiple linear regression model with quadratic terms, yielding a curved, quadratic surface of the response.</p>
<p>The response surface sampling approach is an adaptation of an experimental design, but at the same time it is an example of a model-based sampling design. Sampling units are selected to implicitly optimise the estimation of the quadratic regression model. However, this optimisation is done under one or more spatial constraints. Unconstrained optimisation of the sampling design under the linear regression model will not prevent the units from spatial clustering, see the optimal sample in Figure <a href="IntroSamplingforMapping.html#fig:twosamples">16.1</a>. The assumption of independent data might be violated when the sampling units are spatially clustered. For this reason, the response surface sampling design selects samples with good spatial coverage, so that the design becomes robust against violation of the independence assumption.</p>
<p><span class="citation">Lesch, Strauss, and Rhoades (<a href="#ref-lesch95" role="doc-biblioref">1995</a>)</span> adapted the response surface methodology for observational studies. Several problems needed to be tackled. First, when multiple covariates are used, the covariates must be decorrelated. Second, when sampling units are spatially clustered, the assumption in linear regression modelling of spatially uncorrelated model residuals can be violated. To address these two problems, <span class="citation">Lesch, Strauss, and Rhoades (<a href="#ref-lesch95" role="doc-biblioref">1995</a>)</span> proposed the following procedure; see also <span class="citation">Lesch (<a href="#ref-lesch2005" role="doc-biblioref">2005</a>)</span>:</p>
<ol style="list-style-type: decimal">
<li>Transform the covariate matrix into a scaled, centred, decorrelated matrix by principal components analysis (PCA).<br />
</li>
<li>Choose the response surface design type.<br />
</li>
<li>Select candidate sampling units based on the distance from the design points in the space spanned by the principal components. Select multiple sampling units per design point.<br />
</li>
<li>Select the combination of candidate sampling units with the highest value for a criterion that quantifies how uniform the sample is spread across the study area.</li>
</ol>
<p>This design has been applied, among others, for mapping soil salinity (ECe), using electromagnetic (EM) induction measurements and surface array conductivity measurements as predictors in multiple linear regression models. For applications, see <span class="citation">Corwin and Lesch (<a href="#ref-corwin2005" role="doc-biblioref">2005</a>)</span>, <span class="citation">Lesch (<a href="#ref-lesch2005" role="doc-biblioref">2005</a>)</span>, <span class="citation">Fitzgerald et al. (<a href="#ref-fitzgerald2006" role="doc-biblioref">2006</a>)</span>, <span class="citation">Corwin et al. (<a href="#ref-Corwin2010" role="doc-biblioref">2010</a>)</span>, and <span class="citation">Fitzgerald (<a href="#ref-Fitzgerald2010" role="doc-biblioref">2010</a>)</span>.</p>
<p>Spatial response surface sampling is illustrated with the EM measurements (mS m<sup>-1</sup>) of the apparent electrical conductivity on the 80 ha Cotton Research Farm in Uzbekistan. The EM measurements in vertical dipole mode, with transmitter at 1 m and 0.5 m from the receiver, are on transects covering the Cotton Research Farm (Figure <a href="SpatialResponseSurface.html#fig:EMdataUzbekistan">20.1</a>). As a first step, the natural log of the two EM measurements, denoted by lnEM, are interpolated by ordinary kriging to a fine grid (Figure <a href="SpatialResponseSurface.html#fig:EMdataUzbekistan2">20.2</a>). These ordinary kriging predictions of lnEM are used as covariates in response surface sampling. The two covariates are strongly correlated, <span class="math inline">\(r=0.73\)</span>, as expected since they are interpolations of measurements of the same variable but of different overlapping layers.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:EMdataUzbekistan"></span>
<img src="SpatialSampling_files/figure-html/EMdataUzbekistan-1.png" alt="Natural log of EM measurements on the Cotton Research Farm (with transmitter at 1 m and 0.5 m from receiver)." width="100%" />
<p class="caption">
Figure 20.1: Natural log of EM measurements on the Cotton Research Farm (with transmitter at 1 m and 0.5 m from receiver).
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:EMdataUzbekistan2"></span>
<img src="SpatialSampling_files/figure-html/EMdataUzbekistan2-1.png" alt="Interpolated surfaces of natural log of EM measurements on the Cotton Research Farm, used as covariates in spatial response surface sampling." width="100%" />
<p class="caption">
Figure 20.2: Interpolated surfaces of natural log of EM measurements on the Cotton Research Farm, used as covariates in spatial response surface sampling.
</p>
</div>
<p>Function <code>prcomp</code> of the <strong>stats</strong> package <span class="citation">(<a href="#ref-R2020" role="doc-biblioref">R Core Team 2021</a>)</span> is used to compute the principal component scores for all units in the population (grid cells). The two covariates are centred and scaled, i.e., standardised principal components are computed.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="SpatialResponseSurface.html#cb443-1" aria-hidden="true" tabindex="-1"></a>pc <span class="ot">&lt;-</span> grdCRF <span class="sc">%&gt;%</span></span>
<span id="cb443-2"><a href="SpatialResponseSurface.html#cb443-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(lnEM100cm, lnEM50cm) <span class="sc">%&gt;%</span></span>
<span id="cb443-3"><a href="SpatialResponseSurface.html#cb443-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prcomp</span>(<span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The means of the two principal component scores are 0; however, their standard deviations are not zero but 1.330 and 0.480. Therefore, the principal component scores are divided by these standard deviations. They then will have the same weight in the following steps.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="SpatialResponseSurface.html#cb444-1" aria-hidden="true" tabindex="-1"></a>grdCRF <span class="ot">&lt;-</span> grdCRF <span class="sc">%&gt;%</span></span>
<span id="cb444-2"><a href="SpatialResponseSurface.html#cb444-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb444-3"><a href="SpatialResponseSurface.html#cb444-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">PC1 =</span> pc<span class="sc">$</span>x[, <span class="dv">1</span>] <span class="sc">/</span> pc<span class="sc">$</span>sdev[<span class="dv">1</span>],</span>
<span id="cb444-4"><a href="SpatialResponseSurface.html#cb444-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">PC2 =</span> pc<span class="sc">$</span>x[, <span class="dv">2</span>] <span class="sc">/</span> pc<span class="sc">$</span>sdev[<span class="dv">2</span>])</span></code></pre></div>
<p>Function <code>ccd</code> of package <strong>rsm</strong> <span class="citation">(<a href="#ref-Lenth2009" role="doc-biblioref">Lenth 2009</a>)</span> is now used to generate a central composite response surface design (CCRSD). Argument <code>basis</code> specifies the number of factors, which is two in our case. Argument <code>n0</code> is the number of centre points, and argument <code>alpha</code> determines the position of the star points (explained hereafter).</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="SpatialResponseSurface.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsm)</span>
<span id="cb445-2"><a href="SpatialResponseSurface.html#cb445-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb445-3"><a href="SpatialResponseSurface.html#cb445-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ccdesign <span class="ot">&lt;-</span> <span class="fu">ccd</span>(<span class="at">basis =</span> <span class="dv">2</span>, <span class="at">n0 =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="st">&quot;rotatable&quot;</span>))</span></code></pre></div>
<pre><code>   run.order std.order  x1.as.is  x2.as.is Block
1          1         4  1.000000  1.000000     1
2          2         5  0.000000  0.000000     1
3          3         2  1.000000 -1.000000     1
4          4         1 -1.000000 -1.000000     1
5          5         3 -1.000000  1.000000     1
6          1         5  0.000000  0.000000     2
7          2         3  0.000000 -1.414214     2
8          3         1 -1.414214  0.000000     2
9          4         4  0.000000  1.414214     2
10         5         2  1.414214  0.000000     2

Data are stored in coded form using these coding formulas ...
x1 ~ x1.as.is
x2 ~ x2.as.is</code></pre>
<p>The experiment consists of two blocks, each of five experimental units. Block 1, the so-called cube block, consists of one centre point and four cube points. In the experimental unit represented by the centre point, both factors have levels in the centre of the experimental range. In the experimental units represented by the cube points, the levels of both factors is either -1 or +1 unit in the design space. Block 2, referred to as the star block, consists of one centre point and four star points. With <code>alpha = "rotatable"</code> the star points are on the circle circumscribing the square (Figure <a href="SpatialResponseSurface.html#fig:ccdesign">20.3</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ccdesign"></span>
<img src="SpatialSampling_files/figure-html/ccdesign-1.png" alt="Rotatable central composite design for two factors." width="80%" />
<p class="caption">
Figure 20.3: Rotatable central composite design for two factors.
</p>
</div>
<p>To adapt this design for an observational study, we drop one of the centre points (0,0).</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="SpatialResponseSurface.html#cb447-1" aria-hidden="true" tabindex="-1"></a>ccd_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> ccdesign<span class="sc">$</span>x1, <span class="at">x2 =</span> ccdesign<span class="sc">$</span>x2)</span>
<span id="cb447-2"><a href="SpatialResponseSurface.html#cb447-2" aria-hidden="true" tabindex="-1"></a>ccd_df <span class="ot">&lt;-</span> ccd_df[<span class="sc">-</span><span class="dv">6</span>, ]</span></code></pre></div>
<p>The coordinates of the CCRSD points are multiplied by a factor so that a large proportion <span class="math inline">\(p\)</span> of the bivariate standardised principal component scores of the population units is covered by the circle that passes through the design points (Figure <a href="SpatialResponseSurface.html#fig:ccdesign">20.3</a>). The factor is computed as a sample quantile of the empirical distribution of the distances of the points in the scatter to the centre. For <span class="math inline">\(p\)</span>, I chose 0.7.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="SpatialResponseSurface.html#cb448-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(grdCRF<span class="sc">$</span>PC1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> grdCRF<span class="sc">$</span>PC2<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb448-2"><a href="SpatialResponseSurface.html#cb448-2" aria-hidden="true" tabindex="-1"></a>fct <span class="ot">&lt;-</span> <span class="fu">quantile</span>(d, <span class="at">p =</span> <span class="fl">0.7</span>)</span>
<span id="cb448-3"><a href="SpatialResponseSurface.html#cb448-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fct)</span></code></pre></div>
<pre><code>     70% 
1.472547 </code></pre>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="SpatialResponseSurface.html#cb450-1" aria-hidden="true" tabindex="-1"></a>ccd_df <span class="ot">&lt;-</span> ccd_df <span class="sc">%&gt;%</span></span>
<span id="cb450-2"><a href="SpatialResponseSurface.html#cb450-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x1 =</span> x1 <span class="sc">*</span> fct, <span class="at">x2 =</span> x2 <span class="sc">*</span> fct)</span></code></pre></div>
<p>The next step is to select for each design point several candidate sampling points. For each of the nine design points, eight points are selected that are closest to that design point. This results in 9 <span class="math inline">\(\times\)</span> 8 candidate sampling points.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="SpatialResponseSurface.html#cb451-1" aria-hidden="true" tabindex="-1"></a>candi_all <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb451-2"><a href="SpatialResponseSurface.html#cb451-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(ccd_df))) {</span>
<span id="cb451-3"><a href="SpatialResponseSurface.html#cb451-3" aria-hidden="true" tabindex="-1"></a>    d2dpnt <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((grdCRF<span class="sc">$</span>PC1 <span class="sc">-</span> ccd_df<span class="sc">$</span>x1[i])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb451-4"><a href="SpatialResponseSurface.html#cb451-4" aria-hidden="true" tabindex="-1"></a>      (grdCRF<span class="sc">$</span>PC2 <span class="sc">-</span> ccd_df<span class="sc">$</span>x2[i])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb451-5"><a href="SpatialResponseSurface.html#cb451-5" aria-hidden="true" tabindex="-1"></a>    grdCRF <span class="ot">&lt;-</span> grdCRF[<span class="fu">order</span>(d2dpnt), ]</span>
<span id="cb451-6"><a href="SpatialResponseSurface.html#cb451-6" aria-hidden="true" tabindex="-1"></a>    candi <span class="ot">&lt;-</span> grdCRF[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>), <span class="fu">c</span>(<span class="st">&quot;point_id&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;PC1&quot;</span>, <span class="st">&quot;PC2&quot;</span>)]</span>
<span id="cb451-7"><a href="SpatialResponseSurface.html#cb451-7" aria-hidden="true" tabindex="-1"></a>    candi<span class="sc">$</span>dpnt <span class="ot">&lt;-</span> i</span>
<span id="cb451-8"><a href="SpatialResponseSurface.html#cb451-8" aria-hidden="true" tabindex="-1"></a>    candi_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(candi_all, candi)</span>
<span id="cb451-9"><a href="SpatialResponseSurface.html#cb451-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Figure <a href="SpatialResponseSurface.html#fig:candidatelocations">20.4</a> shows the nine clusters of candidate sampling points around the design points. Note that the location of the candidate sampling points associated with the design points with coordinates (0,-2.13), (1.51,-1.51), and (2.13,0) are all far inside the circle that passes through the design points. So, for the optimised sample, there will be three points with principal component scores that considerably differ from the ideal values according to the CCRSD design.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:candidatelocations"></span>
<img src="SpatialSampling_files/figure-html/candidatelocations-1.png" alt="Clusters of points (red points) around the design points (triangles) of a CCRSD (two covariates), serving as candidate sampling points." width="80%" />
<p class="caption">
Figure 20.4: Clusters of points (red points) around the design points (triangles) of a CCRSD (two covariates), serving as candidate sampling points.
</p>
</div>
<p>Figure <a href="SpatialResponseSurface.html#fig:candidatesingeospace">20.5</a> shows that in geographical space for most design points there are multiple spatial clusters of candidate units. For instance, for design point nine, there are three clusters of candidate sampling units. Therefore, there is scope to optimise the sample computationally.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:candidatesingeospace"></span>
<img src="SpatialSampling_files/figure-html/candidatesingeospace-1.png" alt="Candidate sampling points plotted on a map of the first standardised principal component (PC1)." width="100%" />
<p class="caption">
Figure 20.5: Candidate sampling points plotted on a map of the first standardised principal component (PC1).
</p>
</div>
<p>As a first step, an initial subsample from the candidate sampling units is selected by stratified simple random sampling, using the levels of factor <code>dpnt</code> as strata. Function <code>strata</code> of package <strong>sampling</strong> is used for stratified random sampling <span class="citation">(<a href="#ref-Tille2016" role="doc-biblioref">Tillé and Matei 2021</a>)</span>.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="SpatialResponseSurface.html#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sampling)</span>
<span id="cb452-2"><a href="SpatialResponseSurface.html#cb452-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb452-3"><a href="SpatialResponseSurface.html#cb452-3" aria-hidden="true" tabindex="-1"></a>units_stsi <span class="ot">&lt;-</span> sampling<span class="sc">::</span><span class="fu">strata</span>(</span>
<span id="cb452-4"><a href="SpatialResponseSurface.html#cb452-4" aria-hidden="true" tabindex="-1"></a>  candi_all, <span class="at">stratanames =</span> <span class="st">&quot;dpnt&quot;</span>, <span class="at">size =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">9</span>))</span>
<span id="cb452-5"><a href="SpatialResponseSurface.html#cb452-5" aria-hidden="true" tabindex="-1"></a>mysample0 <span class="ot">&lt;-</span> <span class="fu">getdata</span>(candi_all, units_stsi) <span class="sc">%&gt;%</span></span>
<span id="cb452-6"><a href="SpatialResponseSurface.html#cb452-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>(ID_unit<span class="sc">:</span>Stratum))</span></code></pre></div>
<p>The locations of the nine sampling units are now optimised by minimising a criterion that is a function of the distance between the nine sampling points. Two minimisation criteria are implemented, a geometric criterion and a model-based criterion.</p>
<p>In the geometric criterion (as proposed by <span class="citation">Lesch (<a href="#ref-lesch2005" role="doc-biblioref">2005</a>)</span>) for each sampling point the log of the shortest distance to the other points is computed. The minimisation criterion is the negative of the sample mean of these distances.</p>
<p>The model-based minimisation criterion is the average correlation of the sampling points. This criterion requires as input the parameters of a residual correlogram (see Section <a href="Introkriging.html#IntroKED">21.3</a>). I assume an exponential correlogram without nugget, so that the only parameter to be chosen is the distance parameter <span class="math inline">\(\phi\)</span> (Equation <a href="Introkriging.html#eq:exponential">(21.13)</a>). Three times <span class="math inline">\(\phi\)</span> is referred to as the effective range of the exponential correlogram. The correlation of the random variables at two points separated by this distance is 0.05.</p>
<p>A penalty term is added to the geometric or the model-based minimisation criterion, equal to the average distance of the sampling points to the associated design points, multiplied by a weight. With weights <span class="math inline">\(&gt;0\)</span>, sampling points close to the design points are preferred over more distant points.</p>
<p>In the next code chunk, a function is defined for computing the minimisation criterion. Given a chosen value for <span class="math inline">\(\phi\)</span>, the 9 <span class="math inline">\(\times\)</span> 9 distance matrix of the sampling points can be converted into a correlation matrix, using function <code>variogramLine</code> of package <strong>gstat</strong> <span class="citation">(<a href="#ref-peb04" role="doc-biblioref">E. J. Pebesma 2004</a>)</span>. Argument <code>weight</code> is an optional argument with default value 0.</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="SpatialResponseSurface.html#cb453-1" aria-hidden="true" tabindex="-1"></a>getCriterion <span class="ot">&lt;-</span> <span class="cf">function</span>(mysample, dpnt, <span class="at">weight =</span> <span class="dv">0</span>, <span class="at">phi =</span> <span class="cn">NULL</span>) {</span>
<span id="cb453-2"><a href="SpatialResponseSurface.html#cb453-2" aria-hidden="true" tabindex="-1"></a>  D2dpnt <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((mysample<span class="sc">$</span>PC1 <span class="sc">-</span> dpnt<span class="sc">$</span>x1)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (mysample<span class="sc">$</span>PC2 <span class="sc">-</span> dpnt<span class="sc">$</span>x2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb453-3"><a href="SpatialResponseSurface.html#cb453-3" aria-hidden="true" tabindex="-1"></a>  D <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(mysample[, <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)]))</span>
<span id="cb453-4"><a href="SpatialResponseSurface.html#cb453-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(phi)) {</span>
<span id="cb453-5"><a href="SpatialResponseSurface.html#cb453-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">diag</span>(D) <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb453-6"><a href="SpatialResponseSurface.html#cb453-6" aria-hidden="true" tabindex="-1"></a>    logdmin <span class="ot">&lt;-</span> <span class="fu">apply</span>(D, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> min, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> log</span>
<span id="cb453-7"><a href="SpatialResponseSurface.html#cb453-7" aria-hidden="true" tabindex="-1"></a>    criterion_cur <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="sc">-</span>logdmin) <span class="sc">+</span> <span class="fu">mean</span>(D2dpnt) <span class="sc">*</span> weight</span>
<span id="cb453-8"><a href="SpatialResponseSurface.html#cb453-8" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb453-9"><a href="SpatialResponseSurface.html#cb453-9" aria-hidden="true" tabindex="-1"></a>    vgmodel <span class="ot">&lt;-</span> <span class="fu">vgm</span>(<span class="at">model =</span> <span class="st">&quot;Exp&quot;</span>, <span class="at">psill =</span> <span class="dv">1</span>, <span class="at">range =</span> phi)</span>
<span id="cb453-10"><a href="SpatialResponseSurface.html#cb453-10" aria-hidden="true" tabindex="-1"></a>    C <span class="ot">&lt;-</span> <span class="fu">variogramLine</span>(vgmodel, <span class="at">dist_vector =</span> D, <span class="at">covariance =</span> <span class="cn">TRUE</span>)</span>
<span id="cb453-11"><a href="SpatialResponseSurface.html#cb453-11" aria-hidden="true" tabindex="-1"></a>    criterion_cur <span class="ot">&lt;-</span> <span class="fu">mean</span>(C) <span class="sc">+</span> <span class="fu">mean</span>(D2dpnt) <span class="sc">*</span> weight</span>
<span id="cb453-12"><a href="SpatialResponseSurface.html#cb453-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb453-13"><a href="SpatialResponseSurface.html#cb453-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(criterion_cur)</span>
<span id="cb453-14"><a href="SpatialResponseSurface.html#cb453-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Function <code>getCriterion</code> is used to compute the geometric criterion for the initial sample.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="SpatialResponseSurface.html#cb454-1" aria-hidden="true" tabindex="-1"></a>criterion_geo <span class="ot">&lt;-</span> <span class="fu">getCriterion</span>(<span class="at">mysample =</span> mysample0, <span class="at">dpnt =</span> ccd_df)</span></code></pre></div>
<p>The initial value of the geometric criterion is -4.829. In the next code chunk, the initial value for the model-based criterion is computed for an effective range of 150 m.</p>

<div class="rmdnote">
It does not make sense to make the effective range smaller than the size of the grid cells, which is 25 m in our case. For smaller ranges, the correlation matrix is for any sample a matrix with zeroes. If the effective range is smaller than the smallest distance between two points in a cluster, the mean correlation is equal for all samples.
</div>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="SpatialResponseSurface.html#cb455-1" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb455-2"><a href="SpatialResponseSurface.html#cb455-2" aria-hidden="true" tabindex="-1"></a>criterion_mb <span class="ot">&lt;-</span> <span class="fu">getCriterion</span>(<span class="at">mysample =</span> mysample0, <span class="at">dpnt =</span> ccd_df, <span class="at">phi =</span> phi)</span></code></pre></div>
<p>The initial value of the model-based criterion is 0.134.</p>
<p>The objective function defining the minimisation criterion is minimised with simulated annealing (<span class="citation">Kirkpatrick, Gelatt, and Vecchi (<a href="#ref-Kirkpatrick1983" role="doc-biblioref">1983</a>)</span>, <span class="citation">Aarts and Korst (<a href="#ref-Aarts1987" role="doc-biblioref">1989</a>)</span>). One sampling point is randomly selected and replaced by another candidate sampling point from the same cluster. If the criterion of the new sample is smaller than that of the current sample, the new sample is accepted. If it is larger, it is accepted with a probability that is a function of the change in the criterion (the larger the increase, the smaller the acceptance probability) and of an annealing parameter named the temperature (the higher the temperature, the larger the probability of accepting a new, poorer sample, given an increase of the criterion). See Section <a href="MBSamplePattern.html#SSA">23.1</a> for a more detailed introduction to simulated annealing.</p>
<p>The sampling pattern can be optimised with function <code>anneal</code> of package <strong>sswr</strong>. The arguments of this function will be clear from the description of the sampling procedure above.</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="SpatialResponseSurface.html#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb456-2"><a href="SpatialResponseSurface.html#cb456-2" aria-hidden="true" tabindex="-1"></a>mySRSsample <span class="ot">&lt;-</span> <span class="fu">anneal</span>(</span>
<span id="cb456-3"><a href="SpatialResponseSurface.html#cb456-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mysample =</span> mysample0, <span class="at">candidates =</span> candi_all, <span class="at">dpnt =</span> ccd_df, <span class="at">phi =</span> <span class="dv">50</span>,</span>
<span id="cb456-4"><a href="SpatialResponseSurface.html#cb456-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">T_ini =</span> <span class="dv">1</span>, <span class="at">coolingRate =</span> <span class="fl">0.9</span>, <span class="at">maxPermuted =</span> <span class="dv">25</span> <span class="sc">*</span> <span class="fu">nrow</span>(mysample0),</span>
<span id="cb456-5"><a href="SpatialResponseSurface.html#cb456-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxNoChange =</span> <span class="dv">20</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Figure <a href="SpatialResponseSurface.html#fig:CCRSDinPCspace">20.6</a> shows the optimised CCRSD samples plotted in the space spanned by the two principal components, obtained with the geometric and the model-based criterion, plotted together with the design points. The two optimised samples are very similar.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CCRSDinPCspace"></span>
<img src="SpatialSampling_files/figure-html/CCRSDinPCspace-1.png" alt="Principal component scores of the spatial CCRSD sample (triangles), optimised with the geometric and the model-based criterion. Dots: design points of CCRSD." width="100%" />
<p class="caption">
Figure 20.6: Principal component scores of the spatial CCRSD sample (triangles), optimised with the geometric and the model-based criterion. Dots: design points of CCRSD.
</p>
</div>
<p>Figure <a href="SpatialResponseSurface.html#fig:CCRSDSample">20.7</a> shows the two optimised CCRSD samples plotted in geographical space on the first standardised principal component scores.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CCRSDSample"></span>
<img src="SpatialSampling_files/figure-html/CCRSDSample-1.png" alt="CCRSD sample from the Cotton Research Farm, optimised with the geometric and the model-based criterion, plotted on a map of the first standardised principal component (PC1)." width="100%" />
<p class="caption">
Figure 20.7: CCRSD sample from the Cotton Research Farm, optimised with the geometric and the model-based criterion, plotted on a map of the first standardised principal component (PC1).
</p>
</div>
<div id="IncreaseSampleSize" class="section level2 hasAnchor" number="20.1">
<h2><span class="header-section-number">20.1</span> Increasing the sample size<a href="SpatialResponseSurface.html#IncreaseSampleSize" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nine points are rather few for fitting a polynomial regression model, especially for a second-order polynomial with interaction. Therefore, in experiments often multiple observations are done for each design point. Increasing the sample size of a response surface sample in observational studies is not straightforward. The challenge is to avoid spatial clustering of sampling points. A simple solution is to select multiple points from each subset of candidate sampling units. The success of this solution depends on how strong candidate sampling units are spatially clustered. For the Cotton Research Farm for most design points the candidate sampling units are not in one spatial cluster; so in this case, the solution may work properly. I increased the number of candidate sampling units per design point to 16, so that there is a larger choice in the optimisation of the sampling pattern.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="SpatialResponseSurface.html#cb457-1" aria-hidden="true" tabindex="-1"></a>candi_all <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb457-2"><a href="SpatialResponseSurface.html#cb457-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(ccd_df))) {</span>
<span id="cb457-3"><a href="SpatialResponseSurface.html#cb457-3" aria-hidden="true" tabindex="-1"></a>    d2dpnt <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((grdCRF<span class="sc">$</span>PC1 <span class="sc">-</span> ccd_df<span class="sc">$</span>x1[i])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb457-4"><a href="SpatialResponseSurface.html#cb457-4" aria-hidden="true" tabindex="-1"></a>      (grdCRF<span class="sc">$</span>PC2 <span class="sc">-</span> ccd_df<span class="sc">$</span>x2[i])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb457-5"><a href="SpatialResponseSurface.html#cb457-5" aria-hidden="true" tabindex="-1"></a>    grdCRF <span class="ot">&lt;-</span> grdCRF[<span class="fu">order</span>(d2dpnt), ]</span>
<span id="cb457-6"><a href="SpatialResponseSurface.html#cb457-6" aria-hidden="true" tabindex="-1"></a>    candi <span class="ot">&lt;-</span> grdCRF[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>), <span class="fu">c</span>(<span class="st">&quot;point_id&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;PC1&quot;</span>, <span class="st">&quot;PC2&quot;</span>)]</span>
<span id="cb457-7"><a href="SpatialResponseSurface.html#cb457-7" aria-hidden="true" tabindex="-1"></a>    candi<span class="sc">$</span>dpnt <span class="ot">&lt;-</span> i</span>
<span id="cb457-8"><a href="SpatialResponseSurface.html#cb457-8" aria-hidden="true" tabindex="-1"></a>    candi_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(candi_all, candi)</span>
<span id="cb457-9"><a href="SpatialResponseSurface.html#cb457-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>A stratified simple random subsample of two points per stratum is selected, which serves as an initial sample.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="SpatialResponseSurface.html#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb458-2"><a href="SpatialResponseSurface.html#cb458-2" aria-hidden="true" tabindex="-1"></a>units_stsi <span class="ot">&lt;-</span> sampling<span class="sc">::</span><span class="fu">strata</span>(</span>
<span id="cb458-3"><a href="SpatialResponseSurface.html#cb458-3" aria-hidden="true" tabindex="-1"></a>  candi_all, <span class="at">stratanames =</span> <span class="st">&quot;dpnt&quot;</span>, <span class="at">size =</span> <span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">9</span>))</span>
<span id="cb458-4"><a href="SpatialResponseSurface.html#cb458-4" aria-hidden="true" tabindex="-1"></a>mysample0 <span class="ot">&lt;-</span> <span class="fu">getdata</span>(candi_all, units_stsi) <span class="sc">%&gt;%</span></span>
<span id="cb458-5"><a href="SpatialResponseSurface.html#cb458-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>(ID_unit<span class="sc">:</span>Stratum))</span></code></pre></div>
<p>The data frame with the design points must be doubled. Note that the order of the design points must be equal to the order in the stratified subsample.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="SpatialResponseSurface.html#cb459-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ccd_df, <span class="at">dpnt =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb459-2"><a href="SpatialResponseSurface.html#cb459-2" aria-hidden="true" tabindex="-1"></a>ccd_df2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(tmp, tmp)</span>
<span id="cb459-3"><a href="SpatialResponseSurface.html#cb459-3" aria-hidden="true" tabindex="-1"></a>ccd_df2 <span class="ot">&lt;-</span> ccd_df2[<span class="fu">order</span>(ccd_df2<span class="sc">$</span>dpnt), ]</span></code></pre></div>
<p>Figures <a href="SpatialResponseSurface.html#fig:CCRSDUzbekistan2n">20.8</a> and <a href="SpatialResponseSurface.html#fig:CCRSDinPCSpace2n">20.9</a> show the optimised CCRSD sample of 18 points in geographical and principal component space, respectively, obtained with the model-based criterion, an effective range of 150 m, and zero weight for the penalty term. Sampling points are not spatially clustered, so I do not expect violation of the assumption of independent residuals. In principal component space, all points are pretty close to the design points, except for the four design points in the lower right corner, where no candidate units near these design points are available.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CCRSDUzbekistan2n"></span>
<img src="SpatialSampling_files/figure-html/CCRSDUzbekistan2n-1.png" alt="CCRSD sample with two points per design point, from the Cotton Research Farm, plotted on a map of the first standardised principal component (PC1)." width="100%" />
<p class="caption">
Figure 20.8: CCRSD sample with two points per design point, from the Cotton Research Farm, plotted on a map of the first standardised principal component (PC1).
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CCRSDinPCSpace2n"></span>
<img src="SpatialSampling_files/figure-html/CCRSDinPCSpace2n-1.png" alt="CCRSD sample (triangles) with two points per design point (dots), optimised with model-based criterion, plotted in the space spanned by the two standardised principal components." width="80%" />
<p class="caption">
Figure 20.9: CCRSD sample (triangles) with two points per design point (dots), optimised with model-based criterion, plotted in the space spanned by the two standardised principal components.
</p>
</div>
</div>
<div id="stratified-spatial-response-surface-sampling" class="section level2 hasAnchor" number="20.2">
<h2><span class="header-section-number">20.2</span> Stratified spatial response surface sampling<a href="SpatialResponseSurface.html#stratified-spatial-response-surface-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The sample size can also be increased by stratified spatial response surface sampling. The strata are subareas of the study area. When the subsets of candidate sampling units for some design points are strongly spatially clustered, the final optimised sample obtained with the method of the previous section may also show strong spatial clustering. An alternative is then to split the study area into two or more subareas (strata) and to select from each stratum candidate sampling units. This guarantees that for each design point we have at least as many spatial clusters of candidate units as we have strata.</p>

<div class="rmdnote">
The spatial strata are not used for fitting separate regression models. All data are used to fit one (second-order) polynomial regression model.
</div>
<p>Figure <a href="SpatialResponseSurface.html#fig:StrataCRF4CCRSD">20.10</a> shows two subareas used as strata in stratified response surface sampling of the Cotton Research Farm.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:StrataCRF4CCRSD"></span>
<img src="SpatialSampling_files/figure-html/StrataCRF4CCRSD-1.png" alt="Two subareas of the Cotton Research Farm used as strata in stratified CCRSD sampling." width="100%" />
<p class="caption">
Figure 20.10: Two subareas of the Cotton Research Farm used as strata in stratified CCRSD sampling.
</p>
</div>
<p>The candidate sampling units are selected in a double for-loop. The outer loop is over the strata, the inner loop over the design points. Note that variable <code>dpnt</code> continues to increase by 1 after the inner loop over the nine design points in subarea 1 is completed, so that variable <code>dpnt</code> (used as a stratification variable in subsampling the sample of candidate sampling points) now has values <span class="math inline">\(1,2, \dots , 18\)</span>. An equal number of candidate sampling points per design point in both strata (eight points) is selected by sorting the points of a stratum by the distance to a design point using function <code>order</code>. Figure <a href="SpatialResponseSurface.html#fig:candidatesSTResponse">20.11</a> shows the candidate sampling points for stratified CCRSD sampling.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="SpatialResponseSurface.html#cb460-1" aria-hidden="true" tabindex="-1"></a>candi_all <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb460-2"><a href="SpatialResponseSurface.html#cb460-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (h <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) {</span>
<span id="cb460-3"><a href="SpatialResponseSurface.html#cb460-3" aria-hidden="true" tabindex="-1"></a>  data_stratum <span class="ot">&lt;-</span> grdCRF <span class="sc">%&gt;%</span></span>
<span id="cb460-4"><a href="SpatialResponseSurface.html#cb460-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(subarea <span class="sc">==</span> h)</span>
<span id="cb460-5"><a href="SpatialResponseSurface.html#cb460-5" aria-hidden="true" tabindex="-1"></a>  candi_stratum <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb460-6"><a href="SpatialResponseSurface.html#cb460-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(ccd_df))) {</span>
<span id="cb460-7"><a href="SpatialResponseSurface.html#cb460-7" aria-hidden="true" tabindex="-1"></a>      d2dpnt <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((data_stratum<span class="sc">$</span>PC1 <span class="sc">-</span> ccd_df<span class="sc">$</span>x1[i])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb460-8"><a href="SpatialResponseSurface.html#cb460-8" aria-hidden="true" tabindex="-1"></a>                     (data_stratum<span class="sc">$</span>PC2 <span class="sc">-</span> ccd_df<span class="sc">$</span>x2[i])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb460-9"><a href="SpatialResponseSurface.html#cb460-9" aria-hidden="true" tabindex="-1"></a>      data_stratum <span class="ot">&lt;-</span> data_stratum[<span class="fu">order</span>(d2dpnt), ]</span>
<span id="cb460-10"><a href="SpatialResponseSurface.html#cb460-10" aria-hidden="true" tabindex="-1"></a>      candi <span class="ot">&lt;-</span> data_stratum[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>),</span>
<span id="cb460-11"><a href="SpatialResponseSurface.html#cb460-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">c</span>(<span class="st">&quot;point_id&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;PC1&quot;</span>, <span class="st">&quot;PC2&quot;</span>, <span class="st">&quot;subarea&quot;</span>)]</span>
<span id="cb460-12"><a href="SpatialResponseSurface.html#cb460-12" aria-hidden="true" tabindex="-1"></a>      candi<span class="sc">$</span>dpnt <span class="ot">&lt;-</span> i <span class="sc">+</span> (h <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">nrow</span>(ccd_df)</span>
<span id="cb460-13"><a href="SpatialResponseSurface.html#cb460-13" aria-hidden="true" tabindex="-1"></a>      candi_stratum <span class="ot">&lt;-</span> <span class="fu">rbind</span>(candi_stratum, candi)</span>
<span id="cb460-14"><a href="SpatialResponseSurface.html#cb460-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb460-15"><a href="SpatialResponseSurface.html#cb460-15" aria-hidden="true" tabindex="-1"></a>  candi_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(candi_all, candi_stratum)</span>
<span id="cb460-16"><a href="SpatialResponseSurface.html#cb460-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:candidatesSTResponse"></span>
<img src="SpatialSampling_files/figure-html/candidatesSTResponse-1.png" alt="Candidate sampling points for stratified CCRSD sampling, plotted on a map of the first principal component (PC1)." width="100%" />
<p class="caption">
Figure 20.11: Candidate sampling points for stratified CCRSD sampling, plotted on a map of the first principal component (PC1).
</p>
</div>
<p>As before, <code>dpnt</code> is used as a stratum identifier to subsample the candidate sampling units. Finally, the number of rows in <code>data.frame</code> <code>ccd_df</code> with the design points is doubled.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="SpatialResponseSurface.html#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb461-2"><a href="SpatialResponseSurface.html#cb461-2" aria-hidden="true" tabindex="-1"></a>units_stsi <span class="ot">&lt;-</span> sampling<span class="sc">::</span><span class="fu">strata</span>(</span>
<span id="cb461-3"><a href="SpatialResponseSurface.html#cb461-3" aria-hidden="true" tabindex="-1"></a>  candi_all, <span class="at">stratanames =</span> <span class="st">&quot;dpnt&quot;</span>, <span class="at">size =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">18</span>))</span>
<span id="cb461-4"><a href="SpatialResponseSurface.html#cb461-4" aria-hidden="true" tabindex="-1"></a>mysample0 <span class="ot">&lt;-</span> <span class="fu">getdata</span>(candi_all, units_stsi) <span class="sc">%&gt;%</span></span>
<span id="cb461-5"><a href="SpatialResponseSurface.html#cb461-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>(ID_unit<span class="sc">:</span>Stratum))</span>
<span id="cb461-6"><a href="SpatialResponseSurface.html#cb461-6" aria-hidden="true" tabindex="-1"></a>ccd_df2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ccd_df, ccd_df)</span></code></pre></div>
<p>Figures <a href="SpatialResponseSurface.html#fig:StratifiedCCRSD">20.12</a> and <a href="SpatialResponseSurface.html#fig:StratifiedCCRSDinPCSpace">20.13</a> show the optimised sample of 18 points in geographical and principal component space, obtained with the model-based criterion with an effective range of 150 m. The pattern in the principal component space is worse compared to the pattern in Figure <a href="SpatialResponseSurface.html#fig:CCRSDinPCSpace2n">20.9</a>. In stratum 1, the distance to the star point at the top and the upper left and upper right cube points is very large. In this stratum no population units are present that are close to these design points. By adding a penalty term to the minimisation criterion that is proportional to the distance to the design points, the distance is somewhat decreased, but not really for the three design points mentioned above (Figure <a href="SpatialResponseSurface.html#fig:CCRSDinPCSpace2n">20.9</a>). Also note the spatial cluster of three sampling units in Figure <a href="SpatialResponseSurface.html#fig:StratifiedCCRSD">20.12</a> obtained with a weight equal to 5.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:StratifiedCCRSD"></span>
<img src="SpatialSampling_files/figure-html/StratifiedCCRSD-1.png" alt="Stratified CCRSD samples from the Cotton Research Farm, optimised with the model-based criterion, obtained without (weight = 0) and with penalty (weight = 5) for a large average distance to design points." width="100%" />
<p class="caption">
Figure 20.12: Stratified CCRSD samples from the Cotton Research Farm, optimised with the model-based criterion, obtained without (weight = 0) and with penalty (weight = 5) for a large average distance to design points.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:StratifiedCCRSDinPCSpace"></span>
<img src="SpatialSampling_files/figure-html/StratifiedCCRSDinPCSpace-1.png" alt="Principal component scores of the stratified CCRSD sample, optimised with the model-based criterion, obtained without (weight = 0) and with penalty (weight = 5) for a large average distance to design points (dots)." width="100%" />
<p class="caption">
Figure 20.13: Principal component scores of the stratified CCRSD sample, optimised with the model-based criterion, obtained without (weight = 0) and with penalty (weight = 5) for a large average distance to design points (dots).
</p>
</div>
</div>
<div id="mapping" class="section level2 hasAnchor" number="20.3">
<h2><span class="header-section-number">20.3</span> Mapping<a href="SpatialResponseSurface.html#mapping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Once the data are collected, the study variable is mapped by fitting a multiple linear regression model using the two covariates, in our case the two EM measurements, as predictors. The fitted model is then used to predict the study variable for all unsampled population units.</p>
<p>The value of the study variable at an unsampled prediction location <span class="math inline">\(\mathbf{s}_0\)</span> is predicted by
<span class="math display" id="eq:ZpredMLR">\[\begin{equation}
\widehat{Z}(\mathbf{s}_0) = \mathbf{x}_0 \hat{\pmb{\beta}}_{\text{OLS}}\;,
\tag{20.1}
\end{equation}\]</span>
with <span class="math inline">\(\mathbf{x}_0\)</span> the (<span class="math inline">\(p+1\)</span>)-vector with covariate values at prediction location <span class="math inline">\(\mathbf{s}_0\)</span> and 1 in the first entry (<span class="math inline">\(p\)</span> is the number of covariates) and <span class="math inline">\(\hat{\pmb{\beta}}\)</span> the vector with ordinary least squares estimates of the regression coefficients:
<span class="math display" id="eq:betaOLS">\[\begin{equation}
\hat{\pmb{\beta}}_{\text{OLS}} = (\mathbf{X}^{\mathrm{T}}\mathbf{X})^{-1} (\mathbf{X}^{\mathrm{T}}\mathbf{z})\;,
\tag{20.2}
\end{equation}\]</span>
with <span class="math inline">\(\mathbf{X}\)</span> the <span class="math inline">\((n \times (p+1))\)</span> matrix with covariate values and ones in the first column (<span class="math inline">\(n\)</span> is the sample size, and <span class="math inline">\(p\)</span> is the number of covariates) and <span class="math inline">\(\mathbf{z}\)</span> the <span class="math inline">\(n\)</span>-vector with observations of the study variable.</p>

<div class="rmdnote">
Although the principal component scores are used to select the sampling locations, there is no need to use these scores as predictors in the linear regression model. When all principal components derived from the covariates are used as predictors, the predicted values and standard errors obtained with the model using the principal components as predictors are equal to those obtained with the model using the covariates as predictors.
</div>
<p>The variance of the prediction error can be estimated by
<span class="math display" id="eq:VarZpredMLR">\[\begin{equation}
\widehat{V}(\widehat{Z}(\mathbf{s}_0)) = \hat{\sigma}^2_{\epsilon}(1+\mathbf{x}_0^{\mathrm{T}}(\mathbf{X}^{\mathrm{T}}\mathbf{X})^{-1}\mathbf{x}_0)\;,
\tag{20.3}
\end{equation}\]</span>
with <span class="math inline">\(\hat{\sigma}^2_{\epsilon}\)</span> the estimated variance of the residuals.</p>
<p>In <strong>R</strong> the model can be calibrated with function <code>lm</code>, and the predictions can be obtained with function <code>predict</code>. The standard errors of the estimated means can be obtained with argument <code>se.fit = TRUE</code>. The variances of Equation <a href="SpatialResponseSurface.html#eq:VarZpredMLR">(20.3)</a> can be computed by squaring these standard errors and adding the squared value of the estimated residual variance, which can be extracted with <code>sigma()</code>.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="SpatialResponseSurface.html#cb462-1" aria-hidden="true" tabindex="-1"></a>mdl <span class="ot">&lt;-</span> <span class="fu">lm</span>(lnECe <span class="sc">~</span> lnEM100cm <span class="sc">+</span> lnEM50cm, <span class="at">data =</span> mysample)</span>
<span id="cb462-2"><a href="SpatialResponseSurface.html#cb462-2" aria-hidden="true" tabindex="-1"></a>zpred <span class="ot">&lt;-</span> <span class="fu">predict</span>(mdl, <span class="at">newdata =</span> grdCRF, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb462-3"><a href="SpatialResponseSurface.html#cb462-3" aria-hidden="true" tabindex="-1"></a>v_zpred <span class="ot">&lt;-</span> zpred<span class="sc">$</span>se.fit<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="fu">sigma</span>(mdl)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<p>The assumption underlying Equations <a href="SpatialResponseSurface.html#eq:betaOLS">(20.2)</a> and <a href="SpatialResponseSurface.html#eq:VarZpredMLR">(20.3)</a> is that the model residuals are independent. We assume that all the spatial structure of the study variable is explained by the covariates. Even the residuals at two locations close to each other are assumed to be uncorrelated. A drawback of the spatial response surface design is that it is hard or even impossible to check this assumption, as the sampling locations are spread throughout the study area. If the residuals are not independent, the covariance of the residuals can be accounted for by generalised least squares estimation of the regression coefficients (Equation <a href="Introkriging.html#eq:betaGLS">(21.24)</a>). The study variable can then be mapped by kriging with an external drift (Section <a href="Introkriging.html#IntroKED">21.3</a>). However, this requires an estimate of the semivariogram of the residuals (Section <a href="Introkriging.html#ResidualVariogram">21.5</a>).</p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Aarts1987" class="csl-entry">
Aarts, E. H. L., and J. H. M. Korst. 1989. <em><span class="nocase">Simulated Annealing and Boltzmann Machines: A Stochastic Approach to Combinatorial Optimization and Neural Computing</span></em>. Chichester: John Wiley &amp; Sons.
</div>
<div id="ref-corwin2005" class="csl-entry">
Corwin, D. L., and S. M. Lesch. 2005. <span>“Characterizing Soil Spatial Variability with Apparent Soil Electrical Conductivity: Part <span>II</span>. <span class="nocase">Case study</span>.”</span> <em>Computers and Electronics in Agriculture</em> 46 (1–3): 135–52.
</div>
<div id="ref-Corwin2010" class="csl-entry">
Corwin, D. L., S. M. Lesch, E. Segal, T. H. Skaggs, and S. A. Bradford. 2010. <span>“Comparison of Sampling Strategies for Characterizing Spatial Variability with Apparent Soil Electrical Conductivity Directed Soil Sampling.”</span> <em>Journal of Environmental and Engineering Geophysics</em> 15 (3): 147–62. <a href="https://doi.org/10.2113/JEEG15.3.147">https://doi.org/10.2113/JEEG15.3.147</a>.
</div>
<div id="ref-Fitzgerald2010" class="csl-entry">
Fitzgerald, G. J. 2010. <span>“Response Surface Sampling of Remotely Sensed Imagery for Precision Agriculture.”</span> In <em>Proximal Soil Sensing</em>, edited by R. A. Viscarra Rossel, A. B. McBratney, and B. Minasny, 121–29. Dordrecht: Springer.
</div>
<div id="ref-fitzgerald2006" class="csl-entry">
Fitzgerald, G. J., S. M. Lesch, E. M. Barnes, and W. E. Luckett. 2006. <span>“Directed Sampling Using Remote Sensing with a Response Surface Sampling Design for Site-Specific Agriculture.”</span> <em>Computers and Electronics in Agriculture</em> 53 (2): 98–112.
</div>
<div id="ref-Kirkpatrick1983" class="csl-entry">
Kirkpatrick, S., C. D. Gelatt, and M. P. Vecchi. 1983. <span>“Optimization by Simulated Annealing.”</span> <em>Science</em> 220 (4598): 671–80. https://doi.org/<a href="https://doi.org/10.1126/science.220.4598.671">https://doi.org/10.1126/science.220.4598.671</a>.
</div>
<div id="ref-Lenth2009" class="csl-entry">
Lenth, R. V. 2009. <span>“<span class="nocase">Response-Surface Methods in <span>R</span>, Using <span class="nocase">rsm</span></span>.”</span> <em>Journal of Statistical Software</em> 32 (7): 1–17.
</div>
<div id="ref-lesch2005" class="csl-entry">
Lesch, S. M. 2005. <span>“Sensor-Directed Response Surface Sampling Designs for Characterizing Spatial Variation in Soil Properties.”</span> <em>Computers and Electronics in Agriculture</em> 46 (1–3): 153–79.
</div>
<div id="ref-lesch95" class="csl-entry">
Lesch, S. M., D. J. Strauss, and J. D. Rhoades. 1995. <span>“Spatial Prediction of Soil Salinity Using Electromagnetic Induction Techniques, 2. <span>An</span> Efficient Spatial Sampling Algorithm Suitable for Multiple Linear Regression Model Identification and Estimation.”</span> <em>Water Resources Research</em> 31 (2): 387–98.
</div>
<div id="ref-myers2002" class="csl-entry">
Myers, R. H., D. C. Montgomery, and C. M. Anderson-Cook. 2009. <em><span class="nocase">Response Surface Methodology: Process and Product Optimization Using Designed Experiments</span></em>. Third. Hoboken: John Wiley &amp; Sons.
</div>
<div id="ref-peb04" class="csl-entry">
Pebesma, E. J. 2004. <span>“Multivariable Geostatistics in <span>S</span>: The Gstat Package.”</span> <em>Computers &amp; Geosciences</em> 30 (7): 683–91.
</div>
<div id="ref-R2020" class="csl-entry">
R Core Team. 2021. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-Tille2016" class="csl-entry">
Tillé, Y., and A. Matei. 2021. <em><span class="nocase">sampling: Survey Sampling</span></em>. <a href="https://CRAN.R-project.org/package=sampling">https://CRAN.R-project.org/package=sampling</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cLHS.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Introkriging.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/DickBrus/SpatialSamplingwithR/edit/master/26-SpatialResponseSurface.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SpatialSampling.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
