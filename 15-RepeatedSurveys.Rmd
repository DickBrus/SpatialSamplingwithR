# Repeated sample surveys for monitoring population parameters {#RepeatedSurveys}

The previous chapters are all about sampling to estimate population parameters *at a given time*. The survey is done in a relatively short period of time, so that we can safely assume that the study variable did not change during that period. This chapter is about repeating the sample survey two or more times, to estimate a temporal change in a population parameter\index{Repeated surveys for monitoring}. Sampling locations are selected by probability sampling, by any design type. Sampling times are not selected randomly, but purposively. For instance, to monitor the carbon stock in the soil of a country, we may decide to repeat the survey after five years, in the same season of the year as the first sampling round.

## Space-time designs

@gru06 present an overview of space-time designs\index{Space-time design}. Five of these designs are schematically shown in Figure \@ref(fig:SpaceTimeDesigns). With repeated sampling in two-dimensional space there are three dimensions: two spatial and one time dimension. In Figure  \@ref(fig:SpaceTimeDesigns) the sampling locations in 2D are plotted in one dimension, along the horizontal axis. A selected unit along this axis actually represents a sampling location in 2D. In Figure \@ref(fig:SpaceTimeDesigns) in each space-time design twenty sampling locations are selected by simple random sampling.

In the static-synchronous design\index{Space-time design!static-synchronous design}, also referred to as a pure panel\index{Pure panel}, all sampling locations selected in the first survey are revisited in the subsequent surveys. On the contrary, in an independent synchronous design\index{Space-time design!independent-synchronous design}, in each survey a probability sample is selected independent from the samples selected in the previous surveys. The serially alternating design\index{Space-time design!serially alternating design} is a compromise between a static-synchronous and an independent synchronous design. The sample selected in the first survey is revisited in the third survey. The sample of the second survey is selected independently from the sample of the first survey, and these locations are revisited in the fourth survey. In this case the period of revisits is two, i.e. two sampling intervals between successive surveys, but this can also be increased. For instance with a period of three, three samples are selected independently from each other for the first three surveys. The sample of the first survey is revisited in the fourth survey, et cetera.

Two other compromise designs are a supplemented panel design\index{Space-time design!supplemented panel design} and a rotating panel design\index{Space-time design!rotating panel design}. In a supplemented panel design only a subset of the sampling locations of the first survey is revisited in the subsequent surveys. These are the permanent sampling locations observed in all subsequent surveys. These permanent sampling locations are supplemented by samples that are selected independently from the samples in the previous surveys. In Figure \@ref(fig:SpaceTimeDesigns), one-half of the sampling locations (ten locations) is permanent, i.e. revisited in all surveys, but the proportion of permanent sampling locations can be smaller or larger and, if prior information on the variation in space and time is available, even optimised. Also in a rotating panel design sampling units of the previous survey are partially replaced by new units. The difference with a supplemented panel design is that there are no permanent sampling units, observed in all surveys. All sampling units are sequentially rotated out and in again at the consecutive sampling times.

```{r SpaceTimeDesigns, echo=FALSE, out.width="100%", fig.cap="Space-time designs for monitoring population parameters. Twenty sampling locations are selected by simple random sampling. SS: static-synchronous design; IS: independent synchronous design; SA: serially alternating design; SP: supplemeneted panel design; RP: rotating panel design."}

#pure panel
set.seed(314)
Space <- sample.int(n=1000, size=20, replace=FALSE)
mysampleSS <- data.frame(
    Space=rep(x=Space, times=4),
    Time=rep(x=c(1, 2, 3, 4), each=length(Space)),
    Panel=rep("a", 4*length(Space)) #unselect this line for figure withpanelsaslegend
)
mysampleSS$design<-"SS"

#independent synchronous
Space <- sample.int(n=1000, size=80, replace=FALSE)
mysampleIS <- data.frame(
    Space,
    Time=rep(x=c(1, 2, 3, 4), each=20)
)
mysampleIS$Panel <- rep(x=c("a","b","c","d"), each=20)
mysampleIS$design <- "IS"

#serially alternating
# set periodicity
p <- 2
# construct data.frame
mysample1 <- NULL
for (i in seq_len(p)) {
    mysample1 <- 
      rbind(mysample1,
            data.frame(Space=sample.int(n=1000, size=20, replace=FALSE), Time=i, Panel=letters[i]))
}
mysample2 <- mysample1
mysample2$Time <- mysample1$Time + p
mysample2$Panel <- mysample1$Panel
mysampleSA <- rbind(mysample1, mysample2)
mysampleSA$design <- "SA"

#supplemented panel
p <- 5 #number of panels
mysample1 <- NULL
for (i in seq_len(p)) {
    mysample1 <- rbind(
        mysample1,
        data.frame(
            Space=sample.int(n=1000, size=10, replace=FALSE),
            Time=(i==1)*1+(i>1)*(i-1),
            Panel=letters[i])
    )
}
mysample2<-NULL
mysample2$Space[1:10] <- mysample1$Space[1:10]
mysample2$Space[11:20] <- mysample1$Space[1:10]
mysample2$Space[21:30] <- mysample1$Space[1:10]

mysample2$Time <- rep(x=c(2, 3, 4), each=10)
mysample2$Panel <- rep(x="a", each=30)
mysampleSP <- rbind(mysample1, mysample2)
mysampleSP$design<-"SP"

#rotating panel
p <- 5 #number of panels
mysample1 <- NULL
for (i in seq_len(p)) {
    mysample1 <- rbind(
        mysample1,
        data.frame(
            Space=sample.int(n=1000, size=10, replace=FALSE),
            Time=(i==1)*1+(i>1)*(i-1),
            Panel=letters[i])
        )
}
mysample2<-NULL
mysample2$Space[1:10] <- mysample1$Space[11:20]
mysample2$Space[11:20] <- mysample1$Space[21:30]
mysample2$Space[21:30] <- mysample1$Space[31:40]

mysample2$Time <- rep(x=c(2, 3, 4), each=10)
mysample2$Panel <- rep(x=c("b", "c", "d"), each=10)
mysampleRP <- rbind(mysample1, mysample2)
mysampleRP$design<-"RP"

mysample<-rbind(mysampleSS,mysampleIS,mysampleSA,mysampleSP,mysampleRP)
mysample$design<-factor(x=mysample$design,levels=c("SS","IS","SA","SP","RP"),ordered=TRUE)

# create plot
ggplot(data=mysample) +
            geom_point(mapping=aes(x=Space, y=Time, shape=factor(Panel), colour=factor(Panel)), size=2) +
            scale_x_continuous(limits=c(0, 1000)) +
            scale_y_continuous(breaks=1:4) +
            scale_shape(name="panel", solid=FALSE) +
            scale_colour_viridis_d(name="panel")+
            facet_wrap(~design, nrow=3, ncol=2)
```
In Figure \@ref(fig:SpaceTimeDesigns) the shape and colour of the symbols represent a panel. A panel is a group of sampling locations that is observed in the same surveys. In the static-synchronous design there is only one panel. All locations are observed in all surveys, so all locations are in the same panel. In the independent synchronous design there are as many panels as there ar surveys. In the serially alternating design with a period of two the number of panels equals the number of surveys divided by two. In these three space-time designs (SS, IS and SA) all sampling locations of a given survey are in the same panel. This is not the case in the supplemented panel design and rotating panel design. In Figure \@ref(fig:SpaceTimeDesigns) in each survey two panels are observed. In the supplemented panel there is one panel of permanent sampling locations (pure panel part of sample), and another panel of swarming sampling locations. In a rotating panel we may have more than two panels per survey. For instance, with three panels the locations of a panel are observed in three subsequent surveys, referred to as a 'in-for-three' rotational sample @McLaren2001. Also, in an independent synchronous, supplemented panel and rotating panel design we may decide after several surveys to stop selecting new sampling locations and to revisit existing locations. The concept of panels is needed hereafter in estimating space-time population parameters.  

## Space-time population parameters

The data of repeated surveys can be used to estimate various parameters of the space-time universe. I will focus on the mean as a parameter, but estimation of a total, think for instance of the total amount of greenhouse gas emissions from the soil in a given study area during some period,  or proportion is straightforward. In this chapter I show how to estimate the current mean, i.e. the population mean (spatial mean) in the last survey, the change of the mean between two surveys, the temporal trend of the mean and the space-time mean. The current mean need not be defined here as only one survey (one sampling time) is involved in this parameter, so that the definition in Section \@ref(PopulationParameters) is also relevant here.

The change of the mean is defined as the spatial mean at a given survey minus this mean at an earlier survey\index{Change of spatial mean (total)}:

\begin{equation}
\bar{d}_{2,1}=\frac{1}{A}\left(\int_{\mathbf{s} \in \mathcal{U}} z(\mathbf{s},t_2) \;\mathrm{d}\mathbf{s}-\int_{\mathbf{s} \in \mathcal{U}} z(\mathbf{s},t_1) \;\mathrm{d}\mathbf{s}\right)\;.
(\#eq:ChangePopMean)
\end{equation}

With more than two surveys an interesting population parameter is the *average change* per time unit of the mean, referred to as the temporal trend of the spatial mean\index{Temporal trend of spatial mean}. It is defined as a linear combination of the spatial means at the sampling times [@Breidt99]:

\begin{equation}
b=\sum_{j=1}^r w_j \bar{z}_j \;,
(\#eq:TrendofMean)
\end{equation}

with $r$ the number of sampling times and $\bar{z}_j$ the spatial mean at time $t_j$, and weights $w_j$ equal to

\begin{equation}
w_j = \frac{t_j-\bar{t}}{\sum_{j=1}^r(t_j-\bar{t})^2} \;,
(\#eq:weightsTrendofMean)
\end{equation}

with $\bar{t}$ the mean of the sampling times. Note that the temporal trend is defined as a parameter of a space-time population, not as a parameter of a time-series model.

A space-time mean can be defined as the average of the spatial means at the sampling times. In this definition the temporal universe is discrete and restricted to the sampling times. The target universe consists of a finite set of spatial populations:
$$
\bar{\bar{z}}_\mathcal{U}=\frac{1}{r} \sum_{j=1}^r \bar{z_j}
(\#eq:SpacetimeMeanDiscrete)
$$
Alternatively, a space-time mean for a continuous temporal universe is defined as

$$
\bar{\bar{z}}_\mathcal{U} = \frac{1}{T}\int_{t \in \mathcal{T}}\bar{z}_t\;,
(\#eq:SpacetimeMeanContinuous)
$$

with $\mathcal{T}$ and $\mathcal{A}$ the temporal and spatial universe, respectively, $T$ the length of the monitoring period, $A$ the area of the study region, $z_{\mathbf{s},t}$ the study variable at location $\mathbf{s}$ and time $t$, and $\bar{z}_t$ the spatial mean at time $t$.

## Design-based generalised least squares estimation of spatial means

Rotational sampling has a long tradition in agronomy, forestry and in social studies. Early papers on how sample data from previous times can be used to increase the precision of estimates of the current mean are @essen1942, @patterson1950 and @woodruff1963. @gurney1965 developed general theory for these estimators, which I will present now.

In overlapping samples such as a supplemented panel or rotating panel sample we may define one estimate of a spatial mean per 'panel'. These panel-specific estimates of the mean at a given sampling time, based on observations at that time only, are referred to as elementary estimates\index{Elementary estimate}.

The essence of the estimation method described in this section is to estimate the spatial mean at a given time point as a weighted average of the elementary estimates *of all time points*, with the weights determined by the sampling variances and covariances of the elementary estimates. Collecting all elementary estimates of the spatial means of the different sampling times in vector $\hat{\mathbf{z}}$, we can write

\begin{equation}
\hat{\mathbf{z}}=\mathbf{X} \mathbf{z} + \boldsymbol{\epsilon} \;,
(\#eq:zbf)
\end{equation}

with $\mathbf{z}$ the vector of true spatial means $\bar{z}(t_1) \cdots \bar{z}(t_r)$ at the $r$ sampling times, $\mathbf{X}$ the ($P \times r$) design matrix with 0's and 1's that selects the appropriate elements from $\mathbf{z}$, ($P$ is the total number of elementary estimates), and $\boldsymbol{\epsilon}$ the $P$-vector of sampling errors with sampling variance-covariance matrix $\mathbf{C}$. With unbiased elementary estimators the expectation of $\boldsymbol{\epsilon}$ is a vector with zeroes.  

With an independent synchronous, static synchronous and serially alternating design the design matrix $\mathbf{X}$ is the identity matrix of size $r$. For the supplemented panel design of Figure \@ref(fig:SpaceTimeDesigns) the design matrix $\mathbf{X}$ is

\begin{eqnarray}
\left[
\begin{array}{cccc}
1 &0 &0 &0\\
0 &1 &0 &0\\
0 &0 &1 &0\\
0 &0 &0 &1\\
1 &0 &0 &0\\
0 &1 &0 &0\\
0 &0 &1 &0\\
0 &0 &0 &1
\end{array} \right]\nonumber
\end{eqnarray}

The first four rows of this matrix are associated with the elementary estimates from panel a (the panel with permanent sampling locations), the remaining rows with the elementary estimates from the other for panels (independent synchronous subsamples). For the rotating panel design of Figure \@ref(fig:SpaceTimeDesigns) the design matrix equals

\begin{eqnarray}
\left[
\begin{array}{cccc}
1 &0 &0 &0\\
1 &0 &0 &0\\
0 &1 &0 &0\\
0 &1 &0 &0\\
0 &0 &1 &0\\
0 &0 &1 &0\\
0 &0 &0 &1\\
0 &0 &0 &1
\end{array} \right]\nonumber
\end{eqnarray}

The first two rows correspond with the two elementary estimates at time $t_1$ from panel a and b, the third and fourth row correspond with the elementary estimate of the mean at time $t_2$ from panels b and c respectively, et cetera. The minimum variance linear unbiased estimator (MVLUE) of the spatial means is the design-based generalized least squares (GLS) estimator \index{Design-based generalised least squares estimator of spatial means} [@bin88]

\begin{equation}
\hat{\mathbf{z}}_{\mathrm{GLS}}=(\mathbf{X}^{\text{T}}\mathbf{C}^{-1}\mathbf{X})^{-1} \mathbf{X}^{\text{T}} \mathbf{C}^{-1} \hat{\mathbf{z}}\;.
(\#eq:DBGLS)
\end{equation}

To define matrix $\mathbf{C}$ for the supplemented panel design in Figure \@ref(fig:SpaceTimeDesigns), let $\hat{\bar{z}}_{jp}$ denote the estimated mean at time $t_j, j = 1,2,3,4$ in subsample $p, p \in (\mathrm{SS},\mathrm{IS})$, with $\mathrm{SS}$ the static-synchronous subsample and $\mathrm{IS}$ the independent synchronous subsample. If the eight elementary estimates in $\hat{\mathbf{z}}$ are ordered as ($\hat{\bar{z}}_{1a},\hat{\bar{z}}_{2a},\hat{\bar{z}}_{3a},\hat{\bar{z}}_{4a},\hat{\bar{z}}_{1b},\hat{\bar{z}}_{2c},\hat{\bar{z}}_{3d},\hat{\bar{z}}_{4e}$), the sampling variance-covariance matrix $\mathbf{C}$ equals

\begin{eqnarray}
$$
\left[
\begin{array}{cccccccc}
V_{1a} &C_{1,2} &C_{1,3} &C_{1,4} &0 &0 &0 &0 \\
C_{2,1} &V_{2a} &C_{2,3} &C_{2,4} &0 &0 &0 &0 \\
C_{3,1} &C_{3,2} &V_{3a} &C_{3,4} &0 &0 &0 &0 \\
C_{4,1} &C_{4,2} &C_{4,3} &V_{4a} &0 &0 &0 &0 \\
0 &0 &0 &0 &V_{1b} &0 &0 &0 \\
0 &0 &0 &0 &0 &V_{2c} &0 &0 \\
0 &0 &0 &0 &0 &0 &V_{3d} &0 \\
0 &0 &0 &0 &0 &0 &0 &V_{4e}
\end{array}
\right]\nonumber
$$
\end{eqnarray}

The sampling covariances of the elementary estimates of the independent synchronous subsamples are 0 because these are estimated from independently selected samples (off-diagonal elements in lower-right ($4 \times 4$) submatrix). Also the covariances of the elementary estimates from the static-synchronous subsample and independent synchronous subsamples are 0 for the same reason (upper-right submatrix and lower-left submatrix). The covariances of the four elementary estimates from the static synchronous subsample are not zero because these are estimated from the same set of sampling locations.

Ordering the elementary estimates of a the rotating panel sample by the sampling times, the variance-covariance matrix equals
\begin{eqnarray}
$$
\left[
\begin{array}{cccccccc}
V_{1a} &0 &0 &0 &0 &0 &0 &0 \\
0 &V_{1b} &C_{1,2} &0 &0 &0 &0 &0 \\
0 &C_{2,1} &V_{2b} &0 &0 &0 &0 &0 \\
0 &0 &0 &V_{2c} &C_{2,3} &0 &0 &0 \\
0 &0 &0 &C_{3,2} &V_{3c} &0 &0 &0 \\
0 &0 &0 &0 &0 &V_{3d} &C_{3,4} &0 \\
0 &0 &0 &0 &0 &C_{4,3} &V_{4d} &0 \\
0 &0 &0 &0 &0 &0 &0 &V_{4e}
\end{array}
\right]\nonumber
$$
\end{eqnarray}

Only the elementary estimates estimated from the same panel are correlated, for instance the elementary estimates of the spatial means at times $t_1$ and $t_2), estimated from panel b.

For the serially alternating design of Figure \@ref(fig:SpaceTimeDesigns) the sampling variance-covariance matrix of the elementary estimates equals (there is only one elementary estimate per time)

\begin{eqnarray}
$$
\left[
\begin{array}{cccc}
V_{1} &0 &C_{1,3} &0  \\
0 &V_{2} &0 &C_{2,4}  \\
C_{3,1} &0 &V_{3} &0  \\
0 &C_{4,2} &0 &V_{4}  
\end{array}
\right]\nonumber
$$
\end{eqnarray}

In practice matrix $\mathbf{C}$ in Equations \@ref(eq:DBGLS and \@ref(eq:CovGLS) is unknown, and is replaced by a matrix with design-based estimates of the sampling variances and covariances of the elementary estimators. With simple random sampling (with replacement) in space the sampling variance of an elementary estimator of the spatial mean at a given time can be estimated by Equation \@ref(eq:EstVarMeanSIR). The sampling covariance of the elementary estimators of the spatial means at two sampling times, using the data of the same panel, can be estimated by

$$
\widehat{C}_{jk} =  \frac{\widehat{S^2}_{jk}}{m} \;,
(\#eq:covartwoelementaryestimates)
$$

with $m$ the number of sampling locations in the panel, and $\frac{\widehat{S^2}_{jk}}$ the estimated covariance of the study variable at times $t_j$ and $t_k$, estimated by

$$
\widehat{S^2}_{jk} = \frac{1}{m-1}\sum_{u=1}^m (z_{jup}-\hat{\bar{z}}_{jp})(z_{kup}-\hat{\bar{z}}_{kp}) 
(\#eq:)
$$

with $z_{jup}$ the study variable of unit $u$ in panel $p$ at time $t_j$, and \hat{\bar{z}}_{jp}$ the spatial mean at time $t_j$ as estimated from panel $p$. 

The sampling variances and covariances of the estimated spatial means at the $r$ sampling times can be estimated by

\begin{equation}
\mbox{Cov}(\hat{\mathbf{z}}_{\mathrm{GLS}}) = (\mathbf{X}^{\text{T}}\widehat{\mathbf{C}}^{-1}\mathbf{X})^{-1}
(\#eq:CovGLS) \;.
\end{equation}

Given the design-based GLS estimates of the spatial means at the different times it is an easy job to compute the change of the mean between two surveys, the temporal trend of the mean and the space-time mean. 

### Current mean

As explained above, with an independent synchronous, static synchronous and serially alternating design the design matrix $\mathbf{X}$ is the identity matrix of size $r$. From this it follows that for these space-time designs $\hat{\mathbf{z}}_{\mathrm{GLS}}=\hat{\mathbf{z}}$, see Equation. (\@ref(eq:DBGLS)), and $\mbox{Cov}(\hat{\mathbf{z}}_{\mathrm{GLS}})=\mbox{Cov}(\hat{\mathbf{z}})=\mathbf{C}$. In words, the GLS estimator equals the elementary estimator, and the variance-covariance matrix of the GLS estimator equals the variance-covariance matrix of the elementary estimators.

With supplemented panel and a rotating panel sampling in space-time there is partial overlap between the samples at the different times, and so the samples at the previous times can be used to increase the precision of the estimated mean at the last time (current mean). The current mean is simply the last element in $\hat{\mathbf{z}}_{\mathrm{GLS}}$. The estimated sampling variance of the estimated current mean is the element in the final row and final column of sampling variance-covariance matrix  of the estimated spatial means (Equation \@ref(eq:CovGLS)).

### Change of the spatial mean

The change of the spatial mean between two sampling times can simply be estimated by subtracting the (GLS) estimated spatial means at these two times. The variance of the estimated change can be estimated by the sum of the estimated variances of the spatial means at the two sampling times, minus two times the estimated covariance of the two estimated spatial means. The covariance is maximal when all sampling locations are revisited, leading to the most precise estimate of the change of the spatial mean. In a supplemented panel and rotating panel design the covariance of the two estimated spatial means is smaller (Equation \@ref(eq:covartwoelementaryestimates)), and so the variance of the estimated change is larger.  

### Trend of the spatial mean

The trend of the mean is estimated by the weighted average of the (GLS) estimated means at $t_1,\cdots t_r$, with weights equal to Equation \@ref(eq:weightsTrendofMean):

\begin{equation}
\hat{b}=\sum_{j=1}^r w_j \hat{\bar{z}}_{\mathrm{GLS},j}
(\#eq:EstimatorTrendofMean) \;.
\end{equation}

The sampling variance of the estimated trend can be estimated by

\begin{equation}
\widehat{V}(\hat{b}) = \mathbf{w}^{\prime}\widehat{\mathbf{C}}(\hat{\mathbf{z}}_{\mathrm{GLS}}) \mathbf{w}\;.
(\#eq:VarEstimatorTrendofMean) \;.
\end{equation}

### Space-time mean

The space-time mean as defined in Equation \@ref(eq:SpacetimeMeanDiscrete) can be estimated by the average of the (GLS) estimated spatial means at the $r$ sampling times. The variance of this estimator can be estimated by Equation \@ref(eq:VarEstimatorTrendofMean) using constant weights, equal to $1/r$, for the $r$ estimators of the mean. 




```{r, echo=FALSE}
rm(list=ls())
```

